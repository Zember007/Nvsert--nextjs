{"version":3,"file":"react-photo-view.modern.js","sources":["../src/hooks/useMethods.ts","../src/hooks/useSetState.ts","../src/photo-context.ts","../src/variables.ts","../src/utils/isTouchDevice.ts","../src/hooks/useIsomorphicLayoutEffect.ts","../src/components/SlidePortal.tsx","../src/components/CloseIcon.tsx","../src/components/ArrowLeft.tsx","../src/components/ArrowRight.tsx","../src/components/PreventScroll.tsx","../node_modules/curtainsjs/src/utils/utils.js","../node_modules/curtainsjs/src/core/Scene.js","../node_modules/curtainsjs/src/utils/CacheManager.js","../node_modules/curtainsjs/src/utils/CallbackQueueManager.js","../node_modules/curtainsjs/src/core/Renderer.js","../node_modules/curtainsjs/src/utils/ScrollManager.js","../node_modules/curtainsjs/src/core/Curtains.js","../node_modules/curtainsjs/src/core/Uniforms.js","../node_modules/curtainsjs/src/shaders/chunks/precision.medium.glsl.js","../node_modules/curtainsjs/src/shaders/chunks/default.attributes.glsl.js","../node_modules/curtainsjs/src/shaders/chunks/default.varyings.glsl.js","../node_modules/curtainsjs/src/shaders/plane.vertex.glsl.js","../node_modules/curtainsjs/src/shaders/plane.fragment.glsl.js","../node_modules/curtainsjs/src/shaders/shaderpass.vertex.glsl.js","../node_modules/curtainsjs/src/shaders/shaderpass.fragment.glsl.js","../node_modules/curtainsjs/src/core/Program.js","../node_modules/curtainsjs/src/core/Geometry.js","../node_modules/curtainsjs/src/math/Mat4.js","../node_modules/curtainsjs/src/math/Vec2.js","../node_modules/curtainsjs/src/math/Vec3.js","../node_modules/curtainsjs/src/core/Texture.js","../node_modules/curtainsjs/src/loaders/TextureLoader.js","../node_modules/curtainsjs/src/loaders/PlaneTextureLoader.js","../node_modules/curtainsjs/src/core/Mesh.js","../node_modules/curtainsjs/src/core/DOMMesh.js","../node_modules/curtainsjs/src/camera/Camera.js","../node_modules/curtainsjs/src/math/Quat.js","../node_modules/curtainsjs/src/core/Plane.js","../node_modules/gsap/gsap-core.js","../node_modules/gsap/CSSPlugin.js","../node_modules/gsap/index.js","../src/hooks/webgl.js","../src/PhotoSlider.tsx","../src/hooks/useAnimationVisible.tsx","../src/hooks/useForkedVariable.ts","../src/utils/limitTarget.ts","../src/hooks/useEventListener.ts","../src/hooks/useAdjacentImages.ts","../src/PhotoProvider.tsx","../src/PhotoView.tsx","../src/hooks/useInitial.ts"],"sourcesContent":["import { useRef } from 'react';\n\n/**\n * Hook of persistent methods\n */\nexport default function useMethods<T extends Record<string, (...args: any[]) => any>>(fn: T) {\n  const { current } = useRef({\n    fn,\n    curr: undefined as T | undefined,\n  });\n  current.fn = fn;\n\n  if (!current.curr) {\n    const curr = Object.create(null);\n    Object.keys(fn).forEach((key) => {\n      curr[key] = (...args: unknown[]) => current.fn[key].call(current.fn, ...args);\n    });\n    current.curr = curr;\n  }\n\n  return current.curr as T;\n}\n","import { useReducer } from 'react';\n\nexport default function useSetState<S extends Record<string, any>>(initialState: S) {\n  return useReducer(\n    (state: S, action: Partial<S> | ((state: S) => Partial<S>)) => ({\n      ...state,\n      ...(typeof action === 'function' ? action(state) : action),\n    }),\n    initialState,\n  );\n}\n","import { createContext } from 'react';\nimport type { DataType } from './types';\n\nexport type UpdateItemType = (dataType: DataType) => void;\n\nexport interface PhotoContextType {\n  show: (key: number) => void;\n  update: UpdateItemType;\n  remove: (key: number) => void;\n  nextId: () => number;\n}\n\nexport default createContext<PhotoContextType>(undefined as unknown as PhotoContextType);\n","/**\n * 最大触摸时间\n */\nexport const maxTouchTime = 200;\n\n/**\n * 默认动画速度\n */\nexport const defaultSpeed = 400;\n\n/**\n * 默认动画函数\n */\nexport const defaultEasing = 'cubic-bezier(0.25, 0.8, 0.25, 1)';\n\n/**\n * 最大滑动切换图片距离\n */\nexport const maxMoveOffset = 40;\n\n/**\n * 图片的间隔\n */\nexport const horizontalOffset = 20;\n\n/**\n * 最小初始响应距离\n */\nexport const minStartTouchOffset = 20;\n\n/**\n * 默认背景透明度\n */\nexport const defaultOpacity = 1;\n\n/**\n * 最小缩放度\n */\nexport const minScale = 1;\n\n/**\n * 最大缩放度（若图片足够大，则会超出）\n */\nexport const maxScale = 6;\n\n/**\n * 最小长图模式比例\n */\nexport const longModeRatio = 3;\n\n/**\n * 缩放弹性缓冲\n */\nexport const scaleBuffer = 0.2;\n\n/**\n * 最大等待动画时间\n */\nexport const maxWaitAnimationTime = 250;\n","/**\n * 是否支持触摸设备\n */\nconst isTouchDevice = typeof window !== 'undefined' && 'ontouchstart' in window;\n\nexport default isTouchDevice;\n","import { useEffect, useLayoutEffect } from 'react';\n\nconst isSSR = typeof window === 'undefined' || /ServerSideRendering/.test(navigator && navigator.userAgent);\n\nexport default isSSR ? useEffect : useLayoutEffect;\n","import React from 'react';\nimport { createPortal } from 'react-dom';\nimport './SlidePortal.less';\n\nexport interface ISliderPortalProps extends React.HTMLAttributes<HTMLDivElement> {\n  container?: HTMLElement;\n}\n\nfunction SlidePortal({ container = document.body, ...rest }: ISliderPortalProps) {\n  return createPortal(<div {...rest} />, container);\n}\n\nexport default SlidePortal;\n","import React, { ButtonHTMLAttributes } from 'react';\n\nfunction CloseIcon(props: any) {\n  return (\n    <button {...props}>\n      <div className=\"in\">\n        <div className=\"close-button-block\"></div>\n        <div className=\"close-button-block\"></div>\n      </div>\n      <div className=\"out\">\n        <div className=\"close-button-block\"></div>\n        <div className=\"close-button-block\"></div>\n      </div>\n    </button>\n  );\n}\n\nexport default CloseIcon;\n","import React from 'react';\n\nfunction ArrowLeft(props: React.HTMLAttributes<SVGElement>) {\n  return (\n    <svg width=\"44\" height=\"44\" viewBox=\"0 0 768 768\" {...props}>\n      <path d=\"M640.5 352.5v63h-390l178.5 180-45 45-256.5-256.5 256.5-256.5 45 45-178.5 180h390z\" />\n    </svg>\n  );\n}\n\nexport default ArrowLeft;\n","import React from 'react';\n\nfunction ArrowRight(props: React.HTMLAttributes<SVGElement>) {\n  return (\n    <svg width=\"44\" height=\"44\" viewBox=\"0 0 768 768\" {...props}>\n      <path d=\"M384 127.5l256.5 256.5-256.5 256.5-45-45 178.5-180h-390v-63h390l-178.5-180z\" />\n    </svg>\n  );\n}\n\nexport default ArrowRight;\n","import { useEffect } from 'react';\n\nexport default function PreventScroll() {\n  useEffect(() => {\n    const { style } = document.body;\n    const lastOverflow = style.overflow;\n    style.overflow = 'hidden';\n\n    return () => {\n      style.overflow = lastOverflow;\n    };\n  }, []);\n\n  return null;\n}\n","/***\r\n Throw a console warning with the passed arguments\r\n ***/\r\n\r\nlet warningThrown = 0;\r\n\r\nexport function throwWarning() {\r\n    if(warningThrown > 100) {\r\n        return;\r\n    }\r\n    else if(warningThrown === 100) {\r\n        console.warn(\"Curtains: too many warnings thrown, stop logging.\");\r\n    }\r\n    else {\r\n        const args = Array.prototype.slice.call(arguments);\r\n        console.warn.apply(console, args);\r\n    }\r\n\r\n    warningThrown++;\r\n}\r\n\r\n\r\n/***\r\n Throw a console error with the passed arguments\r\n ***/\r\nexport function throwError() {\r\n    const args = Array.prototype.slice.call(arguments);\r\n    console.error.apply(console, args);\r\n}\r\n\r\n\r\n/***\r\n Generates an universal unique identifier\r\n ***/\r\nexport function generateUUID() {\r\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\r\n        let r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);\r\n        return v.toString(16).toUpperCase();\r\n    });\r\n}\r\n\r\n\r\n/***\r\n Check whether a number is power of 2\r\n\r\n params:\r\n @value (float): number to check\r\n ***/\r\nexport function isPowerOf2(value) {\r\n    return (value & (value - 1)) === 0;\r\n}\r\n\r\n\r\n/***\r\n Linear interpolation between two numbers\r\n\r\n params:\r\n @start (float): value to lerp\r\n @end (float): end value to use for lerp\r\n @amount (float): amount of lerp\r\n ***/\r\nexport function lerp(start, end, amount) {\r\n    return (1 - amount) * start + amount * end;\r\n}","import {throwError} from '../utils/utils.js';\r\n\r\n/***\r\n Here we create our Scene object\r\n The Scene will stack all the objects that will be drawn (planes and shader passes) in different arrays, and call them in the right order to be drawn.\r\n\r\n Based on the concept exposed here https://webgl2fundamentals.org/webgl/lessons/webgl-drawing-multiple-things.html\r\n The idea is to optimize the order of the rendered object so that the WebGL calls are kept to a strict minimum\r\n\r\n Here's the whole draw process order:\r\n - first we draw the ping pong planes\r\n - if needed, we bind the first scene pass frame buffer\r\n - draw all the planes that are rendered onto a render target (render pass)\r\n - draw the planes from the first render target created, ordered by their renderOrder then indexes (first added first drawn) order\r\n - draw the planes from the second render target created, etc.\r\n - draw the render passes content (depth buffer is cleared after each pass)\r\n - draw the transparent planes ordered by renderOrder, Z positions, geometry IDs and then indexes (first added first drawn)\r\n - draw the opaque planes ordered by renderOrder, geometry IDs and then indexes (first added first drawn)\r\n - draw the scene passes content\r\n\r\n params:\r\n @renderer (Renderer class object): our renderer class object\r\n\r\n returns :\r\n @this: our Scene\r\n ***/\r\n\r\nexport class Scene {\r\n    constructor(renderer) {\r\n        this.type = \"Scene\";\r\n        if(!renderer || renderer.type !== \"Renderer\") {\r\n            throwError(this.type + \": Renderer not passed as first argument\", renderer);\r\n        }\r\n        else if(!renderer.gl) {\r\n            throwError(this.type + \": Renderer WebGL context is undefined\", renderer);\r\n\r\n            // return if no gl context\r\n            return;\r\n        }\r\n\r\n        this.renderer = renderer;\r\n        this.gl = renderer.gl;\r\n\r\n        this.initStacks();\r\n    }\r\n\r\n    /***\r\n     Init our Scene stacks object\r\n     ***/\r\n    initStacks() {\r\n        this.stacks = {\r\n            // planes\r\n            \"pingPong\": [],\r\n            \"renderTargets\": [],\r\n            \"opaque\": [],\r\n            \"transparent\": [],\r\n\r\n            // post processing\r\n            \"renderPasses\": [],\r\n            \"scenePasses\": [],\r\n        };\r\n    }\r\n\r\n    /*** RESET STACKS ***/\r\n\r\n    /***\r\n     Reset the plane stacks (used when disposing a plane)\r\n     ***/\r\n    resetPlaneStacks() {\r\n        // clear the plane stacks\r\n        this.stacks.pingPong = [];\r\n        this.stacks.renderTargets = [];\r\n        this.stacks.opaque = [];\r\n        this.stacks.transparent = [];\r\n\r\n        // rebuild them with the new plane indexes\r\n        for(let i = 0; i < this.renderer.planes.length; i++) {\r\n            this.addPlane(this.renderer.planes[i]);\r\n        }\r\n    }\r\n\r\n    /***\r\n     Reset the shader pass stacks (used when disposing a shader pass)\r\n     ***/\r\n    resetShaderPassStacks() {\r\n        // now rebuild the drawStacks\r\n        // start by clearing all drawstacks\r\n        this.stacks.scenePasses = [];\r\n        this.stacks.renderPasses = [];\r\n\r\n        // restack our planes with new indexes\r\n        for(let i = 0; i < this.renderer.shaderPasses.length; i++) {\r\n            this.renderer.shaderPasses[i].index = i;\r\n            if(this.renderer.shaderPasses[i]._isScenePass) {\r\n                this.stacks.scenePasses.push(this.renderer.shaderPasses[i]);\r\n            }\r\n            else {\r\n                this.stacks.renderPasses.push(this.renderer.shaderPasses[i]);\r\n            }\r\n        }\r\n\r\n        // reset the scenePassIndex if needed\r\n        if(this.stacks.scenePasses.length === 0) {\r\n            this.renderer.state.scenePassIndex = null;\r\n        }\r\n    }\r\n\r\n    /*** ADDING PLANES ***/\r\n\r\n\r\n    /***\r\n     Add a plane to our renderTargets stack\r\n\r\n     params:\r\n     @plane (Plane object): plane to add to our stack\r\n     ***/\r\n    addToRenderTargetsStack(plane) {\r\n        // find all planes that are rendered onto a render target\r\n        const renderTargetsPlanes = this.renderer.planes.filter(el => el.type !== \"PingPongPlane\" && el.target && el.uuid !== plane.uuid);\r\n\r\n        // is there any plane that is already rendered onto that plane's render target?\r\n        let siblingPlaneIndex = -1;\r\n        if(plane.target._depth) {\r\n            // findLastIndex\r\n            for (let i = renderTargetsPlanes.length - 1; i >= 0; i--) {\r\n                if (renderTargetsPlanes[i].target.uuid === plane.target.uuid) {\r\n                    siblingPlaneIndex = i + 1;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            // findIndex\r\n            siblingPlaneIndex = renderTargetsPlanes.findIndex(el => el.target.uuid === plane.target.uuid);\r\n        }\r\n\r\n        // if findIndex returned -1, just push the plane\r\n        siblingPlaneIndex = Math.max(0, siblingPlaneIndex);\r\n        renderTargetsPlanes.splice(siblingPlaneIndex, 0, plane);\r\n\r\n        // sort by index (order of addition) then render order, depending on whether the render target handle depth or not\r\n        if(plane.target._depth) {\r\n            renderTargetsPlanes.sort((a, b) => a.index - b.index);\r\n            renderTargetsPlanes.sort((a, b) => b.renderOrder - a.renderOrder);\r\n        }\r\n        else {\r\n            renderTargetsPlanes.sort((a, b) => b.index - a.index);\r\n            renderTargetsPlanes.sort((a, b) => a.renderOrder - b.renderOrder);\r\n        }\r\n\r\n        // sort by render targets order\r\n        renderTargetsPlanes.sort((a, b) => a.target.index - b.target.index);\r\n\r\n        this.stacks.renderTargets = renderTargetsPlanes;\r\n    }\r\n\r\n\r\n    /***\r\n     Rebuilds our regular stack (transparent or opaque) with our plane added, geometry IDs and then indexes (first added first drawn)\r\n\r\n     params:\r\n     @plane (Plane object): plane to add to our stack\r\n\r\n     returns:\r\n     @planeStack (array): our transparent or opaque stack ready to be applied custom sorting filter\r\n     ***/\r\n    addToRegularPlaneStack(plane) {\r\n        // get all planes that have same transparency\r\n        const planeStack = this.renderer.planes.filter(el => el.type !== \"PingPongPlane\" && !el.target && el._transparent === plane._transparent && el.uuid !== plane.uuid);\r\n\r\n        // find if there's already a plane with the same geometry with a findLastIndex function\r\n        let siblingPlaneIndex = -1;\r\n\r\n        for(let i = planeStack.length - 1; i >= 0; i--) {\r\n            if(planeStack[i]._geometry.definition.id === plane._geometry.definition.id) {\r\n                siblingPlaneIndex = i + 1;\r\n                break;\r\n            }\r\n        }\r\n\r\n        // if findIndex returned -1 (no matching geometry or program)\r\n        siblingPlaneIndex = Math.max(0, siblingPlaneIndex);\r\n\r\n        // add it to our stack plane array\r\n        planeStack.splice(siblingPlaneIndex, 0, plane);\r\n\r\n        // sort by indexes\r\n        planeStack.sort((a, b) => a.index - b.index);\r\n\r\n        return planeStack;\r\n    }\r\n\r\n    /***\r\n     This function will add a plane into one of our 4 stacks : pingPong, renderTargets, transparent and opaque\r\n     - pingPong is just a simple array (ordered by order of creation)\r\n     - renderTargets array is ordered by render target creation order, planes renderOrder value and then planes indexes (order of creation)\r\n     - transparent array is ordered by renderOrder, Z positions, geometry IDs and then indexes (first added first drawn)\r\n     - opaque array is ordered by renderOrder, geometry IDs and then indexes (first added first drawn)\r\n\r\n     This is done to improve speed and reduce GL calls\r\n\r\n     params:\r\n     @plane (Plane object): plane to add to our scene\r\n     ***/\r\n    addPlane(plane) {\r\n        if(plane.type === \"PingPongPlane\") {\r\n            this.stacks.pingPong.push(plane);\r\n        }\r\n        else if(plane.target) {\r\n            this.addToRenderTargetsStack(plane);\r\n        }\r\n        else {\r\n            if(plane._transparent) {\r\n                // rebuild a stack of all transparent planes\r\n                const planeStack = this.addToRegularPlaneStack(plane);\r\n\r\n                // sort by their depth position\r\n                planeStack.sort((a, b) => b.relativeTranslation.z - a.relativeTranslation.z);\r\n\r\n                // then sort by their render order\r\n                planeStack.sort((a, b) => b.renderOrder - a.renderOrder);\r\n\r\n                this.stacks.transparent = planeStack;\r\n            }\r\n            else {\r\n                // rebuild a stack of all opaque planes\r\n                const planeStack = this.addToRegularPlaneStack(plane);\r\n\r\n                // then sort by their render order\r\n                planeStack.sort((a, b) => b.renderOrder - a.renderOrder);\r\n\r\n                this.stacks.opaque = planeStack;\r\n            }\r\n        }\r\n    }\r\n\r\n    /***\r\n     This function will remove a plane from our scene. This just reset the plane stacks for now.\r\n     Useful if we'd want to change the way our draw stacks work and keep the logic separated from our renderer\r\n\r\n     params:\r\n     @plane (Plane object): plane to remove from our scene\r\n     ***/\r\n    removePlane(plane) {\r\n        if(plane.type === \"PingPongPlane\") {\r\n            this.stacks.pingPong = this.stacks.pingPong.filter(el => el.uuid !== plane.uuid);\r\n        }\r\n        else if(plane.target) {\r\n            this.stacks.renderTargets = this.stacks.renderTargets.filter(el => el.uuid !== plane.uuid);\r\n        }\r\n        else {\r\n            if(plane._transparent) {\r\n                this.stacks.transparent = this.stacks.transparent.filter(el => el.uuid !== plane.uuid);\r\n            }\r\n            else {\r\n                this.stacks.opaque = this.stacks.opaque.filter(el => el.uuid !== plane.uuid);\r\n            }\r\n        }\r\n    }\r\n\r\n    /***\r\n     Changing the position of a plane inside the correct plane stack to render it on above or behind the other planes\r\n\r\n     params:\r\n     @plane (Plane object): the plane that had its renderOrder property updated\r\n     ***/\r\n    setPlaneRenderOrder(plane) {\r\n        if(plane.type === \"ShaderPass\") {\r\n            this.sortShaderPassStack(plane._isScenePass ? this.stacks.scenePasses : this.stacks.renderPasses);\r\n        }\r\n        else if(plane.type === \"PingPongPlane\") {\r\n            // this does not makes any sense for ping pong planes\r\n            return;\r\n        }\r\n\r\n        if(plane.target) {\r\n            // sort by index (order of addition) then render order, depending on whether the render target handle depth or not\r\n            if(plane.target._depth) {\r\n                this.stacks.renderTargets.sort((a, b) => a.index - b.index);\r\n                this.stacks.renderTargets.sort((a, b) => b.renderOrder - a.renderOrder);\r\n            }\r\n            else {\r\n                this.stacks.renderTargets.sort((a, b) => b.index - a.index);\r\n                this.stacks.renderTargets.sort((a, b) => a.renderOrder - b.renderOrder);\r\n            }\r\n\r\n            // then sort by render targets order\r\n            this.stacks.renderTargets.sort((a, b) => a.target.index - b.target.index);\r\n        }\r\n        else {\r\n            const planeStack = plane._transparent ?\r\n                this.stacks.transparent\r\n                : this.stacks.opaque;\r\n\r\n            // if the first drawn scene pass does not handle depth, we'll have to sort them in the inverse order\r\n            const scenePassWithoutDepth = this.stacks.scenePasses.find((pass, index) => pass._isScenePass && !pass._depth && index === 0);\r\n\r\n            if(!this.renderer.depth || scenePassWithoutDepth) {\r\n                // inverted sorting\r\n\r\n                // sort by indexes\r\n                planeStack.sort((a, b) => b.index - a.index);\r\n\r\n                if(plane._transparent) {\r\n                    // if plane is transparent, sort by their depth position\r\n                    planeStack.sort((a, b) => a.relativeTranslation.z - b.relativeTranslation.z);\r\n                }\r\n\r\n                // then sort by render order\r\n                planeStack.sort((a, b) => a.renderOrder - b.renderOrder);\r\n            }\r\n            else {\r\n                // regular sorting\r\n\r\n                // sort by indexes\r\n                planeStack.sort((a, b) => a.index - b.index);\r\n\r\n                if(plane._transparent) {\r\n                    // if plane is transparent, sort by their depth position\r\n                    planeStack.sort((a, b) => b.relativeTranslation.z - a.relativeTranslation.z);\r\n                }\r\n\r\n                // then sort by render order\r\n                planeStack.sort((a, b) => b.renderOrder - a.renderOrder);\r\n            }\r\n        }\r\n    }\r\n\r\n    /*** ADDING POST PROCESSING ***/\r\n\r\n    /***\r\n     Add a shader pass to the stack\r\n\r\n     params:\r\n     @shaderPass (ShaderPass object): shaderPass to add to our scene\r\n     ***/\r\n    addShaderPass(shaderPass) {\r\n        if(!shaderPass._isScenePass) {\r\n            this.stacks.renderPasses.push(shaderPass);\r\n            this.sortShaderPassStack(this.stacks.renderPasses);\r\n        }\r\n        else {\r\n            this.stacks.scenePasses.push(shaderPass);\r\n            this.sortShaderPassStack(this.stacks.scenePasses);\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     This function will remove a shader pass from our scene. This just reset the shaderPass stacks for now.\r\n     Useful if we'd want to change the way our draw stacks work and keep the logic separated from our renderer\r\n\r\n     params:\r\n     @shaderPass (ShaderPass object): shader pass to remove from our scene\r\n     ***/\r\n    removeShaderPass(shaderPass) {\r\n        this.resetShaderPassStacks();\r\n    }\r\n\r\n\r\n    /***\r\n     Sorts the shader pass stack by index then by renderOrder property\r\n\r\n     params:\r\n     @passStack (array): which shader pass stack (scenePasses or renderPasses) to sort\r\n     ***/\r\n    sortShaderPassStack(passStack) {\r\n        passStack.sort((a, b) => a.index - b.index);\r\n        passStack.sort((a, b) => a.renderOrder - b.renderOrder);\r\n    }\r\n\r\n    /*** DRAWING SCENE ***/\r\n\r\n    /***\r\n     Enable the first Shader pass scene pass\r\n     ***/\r\n    enableShaderPass() {\r\n        if(this.stacks.scenePasses.length && this.stacks.renderPasses.length === 0 && this.renderer.planes.length) {\r\n            this.renderer.state.scenePassIndex = 0;\r\n            this.renderer.bindFrameBuffer(this.stacks.scenePasses[0].target);\r\n        }\r\n    }\r\n\r\n    /***\r\n     Draw the render passes\r\n     ***/\r\n    drawRenderPasses() {\r\n        // if we got one or multiple scene passes after the render passes, bind the first scene pass here\r\n        if(this.stacks.scenePasses.length && this.stacks.renderPasses.length && this.renderer.planes.length) {\r\n            this.renderer.state.scenePassIndex = 0;\r\n            this.renderer.bindFrameBuffer(this.stacks.scenePasses[0].target);\r\n        }\r\n\r\n        for(let i = 0; i < this.stacks.renderPasses.length; i++) {\r\n            this.stacks.renderPasses[i]._startDrawing();\r\n\r\n            // we need to clear our depth buffer to display previously drawn render passes\r\n            this.renderer.clearDepth();\r\n        }\r\n    }\r\n\r\n    /***\r\n     Draw the scene passes\r\n     ***/\r\n    drawScenePasses() {\r\n        // then the scene passes\r\n        for(let i = 0; i < this.stacks.scenePasses.length; i++) {\r\n            this.stacks.scenePasses[i]._startDrawing();\r\n        }\r\n    }\r\n\r\n    /***\r\n     Loop through the special ping pong planes stack and draw its planes\r\n     ***/\r\n    drawPingPongStack() {\r\n        for(let i = 0; i < this.stacks.pingPong.length; i++) {\r\n            const plane = this.stacks.pingPong[i];\r\n            // be sure the plane exists\r\n            if(plane) {\r\n                // draw the plane\r\n                plane._startDrawing();\r\n            }\r\n        }\r\n    }\r\n\r\n    /***\r\n     Loop through one of our stack (renderTargets, opaque or transparent objects) and draw its planes\r\n     ***/\r\n    drawStack(stackType) {\r\n        for(let i = 0; i < this.stacks[stackType].length; i++) {\r\n            const plane = this.stacks[stackType][i];\r\n            // be sure the plane exists\r\n            if(plane) {\r\n                // draw the plane\r\n                plane._startDrawing();\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     Draw our scene content\r\n     ***/\r\n    draw() {\r\n        // always draw our ping pong planes first!\r\n        this.drawPingPongStack();\r\n\r\n        // enable first frame buffer for shader passes if needed\r\n        this.enableShaderPass();\r\n\r\n        // our planes that are drawn onto a render target\r\n        this.drawStack(\"renderTargets\");\r\n\r\n        // then draw the content of our render targets render passes\r\n        this.drawRenderPasses();\r\n\r\n        // disable blending for the opaque planes\r\n        this.renderer.setBlending(false);\r\n\r\n        // loop on our stacked planes\r\n        this.drawStack(\"opaque\");\r\n\r\n        // set blending and draw transparents planes only if we have some\r\n        if(this.stacks.transparent.length) {\r\n            this.renderer.setBlending(true);\r\n\r\n            // draw the transparent planes\r\n            this.drawStack(\"transparent\");\r\n        }\r\n\r\n        // now draw the render targets scene passes\r\n        this.drawScenePasses();\r\n    }\r\n}","/***\r\n Here we create a CacheManager class object\r\n This will store geometries attributes arrays, textures and WebGL programs in arrays\r\n This helps speed up slow synchronous CPU operations such as WebGL shaders compilations, images decoding, etc.\r\n\r\n returns :\r\n @this: our CacheManager class object\r\n ***/\r\nexport class CacheManager {\r\n    constructor() {\r\n        // never clear cached geometries\r\n        this.geometries = [];\r\n\r\n        this.clear();\r\n    }\r\n\r\n    /***\r\n     Clear WebGL context depending cache arrays (used on init and context restoration)\r\n     ***/\r\n    clear() {\r\n        // only cache images textures for now\r\n        this.textures = [];\r\n\r\n        // cached programs\r\n        this.programs = [];\r\n    }\r\n\r\n\r\n    /*** GEOMETRIES ***/\r\n\r\n    /***\r\n     Check if this geometry is already in our cached geometries array\r\n\r\n     params:\r\n     @definitionID (integer): the geometry ID\r\n     ***/\r\n    getGeometryFromID(definitionID) {\r\n        return this.geometries.find(element => element.id === definitionID);\r\n    }\r\n\r\n    /***\r\n     Add a geometry to our cache if not already in it\r\n\r\n     params:\r\n     @definitionID  (integer): the geometry ID to add to our cache\r\n     @vertices (array): vertices coordinates array to add to our cache\r\n     @uvs (array): uvs coordinates array to add to our cache\r\n     ***/\r\n    addGeometry(definitionID, vertices, uvs) {\r\n        this.geometries.push({\r\n            id: definitionID,\r\n            vertices: vertices,\r\n            uvs: uvs\r\n        });\r\n    }\r\n\r\n\r\n    /*** PROGRAMS ***/\r\n\r\n    /***\r\n     Compare two shaders strings to detect whether they are equal or not\r\n\r\n     params:\r\n     @firstShader (string): shader code\r\n     @secondShader (string): shader code\r\n\r\n     returns:\r\n     @isSameShader (bool): whether both shaders are equal or not\r\n     ***/\r\n    isSameShader(firstShader, secondShader) {\r\n        return firstShader.localeCompare(secondShader) === 0;\r\n    }\r\n\r\n    /***\r\n     Returns a program from our cache if this program's vertex and fragment shaders code are the same as the one provided\r\n\r\n     params:\r\n     @vsCode (string): vertex shader code\r\n     @fsCode (string): fragment shader code\r\n\r\n     returns:\r\n     @program (Program class object or null): our program if it has been found\r\n     ***/\r\n    getProgramFromShaders(vsCode, fsCode) {\r\n        return this.programs.find((element) => {\r\n            return this.isSameShader(element.vsCode, vsCode) && this.isSameShader(element.fsCode, fsCode);\r\n        });\r\n    }\r\n\r\n    /***\r\n     Add a program to our cache\r\n\r\n     params :\r\n     @program (Program class object) : program to add to our cache\r\n     ***/\r\n    addProgram(program) {\r\n        this.programs.push(program);\r\n    }\r\n\r\n\r\n    /*** TEXTURES ***/\r\n\r\n    /***\r\n     Check if this source is already in our cached textures array\r\n\r\n     params :\r\n     @source (HTML element) : html image, video or canvas element (only images for now)\r\n     ***/\r\n    getTextureFromSource(source) {\r\n        const src = typeof source === \"string\" ? source : source.src;\r\n        // return the texture if the source is the same and if it's not the same texture\r\n        return this.textures.find(element => element.source && element.source.src === src);\r\n    }\r\n\r\n    /***\r\n     Add a texture to our cache if not already in it\r\n\r\n     params :\r\n     @texture (Texture class object) : texture to add to our cache\r\n     ***/\r\n    addTexture(texture) {\r\n        const cachedTexture = this.getTextureFromSource(texture.source);\r\n\r\n        if(!cachedTexture) {\r\n            this.textures.push(texture);\r\n        }\r\n    }\r\n\r\n    /***\r\n     Removes a texture from the cache array\r\n\r\n     params :\r\n     @texture (Texture class object) : texture to remove from our cache\r\n     ***/\r\n    removeTexture(texture) {\r\n        // remove from our textures array\r\n        this.textures = this.textures.filter(element => element.uuid !== texture.uuid);\r\n    }\r\n}","/***\r\n Here we create a CallbackQueueManager class object\r\n This allows to store callbacks in a queue array with a timeout of 0 to be executed on next render call\r\n\r\n returns:\r\n @this: our CallbackQueueManager class object\r\n ***/\r\nexport class CallbackQueueManager {\r\n    constructor() {\r\n        this.clear();\r\n    }\r\n\r\n    /***\r\n     Clears our queue array (used on init)\r\n     ***/\r\n    clear() {\r\n        this.queue = [];\r\n    }\r\n\r\n    /***\r\n     Adds a callback to our queue list with a timeout of 0\r\n\r\n     params:\r\n     @callback (function): the callback to execute on next render call\r\n     @keep (bool): whether to keep calling that callback on each rendering call or not (act as a setInterval). Default to false\r\n\r\n     returns:\r\n     @queueItem: the queue item. Allows to keep a track of it and set its keep property to false when needed\r\n     ***/\r\n    add(callback, keep = false) {\r\n        const queueItem = {\r\n            callback,\r\n            keep,\r\n            timeout: null, // keep a reference to the timeout so we can safely delete if afterwards\r\n        };\r\n        queueItem.timeout = setTimeout(() => {\r\n            this.queue.push(queueItem);\r\n        }, 0);\r\n\r\n        return queueItem;\r\n    }\r\n\r\n    /***\r\n     Executes all callbacks in the queue and remove the ones that have their keep property set to false.\r\n     Called at the beginning of each render call\r\n     ***/\r\n    execute() {\r\n        // execute queue callbacks list\r\n        this.queue.map((entry) => {\r\n            if(entry.callback) {\r\n                entry.callback();\r\n            }\r\n\r\n            // clear our timeout\r\n            clearTimeout(this.queue.timeout);\r\n        });\r\n\r\n        // remove all items that have their keep property set to false\r\n        this.queue = this.queue.filter((entry) => entry.keep);\r\n    }\r\n}","import {Scene} from \"./Scene.js\";\r\nimport {CacheManager} from \"../utils/CacheManager.js\";\r\nimport {CallbackQueueManager} from \"../utils/CallbackQueueManager.js\";\r\nimport {throwWarning} from '../utils/utils.js';\r\n\r\n\r\n/***\r\n Here we create our Renderer object\r\n It will create our WebGL context and handle everything that relates to it\r\n Will create a container, append a canvas, handle WebGL extensions, context lost/restoration events\r\n Will create a Scene class object that will keep tracks of all added objects\r\n Will also handle all global WebGL commands, like clearing scene, binding frame buffers, setting depth, blend func, etc.\r\n Will use a state object to handle all those commands and keep a track of what is being drawned to avoid redundant WebGL calls.\r\n\r\n params:\r\n @Curtainsparams see Curtains class object\r\n\r\n @onError (function): called when there has been an error while initiating the WebGL context\r\n @onSuccess (function): called when the WebGL context has been successfully created\r\n @onContextLost (function): called when the WebGL context is lost\r\n @onContextRestored (function): called when the WebGL context is restored\r\n @onSceneChange (function): called every time an object has been added/removed from the scene\r\n\r\n returns :\r\n @this: our Renderer\r\n ***/\r\n\r\nexport class Renderer {\r\n    constructor({\r\n        // inherited from Curtains class object\r\n        alpha,\r\n        antialias,\r\n        premultipliedAlpha,\r\n        depth,\r\n        failIfMajorPerformanceCaveat,\r\n        preserveDrawingBuffer,\r\n        stencil,\r\n        container,\r\n        pixelRatio,\r\n        renderingScale,\r\n        production,\r\n\r\n        // callbacks passed by the Curtains class object on instantiation\r\n        onError,\r\n        onSuccess,\r\n        onContextLost,\r\n        onContextRestored,\r\n        onDisposed,\r\n        onSceneChange,\r\n    }) {\r\n        this.type = \"Renderer\";\r\n        // context attributes\r\n        this.alpha = alpha;\r\n        this.antialias = antialias;\r\n        this.premultipliedAlpha = premultipliedAlpha;\r\n        this.depth = depth;\r\n        this.failIfMajorPerformanceCaveat = failIfMajorPerformanceCaveat;\r\n        this.preserveDrawingBuffer = preserveDrawingBuffer;\r\n        this.stencil = stencil;\r\n\r\n        this.container = container;\r\n\r\n        this.pixelRatio = pixelRatio;\r\n        this._renderingScale = renderingScale;\r\n\r\n        this.production = production;\r\n\r\n        // callbacks\r\n        this.onError = onError;\r\n        this.onSuccess = onSuccess;\r\n        this.onContextLost = onContextLost;\r\n        this.onContextRestored = onContextRestored;\r\n        this.onDisposed = onDisposed;\r\n\r\n        // keep sync between Curtains objects arrays and renderer objects arrays\r\n        this.onSceneChange = onSceneChange;\r\n\r\n        // managing our webgl draw states\r\n        this.initState();\r\n\r\n        // create the canvas\r\n        this.canvas = document.createElement(\"canvas\");\r\n\r\n        // set our webgl context\r\n        const glAttributes = {\r\n            alpha: this.alpha,\r\n            premultipliedAlpha: this.premultipliedAlpha,\r\n            antialias: this.antialias,\r\n            depth: this.depth,\r\n            failIfMajorPerformanceCaveat: this.failIfMajorPerformanceCaveat,\r\n            preserveDrawingBuffer: this.preserveDrawingBuffer,\r\n            stencil: this.stencil,\r\n        };\r\n\r\n        // try webgl2 context first\r\n        this.gl = this.canvas.getContext(\"webgl2\", glAttributes);\r\n        this._isWebGL2 = !!this.gl;\r\n        // fallback to webgl1\r\n        if(!this.gl) {\r\n            this.gl = this.canvas.getContext(\"webgl\", glAttributes) || this.canvas.getContext(\"experimental-webgl\", glAttributes);\r\n        }\r\n\r\n        // WebGL context could not be created\r\n        if(!this.gl) {\r\n            if(!this.production) throwWarning(this.type + \": WebGL context could not be created\");\r\n\r\n            this.state.isActive = false;\r\n\r\n            if(this.onError) {\r\n                this.onError();\r\n            }\r\n\r\n            return;\r\n        }\r\n        else if(this.onSuccess) {\r\n            this.onSuccess();\r\n        }\r\n\r\n        this.initRenderer();\r\n    }\r\n\r\n    /***\r\n     Set/reset our context state object\r\n     ***/\r\n    initState() {\r\n        this.state = {\r\n            // if we are currently rendering\r\n            isActive: true,\r\n            isContextLost: true,\r\n            drawingEnabled: true,\r\n            forceRender: false,\r\n\r\n            // current program ID\r\n            currentProgramID: null,\r\n\r\n            // current geometry drawn\r\n            currentGeometryID: null,\r\n            // whether we should force buffer bindings update\r\n            forceBufferUpdate: false,\r\n\r\n            // if we're using depth test or not\r\n            depthTest: null,\r\n            // blending\r\n            blending: null,\r\n            // face culling\r\n            cullFace: null,\r\n\r\n            // current frame buffer ID\r\n            frameBufferID: null,\r\n            // current scene pass ID\r\n            scenePassIndex: null,\r\n\r\n            // textures\r\n            activeTexture: null,\r\n            unpackAlignment: null,\r\n            flipY: null,\r\n            premultiplyAlpha: null,\r\n        };\r\n    }\r\n\r\n    /***\r\n     Add a callback queueing manager (execute functions on the next render call, see CallbackQueueManager class object)\r\n     ***/\r\n    initCallbackQueueManager() {\r\n        this.nextRender = new CallbackQueueManager();\r\n    }\r\n\r\n    /***\r\n     Init our renderer\r\n     ***/\r\n    initRenderer() {\r\n        this.planes = [];\r\n        this.renderTargets = [];\r\n        this.shaderPasses = [];\r\n\r\n        // context is not lost\r\n        this.state.isContextLost = false;\r\n        this.state.maxTextureSize = this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE);\r\n\r\n        // callback queue\r\n        this.initCallbackQueueManager();\r\n\r\n        // set blend func\r\n        this.setBlendFunc();\r\n\r\n        // enable depth by default\r\n        this.setDepthFunc();\r\n        this.setDepthTest(true);\r\n\r\n        // texture cache\r\n        this.cache = new CacheManager();\r\n\r\n        // init our scene\r\n        this.scene = new Scene(this);\r\n\r\n        // get webgl extensions\r\n        this.getExtensions();\r\n\r\n        // handling context\r\n        this._contextLostHandler = this.contextLost.bind(this);\r\n        this.canvas.addEventListener(\"webglcontextlost\", this._contextLostHandler, false);\r\n\r\n        this._contextRestoredHandler = this.contextRestored.bind(this);\r\n        this.canvas.addEventListener(\"webglcontextrestored\", this._contextRestoredHandler, false);\r\n    }\r\n\r\n    /***\r\n     Get all available WebGL extensions based on WebGL used version\r\n     Called on init and on context restoration\r\n     ***/\r\n    getExtensions() {\r\n        this.extensions = [];\r\n        if(this._isWebGL2) {\r\n            this.extensions['EXT_color_buffer_float'] = this.gl.getExtension('EXT_color_buffer_float');\r\n            this.extensions['OES_texture_float_linear'] = this.gl.getExtension('OES_texture_float_linear');\r\n            this.extensions['EXT_texture_filter_anisotropic'] = this.gl.getExtension('EXT_texture_filter_anisotropic');\r\n            this.extensions['WEBGL_lose_context'] = this.gl.getExtension('WEBGL_lose_context');\r\n        } else {\r\n            this.extensions['OES_vertex_array_object'] = this.gl.getExtension('OES_vertex_array_object');\r\n            this.extensions['OES_texture_float'] = this.gl.getExtension('OES_texture_float');\r\n            this.extensions['OES_texture_float_linear'] = this.gl.getExtension('OES_texture_float_linear');\r\n            this.extensions['OES_texture_half_float'] = this.gl.getExtension('OES_texture_half_float');\r\n            this.extensions['OES_texture_half_float_linear'] = this.gl.getExtension('OES_texture_half_float_linear');\r\n            this.extensions['EXT_texture_filter_anisotropic'] = this.gl.getExtension('EXT_texture_filter_anisotropic');\r\n            this.extensions['OES_element_index_uint'] = this.gl.getExtension('OES_element_index_uint');\r\n            this.extensions['OES_standard_derivatives'] = this.gl.getExtension('OES_standard_derivatives');\r\n            this.extensions['EXT_sRGB'] = this.gl.getExtension('EXT_sRGB');\r\n            this.extensions['WEBGL_depth_texture'] = this.gl.getExtension('WEBGL_depth_texture');\r\n            this.extensions['WEBGL_draw_buffers'] = this.gl.getExtension('WEBGL_draw_buffers');\r\n            this.extensions['WEBGL_lose_context'] = this.gl.getExtension('WEBGL_lose_context');\r\n        }\r\n    }\r\n\r\n\r\n    /*** HANDLING CONTEXT LOST/RESTORE ***/\r\n\r\n    /***\r\n     Called when the WebGL context is lost\r\n     ***/\r\n    contextLost(event) {\r\n        this.state.isContextLost = true;\r\n\r\n        // do not try to restore the context if we're disposing everything!\r\n        if(!this.state.isActive) return;\r\n\r\n        event.preventDefault();\r\n\r\n        this.nextRender.add(() => this.onContextLost && this.onContextLost());\r\n    }\r\n\r\n\r\n    /***\r\n     Call this method to restore your context\r\n     ***/\r\n    restoreContext() {\r\n        // do not try to restore the context if we're disposing everything!\r\n        if(!this.state.isActive) return;\r\n\r\n        this.initState();\r\n\r\n        if(this.gl && this.extensions['WEBGL_lose_context']) {\r\n            this.extensions['WEBGL_lose_context'].restoreContext();\r\n        }\r\n        else {\r\n            if(!this.gl && !this.production) {\r\n                throwWarning(this.type + \": Could not restore the context because the context is not defined\");\r\n            }\r\n            else if(!this.extensions['WEBGL_lose_context'] && !this.production) {\r\n                throwWarning(this.type + \": Could not restore the context because the restore context extension is not defined\");\r\n            }\r\n\r\n            if(this.onError) {\r\n                this.onError();\r\n            }\r\n        }\r\n    }\r\n\r\n    /***\r\n     Check that all objects and textures have been restored\r\n\r\n     returns:\r\n     @isRestored (bool): whether everything has been restored or not\r\n     ***/\r\n    isContextexFullyRestored() {\r\n        let isRestored = true;\r\n        for(let i = 0; i < this.renderTargets.length; i++) {\r\n            if(!this.renderTargets[i].textures[0]._canDraw) {\r\n                isRestored = false;\r\n            }\r\n            break;\r\n        }\r\n\r\n        if(isRestored) {\r\n            for(let i = 0; i < this.planes.length; i++) {\r\n                if(!this.planes[i]._canDraw) {\r\n                    isRestored = false;\r\n                    break;\r\n                }\r\n                else {\r\n                    for(let j = 0; j < this.planes[i].textures.length; j++) {\r\n                        if(!this.planes[i].textures[j]._canDraw) {\r\n                            isRestored = false;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if(isRestored) {\r\n            for(let i = 0; i < this.shaderPasses.length; i++) {\r\n                if(!this.shaderPasses[i]._canDraw) {\r\n                    isRestored = false;\r\n                    break;\r\n                }\r\n                else {\r\n                    for(let j = 0; j < this.shaderPasses[i].textures.length; j++) {\r\n                        if(!this.shaderPasses[i].textures[j]._canDraw) {\r\n                            isRestored = false;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return isRestored;\r\n    }\r\n\r\n    /***\r\n     Called when the WebGL context is restored\r\n     ***/\r\n    contextRestored() {\r\n        this.getExtensions();\r\n\r\n        // set blend func\r\n        this.setBlendFunc();\r\n\r\n        // enable depth by default\r\n        this.setDepthFunc();\r\n        this.setDepthTest(true);\r\n\r\n        // clear texture and programs cache\r\n        this.cache.clear();\r\n\r\n        // reset draw stacks\r\n        this.scene.initStacks();\r\n\r\n        // we need to reset everything : planes programs, shaders, buffers and textures !\r\n        for(let i = 0; i < this.renderTargets.length; i++) {\r\n            this.renderTargets[i]._restoreContext();\r\n        }\r\n\r\n        for(let i = 0; i < this.planes.length; i++) {\r\n            this.planes[i]._restoreContext();\r\n        }\r\n\r\n        // same goes for shader passes\r\n        for(let i = 0; i < this.shaderPasses.length; i++) {\r\n            this.shaderPasses[i]._restoreContext();\r\n        }\r\n\r\n        // callback if everything is restored\r\n        const isRestoredQueue = this.nextRender.add(() => {\r\n            const isRestored = this.isContextexFullyRestored();\r\n            if(isRestored) {\r\n                isRestoredQueue.keep = false;\r\n\r\n                // start drawing again\r\n                this.state.isContextLost = false;\r\n\r\n                if(this.onContextRestored) {\r\n                    this.onContextRestored();\r\n                }\r\n\r\n                // we've changed the objects, keep Curtains class in sync with our renderer\r\n                this.onSceneChange();\r\n\r\n                // force next frame render whatever our drawing flag value\r\n                this.needRender();\r\n            }\r\n        }, true);\r\n    }\r\n\r\n\r\n    /*** SIZING ***/\r\n\r\n    /***\r\n     Updates pixelRatio property\r\n     ***/\r\n    setPixelRatio(pixelRatio) {\r\n        this.pixelRatio = pixelRatio;\r\n    }\r\n\r\n    /***\r\n     Set/reset container sizes and WebGL viewport sizes\r\n     ***/\r\n    setSize() {\r\n        if(!this.gl) return;\r\n\r\n        // get our container bounding client rectangle\r\n        const containerBoundingRect = this.container.getBoundingClientRect();\r\n\r\n        // use the bounding rect values\r\n        this._boundingRect = {\r\n            width: containerBoundingRect.width * this.pixelRatio,\r\n            height: containerBoundingRect.height * this.pixelRatio,\r\n            top: containerBoundingRect.top * this.pixelRatio,\r\n            left: containerBoundingRect.left * this.pixelRatio,\r\n        };\r\n\r\n        // iOS Safari > 8+ has a known bug due to navigation bar appearing/disappearing\r\n        // this causes wrong bounding client rect calculations, especially negative top value when it shouldn't\r\n        // to fix this we'll use a dirty but useful workaround\r\n\r\n        // first we check if we're on iOS Safari\r\n        const isSafari = !!navigator.userAgent.match(/Version\\/[\\d\\.]+.*Safari/);\r\n        const iOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\r\n\r\n        if(isSafari && iOS) {\r\n            // if we are on iOS Safari we'll need a custom function to retrieve our container absolute top position\r\n            function getTopOffset(el) {\r\n                let topOffset = 0;\r\n                while(el && !isNaN(el.offsetTop)) {\r\n                    topOffset += el.offsetTop - el.scrollTop;\r\n                    el = el.offsetParent;\r\n                }\r\n                return topOffset;\r\n            }\r\n\r\n            // use it to update our top value\r\n            this._boundingRect.top = getTopOffset(this.container) * this.pixelRatio;\r\n        }\r\n\r\n        this.canvas.style.width  = Math.floor(this._boundingRect.width / this.pixelRatio) + \"px\";\r\n        this.canvas.style.height = Math.floor(this._boundingRect.height / this.pixelRatio) + \"px\";\r\n\r\n        this.canvas.width = Math.floor(this._boundingRect.width * this._renderingScale);\r\n        this.canvas.height = Math.floor(this._boundingRect.height * this._renderingScale);\r\n\r\n        this.gl.viewport(0, 0, this.gl.drawingBufferWidth, this.gl.drawingBufferHeight);\r\n    }\r\n\r\n    /***\r\n     Resize all our elements: planes, shader passes and render targets\r\n     Their textures will be resized as well\r\n     ***/\r\n    resize() {\r\n        // resize the planes only if they are fully initiated\r\n        for(let i = 0; i < this.planes.length; i++) {\r\n            if(this.planes[i]._canDraw) {\r\n                this.planes[i].resize();\r\n            }\r\n        }\r\n\r\n        // resize the shader passes only if they are fully initiated\r\n        for(let i = 0; i < this.shaderPasses.length; i++) {\r\n            if(this.shaderPasses[i]._canDraw) {\r\n                this.shaderPasses[i].resize();\r\n            }\r\n        }\r\n\r\n        // resize the render targets\r\n        for(let i = 0; i < this.renderTargets.length; i++) {\r\n            this.renderTargets[i].resize();\r\n        }\r\n\r\n        // be sure we'll update the scene even if drawing is disabled\r\n        this.needRender();\r\n    }\r\n\r\n\r\n    /*** CLEAR SCENE ***/\r\n\r\n    /***\r\n     Clear our WebGL scene colors and depth\r\n     ***/\r\n    clear() {\r\n        this.gl.clear(this.gl.COLOR_BUFFER_BIT | this.gl.DEPTH_BUFFER_BIT);\r\n    }\r\n\r\n    /***\r\n     Clear our WebGL scene depth\r\n     ***/\r\n    clearDepth() {\r\n        this.gl.clear(this.gl.DEPTH_BUFFER_BIT);\r\n    }\r\n\r\n    /***\r\n     Clear our WebGL scene colors and depth\r\n     ***/\r\n    clearColor() {\r\n        this.gl.clear(this.gl.COLOR_BUFFER_BIT);\r\n    }\r\n\r\n\r\n    /*** FRAME BUFFER OBJECTS ***/\r\n\r\n    /***\r\n     Called to bind or unbind a FBO\r\n\r\n     params:\r\n     @frameBuffer (frameBuffer): if frameBuffer is not null, bind it, unbind it otherwise\r\n     @cancelClear (bool / undefined): if we should cancel clearing the frame buffer (typically on init & resize)\r\n     ***/\r\n    bindFrameBuffer(frameBuffer, cancelClear) {\r\n        let bufferId = null;\r\n        if(frameBuffer) {\r\n            bufferId = frameBuffer.index;\r\n\r\n            // new frame buffer, bind it\r\n            if(bufferId !== this.state.frameBufferID) {\r\n                this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, frameBuffer._frameBuffer);\r\n\r\n                this.gl.viewport(0, 0, frameBuffer._size.width, frameBuffer._size.height);\r\n\r\n                // if we should clear the buffer content\r\n                if(frameBuffer._shouldClear && !cancelClear) {\r\n                    this.clear();\r\n                }\r\n            }\r\n        }\r\n        else if(this.state.frameBufferID !== null) {\r\n            this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, null);\r\n            this.gl.viewport(0, 0, this.gl.drawingBufferWidth, this.gl.drawingBufferHeight);\r\n        }\r\n\r\n        this.state.frameBufferID = bufferId;\r\n    }\r\n\r\n\r\n    /*** DEPTH ***/\r\n\r\n    /***\r\n     Called to set whether the renderer will handle depth test or not\r\n     Depth test is enabled by default\r\n\r\n     params:\r\n     @setDepth (boolean): if we should enable or disable the depth test\r\n     ***/\r\n    setDepthTest(depthTest) {\r\n        if(depthTest && !this.state.depthTest) {\r\n            this.state.depthTest = depthTest;\r\n            // enable depth test\r\n            this.gl.enable(this.gl.DEPTH_TEST);\r\n        }\r\n        else if(!depthTest && this.state.depthTest) {\r\n            this.state.depthTest = depthTest;\r\n            // disable depth test\r\n            this.gl.disable(this.gl.DEPTH_TEST);\r\n        }\r\n    }\r\n\r\n    /***\r\n     Called to set the depth buffer behavior\r\n     Only available option is gl.LEQUAL at the moment\r\n     (see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/depthFunc)\r\n     ***/\r\n    setDepthFunc() {\r\n        this.gl.depthFunc(this.gl.LEQUAL);\r\n    }\r\n\r\n\r\n    /*** BLENDING ***/\r\n\r\n    /***\r\n     Whether we should enable or disable the blending state\r\n     Used to draw transparent planes\r\n\r\n     params:\r\n     @enableBlending (boolean): if we should enable or disable the blending (default to false)\r\n     ***/\r\n    setBlending(enableBlending = false) {\r\n        if(enableBlending && !this.state.blending) {\r\n            this.state.blending = enableBlending;\r\n            // enable blending\r\n            this.gl.enable(this.gl.BLEND);\r\n        }\r\n        else if(!enableBlending && this.state.blending) {\r\n            this.state.blending = enableBlending;\r\n            // disable blending\r\n            this.gl.disable(this.gl.BLEND);\r\n        }\r\n    }\r\n\r\n    /***\r\n     Called to set the blending function (transparency)\r\n     ***/\r\n    setBlendFunc() {\r\n        // allows transparency\r\n        // based on how three.js solves this\r\n        this.gl.enable(this.gl.BLEND);\r\n        if(this.premultipliedAlpha) {\r\n            this.gl.blendFuncSeparate(this.gl.ONE, this.gl.ONE_MINUS_SRC_ALPHA, this.gl.ONE, this.gl.ONE_MINUS_SRC_ALPHA);\r\n        }\r\n        else {\r\n            this.gl.blendFuncSeparate(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA, this.gl.ONE, this.gl.ONE_MINUS_SRC_ALPHA);\r\n        }\r\n    }\r\n\r\n\r\n    /*** FACE CULLING ***/\r\n\r\n    /***\r\n     Called to set whether we should cull an object face or not\r\n\r\n     params:\r\n     @cullFace (boolean): what face we should cull\r\n     ***/\r\n    setFaceCulling(cullFace) {\r\n        if(this.state.cullFace !== cullFace) {\r\n            this.state.cullFace = cullFace;\r\n\r\n            if(cullFace === \"none\") {\r\n                this.gl.disable(this.gl.CULL_FACE);\r\n            }\r\n            else {\r\n                // default to back face culling\r\n                const faceCulling = cullFace === \"front\" ? this.gl.FRONT : this.gl.BACK;\r\n\r\n                this.gl.enable(this.gl.CULL_FACE);\r\n                this.gl.cullFace(faceCulling);\r\n            }\r\n        }\r\n    }\r\n\r\n    /***\r\n     Tell WebGL to use the specified program if it's not already in use\r\n\r\n     params:\r\n     @program (object): a program object\r\n     ***/\r\n    useProgram(program) {\r\n        if(this.state.currentProgramID === null || this.state.currentProgramID !== program.id) {\r\n            this.gl.useProgram(program.program);\r\n            this.state.currentProgramID = program.id;\r\n        }\r\n    }\r\n\r\n\r\n    /*** PLANES ***/\r\n\r\n\r\n    /***\r\n     Removes a Plane element (that has already been disposed) from the scene and the planes array\r\n\r\n     params:\r\n     @plane (Plane object): the plane to remove\r\n     ***/\r\n    removePlane(plane) {\r\n        if(!this.gl) return;\r\n\r\n        // remove from our planes array\r\n        this.planes = this.planes.filter(element => element.uuid !== plane.uuid);\r\n\r\n        // remove from scene stacks\r\n        this.scene.removePlane(plane);\r\n\r\n        plane = null;\r\n\r\n        // clear the buffer to clean scene\r\n        if(this.gl) this.clear();\r\n\r\n        // we've removed an object, keep Curtains class in sync with our renderer\r\n        this.onSceneChange();\r\n    }\r\n\r\n\r\n    /*** POST PROCESSING ***/\r\n\r\n\r\n    /***\r\n     Completely remove a RenderTarget element\r\n\r\n     params:\r\n     @renderTarget (RenderTarget object): the render target to remove\r\n     ***/\r\n    removeRenderTarget(renderTarget) {\r\n        if(!this.gl) return;\r\n\r\n        let hasPlane = this.planes.find(plane => plane.type !== \"PingPongPlane\" && plane.target && plane.target.uuid === renderTarget.uuid);\r\n\r\n        // loop through all planes that might use that render target and reset it\r\n        for(let i = 0; i < this.planes.length; i++) {\r\n            if(this.planes[i].target && this.planes[i].target.uuid === renderTarget.uuid) {\r\n                this.planes[i].target = null;\r\n            }\r\n        }\r\n\r\n        this.renderTargets = this.renderTargets.filter(element => element.uuid !== renderTarget.uuid);\r\n\r\n        // update render target indexes\r\n        for(let i = 0; i < this.renderTargets.length; i++) {\r\n            this.renderTargets[i].index = i;\r\n        }\r\n\r\n        renderTarget = null;\r\n\r\n        // clear the buffer to clean scene\r\n        if(this.gl) this.clear();\r\n\r\n        // we had at least a plane that was rendered in this render targets stack\r\n        // re init stacks\r\n        if(hasPlane) {\r\n            this.scene.resetPlaneStacks();\r\n        }\r\n\r\n        // we've removed an object, keep Curtains class in sync with our renderer\r\n        this.onSceneChange();\r\n    }\r\n\r\n\r\n    /*** SHADER PASSES ***/\r\n\r\n\r\n    /***\r\n     Removes a ShaderPass element (that has already been disposed) from the scene and the shaderPasses array\r\n\r\n     params:\r\n     @shaderPass (ShaderPass object): the shader pass to remove\r\n     ***/\r\n    removeShaderPass(shaderPass) {\r\n        if(!this.gl) return;\r\n\r\n        // remove from shaderPasses our array\r\n        this.shaderPasses = this.shaderPasses.filter(element => element.uuid !== shaderPass.uuid);\r\n\r\n        // remove from scene stacks\r\n        this.scene.removeShaderPass(shaderPass);\r\n\r\n        shaderPass = null;\r\n\r\n        // clear the buffer to clean scene\r\n        if(this.gl) this.clear();\r\n\r\n        // we've removed an object, keep Curtains class in sync with our renderer\r\n        this.onSceneChange();\r\n    }\r\n\r\n\r\n    /***\r\n     Enables the render loop\r\n     ***/\r\n    enableDrawing() {\r\n        this.state.drawingEnabled = true;\r\n    }\r\n\r\n    /***\r\n     Disables the render loop\r\n     ***/\r\n    disableDrawing() {\r\n        this.state.drawingEnabled = false;\r\n    }\r\n\r\n    /***\r\n     Forces the rendering of the next frame, even if disabled\r\n     ***/\r\n    needRender() {\r\n        this.state.forceRender = true;\r\n    }\r\n\r\n    /***\r\n     Called at each draw call to render our scene and its content\r\n     Also execute our nextRender callback queue\r\n     ***/\r\n    render() {\r\n        if(!this.gl) return;\r\n\r\n        // clear scene first\r\n        this.clear();\r\n\r\n        // reset attributes buffer state\r\n        this.state.currentGeometryID = null;\r\n\r\n        // draw our scene content\r\n        this.scene.draw();\r\n    }\r\n\r\n\r\n    /*** DISPOSING ***/\r\n\r\n    /***\r\n     Delete all cached programs\r\n     ***/\r\n    deletePrograms() {\r\n        // delete all programs from manager\r\n        for(let i = 0; i < this.cache.programs.length; i++) {\r\n            const program = this.cache.programs[i];\r\n            this.gl.deleteProgram(program.program);\r\n        }\r\n    }\r\n\r\n    /***\r\n     Dispose our WebGL context and all its objects\r\n     ***/\r\n    dispose() {\r\n        if(!this.gl) return;\r\n\r\n        this.state.isActive = false;\r\n\r\n        // be sure to delete all planes\r\n        while(this.planes.length > 0) {\r\n            this.removePlane(this.planes[0]);\r\n        }\r\n\r\n        // we need to delete the shader passes also\r\n        while(this.shaderPasses.length > 0) {\r\n            this.removeShaderPass(this.shaderPasses[0]);\r\n        }\r\n\r\n        // finally we need to delete the render targets\r\n        while(this.renderTargets.length > 0) {\r\n            this.removeRenderTarget(this.renderTargets[0]);\r\n        }\r\n\r\n        // wait for all planes to be deleted before stopping everything\r\n        let disposeQueue = this.nextRender.add(() => {\r\n            if(this.planes.length === 0 && this.shaderPasses.length === 0 && this.renderTargets.length === 0) {\r\n                // clear from callback queue\r\n                disposeQueue.keep = false;\r\n\r\n                this.deletePrograms();\r\n\r\n                // clear the buffer to clean scene\r\n                this.clear();\r\n\r\n                this.canvas.removeEventListener(\"webgllost\", this._contextLostHandler, false);\r\n                this.canvas.removeEventListener(\"webglrestored\", this._contextRestoredHandler, false);\r\n\r\n                // lose context\r\n                if(this.gl && this.extensions['WEBGL_lose_context']) {\r\n                    this.extensions['WEBGL_lose_context'].loseContext();\r\n                }\r\n\r\n                // clear canvas state\r\n                this.canvas.width = this.canvas.width;\r\n\r\n                this.gl = null;\r\n\r\n                // remove canvas from DOM\r\n                this.container.removeChild(this.canvas);\r\n\r\n                this.container = null;\r\n                this.canvas = null;\r\n\r\n                this.onDisposed && this.onDisposed();\r\n            }\r\n        }, true);\r\n    }\r\n}","/***\r\n Here we create a ScrollManager class object\r\n This keeps track of our scroll position, scroll deltas and triggers an onScroll callback\r\n Could either listen to the native scroll event or be hooked to any scroll (natural or virtual) scroll event\r\n\r\n params:\r\n @xOffset (float): scroll along X axis\r\n @yOffset (float): scroll along Y axis\r\n @lastXDelta (float): last scroll delta along X axis\r\n @lastYDelta (float): last scroll delta along Y axis\r\n\r\n @shouldWatch (bool): if the scroll manager should listen to the scroll event or not. Default to true.\r\n\r\n @onScroll (function): callback to execute each time the scroll values changed\r\n\r\n returns:\r\n @this: our ScrollManager class object\r\n ***/\r\nexport class ScrollManager {\r\n    constructor({\r\n        xOffset = 0,\r\n        yOffset = 0,\r\n        lastXDelta = 0,\r\n        lastYDelta = 0,\r\n\r\n        shouldWatch = true,\r\n\r\n        onScroll = () => {},\r\n    } = {}) {\r\n        this.xOffset = xOffset;\r\n        this.yOffset = yOffset;\r\n        this.lastXDelta = lastXDelta;\r\n        this.lastYDelta = lastYDelta;\r\n        this.shouldWatch = shouldWatch;\r\n\r\n        this.onScroll = onScroll;\r\n\r\n        // keep a ref to our scroll event\r\n        this.handler = this.scroll.bind(this, true);\r\n        if(this.shouldWatch) {\r\n            window.addEventListener(\"scroll\", this.handler, {\r\n                passive: true\r\n            });\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     Called by the scroll event listener\r\n     ***/\r\n    scroll() {\r\n        this.updateScrollValues(window.pageXOffset, window.pageYOffset)\r\n    }\r\n\r\n\r\n    /***\r\n     Updates the scroll manager X and Y scroll values as well as last X and Y deltas\r\n     Internally called by the scroll handler\r\n     Could be called externally as well if the user wants to handle the scroll by himself\r\n\r\n     params:\r\n     @x (float): scroll value along X axis\r\n     @y (float): scroll value along Y axis\r\n     ***/\r\n    updateScrollValues(x, y) {\r\n        // get our scroll delta values\r\n        const lastScrollXValue = this.xOffset;\r\n        this.xOffset = x;\r\n        this.lastXDelta = lastScrollXValue - this.xOffset;\r\n\r\n        const lastScrollYValue = this.yOffset;\r\n        this.yOffset = y;\r\n        this.lastYDelta = lastScrollYValue - this.yOffset;\r\n\r\n        if(this.onScroll) {\r\n            this.onScroll(this.lastXDelta, this.lastYDelta);\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     Dispose our scroll manager (just remove our event listner if it had been added previously)\r\n     ***/\r\n    dispose() {\r\n        if(this.shouldWatch) {\r\n            window.removeEventListener(\"scroll\", this.handler, {\r\n                passive: true\r\n            });\r\n        }\r\n    }\r\n}","import {Renderer} from \"./Renderer.js\";\r\nimport {ScrollManager} from \"../utils/ScrollManager.js\";\r\nimport {throwWarning, lerp} from \"../utils/utils.js\";\r\n\r\n\r\nconst version = \"8.1.6\";\r\n\r\n/***\r\n Here we create our Curtains object\r\n\r\n\r\n params:\r\n @container (HTML element or string, optional): the container HTML element or ID that will hold our canvas. Could be set later if not passed as parameter here\r\n\r\n (WebGL context parameters)\r\n @alpha (bool, optional): whether the WebGL context should handle transparency. Default to true.\r\n @premultipliedAlpha (bool, optional): whether the WebGL context should handle premultiplied alpha. Default to false.\r\n @antialias (bool, optional): whether the WebGL context should use the default antialiasing. When using render targets, WebGL disables antialiasing, so you can safely set this to false to improve the performance. Default to true.\r\n @depth (bool, optional): whether the WebGL context should handle depth. Default to true.\r\n @failIfMajorPerformanceCaveat (bool, optional): whether the WebGL context creation should fail in case of major performance caveat. Default to true.\r\n @preserveDrawingBuffer (bool, optional): whether the WebGL context should preserve the drawing buffer. Default to false.\r\n @stencil (bool, optional): whether the WebGL context should handle stencil. Default to false.\r\n\r\n @autoResize (bool, optional): Whether the library should listen to the window resize event and actually resize the scene. Set it to false if you want to handle this by yourself using the resize() method. Default to true.\r\n @autoRender (bool, optional): Whether the library should create a request animation frame loop to render the scene. Set it to false if you want to handle this by yourself using the render() method. Default to true.\r\n @watchScroll (bool, optional): Whether the library should listen to the window scroll event. Set it to false if you want to handle this by yourself. Default to true.\r\n\r\n @pixelRatio (float, optional): Defines the pixel ratio value. Use it to limit it on init to increase performance. Default to window.devicePixelRatio.\r\n @renderingScale (float, optional): Use it to downscale your rendering canvas. May improve performance but will decrease quality. Default to 1 (minimum: 0.25, maximum: 1).\r\n\r\n @production (bool, optional): Whether the library should throw useful console warnings and errors and check shaders and programs compilation status. Default to false.\r\n\r\n returns :\r\n @this: our Renderer\r\n ***/\r\nexport class Curtains {\r\n    constructor({\r\n        // renderer container\r\n        container,\r\n\r\n        // webgl params\r\n        alpha = true,\r\n        premultipliedAlpha = false,\r\n        antialias = true,\r\n        depth = true,\r\n        failIfMajorPerformanceCaveat = true,\r\n        preserveDrawingBuffer = false,\r\n        stencil = false,\r\n\r\n        autoResize = true,\r\n        autoRender = true,\r\n        watchScroll = true,\r\n\r\n        pixelRatio = window.devicePixelRatio || 1,\r\n        renderingScale = 1,\r\n\r\n        production = false,\r\n    } = {}) {\r\n        this.type = \"Curtains\";\r\n\r\n        // if we should use auto resize (default to true)\r\n        this._autoResize = autoResize;\r\n        // if we should use auto render (default to true)\r\n        this._autoRender = autoRender;\r\n        // if we should watch the scroll (default to true)\r\n        this._watchScroll = watchScroll;\r\n\r\n        // pixel ratio and rendering scale\r\n        this.pixelRatio = pixelRatio;\r\n        // rendering scale\r\n        renderingScale = isNaN(renderingScale) ? 1 : parseFloat(renderingScale);\r\n        this._renderingScale = Math.max(0.25, Math.min(1, renderingScale));\r\n\r\n        // webgl context parameters\r\n        this.premultipliedAlpha = premultipliedAlpha;\r\n        this.alpha = alpha;\r\n        this.antialias = antialias;\r\n        this.depth = depth;\r\n        this.failIfMajorPerformanceCaveat = failIfMajorPerformanceCaveat;\r\n        this.preserveDrawingBuffer = preserveDrawingBuffer;\r\n        this.stencil = stencil;\r\n\r\n        this.production = production;\r\n\r\n        this.errors = false;\r\n\r\n        // if a container has been provided, proceed to init\r\n        if(container) {\r\n            this.setContainer(container);\r\n        }\r\n        else if(!this.production) {\r\n            throwWarning(this.type + \": no container provided in the initial parameters. Use setContainer() method to set one later and initialize the WebGL context\")\r\n        }\r\n    }\r\n\r\n    /***\r\n     Set up our Curtains container and start initializing everything\r\n     Called on Curtains instancing if a params container has been provided, could be call afterwards else\r\n     Useful with JS frameworks to init our Curtains class globally and then set the container in a canvas component afterwards to fully instantiate everything\r\n\r\n     params:\r\n     @container (HTML element or string): the container HTML element or ID that will hold our canvas\r\n     ***/\r\n    setContainer(container) {\r\n        if(!container) {\r\n            let container = document.createElement(\"div\");\r\n            container.setAttribute(\"id\", \"curtains-canvas\");\r\n            document.body.appendChild(container);\r\n            this.container = container;\r\n            if(!this.production) throwWarning('Curtains: no valid container HTML element or ID provided, created a div with \"curtains-canvas\" ID instead');\r\n        }\r\n        else {\r\n            if(typeof container === \"string\") {\r\n                container = document.getElementById(container);\r\n\r\n                if(!container) {\r\n                    let container = document.createElement(\"div\");\r\n                    container.setAttribute(\"id\", \"curtains-canvas\");\r\n                    document.body.appendChild(container);\r\n                    this.container = container;\r\n                    if(!this.production) throwWarning('Curtains: no valid container HTML element or ID provided, created a div with \"curtains-canvas\" ID instead');\r\n                }\r\n                else {\r\n                    this.container = container;\r\n                }\r\n            }\r\n            else if(container instanceof Element) {\r\n                this.container = container;\r\n            }\r\n        }\r\n\r\n        this._initCurtains();\r\n    }\r\n\r\n\r\n    /***\r\n     Initialize everything that the class will need: WebGL renderer, scroll manager, sizes, listeners\r\n     Then starts our animation frame loop if needed\r\n     ***/\r\n    _initCurtains() {\r\n        this.planes = [];\r\n        this.renderTargets = [];\r\n        this.shaderPasses = [];\r\n\r\n        // init webgl context\r\n        this._initRenderer();\r\n\r\n        if(!this.gl) return;\r\n\r\n        // scroll\r\n        this._initScroll();\r\n\r\n        // sizes\r\n        this._setSize();\r\n\r\n        // event listeners\r\n        this._addListeners();\r\n\r\n        // we are ready to go\r\n        this.container.appendChild(this.canvas);\r\n\r\n        // watermark\r\n        console.log(\"curtains.js - v\" + version);\r\n\r\n        // start rendering\r\n        this._animationFrameID = null;\r\n        if(this._autoRender) {\r\n            this._animate();\r\n        }\r\n    }\r\n\r\n\r\n    /*** WEBGL CONTEXT ***/\r\n\r\n    /***\r\n     Initialize the Renderer class object\r\n     ***/\r\n    _initRenderer() {\r\n        this.renderer = new Renderer({\r\n            alpha: this.alpha,\r\n            antialias: this.antialias,\r\n            premultipliedAlpha: this.premultipliedAlpha,\r\n            depth: this.depth,\r\n            failIfMajorPerformanceCaveat: this.failIfMajorPerformanceCaveat,\r\n            preserveDrawingBuffer: this.preserveDrawingBuffer,\r\n            stencil: this.stencil,\r\n\r\n            container: this.container,\r\n            pixelRatio: this.pixelRatio,\r\n            renderingScale: this._renderingScale,\r\n\r\n            production: this.production,\r\n\r\n            onError: () => this._onRendererError(),\r\n            onSuccess: () => this._onRendererSuccess(),\r\n            onContextLost: () => this._onRendererContextLost(),\r\n            onContextRestored: () => this._onRendererContextRestored(),\r\n            onDisposed: () => this._onRendererDisposed(),\r\n            // keep sync between renderer planes, shader passes and render targets arrays and the Curtains ones\r\n            onSceneChange: () => this._keepSync(),\r\n        });\r\n\r\n        this.gl = this.renderer.gl;\r\n        this.canvas = this.renderer.canvas;\r\n    }\r\n\r\n\r\n    /***\r\n     Force our renderer to restore the WebGL context\r\n     ***/\r\n    restoreContext() {\r\n        this.renderer.restoreContext();\r\n    }\r\n\r\n\r\n    /***\r\n     This just handles our drawing animation frame\r\n     ***/\r\n    _animate() {\r\n        this.render();\r\n        this._animationFrameID = window.requestAnimationFrame(this._animate.bind(this));\r\n    }\r\n\r\n\r\n    /*** RENDERING ***/\r\n\r\n    /***\r\n     Enables rendering\r\n     ***/\r\n    enableDrawing() {\r\n        this.renderer.enableDrawing();\r\n    }\r\n\r\n    /***\r\n     Disables rendering\r\n     ***/\r\n    disableDrawing() {\r\n        this.renderer.disableDrawing();\r\n    }\r\n\r\n    /***\r\n     Forces the rendering of the next frame, even if disabled\r\n     ***/\r\n    needRender() {\r\n        this.renderer.needRender();\r\n    }\r\n\r\n    /***\r\n     Executes a callback on next frame\r\n\r\n     params:\r\n     @callback (function): callback to execute on next frame\r\n     @keep (bool): whether to keep calling that callback on each rendering call or not (act as a setInterval). Default to false\r\n\r\n     returns:\r\n     @queueItem: the queue item. Allows to keep a track of it and set its keep property to false when needed\r\n     ***/\r\n    nextRender(callback, keep = false) {\r\n        return this.renderer.nextRender.add(callback, keep);\r\n    }\r\n\r\n    /***\r\n     Clear our WebGL renderer colors and depth buffers\r\n     ***/\r\n    clear() {\r\n        this.renderer && this.renderer.clear();\r\n    }\r\n\r\n    /***\r\n     Clear our WebGL renderer depth buffer\r\n     ***/\r\n    clearDepth() {\r\n        this.renderer && this.renderer.clearDepth();\r\n    }\r\n\r\n    /***\r\n     Clear our WebGL renderer color buffer\r\n     ***/\r\n    clearColor() {\r\n        this.renderer && this.renderer.clearColor();\r\n    }\r\n\r\n\r\n    /***\r\n     Check whether the created context is WebGL2\r\n\r\n     return:\r\n     @isWebGL2 (bool): whether the created WebGL context is 2.0 or not\r\n     ***/\r\n    isWebGL2() {\r\n        return this.gl ? this.renderer._isWebGL2 : false;\r\n    }\r\n\r\n\r\n    /***\r\n     Tells our renderer to render the scene if the drawing is enabled\r\n     ***/\r\n    render() {\r\n        // always execute callback queue\r\n        this.renderer.nextRender.execute();\r\n\r\n        // If forceRender is true, force rendering this frame even if drawing is not enabled.\r\n        // If not, only render if enabled.\r\n        if(!this.renderer.state.drawingEnabled && !this.renderer.state.forceRender) {\r\n            return;\r\n        }\r\n\r\n        // reset forceRender\r\n        if(this.renderer.state.forceRender) {\r\n            this.renderer.state.forceRender = false;\r\n        }\r\n\r\n        // Curtains onRender callback\r\n        if(this._onRenderCallback) {\r\n            this._onRenderCallback();\r\n        }\r\n\r\n        this.renderer.render();\r\n    }\r\n\r\n\r\n    /*** LISTENERS ***/\r\n\r\n    /***\r\n     Adds our resize event listener if needed\r\n     ***/\r\n    _addListeners() {\r\n        // handling window resize event\r\n        this._resizeHandler = null;\r\n        if(this._autoResize) {\r\n            this._resizeHandler = this.resize.bind(this, true);\r\n            window.addEventListener(\"resize\", this._resizeHandler, false);\r\n        }\r\n    }\r\n\r\n\r\n    /*** SIZING ***/\r\n\r\n    /***\r\n     Set the pixel ratio property and update everything by calling the resize() method\r\n     ***/\r\n    setPixelRatio(pixelRatio, triggerCallback) {\r\n        this.pixelRatio = parseFloat(Math.max(pixelRatio, 1)) || 1;\r\n        this.renderer.setPixelRatio(pixelRatio);\r\n        // apply new pixel ratio to all our elements but don't trigger onAfterResize callback\r\n        this.resize(triggerCallback);\r\n    }\r\n\r\n\r\n    /***\r\n     Set our renderer container and canvas sizes and update the scroll values\r\n     ***/\r\n    _setSize() {\r\n        this.renderer.setSize();\r\n\r\n        // update scroll values ass well\r\n        if(this._scrollManager.shouldWatch) {\r\n            this._scrollManager.xOffset = window.pageXOffset;\r\n            this._scrollManager.yOffset = window.pageYOffset;\r\n        }\r\n    }\r\n\r\n    /***\r\n     Useful to get our container bounding rectangle without triggering a reflow/layout\r\n\r\n     returns :\r\n     @boundingRectangle (object): an object containing our container bounding rectangle (width, height, top and left properties)\r\n     ***/\r\n    getBoundingRect() {\r\n        return this.renderer._boundingRect;\r\n    }\r\n\r\n\r\n    /***\r\n     Resize our container and the renderer\r\n\r\n     params:\r\n     @triggerCallback (bool): Whether we should trigger onAfterResize callback\r\n     ***/\r\n    resize(triggerCallback) {\r\n        if(!this.gl) return;\r\n\r\n        this._setSize();\r\n\r\n        this.renderer.resize();\r\n\r\n        this.nextRender(() => {\r\n            if(this._onAfterResizeCallback && triggerCallback) {\r\n                this._onAfterResizeCallback();\r\n            }\r\n        });\r\n    }\r\n\r\n    /*** SCROLL ***/\r\n\r\n    /***\r\n     Init our ScrollManager class object\r\n     ***/\r\n    _initScroll() {\r\n        this._scrollManager = new ScrollManager({\r\n            // init values\r\n            xOffset: window.pageXOffset,\r\n            yOffset: window.pageYOffset,\r\n            lastXDelta: 0,\r\n            lastYDelta: 0,\r\n            shouldWatch: this._watchScroll,\r\n\r\n            onScroll: (lastXDelta, lastYDelta) => this._updateScroll(lastXDelta, lastYDelta),\r\n        });\r\n    }\r\n\r\n    /***\r\n     Handles the different values associated with a scroll event (scroll and delta values)\r\n     If no plane watch the scroll then those values won't be retrieved to avoid unnecessary reflow calls\r\n     If at least a plane is watching, update all watching planes positions based on the scroll values\r\n     And force render for at least one frame to actually update the scene\r\n     ***/\r\n    _updateScroll(lastXDelta, lastYDelta) {\r\n        for(let i = 0; i < this.planes.length; i++) {\r\n            // if our plane is watching the scroll, update its position\r\n            if(this.planes[i].watchScroll) {\r\n                this.planes[i].updateScrollPosition(lastXDelta, lastYDelta);\r\n            }\r\n        }\r\n\r\n        // be sure we'll update the scene even if drawing is disabled\r\n        this.renderer.needRender();\r\n\r\n        this._onScrollCallback && this._onScrollCallback();\r\n    }\r\n\r\n\r\n    /***\r\n     Updates the scroll manager X and Y scroll values as well as last X and Y deltas\r\n     Internally called by the scroll handler if at least one plane is watching the scroll\r\n     Could be called externally as well if the user wants to handle the scroll by himself\r\n\r\n     params:\r\n     @x (float): scroll value along X axis\r\n     @y (float): scroll value along Y axis\r\n     ***/\r\n    updateScrollValues(x, y) {\r\n        this._scrollManager.updateScrollValues(x, y);\r\n    }\r\n\r\n\r\n    /***\r\n     Returns last delta scroll values\r\n\r\n     returns:\r\n     @delta (object): an object containing X and Y last delta values\r\n     ***/\r\n    getScrollDeltas() {\r\n        return {\r\n            x: this._scrollManager.lastXDelta,\r\n            y: this._scrollManager.lastYDelta,\r\n        };\r\n    }\r\n\r\n\r\n    /***\r\n     Returns last window scroll values\r\n\r\n     returns:\r\n     @scrollValues (object): an object containing X and Y last scroll values\r\n     ***/\r\n    getScrollValues() {\r\n        return {\r\n            x: this._scrollManager.xOffset,\r\n            y: this._scrollManager.yOffset,\r\n        };\r\n    }\r\n\r\n    /*** ADDING / REMOVING OBJECTS TO THE RENDERER ***/\r\n\r\n    /***\r\n     Always keep sync between renderer and Curtains scene objects when adding/removing objects\r\n     ***/\r\n    _keepSync() {\r\n        this.planes = this.renderer.planes;\r\n        this.shaderPasses = this.renderer.shaderPasses;\r\n        this.renderTargets = this.renderer.renderTargets;\r\n    }\r\n\r\n\r\n    /*** UTILS ***/\r\n\r\n    /***\r\n     Linear interpolation helper defined in utils\r\n     ***/\r\n    lerp(start, end, amount) {\r\n        return lerp(start, end, amount);\r\n    }\r\n\r\n\r\n    /*** EVENTS ***/\r\n\r\n    /***\r\n     This is called each time our container has been resized\r\n\r\n     params :\r\n     @callback (function) : a function to execute\r\n\r\n     returns :\r\n     @this: our Curtains element to handle chaining\r\n     ***/\r\n    onAfterResize(callback) {\r\n        if(callback) {\r\n            this._onAfterResizeCallback = callback;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /***\r\n     This is called when an error has been detected\r\n\r\n     params:\r\n     @callback (function): a function to execute\r\n\r\n     returns:\r\n     @this: our Curtains element to handle chaining\r\n     ***/\r\n    onError(callback) {\r\n        if(callback) {\r\n            this._onErrorCallback = callback;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /***\r\n     This triggers the onError callback and is called by the renderer when an error has been detected\r\n     ***/\r\n    _onRendererError() {\r\n        // be sure that the callback has been registered and only call the global error callback once\r\n        setTimeout(() => {\r\n            if(this._onErrorCallback && !this.errors) {\r\n                this._onErrorCallback();\r\n            }\r\n            this.errors = true;\r\n        }, 0);\r\n    }\r\n\r\n\r\n    /***\r\n     This is called when the WebGL context has been successfully created\r\n\r\n     params:\r\n     @callback (function): a function to execute\r\n\r\n     returns:\r\n     @this: our Curtains element to handle chaining\r\n     ***/\r\n    onSuccess(callback) {\r\n        if(callback) {\r\n            this._onSuccessCallback = callback;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /***\r\n     This triggers the onSuccess callback and is called by the renderer when the context has been successfully created\r\n     ***/\r\n    _onRendererSuccess() {\r\n        setTimeout(() => {\r\n            this._onSuccessCallback && this._onSuccessCallback();\r\n        }, 0);\r\n    }\r\n\r\n\r\n    /***\r\n     This is called once our context has been lost\r\n\r\n     params:\r\n     @callback (function): a function to execute\r\n\r\n     returns:\r\n     @this: our Curtains element to handle chaining\r\n     ***/\r\n    onContextLost(callback) {\r\n        if(callback) {\r\n            this._onContextLostCallback = callback;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /***\r\n     This triggers the onContextLost callback and is called by the renderer when the context has been lost\r\n     ***/\r\n    _onRendererContextLost() {\r\n        this._onContextLostCallback && this._onContextLostCallback();\r\n    }\r\n\r\n\r\n    /***\r\n     This is called once our context has been restored\r\n\r\n     params:\r\n     @callback (function): a function to execute\r\n\r\n     returns:\r\n     @this: our Curtains element to handle chaining\r\n     ***/\r\n    onContextRestored(callback) {\r\n        if(callback) {\r\n            this._onContextRestoredCallback = callback;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /***\r\n     This triggers the onContextRestored callback and is called by the renderer when the context has been restored\r\n     ***/\r\n    _onRendererContextRestored() {\r\n        this._onContextRestoredCallback && this._onContextRestoredCallback();\r\n    }\r\n\r\n\r\n    /***\r\n     This is called once at each request animation frame call\r\n\r\n     params:\r\n     @callback (function): a function to execute\r\n\r\n     returns:\r\n     @this: our Curtains element to handle chaining\r\n     ***/\r\n    onRender(callback) {\r\n        if(callback) {\r\n            this._onRenderCallback = callback;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     This is called each time window is scrolled and if our scrollManager is active\r\n\r\n     params :\r\n     @callback (function) : a function to execute\r\n\r\n     returns :\r\n     @this: our Curtains element to handle chaining\r\n     ***/\r\n    onScroll(callback) {\r\n        if(callback) {\r\n            this._onScrollCallback = callback;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /*** DESTROYING ***/\r\n\r\n    /***\r\n     Dispose everything\r\n     ***/\r\n    dispose() {\r\n        this.renderer.dispose();\r\n    }\r\n\r\n\r\n    /***\r\n     This is called when the renderer has finished disposing all the WebGL stuff\r\n     ***/\r\n    _onRendererDisposed() {\r\n        // cancel animation frame\r\n        this._animationFrameID && window.cancelAnimationFrame(this._animationFrameID);\r\n\r\n        // remove event listeners\r\n        this._resizeHandler && window.removeEventListener(\"resize\", this._resizeHandler, false);\r\n        this._scrollManager && this._scrollManager.dispose();\r\n    }\r\n\r\n}","import {throwError, throwWarning} from '../utils/utils.js';\r\n\r\n/***\r\n Uniforms class manages uniforms setting and updating\r\n\r\n params:\r\n @renderer (Renderer class object): our renderer class object\r\n @program (object): our mesh's Program (see Program class object)\r\n\r\n @uniforms (object): our uniforms object:\r\n - name (string): uniform name to use in your shaders\r\n - type (uniform type): uniform type. Will try to detect it if not set (see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/uniform)\r\n - value (float / int / Vec2 / Vec3 / Mat4 / array): initial value of the uniform\r\n\r\n returns:\r\n @this: our Uniforms manager\r\n ***/\r\n\r\nexport class Uniforms {\r\n    constructor(renderer, program, uniforms) {\r\n        this.type = \"Uniforms\";\r\n        if(!renderer || renderer.type !== \"Renderer\") {\r\n            throwError(this.type + \": Renderer not passed as first argument\", renderer);\r\n        }\r\n        else if(!renderer.gl) {\r\n            throwError(this.type + \": Renderer WebGL context is undefined\", renderer);\r\n\r\n            // return if no gl context\r\n            return;\r\n        }\r\n        this.renderer = renderer;\r\n        this.gl = renderer.gl;\r\n        this.program = program;\r\n\r\n        this.uniforms = {};\r\n\r\n        if(uniforms) {\r\n            for(const key in uniforms) {\r\n                const uniform = uniforms[key];\r\n\r\n                // fill our uniform object\r\n                this.uniforms[key] = {\r\n                    name: uniform.name,\r\n                    type: uniform.type,\r\n                    // clone value if possible, use original value else\r\n                    value: uniform.value.clone && typeof uniform.value.clone === \"function\" ? uniform.value.clone() : uniform.value,\r\n                    update: null,\r\n                };\r\n            }\r\n        }\r\n    }\r\n\r\n    /***\r\n     Set uniforms WebGL function based on their types\r\n\r\n     params :\r\n     @uniform (object): the uniform\r\n     ***/\r\n    handleUniformSetting(uniform) {\r\n        switch(uniform.type) {\r\n            case \"1i\":\r\n                uniform.update = this.setUniform1i.bind(this);\r\n                break;\r\n            case \"1iv\":\r\n                uniform.update = this.setUniform1iv.bind(this);\r\n                break;\r\n            case \"1f\":\r\n                uniform.update = this.setUniform1f.bind(this);\r\n                break;\r\n            case \"1fv\":\r\n                uniform.update = this.setUniform1fv.bind(this);\r\n                break;\r\n\r\n            case \"2i\":\r\n                uniform.update = this.setUniform2i.bind(this);\r\n                break;\r\n            case \"2iv\":\r\n                uniform.update = this.setUniform2iv.bind(this);\r\n                break;\r\n            case \"2f\":\r\n                uniform.update = this.setUniform2f.bind(this);\r\n                break;\r\n            case \"2fv\":\r\n                uniform.update = this.setUniform2fv.bind(this);\r\n                break;\r\n\r\n            case \"3i\":\r\n                uniform.update = this.setUniform3i.bind(this);\r\n                break;\r\n            case \"3iv\":\r\n                uniform.update = this.setUniform3iv.bind(this);\r\n                break;\r\n            case \"3f\":\r\n                uniform.update = this.setUniform3f.bind(this);\r\n                break;\r\n            case \"3fv\":\r\n                uniform.update = this.setUniform3fv.bind(this);\r\n                break;\r\n\r\n            case \"4i\":\r\n                uniform.update = this.setUniform4i.bind(this);\r\n                break;\r\n            case \"4iv\":\r\n                uniform.update = this.setUniform4iv.bind(this);\r\n                break;\r\n            case \"4f\":\r\n                uniform.update = this.setUniform4f.bind(this);\r\n                break;\r\n            case \"4fv\":\r\n                uniform.update = this.setUniform4fv.bind(this);\r\n                break;\r\n\r\n            case \"mat2\":\r\n                uniform.update = this.setUniformMatrix2fv.bind(this);\r\n                break;\r\n            case \"mat3\":\r\n                uniform.update = this.setUniformMatrix3fv.bind(this);\r\n                break;\r\n            case \"mat4\":\r\n                uniform.update = this.setUniformMatrix4fv.bind(this);\r\n                break;\r\n\r\n            default:\r\n                if(!this.renderer.production) throwWarning(this.type + \": This uniform type is not handled : \", uniform.type);\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     Auto detect the format of the uniform (check if its a float, an integer, a Vector, a Matrix, an array...)\r\n     Also set a lastValue property that we'll use to compare to our value property and update the uniform if it changed\r\n\r\n     params :\r\n     @uniform (object): the uniform\r\n     ***/\r\n    setInternalFormat(uniform) {\r\n        if(uniform.value.type === \"Vec2\") {\r\n            uniform._internalFormat = \"Vec2\";\r\n            uniform.lastValue = uniform.value.clone();\r\n        }\r\n        else if(uniform.value.type === \"Vec3\") {\r\n            uniform._internalFormat = \"Vec3\";\r\n            uniform.lastValue = uniform.value.clone();\r\n        }\r\n        else if(uniform.value.type === \"Mat4\") {\r\n            uniform._internalFormat = \"Mat4\";\r\n            uniform.lastValue = uniform.value.clone();\r\n        }\r\n        else if(uniform.value.type === \"Quat\") {\r\n            uniform._internalFormat = \"Quat\";\r\n            uniform.lastValue = uniform.value.clone();\r\n        }\r\n        else if(Array.isArray(uniform.value)) {\r\n            uniform._internalFormat = \"array\";\r\n            uniform.lastValue = Array.from(uniform.value);\r\n        }\r\n        else if(uniform.value.constructor === Float32Array) {\r\n            uniform._internalFormat = \"mat\";\r\n            uniform.lastValue = uniform.value;\r\n        }\r\n        else {\r\n            uniform._internalFormat = \"float\";\r\n            uniform.lastValue = uniform.value;\r\n        }\r\n    }\r\n\r\n    /***\r\n     This inits our uniforms\r\n     Sets its internal format and type if not provided then upload the uniform\r\n     ***/\r\n    setUniforms() {\r\n        // set our uniforms if we got some\r\n        if(this.uniforms) {\r\n            for(const key in this.uniforms) {\r\n                let uniform = this.uniforms[key];\r\n\r\n                // set our uniform location\r\n                uniform.location = this.gl.getUniformLocation(this.program, uniform.name);\r\n\r\n                // handle Vec2, Vec3, Mat4, floats, arrays, etc\r\n                if(!uniform._internalFormat) {\r\n                    this.setInternalFormat(uniform);\r\n                }\r\n\r\n                if(!uniform.type) {\r\n                    if(uniform._internalFormat === \"Vec2\") {\r\n                        uniform.type = \"2f\";\r\n                    }\r\n                    else if(uniform._internalFormat === \"Vec3\") {\r\n                        uniform.type = \"3f\";\r\n                    }\r\n                    else if(uniform._internalFormat === \"Mat4\") {\r\n                        uniform.type = \"mat4\";\r\n                    }\r\n                    else if(uniform._internalFormat === \"array\") {\r\n                        if(uniform.value.length === 4) {\r\n                            uniform.type = \"4f\";\r\n\r\n                            if(!this.renderer.production) throwWarning(this.type + \": No uniform type declared for \" + uniform.name + \", applied a 4f (array of 4 floats) uniform type\");\r\n                        }\r\n                        else if(uniform.value.length === 3) {\r\n                            uniform.type = \"3f\";\r\n\r\n                            if(!this.renderer.production) throwWarning(this.type + \": No uniform type declared for \" + uniform.name + \", applied a 3f (array of 3 floats) uniform type\");\r\n                        }\r\n                        else if(uniform.value.length === 2) {\r\n                            uniform.type = \"2f\";\r\n\r\n                            if(!this.renderer.production) throwWarning(this.type + \": No uniform type declared for \" + uniform.name + \", applied a 2f (array of 2 floats) uniform type\");\r\n                        }\r\n                    }\r\n                    else if(uniform._internalFormat === \"mat\") {\r\n                        if(uniform.value.length === 16) {\r\n                            uniform.type = \"mat4\";\r\n\r\n                            if(!this.renderer.production) throwWarning(this.type + \": No uniform type declared for \" + uniform.name + \", applied a mat4 (4x4 matrix array) uniform type\");\r\n                        }\r\n                        else if(uniform.value.length === 9) {\r\n                            uniform.type = \"mat3\";\r\n\r\n                            if(!this.renderer.production) throwWarning(this.type + \": No uniform type declared for \" + uniform.name + \", applied a mat3 (3x3 matrix array) uniform type\");\r\n                        }\r\n                        else  if(uniform.value.length === 4) {\r\n                            uniform.type = \"mat2\";\r\n\r\n                            if(!this.renderer.production) throwWarning(this.type + \": No uniform type declared for \" + uniform.name + \", applied a mat2 (2x2 matrix array) uniform type\");\r\n                        }\r\n                    }\r\n                    else {\r\n                        uniform.type = \"1f\";\r\n\r\n                        if(!this.renderer.production) throwWarning(this.type + \": No uniform type declared for \" + uniform.name + \", applied a 1f (float) uniform type\");\r\n                    }\r\n                }\r\n\r\n                // set the uniforms update functions\r\n                this.handleUniformSetting(uniform);\r\n\r\n                // update the uniform\r\n                uniform.update && uniform.update(uniform);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     This updates all uniforms of an object that were set by the user\r\n     It is called at each draw call\r\n     ***/\r\n    updateUniforms() {\r\n        if(this.uniforms) {\r\n            for(const key in this.uniforms) {\r\n                const uniform = this.uniforms[key];\r\n                let shouldUpdate = false;\r\n\r\n                if(uniform._internalFormat === \"Vec2\") {\r\n                    if(!uniform.value.equals(uniform.lastValue)) {\r\n                        shouldUpdate = true;\r\n                        uniform.lastValue.copy(uniform.value);\r\n                    }\r\n                }\r\n                else if(uniform._internalFormat === \"Vec3\") {\r\n                    if(!uniform.value.equals(uniform.lastValue)) {\r\n                        shouldUpdate = true;\r\n                        uniform.lastValue.copy(uniform.value);\r\n                    }\r\n                }\r\n                else if(uniform._internalFormat === \"Quat\") {\r\n                    if(!uniform.value.equals(uniform.lastValue)) {\r\n                        shouldUpdate = true;\r\n                        uniform.lastValue.copy(uniform.value);\r\n                    }\r\n                }\r\n                else if(!uniform.value.length) {\r\n                    if(uniform.value !== uniform.lastValue) {\r\n                        shouldUpdate = true;\r\n                        uniform.lastValue = uniform.value;\r\n                    }\r\n                }\r\n                else if(JSON.stringify(uniform.value) !== JSON.stringify(uniform.lastValue)) { // compare two arrays\r\n                    shouldUpdate = true;\r\n                    // copy array\r\n                    uniform.lastValue = Array.from(uniform.value);\r\n                }\r\n\r\n                if(shouldUpdate) {\r\n                    // update our uniforms\r\n                    uniform.update && uniform.update(uniform);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     Use appropriate WebGL uniform setting function based on the uniform type\r\n\r\n     params :\r\n     @uniform (object): the uniform\r\n     ***/\r\n    setUniform1i(uniform) {\r\n        this.gl.uniform1i(uniform.location, uniform.value);\r\n    }\r\n\r\n    setUniform1iv(uniform) {\r\n        this.gl.uniform1iv(uniform.location, uniform.value);\r\n    }\r\n\r\n    setUniform1f(uniform) {\r\n        this.gl.uniform1f(uniform.location, uniform.value);\r\n    }\r\n\r\n    setUniform1fv(uniform) {\r\n        this.gl.uniform1fv(uniform.location, uniform.value);\r\n    }\r\n\r\n\r\n    setUniform2i(uniform) {\r\n        uniform._internalFormat === \"Vec2\" ?\r\n            this.gl.uniform2i(uniform.location, uniform.value.x, uniform.value.y)\r\n            : this.gl.uniform2i(uniform.location, uniform.value[0], uniform.value[1]);\r\n    }\r\n\r\n    setUniform2iv(uniform) {\r\n        uniform._internalFormat === \"Vec2\" ?\r\n            this.gl.uniform2iv(uniform.location, [uniform.value.x, uniform.value.y])\r\n            : this.gl.uniform2iv(uniform.location, uniform.value);\r\n    }\r\n\r\n    setUniform2f(uniform) {\r\n        uniform._internalFormat === \"Vec2\" ?\r\n            this.gl.uniform2f(uniform.location, uniform.value.x, uniform.value.y)\r\n            : this.gl.uniform2f(uniform.location, uniform.value[0], uniform.value[1]);\r\n    }\r\n\r\n    setUniform2fv(uniform) {\r\n        uniform._internalFormat === \"Vec2\" ?\r\n            this.gl.uniform2fv(uniform.location, [uniform.value.x, uniform.value.y])\r\n            : this.gl.uniform2fv(uniform.location, uniform.value);\r\n    }\r\n\r\n\r\n    setUniform3i(uniform) {\r\n        uniform._internalFormat === \"Vec3\" ?\r\n            this.gl.uniform3i(uniform.location, uniform.value.x, uniform.value.y, uniform.value.z)\r\n            : this.gl.uniform3i(uniform.location, uniform.value[0], uniform.value[1], uniform.value[2]);\r\n    }\r\n\r\n    setUniform3iv(uniform) {\r\n        uniform._internalFormat === \"Vec3\" ?\r\n            this.gl.uniform3iv(uniform.location, [uniform.value.x, uniform.value.y, uniform.value.z])\r\n            : this.gl.uniform3iv(uniform.location, uniform.value);\r\n    }\r\n\r\n    setUniform3f(uniform) {\r\n        uniform._internalFormat === \"Vec3\" ?\r\n            this.gl.uniform3f(uniform.location, uniform.value.x, uniform.value.y, uniform.value.z)\r\n            : this.gl.uniform3f(uniform.location, uniform.value[0], uniform.value[1], uniform.value[2]);\r\n    }\r\n\r\n    setUniform3fv(uniform) {\r\n        uniform._internalFormat === \"Vec3\" ?\r\n            this.gl.uniform3fv(uniform.location, [uniform.value.x, uniform.value.y, uniform.value.z])\r\n            : this.gl.uniform3fv(uniform.location, uniform.value);\r\n    }\r\n\r\n\r\n    setUniform4i(uniform) {\r\n        uniform._internalFormat === \"Quat\" ?\r\n            this.gl.uniform4i(uniform.location, uniform.value.elements[0], uniform.value.elements[1], uniform.value.elements[2], uniform.value[3])\r\n            : this.gl.uniform4i(uniform.location, uniform.value[0], uniform.value[1], uniform.value[2], uniform.value[3]);\r\n    }\r\n\r\n    setUniform4iv(uniform) {\r\n        uniform._internalFormat === \"Quat\" ?\r\n            this.gl.uniform4iv(uniform.location, [uniform.value.elements[0], uniform.value.elements[1], uniform.value.elements[2], uniform.value[3]])\r\n            : this.gl.uniform4iv(uniform.location, uniform.value);\r\n    }\r\n\r\n    setUniform4f(uniform) {\r\n        uniform._internalFormat === \"Quat\" ?\r\n            this.gl.uniform4f(uniform.location, uniform.value.elements[0], uniform.value.elements[1], uniform.value.elements[2], uniform.value[3])\r\n            : this.gl.uniform4f(uniform.location, uniform.value[0], uniform.value[1], uniform.value[2], uniform.value[3]);\r\n    }\r\n\r\n    setUniform4fv(uniform) {\r\n        uniform._internalFormat === \"Quat\" ?\r\n            this.gl.uniform4fv(uniform.location, [uniform.value.elements[0], uniform.value.elements[1], uniform.value.elements[2], uniform.value[3]])\r\n            : this.gl.uniform4fv(uniform.location, uniform.value);\r\n    }\r\n\r\n\r\n    setUniformMatrix2fv(uniform) {\r\n        this.gl.uniformMatrix2fv(uniform.location, false, uniform.value);\r\n    }\r\n\r\n    setUniformMatrix3fv(uniform) {\r\n        this.gl.uniformMatrix3fv(uniform.location, false, uniform.value);\r\n    }\r\n\r\n    setUniformMatrix4fv(uniform) {\r\n        uniform._internalFormat === \"Mat4\" ?\r\n            this.gl.uniformMatrix4fv(uniform.location, false, uniform.value.elements)\r\n            : this.gl.uniformMatrix4fv(uniform.location, false, uniform.value);\r\n    }\r\n}","const precisionMedium = `\r\nprecision mediump float;\r\n`;\r\nexport default precisionMedium.replace(/\\n/g, '');","const defaultAttributes = `\r\nattribute vec3 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n`;\r\nexport default defaultAttributes.replace(/\\n/g, '');","const defaultVaryings = `\r\nvarying vec3 vVertexPosition;\r\nvarying vec2 vTextureCoord;\r\n`;\r\nexport default defaultVaryings.replace(/\\n/g, '');","import precisionMedium from './chunks/precision.medium.glsl.js';\r\nimport defaultAttributes from './chunks/default.attributes.glsl.js';\r\nimport defaultVaryings from './chunks/default.varyings.glsl.js';\r\n\r\nconst planeVS = precisionMedium + defaultAttributes + defaultVaryings + `\r\nuniform mat4 uMVMatrix;\r\nuniform mat4 uPMatrix;\r\n\r\nvoid main() {\r\n    vTextureCoord = aTextureCoord;\r\n    vVertexPosition = aVertexPosition;\r\n    \r\n    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\r\n}\r\n`;\r\nexport default planeVS.replace(/\\n/g, '');","import precisionMedium from './chunks/precision.medium.glsl.js';\r\nimport defaultVaryings from './chunks/default.varyings.glsl.js';\r\n\r\nconst planeFS = precisionMedium + defaultVaryings + `\r\nvoid main() {\r\n    gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\r\n}\r\n`;\r\nexport default planeFS.replace(/\\n/g, '');","import precisionMedium from './chunks/precision.medium.glsl.js';\r\nimport defaultAttributes from './chunks/default.attributes.glsl.js';\r\nimport defaultVaryings from './chunks/default.varyings.glsl.js';\r\n\r\nconst shaderPassVS = precisionMedium + defaultAttributes + defaultVaryings + `\r\nvoid main() {\r\n    vTextureCoord = aTextureCoord;\r\n    vVertexPosition = aVertexPosition;\r\n    \r\n    gl_Position = vec4(aVertexPosition, 1.0);\r\n}\r\n`;\r\nexport default shaderPassVS.replace(/\\n/g, '');","import precisionMedium from './chunks/precision.medium.glsl.js';\r\nimport defaultVaryings from './chunks/default.varyings.glsl.js';\r\n\r\nconst shaderPassFS = precisionMedium + defaultVaryings + `\r\nuniform sampler2D uRenderTexture;\r\n\r\nvoid main() {\r\n    gl_FragColor = texture2D(uRenderTexture, vTextureCoord);\r\n}\r\n`;\r\nexport default shaderPassFS.replace(/\\n/g, '');","import {Uniforms} from './Uniforms.js';\r\nimport {throwError, throwWarning} from '../utils/utils.js';\r\n\r\n// default shaders\r\nimport planeVS from '../shaders/plane.vertex.glsl.js';\r\nimport planeFS from '../shaders/plane.fragment.glsl.js';\r\nimport shaderPassVS from '../shaders/shaderpass.vertex.glsl.js';\r\nimport shaderPassFS from '../shaders/shaderpass.fragment.glsl.js';\r\n\r\n\r\n/***\r\n Program class that creates, compiles and links the shaders\r\n Use a cache system to get already compiled shaders and save some CPU\r\n Also responsible for the creation, setting and updating of the uniforms (see Uniforms class object)\r\n\r\n params:\r\n @renderer (Renderer class object): our renderer class object\r\n\r\n @parent (Plane/ShaderPass class object): the mesh that will use that program\r\n @vertexShader (string): vertex shader as a string\r\n @fragmentShader (string): fragment shader as a string\r\n\r\n returns:\r\n @this: our newly created Program\r\n ***/\r\n\r\n// store programs id\r\nlet id = 0;\r\n\r\nexport class Program {\r\n    constructor(renderer, {\r\n        parent,\r\n        vertexShader,\r\n        fragmentShader,\r\n    } = {}) {\r\n        this.type = \"Program\";\r\n        if(!renderer || renderer.type !== \"Renderer\") {\r\n            throwError(this.type + \": Renderer not passed as first argument\", renderer);\r\n        }\r\n        else if(!renderer.gl) {\r\n            throwError(this.type + \": Renderer WebGL context is undefined\", renderer);\r\n\r\n            // return if no gl context\r\n            return;\r\n        }\r\n        this.renderer = renderer;\r\n        this.gl = this.renderer.gl;\r\n\r\n        this.parent = parent;\r\n\r\n        this.defaultVsCode = this.parent.type === \"Plane\" ? planeVS : shaderPassVS;\r\n        this.defaultFsCode = this.parent.type === \"Plane\" ? planeFS : shaderPassFS;\r\n\r\n        // use the vertex shader specified or fallback to a default one\r\n        if(!vertexShader) {\r\n            if(!this.renderer.production && this.parent.type === \"Plane\") {\r\n                throwWarning(this.parent.type + \": No vertex shader provided, will use a default one\");\r\n            }\r\n\r\n            this.vsCode = this.defaultVsCode;\r\n        }\r\n        else {\r\n            this.vsCode = vertexShader;\r\n        }\r\n\r\n        // use the fragment shader specified or fallback to a default one\r\n        if(!fragmentShader) {\r\n            if(!this.renderer.production) {\r\n                throwWarning(this.parent.type + \": No fragment shader provided, will use a default one\");\r\n            }\r\n\r\n            this.fsCode = this.defaultFsCode;\r\n        }\r\n        else {\r\n            this.fsCode = fragmentShader;\r\n        }\r\n\r\n        this.compiled = true;\r\n\r\n        this.setupProgram();\r\n    }\r\n\r\n    /***\r\n     Compile our WebGL shaders based on our written shaders\r\n\r\n     params:\r\n     @shaderCode (string): shader code\r\n     @shaderType (shaderType): WebGL shader type (vertex or fragment)\r\n\r\n     returns:\r\n     @shader (compiled shader): our compiled shader\r\n     ***/\r\n    createShader(shaderCode, shaderType) {\r\n        const shader = this.gl.createShader(shaderType);\r\n\r\n        this.gl.shaderSource(shader, shaderCode);\r\n        this.gl.compileShader(shader);\r\n\r\n        // check shader compilation status only when not in production mode\r\n        if(!this.renderer.production) {\r\n            if(!this.gl.getShaderParameter(shader, this.gl.COMPILE_STATUS)) {\r\n                // shader debugging log as seen in THREE.js WebGLProgram source code\r\n                const shaderTypeString = shaderType === this.gl.VERTEX_SHADER ? \"vertex shader\" : \"fragment shader\";\r\n                const shaderSource = this.gl.getShaderSource(shader);\r\n                let shaderLines = shaderSource.split('\\n');\r\n\r\n                for(let i = 0; i < shaderLines.length; i++) {\r\n                    shaderLines[i] = (i + 1) + ': ' + shaderLines[i];\r\n                }\r\n                shaderLines = shaderLines.join(\"\\n\");\r\n\r\n                throwWarning(this.type + \": Errors occurred while compiling the\", shaderTypeString, \":\\n\", this.gl.getShaderInfoLog(shader));\r\n                throwError(shaderLines);\r\n\r\n                throwWarning(this.type + \": Will use a default\", shaderTypeString);\r\n\r\n                // use the library default shaders instead\r\n                return this.createShader(shaderType === this.gl.VERTEX_SHADER ? this.defaultVsCode : this.defaultFsCode, shaderType);\r\n            }\r\n        }\r\n\r\n        return shader;\r\n    }\r\n\r\n\r\n    /***\r\n     Compiles and creates new shaders\r\n     ***/\r\n    useNewShaders() {\r\n        this.vertexShader = this.createShader(this.vsCode, this.gl.VERTEX_SHADER);\r\n        this.fragmentShader = this.createShader(this.fsCode, this.gl.FRAGMENT_SHADER);\r\n\r\n        if(!this.vertexShader || !this.fragmentShader) {\r\n            if(!this.renderer.production) throwWarning(this.type + \": Unable to find or compile the vertex or fragment shader\");\r\n        }\r\n    };\r\n\r\n\r\n    /***\r\n     Checks whether the program has already been registered before creating it\r\n     If yes, use the compiled shaders to create a new one with createProgram()\r\n     If not, compile the shaders and call createProgram()\r\n     ***/\r\n    setupProgram() {\r\n        let existingProgram = this.renderer.cache.getProgramFromShaders(this.vsCode, this.fsCode);\r\n\r\n        // we found an existing program\r\n        if(existingProgram) {\r\n            // we need to create a new program but we don't have to re compile the shaders\r\n            this.vertexShader = existingProgram.vertexShader;\r\n            this.fragmentShader = existingProgram.fragmentShader;\r\n\r\n            // copy active uniforms and attributes as well\r\n            this.activeUniforms = existingProgram.activeUniforms;\r\n            this.activeAttributes = existingProgram.activeAttributes;\r\n\r\n            this.createProgram();\r\n        }\r\n        else {\r\n            // compile the new shaders and create a new program\r\n            this.useNewShaders();\r\n            if(this.compiled) {\r\n                this.createProgram();\r\n\r\n                // add it to our program manager programs list\r\n                this.renderer.cache.addProgram(this);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     Used internally to set up program based on the created shaders and attach them to the program\r\n     Sets a list of active textures that are actually used by the shaders to avoid binding unused textures during draw calls\r\n     Add the program to the cache\r\n     ***/\r\n    createProgram() {\r\n        // set program id and type\r\n        id++;\r\n        this.id = id;\r\n\r\n        // we need to create a new shader program\r\n        this.program = this.gl.createProgram();\r\n\r\n        // if shaders are valid, go on\r\n        this.gl.attachShader(this.program, this.vertexShader);\r\n        this.gl.attachShader(this.program, this.fragmentShader);\r\n        this.gl.linkProgram(this.program);\r\n\r\n        // TODO getProgramParameter even in production to avoid errors?\r\n        // check the shader program creation status only when not in production mode\r\n        if(!this.renderer.production) {\r\n            if(!this.gl.getProgramParameter(this.program, this.gl.LINK_STATUS)) {\r\n                throwWarning(this.type + \": Unable to initialize the shader program: \" + this.gl.getProgramInfoLog(this.program));\r\n\r\n                // use default shaders, recompile and recreate program\r\n                throwWarning(this.type + \": Will use default vertex and fragment shaders\");\r\n                this.vertexShader = this.createShader(this.defaultVsCode, this.gl.VERTEX_SHADER);\r\n                this.fragmentShader = this.createShader(this.defaultFsCode, this.gl.FRAGMENT_SHADER);\r\n                this.createProgram();\r\n\r\n                return;\r\n            }\r\n        }\r\n\r\n        // free the shaders handles\r\n        this.gl.deleteShader(this.vertexShader);\r\n        this.gl.deleteShader(this.fragmentShader);\r\n\r\n        // store active textures (those that are used in the shaders) to avoid binding unused textures\r\n        if(!this.activeUniforms || !this.activeAttributes) {\r\n            this.activeUniforms = {\r\n                textures: [],\r\n                textureMatrices: [],\r\n            };\r\n\r\n            // check for program active textures\r\n            const numUniforms = this.gl.getProgramParameter(this.program, this.gl.ACTIVE_UNIFORMS);\r\n            for(let i = 0; i < numUniforms; i++) {\r\n                const activeUniform = this.gl.getActiveUniform(this.program, i);\r\n\r\n                if(activeUniform.type === this.gl.SAMPLER_2D) {\r\n                    // if it's a texture add it to our activeUniforms textures array\r\n                    this.activeUniforms.textures.push(activeUniform.name);\r\n                }\r\n                if(activeUniform.type === this.gl.FLOAT_MAT4 && activeUniform.name !== \"uMVMatrix\" && activeUniform.name !== \"uPMatrix\") {\r\n                    // if it's a texture matrix add it to our activeUniforms textureMatrices array\r\n                    this.activeUniforms.textureMatrices.push(activeUniform.name);\r\n                }\r\n            }\r\n\r\n            this.activeAttributes = [];\r\n\r\n            // check for program active attributes to avoid binding attribute buffer if attribute is unused\r\n            const numAttributes = this.gl.getProgramParameter(this.program, this.gl.ACTIVE_ATTRIBUTES);\r\n            for(let i = 0; i < numAttributes; i++) {\r\n                const activeAttribute = this.gl.getActiveAttrib(this.program, i);\r\n                // push attribute name\r\n                this.activeAttributes.push(activeAttribute.name);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /*** UNIFORMS ***/\r\n\r\n    /***\r\n     Creates and attach the uniform handlers to our program\r\n\r\n     params:\r\n     @uniforms (object): an object describing our uniforms (see Uniforms class object)\r\n     ***/\r\n    createUniforms(uniforms) {\r\n        this.uniformsManager = new Uniforms(this.renderer, this.program, uniforms);\r\n\r\n        // set them right away\r\n        this.setUniforms();\r\n    }\r\n\r\n    /***\r\n     Sets our uniforms (used on init and on context restoration)\r\n     ***/\r\n    setUniforms() {\r\n        // use this program\r\n        this.renderer.useProgram(this);\r\n        this.uniformsManager.setUniforms();\r\n    }\r\n\r\n    /***\r\n     Updates our uniforms at each draw calls\r\n     ***/\r\n    updateUniforms() {\r\n        // use this program\r\n        this.renderer.useProgram(this);\r\n        this.uniformsManager.updateUniforms();\r\n    }\r\n}","import {throwError} from '../utils/utils.js';\r\n\r\n/***\r\n Geometry class handles attributes, VertexArrayObjects (if available) and vertices/UVs set up\r\n\r\n params:\r\n @renderer (Renderer class object): our renderer class object\r\n\r\n @program (object): our mesh's Program (see Program class object)\r\n @width (int): number of vertices along width\r\n @height (int): number of vertices along height\r\n @id (int): an integer based on geometry's width and height and used to avoid redundant buffer binding calls\r\n\r\n returns:\r\n @this: our newly created Geometry\r\n ***/\r\nexport class Geometry {\r\n    constructor(renderer, {\r\n        program = null,\r\n        width = 1,\r\n        height = 1,\r\n    } = {}) {\r\n        this.type = \"Geometry\";\r\n        if(!renderer || renderer.type !== \"Renderer\") {\r\n            throwError(this.type + \": Renderer not passed as first argument\", renderer);\r\n        }\r\n        else if(!renderer.gl) {\r\n            throwError(this.type + \": Renderer WebGL context is undefined\", renderer);\r\n\r\n            // return if no gl context\r\n            return;\r\n        }\r\n        this.renderer = renderer;\r\n        this.gl = this.renderer.gl;\r\n\r\n        // unique plane buffers id based on width and height\r\n        // used to get a geometry from cache\r\n        this.definition = {\r\n            id: width * height + width,\r\n            width: width,\r\n            height: height,\r\n        };\r\n\r\n        this.setDefaultAttributes();\r\n        this.setVerticesUVs();\r\n    }\r\n\r\n\r\n    /*** CONTEXT RESTORATION ***/\r\n\r\n    /***\r\n     Used internally to handle context restoration after the program has been successfully compiled again\r\n     Reset the default attributes, the vertices and UVs and the program\r\n     ***/\r\n    restoreContext(program) {\r\n        this.program = null;\r\n        this.setDefaultAttributes();\r\n        this.setVerticesUVs();\r\n\r\n        this.setProgram(program);\r\n    }\r\n\r\n\r\n    /*** SET DEFAULT ATTRIBUTES ***/\r\n\r\n    /***\r\n     Our geometry default attributes that will handle the buffers\r\n     We're just using vertices positions and texture coordinates\r\n     ***/\r\n    setDefaultAttributes() {\r\n        // our plane default attributes\r\n        // if we'd want to introduce custom attributes we'd merge them with those\r\n        this.attributes = {\r\n            vertexPosition: {\r\n                name: \"aVertexPosition\",\r\n                size: 3,\r\n                isActive: false,\r\n            },\r\n            textureCoord: {\r\n                name: \"aTextureCoord\",\r\n                size: 3,\r\n                isActive: false,\r\n            }\r\n        };\r\n    }\r\n\r\n\r\n    /***\r\n     Set our vertices and texture coordinates array\r\n     Get them from the cache if possible\r\n     ***/\r\n    setVerticesUVs() {\r\n        // we need to create our geometry and material objects\r\n        const cachedGeometry = this.renderer.cache.getGeometryFromID(this.definition.id);\r\n\r\n        if(cachedGeometry) {\r\n            this.attributes.vertexPosition.array = cachedGeometry.vertices;\r\n            this.attributes.textureCoord.array = cachedGeometry.uvs;\r\n        }\r\n        else {\r\n            this.computeVerticesUVs();\r\n            // TODO better caching? We could pass all attributes to cache and handle arrays in there\r\n            this.renderer.cache.addGeometry(this.definition.id, this.attributes.vertexPosition.array, this.attributes.textureCoord.array);\r\n        }\r\n    }\r\n\r\n    /***\r\n     Called on init and on context restoration to set up the attribute buffers\r\n     Use VertexArrayObjects whenever possible\r\n     ***/\r\n    setProgram(program) {\r\n        this.program = program;\r\n        this.initAttributes();\r\n\r\n        // use vertex array objects if available\r\n        if(this.renderer._isWebGL2) {\r\n            this._vao = this.gl.createVertexArray();\r\n            this.gl.bindVertexArray(this._vao);\r\n        }\r\n        else if(this.renderer.extensions['OES_vertex_array_object']) {\r\n            this._vao = this.renderer.extensions['OES_vertex_array_object'].createVertexArrayOES();\r\n            this.renderer.extensions['OES_vertex_array_object'].bindVertexArrayOES(this._vao);\r\n        }\r\n\r\n        this.initializeBuffers();\r\n    }\r\n\r\n    /***\r\n     This creates our mesh attributes and buffers by looping over it\r\n     ***/\r\n    initAttributes() {\r\n        // loop through our attributes and create buffers and attributes locations\r\n        for(const key in this.attributes) {\r\n            // is this attribute active in our program?\r\n            this.attributes[key].isActive = this.program.activeAttributes.includes(this.attributes[key].name);\r\n\r\n            // if attribute is not active, no need to go further\r\n            if(!this.attributes[key].isActive) {\r\n                return;\r\n            }\r\n\r\n            this.attributes[key].location = this.gl.getAttribLocation(this.program.program, this.attributes[key].name);\r\n            this.attributes[key].buffer = this.gl.createBuffer();\r\n            this.attributes[key].numberOfItems = this.definition.width * this.definition.height * this.attributes[key].size * 2;\r\n        }\r\n    }\r\n\r\n    /***\r\n     This method is used internally to create our vertices coordinates and texture UVs\r\n     we first create our UVs on a grid from [0, 0, 0] to [1, 1, 0]\r\n     then we use the UVs to create our vertices coords\r\n     ***/\r\n    computeVerticesUVs() {\r\n        // geometry vertices and UVs\r\n        this.attributes.vertexPosition.array = [];\r\n        this.attributes.textureCoord.array = [];\r\n\r\n        const vertices = this.attributes.vertexPosition.array;\r\n        const uvs = this.attributes.textureCoord.array;\r\n\r\n        for(let y = 0; y < this.definition.height; y++) {\r\n            const v = y / this.definition.height;\r\n\r\n            for(let x = 0; x < this.definition.width; x++) {\r\n                const u = x / this.definition.width;\r\n\r\n                // uvs and vertices\r\n                // our uvs are ranging from 0 to 1, our vertices range from -1 to 1\r\n\r\n                // first triangle\r\n                uvs.push(u);\r\n                uvs.push(v);\r\n                uvs.push(0);\r\n\r\n                vertices.push((u - 0.5) * 2);\r\n                vertices.push((v - 0.5) * 2);\r\n                vertices.push(0);\r\n\r\n                uvs.push(u + (1 / this.definition.width));\r\n                uvs.push(v);\r\n                uvs.push(0);\r\n\r\n                vertices.push(((u + (1 / this.definition.width)) - 0.5) * 2);\r\n                vertices.push((v - 0.5) * 2);\r\n                vertices.push(0);\r\n\r\n                uvs.push(u);\r\n                uvs.push(v + (1 / this.definition.height));\r\n                uvs.push(0);\r\n\r\n                vertices.push((u - 0.5) * 2);\r\n                vertices.push(((v + (1 / this.definition.height)) - 0.5) * 2);\r\n                vertices.push(0);\r\n\r\n                // second triangle\r\n                uvs.push(u);\r\n                uvs.push(v + (1 / this.definition.height));\r\n                uvs.push(0);\r\n\r\n                vertices.push((u - 0.5) * 2);\r\n                vertices.push(((v + (1 / this.definition.height)) - 0.5) * 2);\r\n                vertices.push(0);\r\n\r\n                uvs.push(u + (1 / this.definition.width));\r\n                uvs.push(v);\r\n                uvs.push(0);\r\n\r\n                vertices.push(((u + (1 / this.definition.width)) - 0.5) * 2);\r\n                vertices.push((v - 0.5) * 2);\r\n                vertices.push(0);\r\n\r\n                uvs.push(u + (1 / this.definition.width));\r\n                uvs.push(v + (1 / this.definition.height));\r\n                uvs.push(0);\r\n\r\n                vertices.push(((u + (1 / this.definition.width)) - 0.5) * 2);\r\n                vertices.push(((v + (1 / this.definition.height)) - 0.5) * 2);\r\n                vertices.push(0);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     This method enables and binds our attributes buffers\r\n     ***/\r\n    initializeBuffers() {\r\n        if(!this.attributes) return;\r\n\r\n        // loop through our attributes\r\n        for(const key in this.attributes) {\r\n            if(!this.attributes[key].isActive) return;\r\n\r\n            // bind attribute buffer\r\n            this.gl.enableVertexAttribArray(this.attributes[key].location);\r\n\r\n            this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.attributes[key].buffer);\r\n            this.gl.bufferData(this.gl.ARRAY_BUFFER, new Float32Array(this.attributes[key].array), this.gl.STATIC_DRAW);\r\n\r\n            // set where the attribute gets its data\r\n            this.gl.vertexAttribPointer(this.attributes[key].location, this.attributes[key].size, this.gl.FLOAT, false, 0, 0);\r\n        }\r\n\r\n        // update current buffers ID\r\n        this.renderer.state.currentGeometryID = this.definition.id;\r\n    }\r\n\r\n\r\n    /***\r\n     Used inside our draw call to set the correct plane buffers before drawing it\r\n     ***/\r\n    bindBuffers() {\r\n        if(this._vao) {\r\n            if(this.renderer._isWebGL2) {\r\n                this.gl.bindVertexArray(this._vao);\r\n            }\r\n            else {\r\n                this.renderer.extensions['OES_vertex_array_object'].bindVertexArrayOES(this._vao);\r\n            }\r\n        }\r\n        else {\r\n            // loop through our attributes to bind the buffers and set the attribute pointer\r\n            for(const key in this.attributes) {\r\n                if(!this.attributes[key].isActive) return;\r\n\r\n                this.gl.enableVertexAttribArray(this.attributes[key].location);\r\n                this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.attributes[key].buffer);\r\n                this.gl.vertexAttribPointer(this.attributes[key].location, this.attributes[key].size, this.gl.FLOAT, false, 0, 0);\r\n            }\r\n        }\r\n\r\n        // update current buffers ID\r\n        this.renderer.state.currentGeometryID = this.definition.id;\r\n    }\r\n\r\n\r\n    /***\r\n     Draw a geometry\r\n     ***/\r\n    draw() {\r\n        this.gl.drawArrays(this.gl.TRIANGLES, 0, this.attributes.vertexPosition.numberOfItems);\r\n    }\r\n\r\n\r\n    /***\r\n     Dispose a geometry (ie delete its vertex array objects and buffers)\r\n     ***/\r\n    dispose() {\r\n        // delete buffers\r\n        // each time we check for existing properties to avoid errors\r\n        if(this._vao) {\r\n            if(this.renderer._isWebGL2) {\r\n                this.gl.deleteVertexArray(this._vao);\r\n            }\r\n            else {\r\n                this.renderer.extensions['OES_vertex_array_object'].deleteVertexArrayOES(this._vao);\r\n            }\r\n        }\r\n\r\n        for(const key in this.attributes) {\r\n            if(!this.attributes[key].isActive) return;\r\n\r\n            this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.attributes[key].buffer);\r\n            this.gl.bufferData(this.gl.ARRAY_BUFFER, 1, this.gl.STATIC_DRAW);\r\n            this.gl.deleteBuffer(this.attributes[key].buffer);\r\n        }\r\n\r\n        this.attributes = null;\r\n\r\n        // update current buffers ID\r\n        this.renderer.state.currentGeometryID = null;\r\n    }\r\n}","/***\r\n Here we create a Mat4 class object\r\n This is a really basic Matrix4 class used for matrix calculations\r\n Highly based on https://github.com/mrdoob/three.js/blob/dev/src/math/Matrix4.js and http://glmatrix.net/docs/mat4.js.html\r\n\r\n params :\r\n @elements (Float32Array of length 16): our matrix array. Default to identity matrix.\r\n\r\n returns :\r\n @this: our Mat4 class object\r\n ***/\r\n\r\n// TODO lot of (unused at the time) methods are missing\r\n\r\nexport class Mat4 {\r\n    constructor(\r\n        elements = new Float32Array([\r\n            1, 0, 0, 0,\r\n            0, 1, 0, 0,\r\n            0, 0, 1, 0,\r\n            0, 0, 0, 1\r\n        ]),\r\n    ) {\r\n        this.type = \"Mat4\";\r\n        this.elements = elements;\r\n    }\r\n\r\n    /***\r\n     Sets the matrix values from an array\r\n\r\n     params:\r\n     @array (array): an array of at least 16 elements\r\n\r\n     returns:\r\n     @this (Mat4 class object): this matrix after being set\r\n     ***/\r\n    setFromArray(array) {\r\n        for(let i = 0; i < this.elements.length; i++) {\r\n            this.elements[i] = array[i];\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /***\r\n     Copy another Mat4\r\n\r\n     params:\r\n     @matrix (Mat4 class object): matrix to copy\r\n\r\n     returns:\r\n     @this (Mat4 class object): this matrix after copy\r\n     ***/\r\n    copy(matrix) {\r\n        const array = matrix.elements;\r\n        this.elements[0] = array[0];\r\n        this.elements[1] = array[1];\r\n        this.elements[2] = array[2];\r\n        this.elements[3] = array[3];\r\n        this.elements[4] = array[4];\r\n        this.elements[5] = array[5];\r\n        this.elements[6] = array[6];\r\n        this.elements[7] = array[7];\r\n        this.elements[8] = array[8];\r\n        this.elements[9] = array[9];\r\n        this.elements[10] = array[10];\r\n        this.elements[11] = array[11];\r\n        this.elements[12] = array[12];\r\n        this.elements[13] = array[13];\r\n        this.elements[14] = array[14];\r\n        this.elements[15] = array[15];\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Clone a matrix\r\n\r\n     returns:\r\n     @clonedMatrix (Mat4 object): cloned matrix\r\n     ***/\r\n    clone() {\r\n        return new Mat4().copy(this);\r\n    }\r\n\r\n    /***\r\n     Simple matrix multiplication helper\r\n\r\n     params:\r\n     @matrix (Mat4 class object): Mat4 to multiply with\r\n\r\n     returns:\r\n     @result (Mat4 class object): Mat4 after multiplication\r\n     ***/\r\n    multiply(matrix) {\r\n        const a = this.elements;\r\n        const b = matrix.elements;\r\n\r\n        let result = new Mat4();\r\n\r\n        result.elements[0] = b[0] * a[0] + b[1] * a[4] + b[2] * a[8] + b[3] * a[12];\r\n        result.elements[1] = b[0] * a[1] + b[1] * a[5] + b[2] * a[9] + b[3] * a[13];\r\n        result.elements[2] = b[0] * a[2] + b[1] * a[6] + b[2] * a[10] + b[3] * a[14];\r\n        result.elements[3] = b[0] * a[3] + b[1] * a[7] + b[2] * a[11] + b[3] * a[15];\r\n\r\n        result.elements[4] = b[4] * a[0] + b[5] * a[4] + b[6] * a[8] + b[7] * a[12];\r\n        result.elements[5] = b[4] * a[1] + b[5] * a[5] + b[6] * a[9] + b[7] * a[13];\r\n        result.elements[6] = b[4] * a[2] + b[5] * a[6] + b[6] * a[10] + b[7] * a[14];\r\n        result.elements[7] = b[4] * a[3] + b[5] * a[7] + b[6] * a[11] + b[7] * a[15];\r\n\r\n        result.elements[8] = b[8] * a[0] + b[9] * a[4] + b[10] * a[8] + b[11] * a[12];\r\n        result.elements[9] = b[8] * a[1] + b[9] * a[5] + b[10] * a[9] + b[11] * a[13];\r\n        result.elements[10] = b[8] * a[2] + b[9] * a[6] + b[10] * a[10] + b[11] * a[14];\r\n        result.elements[11] = b[8] * a[3] + b[9] * a[7] + b[10] * a[11] + b[11] * a[15];\r\n\r\n        result.elements[12] = b[12] * a[0] + b[13] * a[4] + b[14] * a[8] + b[15] * a[12];\r\n        result.elements[13] = b[12] * a[1] + b[13] * a[5] + b[14] * a[9] + b[15] * a[13];\r\n        result.elements[14] = b[12] * a[2] + b[13] * a[6] + b[14] * a[10] + b[15] * a[14];\r\n        result.elements[15] = b[12] * a[3] + b[13] * a[7] + b[14] * a[11] + b[15] * a[15];\r\n\r\n        return result;\r\n    }\r\n\r\n\r\n    /***\r\n     Get matrix inverse\r\n\r\n     returns:\r\n     @result (Mat4 class object): inverted Mat4\r\n     ***/\r\n    getInverse() {\r\n        const te = this.elements;\r\n        const out = new Mat4();\r\n        const oe = out.elements;\r\n\r\n        let a00 = te[0],\r\n            a01 = te[1],\r\n            a02 = te[2],\r\n            a03 = te[3];\r\n\r\n        let a10 = te[4],\r\n            a11 = te[5],\r\n            a12 = te[6],\r\n            a13 = te[7];\r\n\r\n        let a20 = te[8],\r\n            a21 = te[9],\r\n            a22 = te[10],\r\n            a23 = te[11];\r\n\r\n        let a30 = te[12],\r\n            a31 = te[13],\r\n            a32 = te[14],\r\n            a33 = te[15];\r\n\r\n        let b00 = a00 * a11 - a01 * a10;\r\n        let b01 = a00 * a12 - a02 * a10;\r\n        let b02 = a00 * a13 - a03 * a10;\r\n        let b03 = a01 * a12 - a02 * a11;\r\n        let b04 = a01 * a13 - a03 * a11;\r\n        let b05 = a02 * a13 - a03 * a12;\r\n        let b06 = a20 * a31 - a21 * a30;\r\n        let b07 = a20 * a32 - a22 * a30;\r\n        let b08 = a20 * a33 - a23 * a30;\r\n        let b09 = a21 * a32 - a22 * a31;\r\n        let b10 = a21 * a33 - a23 * a31;\r\n        let b11 = a22 * a33 - a23 * a32;\r\n\r\n        // Calculate the determinant\r\n\r\n        let det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\r\n        if (!det) {\r\n            return null;\r\n        }\r\n        det = 1 / det;\r\n\r\n        oe[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\r\n        oe[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\r\n        oe[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\r\n        oe[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\r\n        oe[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\r\n        oe[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\r\n        oe[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\r\n        oe[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\r\n        oe[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\r\n        oe[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\r\n        oe[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\r\n        oe[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\r\n        oe[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\r\n        oe[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\r\n        oe[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\r\n        oe[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\r\n\r\n        return out;\r\n    }\r\n\r\n\r\n    /***\r\n     Simple Mat4 scaling helper\r\n\r\n     params :\r\n     @vector (Vec3 class object): Vec3 representing scale along X, Y and Z axis\r\n\r\n     returns :\r\n     @result (Mat4 class object): Mat4 after scaling\r\n     ***/\r\n    scale(vector) {\r\n        let a = this.elements;\r\n\r\n        a[0] *= vector.x;\r\n        a[1] *= vector.x;\r\n        a[2] *= vector.x;\r\n        a[3] *= vector.x;\r\n        a[4] *= vector.y;\r\n        a[5] *= vector.y;\r\n        a[6] *= vector.y;\r\n        a[7] *= vector.y;\r\n        a[8] *= vector.z;\r\n        a[9] *= vector.z;\r\n        a[10] *= vector.z;\r\n        a[11] *= vector.z;\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Creates a matrix from a quaternion rotation, vector translation and vector scale\r\n     Equivalent for applying translation, rotation and scale matrices but much faster\r\n     Source code from: http://glmatrix.net/docs/mat4.js.html\r\n\r\n     params :\r\n     @translation (Vec3 class object): translation vector\r\n     @quaternion (Quat class object): rotation quaternion\r\n     @scale (Vec3 class object): scale vector\r\n\r\n     returns :\r\n     @this (Mat4 class object): matrix after transformations\r\n     ***/\r\n    compose(translation, quaternion, scale) {\r\n        let matrix = this.elements;\r\n\r\n        // Quaternion math\r\n        const x = quaternion.elements[0], y = quaternion.elements[1], z = quaternion.elements[2], w = quaternion.elements[3];\r\n\r\n        const x2 = x + x;\r\n        const y2 = y + y;\r\n        const z2 = z + z;\r\n        const xx = x * x2;\r\n        const xy = x * y2;\r\n        const xz = x * z2;\r\n        const yy = y * y2;\r\n        const yz = y * z2;\r\n        const zz = z * z2;\r\n        const wx = w * x2;\r\n        const wy = w * y2;\r\n        const wz = w * z2;\r\n        const sx = scale.x;\r\n        const sy = scale.y;\r\n        const sz = scale.z;\r\n\r\n        matrix[0] = (1 - (yy + zz)) * sx;\r\n        matrix[1] = (xy + wz) * sx;\r\n        matrix[2] = (xz - wy) * sx;\r\n        matrix[3] = 0;\r\n        matrix[4] = (xy - wz) * sy;\r\n        matrix[5] = (1 - (xx + zz)) * sy;\r\n        matrix[6] = (yz + wx) * sy;\r\n        matrix[7] = 0;\r\n        matrix[8] = (xz + wy) * sz;\r\n        matrix[9] = (yz - wx) * sz;\r\n        matrix[10] = (1 - (xx + yy)) * sz;\r\n        matrix[11] = 0;\r\n        matrix[12] = translation.x;\r\n        matrix[13] = translation.y;\r\n        matrix[14] = translation.z;\r\n        matrix[15] = 1;\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\r\n     Equivalent for applying translation, rotation and scale matrices but much faster\r\n     Source code from: http://glmatrix.net/docs/mat4.js.html\r\n\r\n     params :\r\n     @translation (Vec3 class object): translation vector\r\n     @quaternion (Quat class object): rotation quaternion\r\n     @scale (Vec3 class object): scale vector\r\n     @origin (Vec3 class object): origin vector around which to scale and rotate\r\n\r\n     returns :\r\n     @this (Mat4 class object): matrix after transformations\r\n     ***/\r\n    composeFromOrigin(translation, quaternion, scale, origin) {\r\n        let matrix = this.elements;\r\n\r\n        // Quaternion math\r\n        const x = quaternion.elements[0], y = quaternion.elements[1], z = quaternion.elements[2], w = quaternion.elements[3];\r\n\r\n        const x2 = x + x;\r\n        const y2 = y + y;\r\n        const z2 = z + z;\r\n\r\n        const xx = x * x2;\r\n        const xy = x * y2;\r\n        const xz = x * z2;\r\n        const yy = y * y2;\r\n        const yz = y * z2;\r\n        const zz = z * z2;\r\n\r\n        const wx = w * x2;\r\n        const wy = w * y2;\r\n        const wz = w * z2;\r\n\r\n        const sx = scale.x;\r\n        const sy = scale.y;\r\n        const sz = scale.z; // scale along Z is always equal to 1 anyway\r\n\r\n        const ox = origin.x;\r\n        const oy = origin.y;\r\n        const oz = origin.z;\r\n\r\n        const out0 = (1 - (yy + zz)) * sx;\r\n        const out1 = (xy + wz) * sx;\r\n        const out2 = (xz - wy) * sx;\r\n        const out4 = (xy - wz) * sy;\r\n        const out5 = (1 - (xx + zz)) * sy;\r\n        const out6 = (yz + wx) * sy;\r\n        const out8 = (xz + wy) * sz;\r\n        const out9 = (yz - wx) * sz;\r\n        const out10 = (1 - (xx + yy)) * sz;\r\n\r\n        matrix[0] = out0;\r\n        matrix[1] = out1;\r\n        matrix[2] = out2;\r\n        matrix[3] = 0;\r\n        matrix[4] = out4;\r\n        matrix[5] = out5;\r\n        matrix[6] = out6;\r\n        matrix[7] = 0;\r\n        matrix[8] = out8;\r\n        matrix[9] = out9;\r\n        matrix[10] = out10;\r\n        matrix[11] = 0;\r\n        matrix[12] = translation.x + ox - (out0 * ox + out4 * oy + out8 * oz);\r\n        matrix[13] = translation.y + oy - (out1 * ox + out5 * oy + out9 * oz);\r\n        matrix[14] = translation.z + oz - (out2 * ox + out6 * oy + out10 * oz);\r\n        matrix[15] = 1;\r\n\r\n        return this;\r\n    }\r\n}","/***\r\n Here we create a Vec2 class object\r\n This is a really basic Vector2 class used for vector calculations\r\n Highly based on https://github.com/mrdoob/three.js/blob/dev/src/math/Vector2.js and http://glmatrix.net/docs/vec2.js.html\r\n\r\n params :\r\n @x (float): X component of our vector\r\n @y (float): Y component of our vector\r\n\r\n returns :\r\n @this: our Vec2 class object\r\n ***/\r\n\r\n// TODO lot of (unused at the time) methods are missing\r\n\r\nexport class Vec2 {\r\n    constructor(\r\n        x = 0,\r\n        y = x,\r\n    ) {\r\n        this.type = \"Vec2\";\r\n\r\n        this._x = x;\r\n        this._y = y;\r\n    }\r\n\r\n    /***\r\n     Getters and setters (with onChange callback)\r\n     ***/\r\n    get x() {\r\n        return this._x;\r\n    }\r\n\r\n    get y() {\r\n        return this._y;\r\n    }\r\n\r\n    set x(value) {\r\n        const changed = value !== this._x;\r\n        this._x = value;\r\n        changed && this._onChangeCallback && this._onChangeCallback();\r\n    }\r\n\r\n    set y(value) {\r\n        const changed = value !== this._y;\r\n        this._y = value;\r\n        changed && this._onChangeCallback && this._onChangeCallback();\r\n    }\r\n\r\n    onChange(callback) {\r\n        if(callback) {\r\n            this._onChangeCallback = callback;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /***\r\n     Sets the vector from values\r\n\r\n     params:\r\n     @x (float): X component of our vector\r\n     @y (float): Y component of our vector\r\n\r\n     returns:\r\n     @this (Vec2): this vector after being set\r\n     ***/\r\n    set(x, y) {\r\n        this._x = x;\r\n        this._y = y;\r\n\r\n        return this;\r\n    }\r\n\r\n    /***\r\n     Adds a vector to this vector\r\n\r\n     params:\r\n     @vector (Vec2): vector to add\r\n\r\n     returns:\r\n     @this (Vec2): this vector after addition\r\n     ***/\r\n    add(vector) {\r\n        this._x += vector.x;\r\n        this._y += vector.y;\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Adds a scalar to this vector\r\n\r\n     params:\r\n     @value (float): number to add\r\n\r\n     returns:\r\n     @this (Vec2): this vector after addition\r\n     ***/\r\n    addScalar(value) {\r\n        this._x += value;\r\n        this._y += value;\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Subtracts a vector from this vector\r\n\r\n     params:\r\n     @vector (Vec2): vector to use for subtraction\r\n\r\n     returns:\r\n     @this (Vec2): this vector after subtraction\r\n     ***/\r\n    sub(vector) {\r\n        this._x -= vector.x;\r\n        this._y -= vector.y;\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Subtracts a scalar to this vector\r\n\r\n     params:\r\n     @value (float): number to use for subtraction\r\n\r\n     returns:\r\n     @this (Vec2): this vector after subtraction\r\n     ***/\r\n    subScalar(value) {\r\n        this._x -= value;\r\n        this._y -= value;\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Multiplies a vector with this vector\r\n\r\n     params:\r\n     @vector (Vec2): vector to use for multiplication\r\n\r\n     returns:\r\n     @this (Vec2): this vector after multiplication\r\n     ***/\r\n    multiply(vector) {\r\n        this._x *= vector.x;\r\n        this._y *= vector.y;\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Multiplies a scalar with this vector\r\n\r\n     params:\r\n     @value (float): number to use for multiplication\r\n\r\n     returns:\r\n     @this (Vec2): this vector after multiplication\r\n     ***/\r\n    multiplyScalar(value) {\r\n        this._x *= value;\r\n        this._y *= value;\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Copy a vector into this vector\r\n\r\n     params:\r\n     @vector (Vec2): vector to copy\r\n\r\n     returns:\r\n     @this (Vec2): this vector after copy\r\n     ***/\r\n    copy(vector) {\r\n        this._x = vector.x;\r\n        this._y = vector.y;\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Clone this vector\r\n\r\n     returns:\r\n     @vector (Vec2): cloned vector\r\n     ***/\r\n    clone() {\r\n        return new Vec2(this._x, this._y);\r\n    }\r\n\r\n\r\n    /***\r\n     Merges this vector with a vector when values are NaN. Mostly used internally.\r\n\r\n     params:\r\n     @vector (Vec2): vector to use for sanitization\r\n\r\n     returns:\r\n     @vector (Vec2): sanitized vector\r\n     ***/\r\n    sanitizeNaNValuesWith(vector) {\r\n        this._x = isNaN(this._x) ? vector.x : parseFloat(this._x);\r\n        this._y = isNaN(this._y) ? vector.y : parseFloat(this._y);\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Apply max values to this vector\r\n\r\n     params:\r\n     @vector (Vec2): vector representing max values\r\n\r\n     returns:\r\n     @vector (Vec2): vector with max values applied\r\n     ***/\r\n    max(vector) {\r\n        this._x = Math.max(this._x, vector.x);\r\n        this._y = Math.max(this._y, vector.y);\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Apply min values to this vector\r\n\r\n     params:\r\n     @vector (Vec2): vector representing min values\r\n\r\n     returns:\r\n     @vector (Vec2): vector with min values applied\r\n     ***/\r\n    min(vector) {\r\n        this._x = Math.min(this._x, vector.x);\r\n        this._y = Math.min(this._y, vector.y);\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Checks if 2 vectors are equal\r\n\r\n     params:\r\n     @vector (Vec2): vector to compare\r\n\r\n     returns:\r\n     @isEqual (bool): whether the vectors are equals or not\r\n     ***/\r\n    equals(vector) {\r\n        return this._x === vector.x && this._y === vector.y;\r\n    }\r\n\r\n\r\n    /***\r\n     Normalize this vector\r\n\r\n     returns:\r\n     @this (Vec2): normalized vector\r\n     ***/\r\n    normalize() {\r\n        // normalize\r\n        let len = this._x * this._x + this._y * this._y;\r\n        if (len > 0) {\r\n            len = 1 / Math.sqrt(len);\r\n        }\r\n        this._x *= len;\r\n        this._y *= len;\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Calculates the dot product of 2 vectors\r\n\r\n     params:\r\n     @vector (Vec2): vector to use for dot product\r\n\r\n     returns:\r\n     @dotProduct (float): dot product of the 2 vectors\r\n     ***/\r\n    dot(vector) {\r\n        return this._x * vector.x + this._y * vector.y;\r\n    }\r\n}","/***\r\n Here we create a Vec3 class object\r\n This is a really basic Vector3 class used for vector calculations\r\n Highly based on https://github.com/mrdoob/three.js/blob/dev/src/math/Vector3.js and http://glmatrix.net/docs/vec3.js.html\r\n\r\n params :\r\n @x (float): X component of our vector\r\n @y (float): Y component of our vector\r\n @z (float): Z component of our vector\r\n\r\n returns :\r\n @this: our Vec3 class object\r\n ***/\r\n\r\n// TODO lot of (unused at the time) methods are missing\r\n\r\nexport class Vec3 {\r\n    constructor(\r\n        x = 0,\r\n        y = x,\r\n        z = x,\r\n    ) {\r\n        this.type = \"Vec3\";\r\n\r\n        this._x = x;\r\n        this._y = y;\r\n        this._z = z;\r\n    }\r\n\r\n    /***\r\n     Getters and setters (with onChange callback)\r\n     ***/\r\n    get x() {\r\n        return this._x;\r\n    }\r\n\r\n    get y() {\r\n        return this._y;\r\n    }\r\n\r\n    get z() {\r\n        return this._z;\r\n    }\r\n\r\n    set x(value) {\r\n        const changed = value !== this._x;\r\n        this._x = value;\r\n        changed && this._onChangeCallback && this._onChangeCallback();\r\n    }\r\n\r\n    set y(value) {\r\n        const changed = value !== this._y;\r\n        this._y = value;\r\n        changed && this._onChangeCallback && this._onChangeCallback();\r\n    }\r\n\r\n    set z(value) {\r\n        const changed = value !== this._z;\r\n        this._z = value;\r\n        changed && this._onChangeCallback && this._onChangeCallback();\r\n    }\r\n\r\n    onChange(callback) {\r\n        if(callback) {\r\n            this._onChangeCallback = callback;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /***\r\n     Sets the vector from values\r\n\r\n     params:\r\n     @x (float): X component of our vector\r\n     @y (float): Y component of our vector\r\n     @z (float): Z component of our vector\r\n\r\n     returns:\r\n     @this (Vec2): this vector after being set\r\n     ***/\r\n    set(x, y, z) {\r\n        this._x = x;\r\n        this._y = y;\r\n        this._z = z;\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Adds a vector to this vector\r\n\r\n     params:\r\n     @vector (Vec3): vector to add\r\n\r\n     returns:\r\n     @this (Vec3): this vector after addition\r\n     ***/\r\n    add(vector) {\r\n        this._x += vector.x;\r\n        this._y += vector.y;\r\n        this._z += vector.z;\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Adds a scalar to this vector\r\n\r\n     params:\r\n     @value (float): number to add\r\n\r\n     returns:\r\n     @this (Vec3): this vector after addition\r\n     ***/\r\n    addScalar(value) {\r\n        this._x += value;\r\n        this._y += value;\r\n        this._z += value;\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Subtracts a vector from this vector\r\n\r\n     params:\r\n     @vector (Vec3): vector to use for subtraction\r\n\r\n     returns:\r\n     @this (Vec3): this vector after subtraction\r\n     ***/\r\n    sub(vector) {\r\n        this._x -= vector.x;\r\n        this._y -= vector.y;\r\n        this._z -= vector.z;\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Subtracts a scalar to this vector\r\n\r\n     params:\r\n     @value (float): number to use for subtraction\r\n\r\n     returns:\r\n     @this (Vec3): this vector after subtraction\r\n     ***/\r\n    subScalar(value) {\r\n        this._x -= value;\r\n        this._y -= value;\r\n        this._z -= value;\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Multiplies a vector with this vector\r\n\r\n     params:\r\n     @vector (Vec3): vector to use for multiplication\r\n\r\n     returns:\r\n     @this (Vec3): this vector after multiplication\r\n     ***/\r\n    multiply(vector) {\r\n        this._x *= vector.x;\r\n        this._y *= vector.y;\r\n        this._z *= vector.z;\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Multiplies a scalar with this vector\r\n\r\n     params:\r\n     @value (float): number to use for multiplication\r\n\r\n     returns:\r\n     @this (Vec3): this vector after multiplication\r\n     ***/\r\n    multiplyScalar(value) {\r\n        this._x *= value;\r\n        this._y *= value;\r\n        this._z *= value;\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Copy a vector into this vector\r\n\r\n     params:\r\n     @vector (Vec3): vector to copy\r\n\r\n     returns:\r\n     @this (Vec3): this vector after copy\r\n     ***/\r\n    copy(vector) {\r\n        this._x = vector.x;\r\n        this._y = vector.y;\r\n        this._z = vector.z;\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Clone this vector\r\n\r\n     returns:\r\n     @vector (Vec3): cloned vector\r\n     ***/\r\n    clone() {\r\n        return new Vec3(this._x, this._y, this._z);\r\n    }\r\n\r\n\r\n    /***\r\n     Merges this vector with a vector when values are NaN. Mostly used internally.\r\n\r\n     params:\r\n     @vector (Vec3): vector to use for sanitization\r\n\r\n     returns:\r\n     @vector (Vec3): sanitized vector\r\n     ***/\r\n    sanitizeNaNValuesWith(vector) {\r\n        this._x = isNaN(this._x) ? vector.x : parseFloat(this._x);\r\n        this._y = isNaN(this._y) ? vector.y : parseFloat(this._y);\r\n        this._z = isNaN(this._z) ? vector.z : parseFloat(this._z);\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Apply max values to this vector\r\n\r\n     params:\r\n     @vector (Vec3): vector representing max values\r\n\r\n     returns:\r\n     @vector (Vec3): vector with max values applied\r\n     ***/\r\n    max(vector) {\r\n        this._x = Math.max(this._x, vector.x);\r\n        this._y = Math.max(this._y, vector.y);\r\n        this._z = Math.max(this._z, vector.z);\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Apply min values to this vector\r\n\r\n     params:\r\n     @vector (Vec3): vector representing min values\r\n\r\n     returns:\r\n     @vector (Vec3): vector with min values applied\r\n     ***/\r\n    min(vector) {\r\n        this._x = Math.min(this._x, vector.x);\r\n        this._y = Math.min(this._y, vector.y);\r\n        this._z = Math.min(this._z, vector.z);\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Checks if 2 vectors are equal\r\n\r\n     returns:\r\n     @isEqual (bool): whether the vectors are equals or not\r\n     ***/\r\n    equals(vector) {\r\n        return this._x === vector.x && this._y === vector.y && this._z === vector.z;\r\n    }\r\n\r\n\r\n    /***\r\n     Normalize this vector\r\n\r\n     returns:\r\n     @this (Vec3): normalized vector\r\n     ***/\r\n    normalize() {\r\n        // normalize\r\n        let len = this._x * this._x + this._y * this._y + this._z * this._z;\r\n        if (len > 0) {\r\n            len = 1 / Math.sqrt(len);\r\n        }\r\n        this._x *= len;\r\n        this._y *= len;\r\n        this._z *= len;\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Calculates the dot product of 2 vectors\r\n\r\n     returns:\r\n     @dotProduct (float): dot product of the 2 vectors\r\n     ***/\r\n    dot(vector) {\r\n        return this._x * vector.x + this._y * vector.y + this._z * vector.z;\r\n    }\r\n\r\n\r\n\r\n    /***\r\n     Apply a matrix 4 to a point (vec3)\r\n     Useful to convert a point position from plane local world to webgl space using projection view matrix for example\r\n     Source code from: http://glmatrix.net/docs/vec3.js.html\r\n\r\n     params :\r\n     @matrix (array): 4x4 matrix used\r\n\r\n     returns :\r\n     @this (Vec3): this vector after matrix application\r\n     ***/\r\n    applyMat4(matrix) {\r\n        const x = this._x, y = this._y, z = this._z;\r\n        const mArray = matrix.elements;\r\n\r\n        let w = mArray[3] * x + mArray[7] * y + mArray[11] * z + mArray[15];\r\n        w = w || 1;\r\n\r\n        this._x = (mArray[0] * x + mArray[4] * y + mArray[8] * z + mArray[12]) / w;\r\n        this._y = (mArray[1] * x + mArray[5] * y + mArray[9] * z + mArray[13]) / w;\r\n        this._z = (mArray[2] * x + mArray[6] * y + mArray[10] * z + mArray[14]) / w;\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Apply a quaternion (rotation in 3D space) to this vector\r\n\r\n     params :\r\n     @quaternion (Quat): quaternion to use\r\n\r\n     returns :\r\n     @this (Vec3): this vector after applying the transformation\r\n     ***/\r\n    applyQuat(quaternion) {\r\n        const x = this._x, y = this._y, z = this._z;\r\n        const qx = quaternion.elements[0], qy = quaternion.elements[1], qz = quaternion.elements[2], qw = quaternion.elements[3];\r\n\r\n        // calculate quat * vector\r\n\r\n        const ix = qw * x + qy * z - qz * y;\r\n        const iy = qw * y + qz * x - qx * z;\r\n        const iz = qw * z + qx * y - qy * x;\r\n        const iw = - qx * x - qy * y - qz * z;\r\n\r\n        // calculate result * inverse quat\r\n\r\n        this._x = ix * qw + iw * - qx + iy * - qz - iz * - qy;\r\n        this._y = iy * qw + iw * - qy + iz * - qx - ix * - qz;\r\n        this._z = iz * qw + iw * - qz + ix * - qy - iy * - qx;\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Project 3D coordinate to 2D point\r\n\r\n     params:\r\n     @camera (Camera): camera to use for projection\r\n     ***/\r\n    project(camera) {\r\n        this.applyMat4(camera.viewMatrix).applyMat4(camera.projectionMatrix);\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Unproject 2D point to 3D coordinate\r\n\r\n     params:\r\n     @camera (Camera): camera to use for projection\r\n     ***/\r\n    unproject(camera) {\r\n        this.applyMat4(camera.projectionMatrix.getInverse()).applyMat4(camera.worldMatrix);\r\n        return this;\r\n    }\r\n}","import {Mat4} from '../math/Mat4.js';\r\nimport {Vec2} from '../math/Vec2.js';\r\nimport {Vec3} from '../math/Vec3.js';\r\nimport {generateUUID, throwError, throwWarning, isPowerOf2} from '../utils/utils.js';\r\n\r\n/***\r\n Texture class objects used by render targets, shader passes and planes.\r\n\r\n params:\r\n @renderer (Curtains renderer or Renderer class object): our curtains object OR our curtains renderer object\r\n\r\n @isFBOTexture (bool): Whether this texture is used by a render target/frame buffer object. Default to false\r\n @fromTexture (bool): Whether this texture should copy another texture right from init (and avoid creating a new webgl texture). Default to false\r\n @loader (TextureLoader class object): loader used to create that texture and load its source. Default to null\r\n\r\n @sampler (string): the texture sampler's name that will be used in the shaders\r\n\r\n @floatingPoint (string): texture floating point to apply. Could be \"float\", \"half-float\" or \"none\". Default to \"none\"\r\n\r\n @premultiplyAlpha (bool): Whether this texture should handle premultiplied alpha. Default to false\r\n @anisotropy (int): Texture anisotropy (see https://developer.mozilla.org/en-US/docs/Web/API/EXT_texture_filter_anisotropic). Default to 1\r\n @generateMipmap (bool): Whether to generate texture mipmaps (see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/generateMipmap). Default to true except for frame buffer objects textures.\r\n\r\n see https://developer.mozilla.org/en-US/docs/Web/API/WebGL2RenderingContext/samplerParameter\r\n @wrapS (GLenum): WebGL constant specifying the texture wrapping function for the texture coordinate S\r\n @wrapT (GLenum): WebGL constant specifying the texture wrapping function for the texture coordinate T\r\n @minFilter (GLenum): WebGL constant specifying the texture minification filter\r\n @magFilter (GLenum): WebGL constant specifying the texture magnification filter\r\n\r\n returns:\r\n @this: our newly created Texture class object\r\n ***/\r\n\r\n// avoid reinstancing those during runtime\r\nconst tempVec2 = new Vec2();\r\nconst tempVec3 = new Vec3();\r\n\r\nconst textureTranslation = new Mat4();\r\n\r\nexport class Texture {\r\n    constructor(renderer, {\r\n        isFBOTexture = false,\r\n        fromTexture = false,\r\n        loader,\r\n\r\n        // texture sampler name\r\n        sampler,\r\n\r\n        // floating point textures\r\n        floatingPoint = \"none\",\r\n\r\n        // texture parameters\r\n        premultiplyAlpha = false,\r\n        anisotropy = 1,\r\n        generateMipmap = null,\r\n\r\n        wrapS,\r\n        wrapT,\r\n        minFilter,\r\n        magFilter,\r\n    } = {}) {\r\n        this.type = \"Texture\";\r\n\r\n        // we could pass our curtains object OR our curtains renderer object\r\n        renderer = renderer && renderer.renderer || renderer;\r\n\r\n        if(!renderer || renderer.type !== \"Renderer\") {\r\n            throwError(this.type + \": Renderer not passed as first argument\", renderer);\r\n        }\r\n        else if(!renderer.gl) {\r\n            if(!renderer.production) throwError(this.type + \": Unable to create a \" + this.type + \" because the Renderer WebGL context is not defined\");\r\n\r\n            // return if no gl context\r\n            return;\r\n        }\r\n        this.renderer = renderer;\r\n        this.gl = this.renderer.gl;\r\n\r\n        this.uuid = generateUUID();\r\n\r\n        // texture parameters\r\n        this._globalParameters = {\r\n            // global gl context parameters\r\n            unpackAlignment: 4,\r\n            flipY: !isFBOTexture,\r\n            premultiplyAlpha: false,\r\n            shouldPremultiplyAlpha: premultiplyAlpha,\r\n\r\n            // texImage2D properties\r\n            floatingPoint: floatingPoint,\r\n            type: this.gl.UNSIGNED_BYTE,\r\n            internalFormat: this.gl.RGBA,\r\n            format: this.gl.RGBA,\r\n        };\r\n\r\n        this.parameters = {\r\n            // per texture parameters\r\n            anisotropy,\r\n            generateMipmap: generateMipmap,\r\n\r\n            wrapS: wrapS || this.gl.CLAMP_TO_EDGE,\r\n            wrapT: wrapT || this.gl.CLAMP_TO_EDGE,\r\n            minFilter: minFilter || this.gl.LINEAR,\r\n            magFilter: magFilter || this.gl.LINEAR,\r\n\r\n            _shouldUpdate: true,\r\n        };\r\n\r\n        // per texture state\r\n        this._initState();\r\n\r\n        // is it a frame buffer object texture?\r\n        // if it's not, type will change when the source will be loaded\r\n        this.sourceType = isFBOTexture ? \"fbo\" : \"empty\";\r\n\r\n        // whether to use cache for image textures\r\n        this._useCache = true;\r\n\r\n        this._samplerName = sampler;\r\n\r\n        // prepare texture sampler\r\n        this._sampler = {\r\n            isActive: false,\r\n            isTextureBound: false,\r\n            texture: this.gl.createTexture(), // always create a gl texture\r\n        };\r\n\r\n        // we will always declare a texture matrix\r\n        this._textureMatrix = {\r\n            matrix: new Mat4(),\r\n            isActive: false\r\n        };\r\n\r\n        // actual size will be set later on\r\n        this._size = {\r\n            width: 1,\r\n            height: 1,\r\n        };\r\n\r\n        this.scale = new Vec2(1);\r\n        this.scale.onChange(() => this.resize());\r\n\r\n        this.offset = new Vec2();\r\n        this.offset.onChange(() => this.resize());\r\n\r\n        // source loading and GPU uploading flags\r\n        this._loader = loader;\r\n        this._sourceLoaded = false;\r\n        this._uploaded = false;\r\n\r\n        // _willUpdate and shouldUpdate property are set to false by default\r\n        // we will handle that in the setSource() method for videos and canvases\r\n        this._willUpdate = false;\r\n        this.shouldUpdate = false;\r\n\r\n        // if we need to force a texture update\r\n        this._forceUpdate = false;\r\n\r\n        // custom user properties\r\n        this.userData = {};\r\n\r\n        // useful flag to avoid binding texture that does not belong to current context\r\n        this._canDraw = false;\r\n\r\n        // is it set from an existing texture?\r\n        if(fromTexture) {\r\n            this._copyOnInit = true;\r\n            this._copiedFrom = fromTexture;\r\n\r\n            // everything else will be done when adding a parent to that texture\r\n            return;\r\n        }\r\n\r\n        this._copyOnInit = false;\r\n\r\n        // init our texture\r\n        this._initTexture();\r\n    }\r\n\r\n\r\n    /***\r\n     Init per-texture parameters state\r\n     Called on init and on context restoration to force parameters settings\r\n     ***/\r\n    _initState() {\r\n        this._state = {\r\n            anisotropy: 1,\r\n            generateMipmap: false,\r\n\r\n            wrapS: null,\r\n            wrapT: null,\r\n            minFilter: null,\r\n            magFilter: this.gl.LINEAR, // default to gl.LINEAR\r\n        };\r\n    }\r\n\r\n    /***\r\n     Init our texture object\r\n     ***/\r\n    _initTexture() {\r\n        // bind the texture the target (TEXTURE_2D) of the active texture unit.\r\n        this.gl.bindTexture(this.gl.TEXTURE_2D, this._sampler.texture);\r\n\r\n        if(this.sourceType === \"empty\") {\r\n            // avoid flipY on non DOM elements\r\n            this._globalParameters.flipY = false;\r\n            // update global parameters before drawing an empty texture\r\n            this._updateGlobalTexParameters();\r\n\r\n            // draw a black plane before the real texture's content has been loaded\r\n            this.gl.texImage2D(this.gl.TEXTURE_2D, 0, this.gl.RGBA, 1, 1, 0, this.gl.RGBA, this.gl.UNSIGNED_BYTE, new Uint8Array([0, 0, 0, 255]));\r\n\r\n            this._canDraw = true;\r\n        }\r\n    }\r\n\r\n\r\n    /*** RESTORING CONTEXT ***/\r\n\r\n    /***\r\n     Restore a WebGL texture that is a copy\r\n     Depending on whether it's a copy from start or not, just reset its uniforms or run the full init\r\n     And finally copy our original texture back again\r\n     ***/\r\n    _restoreFromTexture() {\r\n        // init again if needed\r\n        if(!this._copyOnInit) {\r\n            this._initTexture();\r\n        }\r\n\r\n        // a texture shouldn't be restored if it does not have a parent\r\n        // since it's always the parent that calls the _restoreContext() method\r\n        if(this._parent) {\r\n            // set uniforms again\r\n            this._setTextureUniforms();\r\n\r\n            // update the texture matrix uniform as well\r\n            this._setSize();\r\n        }\r\n\r\n        // copy our texture again\r\n        this.copy(this._copiedFrom);\r\n\r\n        this._canDraw = true;\r\n    }\r\n\r\n\r\n    /***\r\n     Restore our WebGL texture\r\n     If it is an original texture, just re run the init function and eventually reset its source\r\n     If it is a texture set from another texture, wait for the original texture to be ready first\r\n     ***/\r\n    _restoreContext() {\r\n        // avoid binding that texture before reseting it\r\n        this._canDraw = false;\r\n\r\n        // reinit sampler and texture matrix\r\n        this._sampler.texture = this.gl.createTexture();\r\n        this._sampler.isActive = false;\r\n        this._sampler.isTextureBound = false;\r\n\r\n        this._textureMatrix.isActive = false;\r\n\r\n        this._initState();\r\n\r\n        // force mip map regeneration if needed\r\n        this._state.generateMipmap = false;\r\n        this.parameters._shouldUpdate = true;\r\n\r\n        // this is an original texture, reset it right away\r\n        if(!this._copiedFrom) {\r\n            this._initTexture();\r\n\r\n            if(this._parent) {\r\n                this._setParent();\r\n            }\r\n\r\n            if(this.source) {\r\n                this.setSource(this.source);\r\n\r\n                // cache again if it is an image\r\n                // also since it's an image it has been uploaded in setSource()\r\n                if(this.sourceType === \"image\") {\r\n                    this.renderer.cache.addTexture(this);\r\n                }\r\n                else {\r\n                    // force update\r\n                    this.needUpdate();\r\n                }\r\n            }\r\n\r\n            this._canDraw = true;\r\n        }\r\n        else {\r\n            // wait for the original texure to be ready before attempting to restore the copy\r\n            const queue = this.renderer.nextRender.add(() => {\r\n                if(this._copiedFrom._canDraw) {\r\n                    this._restoreFromTexture();\r\n                    // remove from callback queue\r\n                    queue.keep = false;\r\n                }\r\n            }, true);\r\n        }\r\n    }\r\n\r\n\r\n    /*** ADD PARENT ***/\r\n\r\n    /***\r\n     Adds a parent to a texture\r\n     Sets its index, its parent and add it to the parent textures array as well\r\n     Then runs _setParent() to set the size and uniforms if needed\r\n     ***/\r\n    addParent(parent) {\r\n        if(!parent || (parent.type !== \"Plane\" && parent.type !== \"PingPongPlane\" && parent.type !== \"ShaderPass\" && parent.type !== \"RenderTarget\")) {\r\n            if(!this.renderer.production) {\r\n                throwWarning(this.type + \": cannot add texture as a child of \", parent, \" because it is not a valid parent\");\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        // add parent property\r\n        this._parent = parent;\r\n        // update parent textures array\r\n        this.index = this._parent.textures.length;\r\n        this._parent.textures.push(this);\r\n\r\n        // now set its parent for real\r\n        this._setParent();\r\n    }\r\n\r\n\r\n    /***\r\n     Sets the parent\r\n     Basically sets the uniforms names and locations and sizes\r\n     ***/\r\n    _setParent() {\r\n        // prepare texture sampler\r\n        this._sampler.name = this._samplerName || \"uSampler\" + this.index;\r\n\r\n        // we will always declare a texture matrix\r\n        this._textureMatrix.name = this._samplerName ? this._samplerName + \"Matrix\" : \"uTextureMatrix\" + this.index;\r\n\r\n        // if the parent has a program it means its not a render target texture\r\n        if(this._parent._program) {\r\n            if(!this._parent._program.compiled) {\r\n                if(!this.renderer.production) {\r\n                    throwWarning(this.type + \": Unable to create the texture because the program is not valid\");\r\n                }\r\n\r\n                return;\r\n            }\r\n\r\n            // set uniform\r\n            this._setTextureUniforms();\r\n\r\n            if(this._copyOnInit) {\r\n                // wait for original texture to be ready before copying it\r\n                const waitForOriginalTexture = this.renderer.nextRender.add(() => {\r\n                    if(this._copiedFrom._canDraw && this._copiedFrom._uploaded) {\r\n                        this.copy(this._copiedFrom);\r\n                        waitForOriginalTexture.keep = false;\r\n                    }\r\n                }, true);\r\n\r\n                // we're done!\r\n                return;\r\n            }\r\n\r\n            if(!this.source) {\r\n                // set its size based on parent element size for now\r\n                this._size = {\r\n                    width: this._parent._boundingRect.document.width,\r\n                    height: this._parent._boundingRect.document.height,\r\n                };\r\n            }\r\n            else if(this._parent.loader) {\r\n                // we're adding a parent to a texture that already has a source\r\n                // it means the source should have been loaded before the parent was set\r\n                // add it to the right asset array if needed\r\n                this._parent.loader._addSourceToParent(this.source, this.sourceType);\r\n            }\r\n\r\n            this._setSize();\r\n        }\r\n        else if(this._parent.type === \"RenderTarget\") {\r\n            // its a render target texture, it has no uniform location and no texture matrix\r\n            this._size = {\r\n                width: this._parent._size && this._parent._size.width || this.renderer._boundingRect.width,\r\n                height: this._parent._size && this._parent._size.height || this.renderer._boundingRect.height,\r\n            };\r\n\r\n            // updload to gpu\r\n            this._upload();\r\n\r\n            // update render texture parameters because it will never be drawn (hence not called)\r\n            this._updateTexParameters();\r\n\r\n            this._canDraw = true;\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     Checks if this texture has a parent\r\n\r\n     return:\r\n     @hasParent (bool): whether this texture has a parent or not\r\n     ***/\r\n    hasParent() {\r\n        return !!this._parent;\r\n    }\r\n\r\n\r\n    /*** SEND DATA TO THE GPU ***/\r\n\r\n    /***\r\n     Check if our textures is effectively used in our shaders\r\n     If so, set it to active, get its uniform locations and bind it to our texture unit\r\n     ***/\r\n    _setTextureUniforms() {\r\n        // check if our texture is used in our program shaders\r\n        // if so, get its uniform locations and bind it to our program\r\n        const activeUniforms = this._parent._program.activeUniforms;\r\n\r\n        for(let i = 0; i < activeUniforms.textures.length; i++) {\r\n            if(activeUniforms.textures[i] === this._sampler.name) {\r\n                // this texture is active\r\n                this._sampler.isActive = true;\r\n\r\n                // use the program and get our sampler and texture matrices uniforms\r\n                this.renderer.useProgram(this._parent._program);\r\n\r\n                // set our texture sampler uniform\r\n                this._sampler.location = this.gl.getUniformLocation(this._parent._program.program, this._sampler.name);\r\n\r\n                // set texture matrix uniform location only if active\r\n                const isTextureMatrixActive = activeUniforms.textureMatrices.find(textureMatrix =>\r\n                    textureMatrix === this._textureMatrix.name\r\n                );\r\n\r\n                if(isTextureMatrixActive) {\r\n                    this._textureMatrix.isActive = true;\r\n                    this._textureMatrix.location = this.gl.getUniformLocation(this._parent._program.program, this._textureMatrix.name);\r\n                }\r\n\r\n                // tell the shader we bound the texture to our indexed texture unit\r\n                this.gl.uniform1i(this._sampler.location, this.index);\r\n            }\r\n        }\r\n    }\r\n\r\n    /***\r\n     This copies an already existing Texture object to our texture\r\n\r\n     params:\r\n     @texture (Texture): texture to set from\r\n     ***/\r\n    copy(texture) {\r\n        if(!texture || texture.type !== \"Texture\") {\r\n            if(!this.renderer.production) {\r\n                throwWarning(this.type + \": Unable to set the texture from texture:\", texture);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // copy states\r\n        this._globalParameters = Object.assign({}, texture._globalParameters);\r\n        this._state = Object.assign({}, texture._state);\r\n\r\n        // regenerate mips if needed\r\n        this.parameters.generateMipmap = texture.parameters.generateMipmap;\r\n        this._state.generateMipmap = null;\r\n\r\n        // copy source\r\n        this._size = texture._size;\r\n\r\n        // trigger loaded callback if needed\r\n        if(!this._sourceLoaded && texture._sourceLoaded) {\r\n            this._onSourceLoadedCallback && this._onSourceLoadedCallback();\r\n        }\r\n\r\n        this._sourceLoaded = texture._sourceLoaded;\r\n\r\n        // trigger uploaded callback if needed\r\n        if(!this._uploaded && texture._uploaded) {\r\n            this._onSourceUploadedCallback && this._onSourceUploadedCallback();\r\n        }\r\n\r\n        this._uploaded = texture._uploaded;\r\n\r\n        this.sourceType = texture.sourceType;\r\n        this.source = texture.source;\r\n        this._videoFrameCallbackID = texture._videoFrameCallbackID;\r\n\r\n        // copy texture\r\n        this._sampler.texture = texture._sampler.texture;\r\n\r\n        // keep a track from the original one\r\n        this._copiedFrom = texture;\r\n\r\n        // update its texture matrix if needed and we're good to go!\r\n        if(this._parent && this._parent._program && (!this._canDraw || !this._textureMatrix.matrix)) {\r\n            this._setSize();\r\n\r\n            this._canDraw = true;\r\n        }\r\n\r\n        this._updateTexParameters();\r\n\r\n        // force rendering\r\n        this.renderer.needRender();\r\n    }\r\n\r\n\r\n    /*** LOADING SOURCES ***/\r\n\r\n    /***\r\n     This uses our source as texture\r\n\r\n     params:\r\n     @source (images/video/canvas): either an image, a video or a canvas\r\n     ***/\r\n    setSource(source) {\r\n        // fire callback during load (useful for a loader)\r\n        if(!this._sourceLoaded) {\r\n            // texture source loaded callback\r\n            this.renderer.nextRender.add(() => this._onSourceLoadedCallback && this._onSourceLoadedCallback());\r\n        }\r\n\r\n        // get new source type based on source tag\r\n        const sourceType = source.tagName.toUpperCase() === \"IMG\" ? \"image\" : source.tagName.toLowerCase();\r\n\r\n        // somehow if the texture type changes from image to video or canvas, the cache won't work anymore\r\n        if(sourceType === \"video\" || sourceType === \"canvas\") {\r\n            this._useCache = false;\r\n        }\r\n\r\n        // check for cache\r\n        if(this._useCache) {\r\n            const cachedTexture = this.renderer.cache.getTextureFromSource(source);\r\n\r\n            // if we have a cached texture, just copy it\r\n            if (cachedTexture && cachedTexture.uuid !== this.uuid) {\r\n                // force texture uploaded callback\r\n                if (!this._uploaded) {\r\n                    // GPU uploading callback\r\n                    this.renderer.nextRender.add(() => this._onSourceUploadedCallback && this._onSourceUploadedCallback());\r\n\r\n                    this._uploaded = true;\r\n                }\r\n\r\n                this.copy(cachedTexture);\r\n\r\n                this.resize();\r\n\r\n                return;\r\n            }\r\n        }\r\n\r\n        if(this.sourceType === \"empty\" || this.sourceType !== sourceType) {\r\n            if(sourceType === \"video\") {\r\n                // a video should be updated by default\r\n                this._willUpdate = false;\r\n                this.shouldUpdate = true;\r\n            }\r\n            else if(sourceType === \"canvas\") {\r\n                // a canvas could change each frame so we need to update it by default\r\n                this._willUpdate = true;\r\n                this.shouldUpdate = true;\r\n            }\r\n            else if(sourceType === \"image\") {\r\n                this._willUpdate = false;\r\n                this.shouldUpdate = false;\r\n            }\r\n            else {\r\n                if(!this.renderer.production) {\r\n                    throwWarning(this.type + \": this HTML tag could not be converted into a texture:\", source.tagName);\r\n                }\r\n\r\n                return;\r\n            }\r\n        }\r\n\r\n        // set new source\r\n        this.source = source;\r\n        this.sourceType = sourceType;\r\n\r\n        this._size = {\r\n            width: this.source.naturalWidth || this.source.width || this.source.videoWidth,\r\n            height: this.source.naturalHeight || this.source.height || this.source.videoHeight,\r\n        };\r\n\r\n        // our source is loaded now\r\n        this._sourceLoaded = true;\r\n\r\n        // no need to set WebGL active texture unit here, we'll do it at run time for each texture\r\n        // binding the texture is enough\r\n        this.gl.bindTexture(this.gl.TEXTURE_2D, this._sampler.texture);\r\n\r\n        this.resize();\r\n\r\n        this._globalParameters.flipY = true;\r\n        this._globalParameters.premultiplyAlpha = this._globalParameters.shouldPremultiplyAlpha;\r\n\r\n        // upload our webgl texture only if it is an image\r\n        // canvas and video textures will be updated anyway in the rendering loop\r\n        // thanks to the shouldUpdate and _willUpdate flags\r\n        if(this.sourceType === \"image\") {\r\n            // generate mip maps if they have not been explicitly disabled\r\n            this.parameters.generateMipmap = this.parameters.generateMipmap || this.parameters.generateMipmap === null;\r\n            this.parameters._shouldUpdate = this.parameters.generateMipmap;\r\n            this._state.generateMipmap = false;\r\n\r\n            this._upload();\r\n        }\r\n\r\n        // update scene\r\n        this.renderer.needRender();\r\n    }\r\n\r\n\r\n    /*** TEXTURE PARAMETERS ***/\r\n\r\n    /***\r\n     Updates textures parameters that depends on global WebGL context state\r\n     Typically unpacking, flipY and premultiplied alpha\r\n     Usually called before uploading a texture to the GPU\r\n     ***/\r\n    _updateGlobalTexParameters() {\r\n        // unpack alignment\r\n        if(this.renderer.state.unpackAlignment !== this._globalParameters.unpackAlignment) {\r\n            this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT, this._globalParameters.unpackAlignment);\r\n            this.renderer.state.unpackAlignment = this._globalParameters.unpackAlignment;\r\n        }\r\n\r\n        // flip Y only if source is not empty\r\n        if(this.renderer.state.flipY !== this._globalParameters.flipY) {\r\n            this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL, this._globalParameters.flipY);\r\n            this.renderer.state.flipY = this._globalParameters.flipY;\r\n        }\r\n\r\n        // premultiplied alpha only if source is not empty\r\n        if(this.renderer.state.premultiplyAlpha !== this._globalParameters.premultiplyAlpha) {\r\n            this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, this._globalParameters.premultiplyAlpha);\r\n            this.renderer.state.premultiplyAlpha = this._globalParameters.premultiplyAlpha;\r\n        }\r\n\r\n        // floating point textures\r\n        if(this._globalParameters.floatingPoint === \"half-float\") {\r\n            if(this.renderer._isWebGL2 && this.renderer.extensions['EXT_color_buffer_float']) {\r\n                this._globalParameters.internalFormat = this.gl.RGBA16F;\r\n                this._globalParameters.type = this.gl.HALF_FLOAT;\r\n            }\r\n            else if(this.renderer.extensions['OES_texture_half_float']) {\r\n                this._globalParameters.type = this.renderer.extensions['OES_texture_half_float'].HALF_FLOAT_OES;\r\n            }\r\n            else if(!this.renderer.production) {\r\n                throwWarning(this.type + \": could not use half-float textures because the extension is not available\");\r\n            }\r\n        }\r\n        else if(this._globalParameters.floatingPoint === \"float\") {\r\n            if(this.renderer._isWebGL2 && this.renderer.extensions['EXT_color_buffer_float']) {\r\n                this._globalParameters.internalFormat = this.gl.RGBA16F;\r\n                this._globalParameters.type = this.gl.FLOAT;\r\n            }\r\n            else if(this.renderer.extensions['OES_texture_float']) {\r\n                this._globalParameters.type = this.renderer.extensions['OES_texture_half_float'].FLOAT;\r\n            }\r\n            else if(!this.renderer.production) {\r\n                throwWarning(this.type + \": could not use float textures because the extension is not available\");\r\n            }\r\n        }\r\n    }\r\n\r\n    /***\r\n     Updates per-textures parameters\r\n     Wrapping, filters, anisotropy and mipmaps generation\r\n     Usually called after uploading a texture to the GPU\r\n     ***/\r\n    _updateTexParameters() {\r\n        // be sure we're updating the right texture\r\n        if(this.index && this.renderer.state.activeTexture !== this.index) {\r\n            this._bindTexture();\r\n        }\r\n\r\n        // wrapS\r\n        if(this.parameters.wrapS !== this._state.wrapS) {\r\n            if(!this.renderer._isWebGL2 && (!isPowerOf2(this._size.width) || !isPowerOf2(this._size.height))) {\r\n                this.parameters.wrapS = this.gl.CLAMP_TO_EDGE;\r\n            }\r\n\r\n            // handle wrong wrapS values\r\n            if(\r\n                this.parameters.wrapS !== this.gl.REPEAT\r\n                && this.parameters.wrapS !== this.gl.CLAMP_TO_EDGE\r\n                && this.parameters.wrapS !== this.gl.MIRRORED_REPEAT\r\n            ) {\r\n                if(!this.renderer.production) {\r\n                    throwWarning(this.type + \": Wrong wrapS value\", this.parameters.wrapS, \"for this texture:\", this, \"\\ngl.CLAMP_TO_EDGE wrapping will be used instead\");\r\n                }\r\n                this.parameters.wrapS = this.gl.CLAMP_TO_EDGE;\r\n            }\r\n\r\n            this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_S, this.parameters.wrapS);\r\n            this._state.wrapS = this.parameters.wrapS;\r\n        }\r\n\r\n        // wrapT\r\n        if(this.parameters.wrapT !== this._state.wrapT) {\r\n            if(!this.renderer._isWebGL2 && (!isPowerOf2(this._size.width) || !isPowerOf2(this._size.height))) {\r\n                this.parameters.wrapT = this.gl.CLAMP_TO_EDGE;\r\n            }\r\n\r\n            // handle wrong wrapT values\r\n            if(\r\n                this.parameters.wrapT !== this.gl.REPEAT\r\n                && this.parameters.wrapT !== this.gl.CLAMP_TO_EDGE\r\n                && this.parameters.wrapT !== this.gl.MIRRORED_REPEAT\r\n            ) {\r\n                if(!this.renderer.production) {\r\n                    throwWarning(this.type + \": Wrong wrapT value\", this.parameters.wrapT, \"for this texture:\", this, \"\\ngl.CLAMP_TO_EDGE wrapping will be used instead\");\r\n                }\r\n                this.parameters.wrapT = this.gl.CLAMP_TO_EDGE;\r\n            }\r\n\r\n            this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_T, this.parameters.wrapT);\r\n            this._state.wrapT = this.parameters.wrapT;\r\n        }\r\n\r\n        // generate mip map only if it has a source\r\n        if(this.parameters.generateMipmap && !this._state.generateMipmap && this.source) {\r\n            if(!this.renderer._isWebGL2 && (!isPowerOf2(this._size.width) || !isPowerOf2(this._size.height))) {\r\n                this.parameters.generateMipmap = false;\r\n            }\r\n            else {\r\n                this.gl.generateMipmap(this.gl.TEXTURE_2D);\r\n            }\r\n\r\n            this._state.generateMipmap = this.parameters.generateMipmap;\r\n        }\r\n\r\n        // min filter\r\n        if(this.parameters.minFilter !== this._state.minFilter) {\r\n            // WebGL1 and non PO2\r\n            if(!this.renderer._isWebGL2 && (!isPowerOf2(this._size.width) || !isPowerOf2(this._size.height))) {\r\n                this.parameters.minFilter = this.gl.LINEAR;\r\n            }\r\n\r\n            // at this point if generateMipmap is null it means we will generate them later on\r\n            if(!this.parameters.generateMipmap && this.parameters.generateMipmap !== null) {\r\n                this.parameters.minFilter = this.gl.LINEAR;\r\n            }\r\n\r\n            // handle wrong minFilter values\r\n            if(\r\n                this.parameters.minFilter !== this.gl.LINEAR\r\n                && this.parameters.minFilter !== this.gl.NEAREST\r\n                && this.parameters.minFilter !== this.gl.NEAREST_MIPMAP_NEAREST\r\n                && this.parameters.minFilter !== this.gl.LINEAR_MIPMAP_NEAREST\r\n                && this.parameters.minFilter !== this.gl.NEAREST_MIPMAP_LINEAR\r\n                && this.parameters.minFilter !== this.gl.LINEAR_MIPMAP_LINEAR\r\n            ) {\r\n                if(!this.renderer.production) {\r\n                    throwWarning(this.type + \": Wrong minFilter value\", this.parameters.minFilter, \"for this texture:\", this, \"\\ngl.LINEAR filtering will be used instead\");\r\n                }\r\n                this.parameters.minFilter = this.gl.LINEAR;\r\n            }\r\n\r\n            this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MIN_FILTER, this.parameters.minFilter);\r\n            this._state.minFilter = this.parameters.minFilter;\r\n        }\r\n\r\n        // mag filter\r\n        if(this.parameters.magFilter !== this._state.magFilter) {\r\n            if(!this.renderer._isWebGL2 && (!isPowerOf2(this._size.width) || !isPowerOf2(this._size.height))) {\r\n                this.parameters.magFilter = this.gl.LINEAR;\r\n            }\r\n\r\n            // handle wrong magFilter values\r\n            if(\r\n                this.parameters.magFilter !== this.gl.LINEAR\r\n                && this.parameters.magFilter !== this.gl.NEAREST\r\n            ) {\r\n                if(!this.renderer.production) {\r\n                    throwWarning(this.type + \": Wrong magFilter value\", this.parameters.magFilter, \"for this texture:\", this, \"\\ngl.LINEAR filtering will be used instead\");\r\n                }\r\n                this.parameters.magFilter = this.gl.LINEAR;\r\n            }\r\n\r\n            this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MAG_FILTER, this.parameters.magFilter);\r\n            this._state.magFilter = this.parameters.magFilter;\r\n        }\r\n\r\n        // anisotropy\r\n        const anisotropyExt = this.renderer.extensions['EXT_texture_filter_anisotropic'];\r\n        if(anisotropyExt && this.parameters.anisotropy !== this._state.anisotropy) {\r\n            const max = this.gl.getParameter(anisotropyExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);\r\n            this.parameters.anisotropy = Math.max(1, Math.min(this.parameters.anisotropy, max));\r\n\r\n            this.gl.texParameterf(this.gl.TEXTURE_2D, anisotropyExt.TEXTURE_MAX_ANISOTROPY_EXT, this.parameters.anisotropy);\r\n            this._state.anisotropy = this.parameters.anisotropy;\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     Sets the texture wrapping for the texture coordinate S\r\n\r\n     params:\r\n     @wrapS (GLenum): WebGL constant specifying the texture wrapping function for the texture coordinate S\r\n     ***/\r\n    setWrapS(wrapS) {\r\n        if(this.parameters.wrapS !== wrapS) {\r\n            this.parameters.wrapS = wrapS;\r\n            this.parameters._shouldUpdate = true;\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     Sets the texture wrapping for the texture coordinate T\r\n\r\n     params:\r\n     @wrapT (GLenum): WebGL constant specifying the texture wrapping function for the texture coordinate T\r\n     ***/\r\n    setWrapT(wrapT) {\r\n        if(this.parameters.wrapT !== wrapT) {\r\n            this.parameters.wrapT = wrapT;\r\n            this.parameters._shouldUpdate = true;\r\n        }\r\n    }\r\n\r\n    /***\r\n     Sets the texture minifaction filter value\r\n\r\n     params:\r\n     @minFilter (GLenum): WebGL constant specifying the texture minification filter\r\n     ***/\r\n    setMinFilter(minFilter) {\r\n        if(this.parameters.minFilter !== minFilter) {\r\n            this.parameters.minFilter = minFilter;\r\n            this.parameters._shouldUpdate = true;\r\n        }\r\n    }\r\n\r\n    /***\r\n     Sets the texture magnifaction filter value\r\n\r\n     params:\r\n     @magFilter (GLenum): WebGL constant specifying the texture magnifaction filter\r\n     ***/\r\n    setMagFilter(magFilter) {\r\n        if(this.parameters.magFilter !== magFilter) {\r\n            this.parameters.magFilter = magFilter;\r\n            this.parameters._shouldUpdate = true;\r\n        }\r\n    }\r\n\r\n    /***\r\n     Sets the texture anisotropy\r\n\r\n     params:\r\n     @anisotropy (int): Texture anisotropy value\r\n     ***/\r\n    setAnisotropy(anisotropy) {\r\n        anisotropy = isNaN(anisotropy) ? this.parameters.anisotropy : anisotropy;\r\n\r\n        if(this.parameters.anisotropy !== anisotropy) {\r\n            this.parameters.anisotropy = anisotropy;\r\n            this.parameters._shouldUpdate = true;\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     This forces a texture to be updated on the next draw call\r\n     ***/\r\n    needUpdate() {\r\n        this._forceUpdate = true;\r\n    }\r\n\r\n\r\n    /***\r\n     This uses the requestVideoFrameCallback API to update the texture each time a new frame is displayed\r\n     ***/\r\n    _videoFrameCallback() {\r\n        this._willUpdate = true;\r\n        if(!this.source) {\r\n            // wait for source to load\r\n            const waitForSource = this.renderer.nextRender.add(() => {\r\n                if(this.source) {\r\n                    // source is ready, stop executing the callback\r\n                    waitForSource.keep = false;\r\n\r\n                    this.source.requestVideoFrameCallback(() => this._videoFrameCallback());\r\n                }\r\n            }, true);\r\n        } else {\r\n          this.source.requestVideoFrameCallback(() => this._videoFrameCallback());\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     This updloads our texture to the GPU\r\n     Called on init or inside our drawing loop if shouldUpdate property is set to true\r\n     Typically used by videos or canvas\r\n     ***/\r\n    _upload() {\r\n        // set parameters that need to be set before texture uploading\r\n        this._updateGlobalTexParameters();\r\n\r\n        if(this.source) {\r\n            this.gl.texImage2D(this.gl.TEXTURE_2D, 0, this._globalParameters.internalFormat, this._globalParameters.format, this._globalParameters.type, this.source);\r\n        }\r\n        else if(this.sourceType === \"fbo\") {\r\n            this.gl.texImage2D(this.gl.TEXTURE_2D, 0, this._globalParameters.internalFormat, this._size.width, this._size.height, 0, this._globalParameters.format, this._globalParameters.type, this.source || null);\r\n        }\r\n\r\n        // texture has been uploaded\r\n        if(!this._uploaded) {\r\n            // GPU uploading callback\r\n            this.renderer.nextRender.add(() => this._onSourceUploadedCallback && this._onSourceUploadedCallback());\r\n\r\n            this._uploaded = true;\r\n        }\r\n    }\r\n\r\n\r\n    /*** TEXTURE SIZINGS ***/\r\n\r\n\r\n    /***\r\n     This is used to calculate how to crop/center an texture\r\n\r\n     returns:\r\n     @sizes (obj): an object containing plane sizes, source sizes and x and y offset to center the source in the plane\r\n     ***/\r\n    _getSizes() {\r\n        // if this is a fbo texture, its size is the same as its parent\r\n        if(this.sourceType === \"fbo\") {\r\n            return {\r\n                parentWidth: this._parent._boundingRect.document.width,\r\n                parentHeight: this._parent._boundingRect.document.height,\r\n                sourceWidth: this._parent._boundingRect.document.width,\r\n                sourceHeight: this._parent._boundingRect.document.height,\r\n                xOffset: 0,\r\n                yOffset: 0,\r\n            };\r\n        }\r\n\r\n        // remember our ShaderPass objects don't have a scale property\r\n        const scale = this._parent.scale ? tempVec2.set(this._parent.scale.x, this._parent.scale.y) : tempVec2.set(1, 1);\r\n\r\n        const parentWidth  = this._parent._boundingRect.document.width * scale.x;\r\n        const parentHeight = this._parent._boundingRect.document.height * scale.y;\r\n\r\n        const sourceWidth = this._size.width;\r\n        const sourceHeight = this._size.height;\r\n\r\n        const sourceRatio = sourceWidth / sourceHeight;\r\n        const parentRatio = parentWidth / parentHeight;\r\n\r\n        // center image in its container\r\n        let xOffset = 0;\r\n        let yOffset = 0;\r\n\r\n        if(parentRatio > sourceRatio) { // means parent is larger\r\n            yOffset = Math.min(0, parentHeight - (parentWidth * (1 / sourceRatio)));\r\n        }\r\n        else if(parentRatio < sourceRatio) { // means parent is taller\r\n            xOffset = Math.min(0, parentWidth - (parentHeight * sourceRatio));\r\n        }\r\n\r\n        return {\r\n            parentWidth: parentWidth,\r\n            parentHeight: parentHeight,\r\n            sourceWidth: sourceWidth,\r\n            sourceHeight: sourceHeight,\r\n            xOffset: xOffset,\r\n            yOffset: yOffset,\r\n        };\r\n    }\r\n\r\n\r\n    /***\r\n     Set the texture scale and then update its matrix\r\n\r\n     params:\r\n     @scale (Vec2 object): scale to apply on X and Y axes\r\n     ***/\r\n    setScale(scale) {\r\n        if(!scale.type || scale.type !== \"Vec2\") {\r\n            if(!this.renderer.production) {\r\n                throwWarning(this.type + \": Cannot set scale because the parameter passed is not of Vec2 type:\", scale);\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        scale.sanitizeNaNValuesWith(this.scale).max(tempVec2.set(0.001, 0.001));\r\n\r\n        if(!scale.equals(this.scale)) {\r\n            this.scale.copy(scale);\r\n\r\n            this.resize();\r\n        }\r\n    }\r\n\r\n    setOffset(offset) {\r\n        if(!offset.type || offset.type !== \"Vec2\") {\r\n            if(!this.renderer.production) {\r\n                throwWarning(this.type + \": Cannot set offset because the parameter passed is not of Vec2 type:\", scale);\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        offset.sanitizeNaNValuesWith(this.offset);\r\n\r\n        if(!offset.equals(this.offset)) {\r\n            this.offset.copy(offset);\r\n\r\n            this.resize();\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     Gets our texture and parent sizes and tells our texture matrix to update based on those values\r\n     ***/\r\n    _setSize() {\r\n        // if we need to update the texture matrix uniform\r\n        if(this._parent && this._parent._program) {\r\n            const sizes = this._getSizes();\r\n\r\n            // always update texture matrix anyway\r\n            this._updateTextureMatrix(sizes);\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     This is used to crop/center a texture\r\n     If the texture is using texture matrix then we just have to update its matrix\r\n     If it is a render pass texture we also upload the texture with its new size on the GPU\r\n     ***/\r\n    resize() {\r\n        if(this.sourceType === \"fbo\") {\r\n            // update size based on parent sizes (RenderTarget or ShaderPass)\r\n            this._size = {\r\n                width: this._parent._size && this._parent._size.width || this._parent._boundingRect.document.width,\r\n                height: this._parent._size && this._parent._size.height || this._parent._boundingRect.document.height,\r\n            };\r\n\r\n            // reupload only if its not a texture set from another texture (means its a RenderTarget texture)\r\n            if(!this._copiedFrom) {\r\n                this.gl.bindTexture(this.gl.TEXTURE_2D, this._sampler.texture);\r\n                this.gl.texImage2D(this.gl.TEXTURE_2D, 0, this._globalParameters.internalFormat, this._size.width, this._size.height, 0, this._globalParameters.format, this._globalParameters.type, null);\r\n            }\r\n        }\r\n        else if(this.source) {\r\n            // reset texture sizes (useful for canvas because their dimensions might change on resize)\r\n            this._size = {\r\n                width: this.source.naturalWidth || this.source.width || this.source.videoWidth,\r\n                height: this.source.naturalHeight || this.source.height || this.source.videoHeight,\r\n            };\r\n        }\r\n\r\n        this._setSize();\r\n    }\r\n\r\n    /***\r\n     This updates our textures matrix uniform based on plane and sources sizes\r\n\r\n     params:\r\n     @sizes (object): object containing plane sizes, source sizes and x and y offset to center the source in the plane\r\n     ***/\r\n    _updateTextureMatrix(sizes) {\r\n        // calculate scale to apply to the matrix\r\n        const textureScale = tempVec3.set(\r\n            sizes.parentWidth / (sizes.parentWidth - sizes.xOffset),\r\n            sizes.parentHeight / (sizes.parentHeight - sizes.yOffset),\r\n            1\r\n        );\r\n\r\n        // apply texture scale\r\n        textureScale.x /= this.scale.x;\r\n        textureScale.y /= this.scale.y;\r\n\r\n        // translate and scale texture to center it\r\n        // equivalent (but faster) than applying those steps to an identity matrix:\r\n        // translate from [(1 - textureScale.x) / 2 + this.offset.x, (1 - textureScale.y) / 2 + this.offset.y, 0]\r\n        // then apply a scale of [textureScale.x, textureScale.y, 1]\r\n        this._textureMatrix.matrix = textureTranslation.setFromArray([\r\n            textureScale.x, 0, 0, 0,\r\n            0, textureScale.y, 0, 0,\r\n            0, 0, 1, 0,\r\n            (1 - textureScale.x) / 2 + this.offset.x, (1 - textureScale.y) / 2 + this.offset.y, 0, 1\r\n        ]);\r\n\r\n        // update the texture matrix uniform\r\n        this._updateMatrixUniform();\r\n    }\r\n\r\n\r\n    /***\r\n     This updates our textures matrix GL uniform\r\n     ***/\r\n    _updateMatrixUniform() {\r\n        if(this._textureMatrix.isActive) {\r\n            this.renderer.useProgram(this._parent._program);\r\n            this.gl.uniformMatrix4fv(this._textureMatrix.location, false, this._textureMatrix.matrix.elements);\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     This calls our loading callback and set our media as texture source\r\n     ***/\r\n    _onSourceLoaded(source) {\r\n        // set the media as our texture source\r\n        this.setSource(source);\r\n\r\n        // add to the cache if needed\r\n        if(this.sourceType === \"image\") {\r\n            this.renderer.cache.addTexture(this);\r\n        }\r\n    }\r\n\r\n\r\n    /*** DRAWING ***/\r\n\r\n    /***\r\n     This is used to set the WebGL context active texture and bind it\r\n\r\n     params:\r\n     @texture (texture object): Our texture object containing our WebGL texture and its index\r\n     ***/\r\n    _bindTexture() {\r\n        if(this._canDraw) {\r\n            if(this.renderer.state.activeTexture !== this.index) {\r\n                // tell WebGL we want to affect the texture at the plane's index unit\r\n                this.gl.activeTexture(this.gl.TEXTURE0 + this.index);\r\n                this.renderer.state.activeTexture = this.index;\r\n            }\r\n\r\n            // bind the texture to the plane's index unit\r\n            this.gl.bindTexture(this.gl.TEXTURE_2D, this._sampler.texture);\r\n\r\n            // check for texture binding until we got one\r\n            if(!this._sampler.isTextureBound) {\r\n                this._sampler.isTextureBound = !!this.gl.getParameter(this.gl.TEXTURE_BINDING_2D);\r\n\r\n                // force render\r\n                this._sampler.isTextureBound && this.renderer.needRender();\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     This is called to draw the texture\r\n     ***/\r\n    _draw() {\r\n        // only draw if the texture is active (used in the shader)\r\n        if(this._sampler.isActive) {\r\n            // bind the texture\r\n            this._bindTexture();\r\n\r\n            // if no videoFrameCallback check if the video is actually really playing\r\n            if(this.sourceType === \"video\" && this.source && !this._videoFrameCallbackID && this.source.readyState >= this.source.HAVE_CURRENT_DATA && !this.source.paused) {\r\n                this._willUpdate = true;\r\n            }\r\n\r\n            if(this._forceUpdate || (this._willUpdate && this.shouldUpdate)) {\r\n                // force mipmaps regeneration if needed\r\n                this._state.generateMipmap = false;\r\n                this._upload();\r\n            }\r\n\r\n            // reset the video willUpdate flag\r\n            if(this.sourceType === \"video\") {\r\n                this._willUpdate = false;\r\n            }\r\n\r\n            this._forceUpdate = false;\r\n        }\r\n\r\n        // set parameters that need to be set after texture uploading\r\n        if(this.parameters._shouldUpdate) {\r\n            this._updateTexParameters();\r\n            this.parameters._shouldUpdate = false;\r\n        }\r\n    }\r\n\r\n\r\n    /*** EVENTS ***/\r\n\r\n    /***\r\n     This is called each time a source has been loaded for the first time\r\n     TODO useless?\r\n\r\n     params :\r\n     @callback (function) : a function to execute\r\n\r\n     returns :\r\n     @this: our texture to handle chaining\r\n     ***/\r\n    onSourceLoaded(callback) {\r\n        if(callback) {\r\n            this._onSourceLoadedCallback = callback;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /***\r\n     This is called each time a texture has been uploaded to the GPU for the first time\r\n\r\n     params :\r\n     @callback (function) : a function to execute\r\n\r\n     returns :\r\n     @this: our texture to handle chaining\r\n     ***/\r\n    onSourceUploaded(callback) {\r\n        if(callback) {\r\n            this._onSourceUploadedCallback = callback;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /*** DESTROYING ***/\r\n\r\n    /***\r\n     This is used to destroy a texture and free the memory space\r\n     Usually used on a plane/shader pass/render target removal\r\n\r\n     params:\r\n     @force (bool, optional): force the texture to be deleted even if cached\r\n     ***/\r\n    _dispose(force = false) {\r\n        if(this.sourceType === \"video\" || this.sourceType === \"image\" && !this.renderer.state.isActive) {\r\n            // remove event listeners\r\n            if(this._loader) {\r\n                this._loader._removeSource(this);\r\n            }\r\n\r\n            // clear source\r\n            this.source = null;\r\n        }\r\n        else if(this.sourceType === \"canvas\") {\r\n            // clear all canvas states\r\n            this.source.width = this.source.width;\r\n\r\n            // clear source\r\n            this.source = null;\r\n        }\r\n\r\n        // remove its parent\r\n        this._parent = null;\r\n\r\n        // do not delete original texture if this texture is a copy, or image texture if we're not destroying the context\r\n        const shouldDelete = this.gl && !this._copiedFrom && (force || this.sourceType !== \"image\" || !this.renderer.state.isActive);\r\n\r\n        if(shouldDelete) {\r\n            this._canDraw = false;\r\n\r\n            // if the texture is in our textures cache array, remove it\r\n            this.renderer.cache.removeTexture(this);\r\n\r\n            this.gl.activeTexture(this.gl.TEXTURE0 + this.index);\r\n            this.gl.bindTexture(this.gl.TEXTURE_2D, null);\r\n            this.gl.deleteTexture(this._sampler.texture);\r\n        }\r\n    }\r\n}","import {Texture} from '../core/Texture.js';\r\nimport {throwError} from \"../utils/utils.js\";\r\n\r\n/*** TEXTURE LOADER CLASS ***/\r\n\r\n/***\r\n An asset loader that handles images, videos and canvas loading\r\n Load the assets and create a Texture class object that will use those assets as sources\r\n\r\n params:\r\n @renderer (Curtains or Renderer class object): our curtains object OR our curtains renderer object\r\n @crossOrigin (string, optional): crossorigin policy to use\r\n\r\n returns :\r\n @this: our TextureLoader element\r\n ***/\r\n\r\n// TODO load assets with a web worker?\r\n\r\nexport class TextureLoader {\r\n    constructor(\r\n        renderer,\r\n        crossOrigin = \"anonymous\",\r\n    ) {\r\n        this.type = \"TextureLoader\";\r\n\r\n        // we could pass our curtains object OR our curtains renderer object\r\n        renderer = renderer && renderer.renderer || renderer;\r\n\r\n        // throw warning if no renderer or webgl context\r\n        if(!renderer || renderer.type !== \"Renderer\") {\r\n            throwError(this.type + \": Renderer not passed as first argument\", renderer);\r\n        }\r\n        else if(!renderer.gl) {\r\n            throwError(this.type + \": Renderer WebGL context is undefined\", renderer);\r\n\r\n            // return if no gl context\r\n            return;\r\n        }\r\n\r\n        // renderer and webgl context\r\n        this.renderer = renderer;\r\n        this.gl = this.renderer.gl;\r\n\r\n        // crossorigin policy to apply\r\n        this.crossOrigin = crossOrigin;\r\n\r\n        // keep a track of all sources loaded via this loader\r\n        this.elements = [];\r\n    }\r\n\r\n\r\n    /***\r\n     Keep a track of all sources loaded via this loader with an els array\r\n     This allows to get clean refs to the event listeners to be able to remove them later\r\n\r\n     params:\r\n     @source (html element): html image, video or canvas element that has been loaded\r\n     @texture (Texture class object): our newly created texture that will use that source\r\n     @successCallback (function): reference to our success callback\r\n     @errorCallback (function): reference to our error callback\r\n     ***/\r\n    _addElement(source, texture, successCallback, errorCallback) {\r\n        const el = {\r\n            source,\r\n            texture,\r\n            load: this._sourceLoaded.bind(this, source, texture, successCallback),\r\n            error: this._sourceLoadError.bind(this, source, errorCallback),\r\n        };\r\n\r\n        this.elements.push(el);\r\n\r\n        return el;\r\n    }\r\n\r\n\r\n    /***\r\n     Handles media loading errors\r\n\r\n     params:\r\n     @source (html element): html image or video element that has failed to load\r\n     @callback (function): function to execute\r\n     @error (object): loading error\r\n     ***/\r\n    _sourceLoadError(source, callback, error) {\r\n        // execute callback\r\n        if(callback) {\r\n            callback(source, error);\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     Handles media loading success\r\n\r\n     params:\r\n     @source (html element): html image, video or canvas element that has been loaded\r\n     @texture (Texture class object): our newly created texture that will use that source\r\n     @callback (function): function to execute\r\n     ***/\r\n    _sourceLoaded(source, texture, callback) {\r\n        // execute only once\r\n        if (!texture._sourceLoaded) {\r\n            texture._onSourceLoaded(source);\r\n\r\n            // if this loader has a parent (means its a PlaneTextureLoader)\r\n            if(this._parent) {\r\n                // increment plane texture loader\r\n                this._increment && this._increment();\r\n\r\n                this.renderer.nextRender.add(() => this._parent._onLoadingCallback && this._parent._onLoadingCallback(texture));\r\n            }\r\n\r\n            // execute callback\r\n            if(callback) {\r\n                callback(texture);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     Get the source type based on its file extension if it's a string or it's tag name if its a HTML element\r\n\r\n     params:\r\n     @source (html element or string): html image, video, canvas element or source url\r\n\r\n     returns :\r\n     @sourceType (string): either \"image\", \"video\", \"canvas\" or null if source type cannot be determined\r\n     ***/\r\n    _getSourceType(source) {\r\n        let sourceType;\r\n\r\n        if(typeof source === \"string\") {\r\n            // from https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#Supported_image_formats\r\n            if(source.match(/\\.(jpeg|jpg|jfif|pjpeg|pjp|gif|bmp|png|webp|svg|avif|apng)$/) !== null) {\r\n                sourceType = \"image\";\r\n            }\r\n            else if(source.match(/\\.(webm|mp4|mpg|mpeg|avi|ogg|ogm|ogv|mov|av1)$/) !== null) {\r\n                sourceType = \"video\";\r\n            }\r\n        }\r\n        else {\r\n            if(source.tagName.toUpperCase() === \"IMG\") {\r\n                sourceType = \"image\";\r\n            }\r\n            else if(source.tagName.toUpperCase() === \"VIDEO\") {\r\n                sourceType = \"video\";\r\n            }\r\n            else if(source.tagName.toUpperCase() === \"CANVAS\") {\r\n                sourceType = \"canvas\";\r\n            }\r\n        }\r\n\r\n        return sourceType;\r\n    }\r\n\r\n\r\n    /***\r\n     Create an image HTML element based on an image source url\r\n\r\n     params:\r\n     @source (string): source url\r\n\r\n     returns :\r\n     @image (HTML image element): an HTML image element\r\n     ***/\r\n    _createImage(source) {\r\n        // create a new image element if the source specified is a string\r\n        // or if the crossorigin attribute is not specified (avoid potential CORS errors)\r\n        if(typeof source === \"string\" || !source.hasAttribute(\"crossOrigin\")) {\r\n            const image = new Image();\r\n            image.crossOrigin = this.crossOrigin;\r\n            if(typeof source === \"string\") {\r\n                image.src = source;\r\n            }\r\n            else {\r\n                image.src = source.src;\r\n                source.hasAttribute(\"data-sampler\") && image.setAttribute(\"data-sampler\", source.getAttribute(\"data-sampler\"));\r\n            }\r\n            return image;\r\n        }\r\n        else {\r\n            // else return source directly to avoid reloading the image\r\n            return source;\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     Create a video HTML element based on a video source url\r\n\r\n     params:\r\n     @source (string): source url\r\n\r\n     returns :\r\n     @video (HTML video element): an HTML video element\r\n     ***/\r\n    _createVideo(source) {\r\n        // create a new video element if the source specified is a string\r\n        // or if the crossorigin attribute is not specified (avoid potential CORS errors)\r\n        if(typeof source === \"string\" || source.getAttribute(\"crossOrigin\") === null) {\r\n            const video = document.createElement(\"video\");\r\n            video.crossOrigin = this.crossOrigin;\r\n            if(typeof source === \"string\") {\r\n                video.src = source;\r\n            }\r\n            else {\r\n                video.src = source.src;\r\n                source.hasAttribute(\"data-sampler\") && video.setAttribute(\"data-sampler\", source.getAttribute(\"data-sampler\"));\r\n            }\r\n            return video;\r\n        }\r\n        else {\r\n            // else return source directly to avoid reloading the video\r\n            return source;\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     This method loads one source\r\n     It checks what type of source it is then use the right loader\r\n\r\n     params:\r\n     @source (html element): html image, video or canvas element\r\n     @textureOptions (object): parameters to apply to the textures, such as sampler name, repeat wrapping, filters, anisotropy...\r\n     @successCallback (function): function to execute when the source has been loaded\r\n     @errorCallback (function): function to execute if the source fails to load\r\n     ***/\r\n    loadSource(\r\n        source,\r\n        textureOptions,\r\n        successCallback,\r\n        errorCallback\r\n    ) {\r\n        // get source type to use the right loader\r\n        const sourceType = this._getSourceType(source);\r\n\r\n        switch(sourceType) {\r\n            case \"image\":\r\n                this.loadImage(source, textureOptions, successCallback, errorCallback);\r\n                break;\r\n            case \"video\":\r\n                this.loadVideo(source, textureOptions, successCallback, errorCallback);\r\n                break;\r\n            case \"canvas\":\r\n                this.loadCanvas(source, textureOptions, successCallback);\r\n                break;\r\n            default:\r\n                this._sourceLoadError(source, errorCallback, \"this source could not be converted into a texture: \" + source);\r\n                break;\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     This method loads an array of sources by calling loadSource() for each one of them\r\n\r\n     params:\r\n     @sources (array of html elements / sources url): array of html images, videos, canvases element or sources url\r\n     @texturesOptions (object): parameters to apply to the textures, such as sampler name, repeat wrapping, filters, anisotropy...\r\n     @successCallback (function): function to execute when each source has been loaded\r\n     @errorCallback (function): function to execute if a source fails to load\r\n     ***/\r\n    loadSources(\r\n        sources,\r\n        texturesOptions,\r\n        successCallback,\r\n        errorCallback\r\n    ) {\r\n        for(let i = 0; i < sources.length; i++) {\r\n            this.loadSource(sources[i], texturesOptions, successCallback, errorCallback);\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     This method loads an image\r\n     Creates a new texture object right away and once the image is loaded it uses it as our WebGL texture\r\n\r\n     params:\r\n     @source (image): html image element\r\n     @textureOptions (object): parameters to apply to the textures, such as sampler name, repeat wrapping, filters, anisotropy...\r\n     @successCallback (function): function to execute when the source has been loaded\r\n     @errorCallback (function): function to execute if the source fails to load\r\n     ***/\r\n    loadImage(\r\n        source,\r\n        textureOptions = {},\r\n        successCallback,\r\n        errorCallback\r\n    ) {\r\n        // check for cache\r\n        const cachedTexture = this.renderer.cache.getTextureFromSource(source);\r\n\r\n        let options = Object.assign({}, textureOptions);\r\n        // merge texture options with its parent textures options if needed\r\n        if(this._parent) {\r\n            options = Object.assign(options, this._parent._texturesOptions);\r\n        }\r\n\r\n        options.loader = this;\r\n\r\n        if(cachedTexture) {\r\n            options.sampler = typeof source !== \"string\" && source.hasAttribute(\"data-sampler\") ? source.getAttribute(\"data-sampler\") : options.sampler;\r\n\r\n            options.fromTexture = cachedTexture;\r\n            const texture = new Texture(this.renderer, options);\r\n\r\n            // execute source loaded callback directly\r\n            this._sourceLoaded(cachedTexture.source, texture, successCallback);\r\n\r\n            // if there's a parent (PlaneTextureLoader) add texture and source to it\r\n            this._parent && this._addToParent(texture, cachedTexture.source, \"image\");\r\n\r\n            // that's all!\r\n            return;\r\n        }\r\n\r\n        const image = this._createImage(source);\r\n\r\n        options.sampler = image.hasAttribute(\"data-sampler\") ? image.getAttribute(\"data-sampler\") : options.sampler;\r\n\r\n        // create a new texture that will use our image later\r\n        const texture = new Texture(this.renderer, options);\r\n\r\n        // add a new entry in our elements array\r\n        const el = this._addElement(image, texture, successCallback, errorCallback);\r\n\r\n        // If the image is in the cache of the browser,\r\n        // the 'load' event might have been triggered\r\n        // before we registered the event handler.\r\n        if(image.complete) {\r\n            this._sourceLoaded(image, texture, successCallback);\r\n        }\r\n        else if(image.decode) {\r\n            image.decode().then(this._sourceLoaded.bind(this, image, texture, successCallback)).catch(() => {\r\n                // fallback to classic load & error events\r\n                image.addEventListener('load', el.load, false);\r\n                image.addEventListener('error', el.error, false);\r\n            });\r\n        }\r\n        else {\r\n            image.addEventListener('load', el.load, false);\r\n            image.addEventListener('error', el.error, false);\r\n        }\r\n\r\n        // if there's a parent (PlaneTextureLoader) add texture and source to it\r\n        this._parent && this._addToParent(texture, image,  \"image\");\r\n    }\r\n\r\n\r\n    /***\r\n     This method loads an array of images by calling loadImage() for each one of them\r\n\r\n     params:\r\n     @sources (array of images / images url): array of html images elements or images url\r\n     @texturesOptions (object): parameters to apply to the textures, such as sampler name, repeat wrapping, filters, anisotropy...\r\n     @successCallback (function): function to execute when each source has been loaded\r\n     @errorCallback (function): function to execute if a source fails to load\r\n     ***/\r\n    loadImages(\r\n        sources,\r\n        texturesOptions,\r\n        successCallback,\r\n        errorCallback\r\n    ) {\r\n        for(let i = 0; i < sources.length; i++) {\r\n            this.loadImage(sources[i], texturesOptions, successCallback, errorCallback);\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     This method loads a video\r\n     Creates a new texture object right away and once the video has enough data it uses it as our WebGL texture\r\n\r\n     params:\r\n     @source (video): html video element\r\n     @textureOptions (object): parameters to apply to the textures, such as sampler name, repeat wrapping, filters, anisotropy...\r\n     @successCallback (function): function to execute when the source has been loaded\r\n     @errorCallback (function): function to execute if the source fails to load\r\n     ***/\r\n    loadVideo(\r\n        source,\r\n        textureOptions = {},\r\n        successCallback,\r\n        errorCallback\r\n    ) {\r\n        const video = this._createVideo(source);\r\n\r\n        video.preload = true;\r\n        video.muted = true;\r\n        video.loop = true;\r\n        video.setAttribute(\"playsinline\", \"\");\r\n\r\n        video.crossOrigin = this.crossOrigin;\r\n\r\n        let options = Object.assign({}, textureOptions);\r\n        // merge texture options with its parent textures options if needed\r\n        if(this._parent) {\r\n            options = Object.assign(textureOptions, this._parent._texturesOptions);\r\n        }\r\n\r\n        options.loader = this;\r\n        options.sampler = video.hasAttribute(\"data-sampler\") ? video.getAttribute(\"data-sampler\") : options.sampler;\r\n\r\n        // create a new texture that will use our video later\r\n        const texture = new Texture(this.renderer, options);\r\n\r\n        // add a new entry in our elements array\r\n        const el = this._addElement(video, texture, successCallback, errorCallback);\r\n\r\n        // handle our loaded data event inside the texture and tell our plane when the video is ready to play\r\n        video.addEventListener('canplaythrough', el.load, false);\r\n        video.addEventListener('error', el.error, false);\r\n\r\n        // If the video is in the cache of the browser,\r\n        // the 'canplaythrough' event might have been triggered\r\n        // before we registered the event handler.\r\n        if(video.readyState >= video.HAVE_FUTURE_DATA && successCallback) {\r\n            this._sourceLoaded(video, texture, successCallback);\r\n        }\r\n\r\n        // start loading our video\r\n        video.load();\r\n\r\n        // if there's a parent (PlaneTextureLoader) add texture and source to it\r\n        this._addToParent && this._addToParent(texture, video, \"video\");\r\n\r\n        // if requestVideoFrameCallback exist, use it to update our video texture\r\n        if('requestVideoFrameCallback' in HTMLVideoElement.prototype) {\r\n            el.videoFrameCallback = texture._videoFrameCallback.bind(texture);\r\n            texture._videoFrameCallbackID = video.requestVideoFrameCallback(el.videoFrameCallback);\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     This method loads an array of images by calling loadVideo() for each one of them\r\n\r\n     params:\r\n     @sources (array of videos / videos url): array of html videos elements or videos url\r\n     @texturesOptions (object): parameters to apply to the textures, such as sampler name, repeat wrapping, filters, anisotropy...\r\n     @successCallback (function): function to execute when each source has been loaded\r\n     @errorCallback (function): function to execute if a source fails to load\r\n     ***/\r\n    loadVideos(\r\n        sources,\r\n        texturesOptions,\r\n        successCallback,\r\n        errorCallback\r\n    ) {\r\n        for(let i = 0; i < sources.length; i++) {\r\n            this.loadVideo(sources[i], texturesOptions, successCallback, errorCallback);\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     This method loads a canvas\r\n     Creates a new texture object right away and uses the canvas as our WebGL texture\r\n\r\n     params:\r\n     @source (canvas): html canvas element\r\n     @textureOptions (object): parameters to apply to the textures, such as sampler name, repeat wrapping, filters, anisotropy...\r\n     @successCallback (function): function to execute when the source has been loaded\r\n     ***/\r\n    loadCanvas(\r\n        source,\r\n        textureOptions = {},\r\n        successCallback\r\n    ) {\r\n        let options = Object.assign({}, textureOptions);\r\n        // merge texture options with its parent textures options if needed\r\n        if(this._parent) {\r\n            options = Object.assign(textureOptions, this._parent._texturesOptions);\r\n        }\r\n\r\n        options.loader = this;\r\n        options.sampler = source.hasAttribute(\"data-sampler\") ? source.getAttribute(\"data-sampler\") : options.sampler;\r\n\r\n        // create a new texture that will use our source later\r\n        const texture = new Texture(this.renderer, options);\r\n\r\n        // add a new entry in our elements array\r\n        this._addElement(source, texture, successCallback, null);\r\n\r\n        // canvas are directly loaded\r\n        this._sourceLoaded(source, texture, successCallback);\r\n\r\n        // if there's a parent (PlaneTextureLoader) add texture and source to it\r\n        this._parent && this._addToParent(texture, source, \"canvas\");\r\n    }\r\n\r\n\r\n    /***\r\n     This method loads an array of images by calling loadCanvas() for each one of them\r\n\r\n     params:\r\n     @sources (array of canvas): array of html canvases elements\r\n     @texturesOptions (object): parameters to apply to the textures, such as sampler name, repeat wrapping, filters, anisotropy...\r\n     @successCallback (function): function to execute when each source has been loaded\r\n     ***/\r\n    loadCanvases(\r\n        sources,\r\n        texturesOptions,\r\n        successCallback,\r\n    ) {\r\n        for(let i = 0; i < sources.length; i++) {\r\n            this.loadCanvas(sources[i], texturesOptions, successCallback);\r\n        }\r\n    }\r\n\r\n\r\n    /*** REMOVING EVENT LISTENERS ***/\r\n\r\n    /***\r\n     Cleanly removes a texture source by removing its associated event listeners\r\n\r\n     params:\r\n     @texture (Texture class object): The texture that contains our source\r\n     ***/\r\n    _removeSource(texture) {\r\n        // find our reference el in our els array\r\n        const el = this.elements.find((element) => element.texture.uuid === texture.uuid);\r\n\r\n        // if we have an element, remove its associated event listeners\r\n        if(el) {\r\n            if(texture.sourceType === \"image\") {\r\n                el.source.removeEventListener(\"load\", el.load, false);\r\n            }\r\n            else if(texture.sourceType === \"video\") {\r\n                // cancel video frame callback\r\n                if(el.videoFrameCallback && texture._videoFrameCallbackID) {\r\n                    el.source.cancelVideoFrameCallback(texture._videoFrameCallbackID);\r\n                }\r\n\r\n                el.source.removeEventListener(\"canplaythrough\", el.load, false);\r\n                // empty source to properly delete video element and free the memory\r\n                el.source.pause();\r\n                el.source.removeAttribute(\"src\");\r\n                el.source.load();\r\n            }\r\n\r\n            el.source.removeEventListener(\"error\", el.error, false);\r\n        }\r\n    }\r\n}","import {TextureLoader} from \"./TextureLoader.js\";\r\nimport {throwWarning} from \"../utils/utils.js\";\r\n\r\n/*** PLANE TEXTURE LOADER CLASS ***/\r\n\r\n/***\r\n Extends our TextureLoader class to add sources loaded count, handle onComplete event\r\n Also adds the sources and textures to its defined parent\r\n\r\n params:\r\n @renderer (Curtains renderer or Renderer class object): our curtains object OR our curtains renderer object\r\n @parent (Plane or ShaderPass class object): The plane or shader pass that will use this loader\r\n\r\n @sourcesLoaded (int): Number of sources loaded\r\n @sourcesToLoad (int): Number of initial sources to load\r\n @complete (bool): Whether the loader has loaded all the initial sources\r\n @onComplete (function): Callback to execute when all the initial sources have been loaded\r\n\r\n returns :\r\n @this: our PlaneTextureLoader element\r\n ***/\r\nexport class PlaneTextureLoader extends TextureLoader {\r\n    constructor(renderer, parent, {\r\n        sourcesLoaded = 0,\r\n        sourcesToLoad = 0,\r\n        complete = false,\r\n\r\n        onComplete = () => {},\r\n    } = {}) {\r\n\r\n        super(renderer, parent.crossOrigin);\r\n        this.type = \"PlaneTextureLoader\";\r\n\r\n        this._parent = parent;\r\n        if(this._parent.type !== \"Plane\" && this._parent.type !== \"PingPongPlane\" && this._parent.type !== \"ShaderPass\") {\r\n            throwWarning(this.type + \": Wrong parent type assigned to this loader\");\r\n            this._parent = null;\r\n        }\r\n\r\n        this.sourcesLoaded = sourcesLoaded;\r\n        this.sourcesToLoad = sourcesToLoad;\r\n        this.complete = complete;\r\n\r\n        this.onComplete = onComplete;\r\n    }\r\n\r\n\r\n    /*** TRACK LOADING ***/\r\n\r\n    /***\r\n     Sets the total number of assets to load before firing the onComplete event\r\n\r\n     params:\r\n     @size (int): our curtains object OR our curtains renderer object\r\n     ***/\r\n    _setLoaderSize(size) {\r\n        this.sourcesToLoad = size;\r\n\r\n        if(this.sourcesToLoad === 0) {\r\n            this.complete = true;\r\n            this.renderer.nextRender.add(() => this.onComplete && this.onComplete());\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     Increment the number of sources loaded\r\n     ***/\r\n    _increment() {\r\n        this.sourcesLoaded++;\r\n        if(this.sourcesLoaded >= this.sourcesToLoad && !this.complete) {\r\n            this.complete = true;\r\n            this.renderer.nextRender.add(() => this.onComplete && this.onComplete());\r\n        }\r\n    }\r\n\r\n\r\n    /*** UPDATE PARENT SOURCES AND TEXTURES ARAYS ***/\r\n\r\n    /***\r\n     Adds the source to the correct parent assets array\r\n\r\n     params:\r\n     @source (html element): html image, video or canvas element that has been loaded\r\n     @sourceType (string): either \"image\", \"video\" or \"canvas\"\r\n     ***/\r\n    _addSourceToParent(source, sourceType) {\r\n        // add the source if it is not already in the correct parent assets array\r\n        if(sourceType === \"image\") {\r\n            const parentAssetArray = this._parent[\"images\"];\r\n            const isInParent = parentAssetArray.find((element) => element.src === source.src);\r\n            !isInParent && parentAssetArray.push(source);\r\n        }\r\n        else if(sourceType === \"video\") {\r\n            const parentAssetArray = this._parent[\"videos\"];\r\n            const isInParent = parentAssetArray.find((element) => element.src === source.src);\r\n            !isInParent && parentAssetArray.push(source);\r\n        }\r\n        else if(sourceType === \"canvas\") {\r\n            const parentAssetArray = this._parent[\"canvases\"];\r\n            const isInParent = parentAssetArray.find((element) => element.isSameNode(source));\r\n            !isInParent && parentAssetArray.push(source);\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     Adds the loader parent to the newly created texture\r\n     Also adds the source to the correct parent assets array\r\n\r\n     params:\r\n     @texture (Texture class object): our newly created texture\r\n     @source (html element): html image, video or canvas element that has been loaded\r\n     @sourceType (string): either \"image\", \"video\" or \"canvas\"\r\n     ***/\r\n    _addToParent(texture, source, sourceType) {\r\n        this._addSourceToParent(source, sourceType);\r\n\r\n        // add the texture to the parent\r\n        this._parent && texture.addParent(this._parent);\r\n    }\r\n}","import {Program} from './Program.js';\r\nimport {Geometry} from './Geometry.js';\r\nimport {Texture} from './Texture.js';\r\nimport {PlaneTextureLoader} from '../loaders/PlaneTextureLoader.js';\r\nimport {generateUUID, throwError, throwWarning} from '../utils/utils.js';\r\n\r\n/***\r\n Here we create our Mesh object\r\n We will create an object containing the program that handles shaders and uniforms, a geometry that handles attributes\r\n Also handles anything that relates to textures creation and basic drawing operations\r\n\r\n params:\r\n @renderer (Curtains renderer or Renderer class object): our curtains object OR our curtains renderer object\r\n @type (string): Object type (should be either \"Plane\" or \"ShaderPass\")\r\n\r\n @vertexShaderID (string, optional): the vertex shader script ID. If not specified, will look for a data attribute data-vs-id on the plane HTML element.\r\n @fragmentShaderID (string, optional): the fragment shader script ID. If not specified, will look for a data attribute data-fs-id on the plane HTML element.\r\n @vertexShader (string, optional): the vertex shader as a string. Will look for a vertexShaderID if not specified.\r\n @fragmentShader (string, optional): the fragment shader as a string. Will look for a fragmentShaderID if not specified.\r\n @uniforms (object, optional): the uniforms that will be passed to the shaders.\r\n @widthSegments (int, optional): mesh definition along the X axis (1 by default)\r\n @heightSegments (int, optional): mesh definition along the Y axis (1 by default)\r\n @renderOrder (int, optional): mesh render order in the scene draw stacks (0 by default)\r\n @depthTest (bool, optional): if the mesh should enable or disable the depth test. Default to true.\r\n @cullFace (string, optional): which face of the mesh should be culled. Could either be \"back\", \"front\" or \"none\". Default to \"back\".\r\n @texturesOptions (object, optional): options and parameters to apply to the textures loaded by the mesh's loader. See the Texture class object.\r\n @crossorigin (string, optional): defines the crossOrigin process to load images if any (default to \"anonymous\").\r\n\r\n returns:\r\n @this: our Mesh element\r\n ***/\r\nexport class Mesh {\r\n    constructor(renderer, type = \"Mesh\", {\r\n        // program\r\n        vertexShaderID,\r\n        fragmentShaderID,\r\n        vertexShader,\r\n        fragmentShader,\r\n        uniforms = {},\r\n\r\n        // geometry\r\n        widthSegments = 1,\r\n        heightSegments = 1,\r\n\r\n        // render order\r\n        renderOrder = 0,\r\n\r\n        // drawing\r\n        depthTest = true,\r\n        cullFace = \"back\",\r\n\r\n        // textures\r\n        texturesOptions = {},\r\n        crossOrigin = \"anonymous\"\r\n    } = {}) {\r\n        this.type = type;\r\n\r\n        // we could pass our curtains object OR our curtains renderer object\r\n        renderer = renderer && renderer.renderer || renderer;\r\n\r\n        if(!renderer || renderer.type !== \"Renderer\") {\r\n            throwError(this.type + \": Curtains not passed as first argument or Curtains Renderer is missing\", renderer);\r\n            // no renderer, we can't use the renderer nextRender method\r\n            setTimeout(() => {\r\n                if(this._onErrorCallback) {\r\n                    this._onErrorCallback();\r\n                }\r\n            }, 0);\r\n        }\r\n        this.renderer = renderer;\r\n        this.gl = this.renderer.gl;\r\n\r\n        if(!this.gl) {\r\n            if(!this.renderer.production) throwError(this.type + \": Unable to create a \" + this.type + \" because the Renderer WebGL context is not defined\");\r\n\r\n            // we should assume there's still no renderer here, so no nextRender method\r\n            setTimeout(() => {\r\n                if(this._onErrorCallback) {\r\n                    this._onErrorCallback();\r\n                }\r\n            }, 0);\r\n\r\n            // return if no gl context\r\n            return;\r\n        }\r\n\r\n        this._canDraw = false;\r\n        this.renderOrder = renderOrder;\r\n\r\n        // depth test\r\n        this._depthTest = depthTest;\r\n        // face culling\r\n        this.cullFace = cullFace;\r\n        if(\r\n            this.cullFace !== \"back\"\r\n            && this.cullFace !== \"front\"\r\n            && this.cullFace !== \"none\"\r\n        ) {\r\n            this.cullFace = \"back\";\r\n        }\r\n\r\n        // textures\r\n        this.textures = [];\r\n        // default textures options depends on the type of Mesh and WebGL context\r\n\r\n        this._texturesOptions = Object.assign({\r\n            premultiplyAlpha: false,\r\n            anisotropy: 1,\r\n\r\n            floatingPoint: \"none\", // accepts \"none\", \"half-float\" or \"float\"\r\n\r\n            wrapS: this.gl.CLAMP_TO_EDGE,\r\n            wrapT: this.gl.CLAMP_TO_EDGE,\r\n\r\n            minFilter: this.gl.LINEAR,\r\n            magFilter: this.gl.LINEAR,\r\n        }, texturesOptions);\r\n\r\n        this.crossOrigin = crossOrigin;\r\n\r\n        // handling shaders\r\n        if(!vertexShader && vertexShaderID && document.getElementById(vertexShaderID)) {\r\n            vertexShader = document.getElementById(vertexShaderID).innerHTML;\r\n        }\r\n\r\n        if(!fragmentShader && fragmentShaderID && document.getElementById(fragmentShaderID)) {\r\n            fragmentShader = document.getElementById(fragmentShaderID).innerHTML;\r\n        }\r\n\r\n        // init sizes and loader\r\n        this._initMesh();\r\n\r\n        // geometry\r\n        // set plane attributes\r\n        widthSegments = parseInt(widthSegments);\r\n        heightSegments = parseInt(heightSegments);\r\n        this._geometry = new Geometry(this.renderer, {\r\n            width: widthSegments,\r\n            height: heightSegments,\r\n            // using a special ID for shader passes to avoid weird buffer binding bugs on mac devices\r\n            //id: this.type === \"ShaderPass\" ? 1 : widthSegments * heightSegments + widthSegments\r\n        });\r\n\r\n        this._program = new Program(this.renderer, {\r\n            parent: this,\r\n            vertexShader: vertexShader,\r\n            fragmentShader: fragmentShader,\r\n        });\r\n\r\n        if(this._program.compiled) {\r\n            // create and set program uniforms\r\n            this._program.createUniforms(uniforms);\r\n\r\n            // make uniforms accessible directly\r\n            this.uniforms = this._program.uniformsManager.uniforms;\r\n\r\n            // geometry\r\n            // set plane attributes\r\n            this._geometry.setProgram(this._program);\r\n\r\n            // we've added a new object, keep Curtains class in sync with our renderer\r\n            this.renderer.onSceneChange();\r\n        }\r\n        else {\r\n            this.renderer.nextRender.add(() => this._onErrorCallback && this._onErrorCallback());\r\n        }\r\n    }\r\n\r\n    _initMesh() {\r\n        this.uuid = generateUUID();\r\n\r\n        // our Loader Class that will handle all medias loading process\r\n        this.loader = new PlaneTextureLoader(this.renderer, this, {\r\n            sourcesLoaded: 0,\r\n            initSourcesToLoad: 0, // will change if there's any texture to load on init\r\n            complete: false,\r\n            onComplete: () => {\r\n                this._onReadyCallback && this._onReadyCallback();\r\n\r\n                this.renderer.needRender();\r\n            }\r\n        });\r\n\r\n        this.images = [];\r\n        this.videos = [];\r\n        this.canvases = [];\r\n\r\n\r\n        // allow the user to add custom data to the plane\r\n        this.userData = {};\r\n\r\n        this._canDraw = true;\r\n    }\r\n\r\n\r\n    /*** RESTORING CONTEXT ***/\r\n\r\n    /***\r\n     Used internally to handle context restoration\r\n     ***/\r\n    _restoreContext() {\r\n        this._canDraw = false;\r\n\r\n        if(this._matrices) {\r\n            this._matrices = null;\r\n        }\r\n\r\n        // reset the used program based on our previous shaders code strings\r\n        this._program = new Program(this.renderer, {\r\n            parent: this,\r\n            vertexShader: this._program.vsCode,\r\n            fragmentShader: this._program.fsCode\r\n        });\r\n\r\n        if(this._program.compiled) {\r\n            // reset geometry\r\n            this._geometry.restoreContext(this._program);\r\n\r\n            // create and set program uniforms\r\n            this._program.createUniforms(this.uniforms);\r\n\r\n            // make uniforms accessible directly\r\n            this.uniforms = this._program.uniformsManager.uniforms;\r\n\r\n            // program restored callback of Planes and ShaderPasses\r\n            this._programRestored();\r\n        }\r\n    }\r\n\r\n    /***\r\n     This function adds a render target to a mesh\r\n\r\n     params :\r\n     @renderTarger (RenderTarget): the render target to add to that mesh\r\n     ***/\r\n    setRenderTarget(renderTarget) {\r\n        if(!renderTarget || renderTarget.type !== \"RenderTarget\") {\r\n            if(!this.renderer.production) {\r\n                throwWarning(this.type + \": Could not set the render target because the argument passed is not a RenderTarget class object\", renderTarget);\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        if(this.type === \"Plane\") {\r\n            // remove from scene stacks\r\n            this.renderer.scene.removePlane(this);\r\n        }\r\n\r\n        this.target = renderTarget;\r\n\r\n        if(this.type === \"Plane\") {\r\n            // add to scene stacks again\r\n            this.renderer.scene.addPlane(this);\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     Set the mesh render order to draw it above or behind other meshes\r\n\r\n     params :\r\n     @renderOrder (int): new render order to apply: higher number means a mesh is drawn on top of others\r\n     ***/\r\n    setRenderOrder(renderOrder = 0) {\r\n        renderOrder = isNaN(renderOrder) ? this.renderOrder : parseInt(renderOrder);\r\n\r\n        if(renderOrder !== this.renderOrder) {\r\n            this.renderOrder = renderOrder;\r\n            this.renderer.scene.setPlaneRenderOrder(this);\r\n        }\r\n    }\r\n\r\n\r\n    /*** IMAGES, VIDEOS AND CANVASES LOADING ***/\r\n\r\n    /***\r\n     This method creates a new Texture and adds it to the mesh\r\n\r\n     params :\r\n     @textureOptions (object, optional) : Parameters to apply to that texture (see Texture class). Will be merged with the mesh default textures options\r\n\r\n     returns :\r\n     @texture: our newly created texture\r\n     ***/\r\n    createTexture(textureOptions = {}) {\r\n        // create a new texture with the specified options\r\n        const texture = new Texture(this.renderer, Object.assign(textureOptions, this._texturesOptions));\r\n        // add the texture to the mesh\r\n        texture.addParent(this);\r\n\r\n        return texture;\r\n    }\r\n\r\n\r\n    /***\r\n     Shortcut for addParent() Texture class method\r\n     ***/\r\n    addTexture(texture) {\r\n        if(!texture || texture.type !== \"Texture\") {\r\n            if(!this.renderer.production) {\r\n                throwWarning(this.type + \": cannot add \", texture, \" to this \" + this.type + \" because it is not a valid texture\");\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        texture.addParent(this);\r\n    }\r\n\r\n\r\n    /***\r\n     This method handles the sources loading process\r\n\r\n     params :\r\n     @sourcesArray (array): array of html images, videos or canvases elements\r\n     @texturesOptions (object, optional) : Parameters to apply to those textures (see Texture class). Will be merged with the mesh default textures options\r\n     @successCallback (function): callback to execute on source loading success\r\n     @errorCallback (function): callback to execute on source loading error\r\n     ***/\r\n    loadSources(sourcesArray, texturesOptions = {}, successCallback, errorCallback) {\r\n        for(let i = 0; i < sourcesArray.length; i++) {\r\n            this.loadSource(sourcesArray[i], texturesOptions, successCallback, errorCallback);\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     This method loads one source using our mesh loader (see PlaneTextureLoader class)\r\n\r\n     params :\r\n     @source (html element) : html image, video or canvas element\r\n     @textureOptions (object, optional) : Parameters to apply to that texture (see Texture class). Will be merged with the mesh default textures options\r\n     @successCallback (function): callback to execute on source loading success\r\n     @errorCallback (function): callback to execute on source loading error\r\n     ***/\r\n    loadSource(source, textureOptions = {}, successCallback, errorCallback) {\r\n        this.loader.loadSource(source, Object.assign(textureOptions, this._texturesOptions), (texture) => {\r\n            successCallback && successCallback(texture);\r\n        }, (source, error) => {\r\n            if(!this.renderer.production) {\r\n                throwWarning(this.type + \": this HTML tag could not be converted into a texture:\", source.tagName);\r\n            }\r\n\r\n            errorCallback && errorCallback(source, error);\r\n        });\r\n    }\r\n\r\n\r\n    /***\r\n     This method loads an image using our mesh loader (see PlaneTextureLoader class)\r\n\r\n     params :\r\n     @source (image) : html image element\r\n     @textureOptions (object, optional) : Parameters to apply to that texture (see Texture class). Will be merged with the mesh default textures options\r\n     @successCallback (function): callback to execute on source loading success\r\n     @errorCallback (function): callback to execute on source loading error\r\n     ***/\r\n    loadImage(source, textureOptions = {}, successCallback, errorCallback) {\r\n        this.loader.loadImage(source, Object.assign(textureOptions, this._texturesOptions), (texture) => {\r\n            successCallback && successCallback(texture);\r\n        }, (source, error) => {\r\n            if(!this.renderer.production) {\r\n                throwWarning(this.type + \": There has been an error:\\n\", error, \"\\nwhile loading this image:\\n\", source);\r\n            }\r\n\r\n            errorCallback && errorCallback(source, error);\r\n        });\r\n    }\r\n\r\n\r\n    /***\r\n     This method loads a video using the mesh loader (see PlaneTextureLoader class)\r\n\r\n     params :\r\n     @source (video) : html video element\r\n     @textureOptions (object, optional) : Parameters to apply to that texture (see Texture class). Will be merged with the mesh default textures options\r\n     @successCallback (function): callback to execute on source loading success\r\n     @errorCallback (function): callback to execute on source loading error\r\n     ***/\r\n    loadVideo(source, textureOptions = {}, successCallback, errorCallback) {\r\n        this.loader.loadVideo(source, Object.assign(textureOptions, this._texturesOptions), (texture) => {\r\n            successCallback && successCallback(texture);\r\n        }, (source, error) => {\r\n            if(!this.renderer.production) {\r\n                throwWarning(this.type + \": There has been an error:\\n\", error, \"\\nwhile loading this video:\\n\", source);\r\n            }\r\n\r\n            errorCallback && errorCallback(source, error);\r\n        });\r\n    }\r\n\r\n\r\n    /***\r\n     This method loads a canvas using the mesh loader (see PlaneTextureLoader class)\r\n\r\n     params :\r\n     @source (canvas) : html canvas element\r\n     @textureOptions (object, optional) : Parameters to apply to that texture (see Texture class). Will be merged with the mesh default textures options\r\n     @successCallback (function): callback to execute on source loading success\r\n     ***/\r\n    loadCanvas(source, textureOptions = {}, successCallback) {\r\n        this.loader.loadCanvas(source, Object.assign(textureOptions, this._texturesOptions), (texture) => {\r\n            successCallback && successCallback(texture);\r\n        });\r\n    }\r\n\r\n\r\n    /*** LOAD ARRAYS ***/\r\n\r\n    /***\r\n     Loads an array of images\r\n\r\n     params :\r\n     @imagesArray (array) : array of html image elements\r\n     @texturesOptions (object, optional) : Parameters to apply to those textures (see Texture class). Will be merged with the mesh default textures options\r\n     @successCallback (function): callback to execute on source loading success\r\n     @errorCallback (function): callback to execute on source loading error\r\n     ***/\r\n    loadImages(imagesArray, texturesOptions = {}, successCallback, errorCallback) {\r\n        for(let i = 0; i < imagesArray.length; i++) {\r\n            this.loadImage(imagesArray[i], texturesOptions, successCallback, errorCallback);\r\n        }\r\n    }\r\n\r\n    /***\r\n     Loads an array of videos\r\n\r\n     params :\r\n     @videosArray (array) : array of html video elements\r\n     @texturesOptions (object, optional) : Parameters to apply to those textures (see Texture class). Will be merged with the mesh default textures options\r\n     @successCallback (function): callback to execute on source loading success\r\n     @errorCallback (function): callback to execute on source loading error\r\n     ***/\r\n    loadVideos(videosArray, texturesOptions = {}, successCallback, errorCallback) {\r\n        for(let i = 0; i < videosArray.length; i++) {\r\n            this.loadVideo(videosArray[i], texturesOptions, successCallback, errorCallback);\r\n        }\r\n    }\r\n\r\n    /***\r\n     Loads an array of canvases\r\n\r\n     params :\r\n     @canvasesArray (array) : array of html canvas elements\r\n     @texturesOptions (object, optional) : Parameters to apply to those textures (see Texture class). Will be merged with the mesh default textures options\r\n     @successCallback (function): callback to execute on source loading success\r\n     @errorCallback (function): callback to execute on source loading error\r\n     ***/\r\n    loadCanvases(canvasesArray, texturesOptions = {}, successCallback) {\r\n        for(let i = 0; i < canvasesArray.length; i++) {\r\n            this.loadCanvas(canvasesArray[i], texturesOptions, successCallback);\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     This has to be called in order to play the planes videos\r\n     We need this because on mobile devices we can't start playing a video without a user action\r\n     Once the video has started playing we set an interval and update a new frame to our our texture at a 30FPS rate\r\n     ***/\r\n    playVideos() {\r\n        for (let i = 0; i < this.textures.length; i++) {\r\n            const texture = this.textures[i];\r\n\r\n            if (texture.sourceType === \"video\") {\r\n                const playPromise = texture.source.play();\r\n\r\n                // In browsers that don’t yet support this functionality,\r\n                // playPromise won’t be defined.\r\n                if (playPromise !== undefined) {\r\n                    playPromise.catch((error) => {\r\n                        if (!this.renderer.production) throwWarning(this.type + \": Could not play the video : \", error);\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /*** DRAW THE PLANE ***/\r\n\r\n    /***\r\n     We draw the plane, ie bind the buffers, set the active textures and draw it\r\n     ***/\r\n    _draw() {\r\n        // enable/disable depth test\r\n        this.renderer.setDepthTest(this._depthTest);\r\n\r\n        // face culling\r\n        this.renderer.setFaceCulling(this.cullFace);\r\n\r\n        // update all uniforms set up by the user\r\n        this._program.updateUniforms();\r\n\r\n        // bind plane attributes buffers\r\n        // TODO ideally we should only bind the attributes buffers if the geometry changed\r\n        // however it is leading to some bugs on macOS & iOS and should therefore be tested extensively\r\n        // for now we'll disable this feature even tho it is ready to be used\r\n        //if(this.renderer.state.currentGeometryID !== this._geometry.definition.id || this.renderer.state.forceBufferUpdate) {\r\n        this._geometry.bindBuffers();\r\n        this.renderer.state.forceBufferUpdate = false;\r\n        //}\r\n\r\n        // draw all our plane textures\r\n        for(let i = 0; i < this.textures.length; i++) {\r\n            // draw (bind and maybe update) our texture\r\n            this.textures[i]._draw();\r\n\r\n            // do not draw mesh if one of the active texture is not bound yet\r\n            if(this.textures[i]._sampler.isActive && !this.textures[i]._sampler.isTextureBound) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        // the draw call!\r\n        this._geometry.draw();\r\n\r\n        // reset active texture\r\n        this.renderer.state.activeTexture = null;\r\n\r\n        // callback after draw\r\n        this._onAfterRenderCallback && this._onAfterRenderCallback();\r\n    }\r\n\r\n\r\n    /*** EVENTS ***/\r\n\r\n\r\n    /***\r\n     This is called each time a mesh can't be instanciated\r\n\r\n     params :\r\n     @callback (function) : a function to execute\r\n\r\n     returns :\r\n     @this: our plane to handle chaining\r\n     ***/\r\n    onError(callback) {\r\n        if(callback) {\r\n            this._onErrorCallback = callback;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /***\r\n     This is called each time a mesh's image has been loaded. Useful to handle a loader\r\n\r\n     params :\r\n     @callback (function) : a function to execute\r\n\r\n     returns :\r\n     @this: our plane to handle chaining\r\n     ***/\r\n    onLoading(callback) {\r\n        if(callback) {\r\n            this._onLoadingCallback = callback;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     This is called when a mesh is ready to be drawn\r\n\r\n     params :\r\n     @callback (function) : a function to execute\r\n\r\n     returns :\r\n     @this: our plane to handle chaining\r\n     ***/\r\n    onReady(callback) {\r\n        if(callback) {\r\n            this._onReadyCallback = callback;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     This is called at each requestAnimationFrame call\r\n\r\n     params :\r\n     @callback (function) : a function to execute\r\n\r\n     returns :\r\n     @this: our plane to handle chaining\r\n     ***/\r\n    onRender(callback) {\r\n        if(callback) {\r\n            this._onRenderCallback = callback;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     This is called at each requestAnimationFrame call for each mesh after the draw call\r\n\r\n     params :\r\n     @callback (function) : a function to execute\r\n\r\n     returns :\r\n     @this: our plane to handle chaining\r\n     ***/\r\n    onAfterRender(callback) {\r\n        if(callback) {\r\n            this._onAfterRenderCallback = callback;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /*** DESTROYING ***/\r\n\r\n    /***\r\n     Remove an element by calling the appropriate renderer method\r\n     ***/\r\n    remove() {\r\n        // first we want to stop drawing it\r\n        this._canDraw = false;\r\n\r\n        // force unbinding frame buffer\r\n        if(this.target) {\r\n            this.renderer.bindFrameBuffer(null);\r\n        }\r\n\r\n        // delete all the webgl bindings\r\n        this._dispose();\r\n\r\n        if(this.type === \"Plane\") {\r\n            this.renderer.removePlane(this);\r\n        }\r\n        else if(this.type === \"ShaderPass\") {\r\n            // remove its render target first\r\n            if(this.target) {\r\n                this.target._shaderPass = null;\r\n                this.target.remove();\r\n                this.target = null;\r\n            }\r\n\r\n            this.renderer.removeShaderPass(this);\r\n        }\r\n    }\r\n\r\n    /***\r\n     This deletes all our mesh webgl bindings and its textures\r\n     ***/\r\n    _dispose() {\r\n        if(this.gl) {\r\n            // dispose our geometry\r\n            this._geometry && this._geometry.dispose();\r\n\r\n            if(this.target && this.type === \"ShaderPass\") {\r\n                this.renderer.removeRenderTarget(this.target);\r\n                // remove the first texture since it has been deleted with the render target\r\n                this.textures.shift();\r\n            }\r\n\r\n            // unbind and delete the textures\r\n            for(let i = 0; i < this.textures.length; i++) {\r\n                this.textures[i]._dispose();\r\n            }\r\n            this.textures = [];\r\n        }\r\n    }\r\n}","import {Mesh} from './Mesh.js';\r\nimport {Vec2} from '../math/Vec2.js';\r\nimport {throwWarning} from '../utils/utils.js';\r\n\r\n/***\r\n Here we create our DOMGLObject object\r\n We will extend our Mesh class object by adding HTML sizes helpers (bounding boxes getter/setter and mouse to mesh positioning)\r\n\r\n params:\r\n @renderer (Curtains renderer or Renderer class object): our curtains object OR our curtains renderer object\r\n @plane (html element): the html element that we will use for our DOMMesh object\r\n @type (string): Object type (should be either \"Plane\" or \"ShaderPass\")\r\n @Meshparams (object): see Mesh class object\r\n \r\n returns:\r\n @this: our BasePlane element\r\n ***/\r\n\r\n// avoid reinstancing those during runtime\r\nconst tempVec2a = new Vec2();\r\nconst tempVec2b = new Vec2();\r\n\r\nexport class DOMMesh extends Mesh {\r\n    constructor(renderer, htmlElement, type = \"DOMMesh\", {\r\n        // Mesh params\r\n        widthSegments,\r\n        heightSegments,\r\n        renderOrder,\r\n        depthTest,\r\n        cullFace,\r\n        uniforms,\r\n        vertexShaderID,\r\n        fragmentShaderID,\r\n        vertexShader,\r\n        fragmentShader,\r\n        texturesOptions,\r\n        crossOrigin,\r\n    } = {}) {\r\n        // handling HTML shaders scripts\r\n        vertexShaderID = vertexShaderID || htmlElement && htmlElement.getAttribute(\"data-vs-id\");\r\n        fragmentShaderID = fragmentShaderID || htmlElement && htmlElement.getAttribute(\"data-fs-id\");\r\n\r\n        super(renderer, type, {\r\n            widthSegments,\r\n            heightSegments,\r\n            renderOrder,\r\n            depthTest,\r\n            cullFace,\r\n            uniforms,\r\n            vertexShaderID,\r\n            fragmentShaderID,\r\n            vertexShader,\r\n            fragmentShader,\r\n            texturesOptions,\r\n            crossOrigin,\r\n        });\r\n\r\n        // return if no gl context\r\n        if(!this.gl) {\r\n            return;\r\n        }\r\n\r\n        // our HTML element\r\n        this.htmlElement = htmlElement;\r\n\r\n        if(!this.htmlElement || this.htmlElement.length === 0) {\r\n            if(!this.renderer.production) throwWarning(this.type + \": The HTML element you specified does not currently exists in the DOM\");\r\n        }\r\n\r\n        // set plane sizes\r\n        this._setDocumentSizes();\r\n    }\r\n\r\n\r\n    /*** PLANE SIZES ***/\r\n\r\n    /***\r\n     Set our plane dimensions and positions relative to document\r\n     Triggers reflow!\r\n     ***/\r\n    _setDocumentSizes() {\r\n        // set our basic initial infos\r\n        let planeBoundingRect = this.htmlElement.getBoundingClientRect();\r\n\r\n        if(!this._boundingRect) this._boundingRect = {};\r\n\r\n        // set plane dimensions in document space\r\n        this._boundingRect.document = {\r\n            width: planeBoundingRect.width * this.renderer.pixelRatio,\r\n            height: planeBoundingRect.height * this.renderer.pixelRatio,\r\n            top: planeBoundingRect.top * this.renderer.pixelRatio,\r\n            left: planeBoundingRect.left * this.renderer.pixelRatio,\r\n        };\r\n    };\r\n\r\n\r\n    /*** BOUNDING BOXES GETTERS ***/\r\n\r\n    /***\r\n     Useful to get our plane HTML element bounding rectangle without triggering a reflow/layout\r\n\r\n     returns :\r\n     @boundingRectangle (obj): an object containing our plane HTML element bounding rectangle (width, height, top, bottom, right and left properties)\r\n     ***/\r\n    getBoundingRect() {\r\n        return {\r\n            width: this._boundingRect.document.width,\r\n            height: this._boundingRect.document.height,\r\n            top: this._boundingRect.document.top,\r\n            left: this._boundingRect.document.left,\r\n\r\n            // right = left + width, bottom = top + height\r\n            right: this._boundingRect.document.left + this._boundingRect.document.width,\r\n            bottom: this._boundingRect.document.top + this._boundingRect.document.height,\r\n        };\r\n    }\r\n\r\n\r\n    /***\r\n     Handles each plane resizing\r\n     used internally when our container is resized\r\n     ***/\r\n    resize() {\r\n        // reset plane dimensions\r\n        this._setDocumentSizes();\r\n\r\n        // if this is a Plane object we need to update its perspective and positions\r\n        if(this.type === \"Plane\") {\r\n            // reset perspective\r\n            this.setPerspective(this.camera.fov, this.camera.near, this.camera.far);\r\n\r\n            // apply new position\r\n            this._setWorldSizes();\r\n            this._applyWorldPositions();\r\n        }\r\n\r\n        // resize all textures\r\n        for(let i = 0; i < this.textures.length; i++) {\r\n            this.textures[i].resize();\r\n        }\r\n\r\n        // handle our after resize event\r\n        this.renderer.nextRender.add(() => this._onAfterResizeCallback && this._onAfterResizeCallback());\r\n    }\r\n\r\n\r\n\r\n    /*** INTERACTION ***/\r\n\r\n    /***\r\n     This function takes the mouse position relative to the document and returns it relative to our plane\r\n     It ranges from -1 to 1 on both axis\r\n\r\n     params :\r\n     @mouseCoordinates (Vec2 object): coordinates of the mouse\r\n\r\n     returns :\r\n     @mousePosition (Vec2 object): the mouse position relative to our plane in WebGL space coordinates\r\n     ***/\r\n    mouseToPlaneCoords(mouseCoordinates) {\r\n        // remember our ShaderPass objects don't have a scale property\r\n        const scale = this.scale ? this.scale : tempVec2b.set(1, 1);\r\n\r\n        // we need to adjust our plane document bounding rect to it's webgl scale\r\n        const scaleAdjustment = tempVec2a.set(\r\n            (this._boundingRect.document.width - this._boundingRect.document.width * scale.x) / 2,\r\n            (this._boundingRect.document.height - this._boundingRect.document.height * scale.y) / 2,\r\n        );\r\n\r\n        // also we need to divide by pixel ratio\r\n        const planeBoundingRect = {\r\n            width: (this._boundingRect.document.width * scale.x) / this.renderer.pixelRatio,\r\n            height: (this._boundingRect.document.height * scale.y) / this.renderer.pixelRatio,\r\n            top: (this._boundingRect.document.top + scaleAdjustment.y) / this.renderer.pixelRatio,\r\n            left: (this._boundingRect.document.left + scaleAdjustment.x) / this.renderer.pixelRatio,\r\n        };\r\n\r\n        // mouse position conversion from document to plane space\r\n        return tempVec2a.set(\r\n            (((mouseCoordinates.x - planeBoundingRect.left) / planeBoundingRect.width) * 2) - 1,\r\n            1 - (((mouseCoordinates.y - planeBoundingRect.top) / planeBoundingRect.height) * 2)\r\n        );\r\n    }\r\n\r\n\r\n    /*** EVENTS ***/\r\n\r\n\r\n    /***\r\n     This is called each time a plane has been resized\r\n\r\n     params :\r\n     @callback (function) : a function to execute\r\n\r\n     returns :\r\n     @this: our plane to handle chaining\r\n     ***/\r\n    onAfterResize(callback) {\r\n        if(callback) {\r\n            this._onAfterResizeCallback = callback;\r\n        }\r\n\r\n        return this;\r\n    }\r\n}","import {Vec3} from '../math/Vec3.js';\r\nimport {Mat4} from '../math/Mat4.js';\r\n\r\n\r\n/***\r\n Here we create our Camera object\r\n Creates a perspective camera and its projection matrix (which is used by Plane's class objects)\r\n Uses a dirty _shouldUpdate flag used to determine if we should update the matrix\r\n\r\n params:\r\n @fov (float, optional): the perspective field of view. Should be greater than 0 and lower than 180. Default to 50.\r\n @near (float, optional): near plane, the closest point where a mesh vertex is drawn. Default to 0.1.\r\n @far (float, optional): far plane, farthest point where a mesh vertex is drawn. Default to 150.\r\n @width (float, optional): width used to calculate the camera aspect ratio. Default to the renderer container's width.\r\n @height (float, optional): height used to calculate the camera aspect ratio. Default to the renderer container's height.\r\n @pixelRatio (float, optional): pixel ratio used to calculate the camera aspect ratio. Default to the renderer's pixel ratio.\r\n\r\n returns:\r\n @this: our Mesh element\r\n ***/\r\nexport class Camera {\r\n    constructor({\r\n                    fov = 50,\r\n                    near = 0.1,\r\n                    far = 150,\r\n                    width,\r\n                    height,\r\n                    pixelRatio = 1,\r\n                } = {}) {\r\n\r\n        this.position = new Vec3();\r\n        this.projectionMatrix = new Mat4();\r\n\r\n        this.worldMatrix = new Mat4();\r\n        this.viewMatrix = new Mat4();\r\n\r\n        this._shouldUpdate = false;\r\n\r\n        this.setSize();\r\n        this.setPerspective(fov, near, far, width, height, pixelRatio);\r\n    }\r\n\r\n    /***\r\n     Sets the camera field of view\r\n     Update the camera projection matrix only if the fov actually changed\r\n\r\n     params:\r\n     @fov (float, optional): field of view to use\r\n     ***/\r\n    setFov(fov) {\r\n        fov = isNaN(fov) ? this.fov : parseFloat(fov);\r\n\r\n        // clamp between 1 and 179\r\n        fov = Math.max(1, Math.min(fov, 179));\r\n\r\n        if(fov !== this.fov) {\r\n            this.fov = fov;\r\n            this.setPosition();\r\n\r\n            this._shouldUpdate = true;\r\n        }\r\n\r\n        this.setCSSPerspective();\r\n    }\r\n\r\n\r\n    /***\r\n     Sets the camera near plane value\r\n     Update the camera projection matrix only if the near plane actually changed\r\n\r\n     params:\r\n     @near (float, optional): near plane value to use\r\n     ***/\r\n    setNear(near) {\r\n        near = isNaN(near) ? this.near : parseFloat(near);\r\n        near = Math.max(near, 0.01);\r\n\r\n        if(near !== this.near) {\r\n            this.near = near;\r\n            this._shouldUpdate = true;\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     Sets the camera far plane value\r\n     Update the camera projection matrix only if the far plane actually changed\r\n\r\n     params:\r\n     @far (float, optional): far plane value to use\r\n     ***/\r\n    setFar(far) {\r\n        far = isNaN(far) ? this.far : parseFloat(far);\r\n        far = Math.max(far, 50);\r\n\r\n        if(far !== this.far) {\r\n            this.far = far;\r\n            this._shouldUpdate = true;\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     Sets the camera pixel ratio value\r\n     Update the camera projection matrix only if the pixel ratio actually changed\r\n\r\n     params:\r\n     @pixelRatio (float, optional): pixelRatio value to use\r\n     ***/\r\n    setPixelRatio(pixelRatio) {\r\n        if(pixelRatio !== this.pixelRatio) {\r\n            this._shouldUpdate = true;\r\n        }\r\n\r\n        this.pixelRatio = pixelRatio;\r\n    }\r\n\r\n    /***\r\n     Sets the camera width and height\r\n     Update the camera projection matrix only if the width or height actually changed\r\n\r\n     params:\r\n     @width (float, optional): width value to use\r\n     @height (float, optional): height value to use\r\n     ***/\r\n    setSize(width, height) {\r\n        if(width !== this.width || height !== this.height) {\r\n            this._shouldUpdate = true;\r\n        }\r\n\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n\r\n\r\n    /***\r\n     Sets the camera perspective\r\n     Update the camera projection matrix if our _shouldUpdate flag is true\r\n\r\n     params:\r\n     @fov (float, optional): field of view to use\r\n     @near (float, optional): near plane value to use\r\n     @far (float, optional): far plane value to use\r\n     @width (float, optional): width value to use\r\n     @height (float, optional): height value to use\r\n     @pixelRatio (float, optional): pixelRatio value to use\r\n     ***/\r\n    setPerspective(fov, near, far, width, height, pixelRatio) {\r\n        this.setPixelRatio(pixelRatio);\r\n        this.setSize(width, height);\r\n        this.setFov(fov);\r\n        this.setNear(near);\r\n        this.setFar(far);\r\n\r\n        if(this._shouldUpdate) {\r\n            this.updateProjectionMatrix();\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     Sets the camera position based on its fov\r\n     Used by the Plane class objects to scale the planes with the right amount\r\n     ***/\r\n    setPosition() {\r\n        this.position.set(0, 0, 1);\r\n\r\n        // update matrices\r\n        this.worldMatrix.setFromArray([\r\n            1, 0, 0, 0,\r\n            0, 1, 0, 0,\r\n            0, 0, 1, 0,\r\n            this.position.x, this.position.y, this.position.z, 1\r\n        ]);\r\n\r\n        this.viewMatrix = this.viewMatrix.copy(this.worldMatrix).getInverse();\r\n    }\r\n\r\n    /***\r\n     Sets a CSSPerspective property based on width, height, pixelRatio and fov\r\n     Used to translate planes along the Z axis using pixel units as CSS would do\r\n     Taken from: https://stackoverflow.com/questions/22421439/convert-field-of-view-value-to-css3d-perspective-value\r\n     ***/\r\n    setCSSPerspective() {\r\n        this.CSSPerspective = Math.pow( Math.pow(this.width / (2 * this.pixelRatio), 2) + Math.pow(this.height / (2 * this.pixelRatio) , 2), 0.5 ) / Math.tan((this.fov * 0.5) * Math.PI / 180);\r\n    }\r\n\r\n\r\n    /***\r\n     Returns visible width / height at a given z-depth from our camera parameters\r\n\r\n     Taken from: https://discourse.threejs.org/t/functions-to-calculate-the-visible-width-height-at-a-given-z-depth-from-a-perspective-camera/269\r\n     ***/\r\n    getScreenRatiosFromFov(depth = 0) {\r\n        // compensate for cameras not positioned at z=0\r\n        const cameraOffset = this.position.z;\r\n        if (depth < cameraOffset) {\r\n            depth -= cameraOffset;\r\n        }\r\n        else {\r\n            depth += cameraOffset;\r\n        }\r\n\r\n        // vertical fov in radians\r\n        const vFOV = this.fov * Math.PI / 180;\r\n\r\n        // Math.abs to ensure the result is always positive\r\n        const height = 2 * Math.tan( vFOV / 2 ) * Math.abs(depth);\r\n        return {\r\n            width: height * this.width / this.height,\r\n            height: height,\r\n        };\r\n    }\r\n\r\n    /***\r\n     Updates the camera projection matrix\r\n     ***/\r\n    updateProjectionMatrix() {\r\n        const aspect = this.width / this.height;\r\n\r\n        const top = this.near * Math.tan((Math.PI / 180) * 0.5 * this.fov);\r\n        const height = 2 * top;\r\n        const width = aspect * height;\r\n        const left = -0.5 * width;\r\n\r\n        const right = left + width;\r\n        const bottom = top - height;\r\n\r\n\r\n        const x = 2 * this.near / (right - left);\r\n        const y = 2 * this.near / (top - bottom);\r\n\r\n        const a = (right + left) / (right - left);\r\n        const b = (top + bottom) / (top - bottom);\r\n        const c = -(this.far + this.near) / (this.far - this.near);\r\n        const d = -2 * this.far * this.near / (this.far - this.near);\r\n\r\n        this.projectionMatrix.setFromArray([\r\n            x, 0, 0, 0,\r\n            0, y, 0, 0,\r\n            a, b, c, -1,\r\n            0, 0, d, 0\r\n        ]);\r\n    }\r\n\r\n\r\n    /***\r\n     Force the projection matrix to update (used in Plane class objects context restoration)\r\n     ***/\r\n    forceUpdate() {\r\n        this._shouldUpdate = true;\r\n    }\r\n\r\n\r\n    /***\r\n     Cancel the projection matrix update (used in Plane class objects after the projection matrix has been updated)\r\n     ***/\r\n    cancelUpdate() {\r\n        this._shouldUpdate = false;\r\n    }\r\n}","/***\r\n Here we create a Quat class object\r\n This is a really basic Quaternion class used for rotation calculations\r\n Highly based on https://github.com/mrdoob/three.js/blob/dev/src/math/Quaternion.js\r\n\r\n params :\r\n @elements (Float32Array of length 4): our quaternion array. Default to identity quaternion.\r\n\r\n returns :\r\n @this: our Quat class object\r\n ***/\r\n\r\n// TODO lot of (unused at the time) methods are missing\r\n\r\nexport class Quat {\r\n    constructor(\r\n        elements = new Float32Array([0, 0, 0, 1]),\r\n        axisOrder = \"XYZ\"\r\n    ) {\r\n        this.type = \"Quat\";\r\n        this.elements = elements;\r\n        // rotation axis order\r\n        this.axisOrder = axisOrder;\r\n    }\r\n\r\n    /***\r\n     Sets the quaternion values from an array\r\n\r\n     params:\r\n     @array (array): an array of at least 4 elements\r\n\r\n     returns:\r\n     @this (Quat class object): this quaternion after being set\r\n     ***/\r\n    setFromArray(array) {\r\n        this.elements[0] = array[0];\r\n        this.elements[1] = array[1];\r\n        this.elements[2] = array[2];\r\n        this.elements[3] = array[3];\r\n\r\n        return this;\r\n    }\r\n\r\n    /***\r\n     Sets the quaternion axis order\r\n\r\n     params:\r\n     @axisOrder (string): an array of at least 4 elements\r\n\r\n     returns:\r\n     @this (Quat class object): this quaternion after axis order has been set\r\n     ***/\r\n    setAxisOrder(axisOrder) {\r\n        // force uppercase for strict equality tests\r\n        axisOrder = axisOrder.toUpperCase();\r\n\r\n        switch (axisOrder) {\r\n            case \"XYZ\" :\r\n            case \"YXZ\" :\r\n            case \"ZXY\" :\r\n            case \"ZYX\" :\r\n            case \"YZX\" :\r\n            case \"XZY\" :\r\n                this.axisOrder = axisOrder;\r\n                break;\r\n            default :\r\n                // apply a default axis order\r\n                this.axisOrder = \"XYZ\";\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Copy a quaternion into this quaternion\r\n\r\n     params:\r\n     @vector (Quat): quaternion to copy\r\n\r\n     returns:\r\n     @this (Quat): this quaternion after copy\r\n     ***/\r\n    copy(quaternion) {\r\n        this.elements = quaternion.elements;\r\n        this.axisOrder = quaternion.axisOrder;\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     Clone a quaternion\r\n\r\n     returns:\r\n     @clonedQuaternion (Quat): cloned quaternion\r\n     ***/\r\n    clone() {\r\n        return new Quat().copy(this);\r\n    }\r\n\r\n\r\n    /***\r\n     Checks if 2 quaternions are equal\r\n\r\n     returns:\r\n     @isEqual (bool): whether the quaternions are equals or not\r\n     ***/\r\n    equals(quaternion) {\r\n        return this.elements[0] === quaternion.elements[0]\r\n            && this.elements[1] === quaternion.elements[1]\r\n            && this.elements[2] === quaternion.elements[2]\r\n            && this.elements[3] === quaternion.elements[3]\r\n            && this.axisOrder === quaternion.axisOrder;\r\n    }\r\n\r\n    /***\r\n     Sets a rotation quaternion using Euler angles and its axis order\r\n\r\n     params:\r\n     @vector (Vec3 class object): rotation vector to set our quaternion from\r\n\r\n     returns :\r\n     @this (Quat class object): quaternion after having applied the rotation\r\n     ***/\r\n    setFromVec3(vector) {\r\n        const ax = vector.x * 0.5;\r\n        const ay = vector.y * 0.5;\r\n        const az = vector.z * 0.5;\r\n\r\n        const cosx = Math.cos(ax);\r\n        const cosy = Math.cos(ay);\r\n        const cosz = Math.cos(az);\r\n        const sinx = Math.sin(ax);\r\n        const siny = Math.sin(ay);\r\n        const sinz = Math.sin(az);\r\n\r\n        // XYZ order\r\n        if(this.axisOrder === \"XYZ\") {\r\n            this.elements[0] = sinx * cosy * cosz + cosx * siny * sinz;\r\n            this.elements[1] = cosx * siny * cosz - sinx * cosy * sinz;\r\n            this.elements[2] = cosx * cosy * sinz + sinx * siny * cosz;\r\n            this.elements[3] = cosx * cosy * cosz - sinx * siny * sinz;\r\n        }\r\n        else if(this.axisOrder === \"YXZ\") {\r\n            this.elements[0] = sinx * cosy * cosz + cosx * siny * sinz;\r\n            this.elements[1] = cosx * siny * cosz - sinx * cosy * sinz;\r\n            this.elements[2] = cosx * cosy * sinz - sinx * siny * cosz;\r\n            this.elements[3] = cosx * cosy * cosz + sinx * siny * sinz;\r\n        }\r\n        else if(this.axisOrder === \"ZXY\") {\r\n            this.elements[0] = sinx * cosy * cosz - cosx * siny * sinz;\r\n            this.elements[1] = cosx * siny * cosz + sinx * cosy * sinz;\r\n            this.elements[2] = cosx * cosy * sinz + sinx * siny * cosz;\r\n            this.elements[3] = cosx * cosy * cosz - sinx * siny * sinz;\r\n        }\r\n        else if(this.axisOrder === \"ZYX\") {\r\n            this.elements[0] = sinx * cosy * cosz - cosx * siny * sinz;\r\n            this.elements[1] = cosx * siny * cosz + sinx * cosy * sinz;\r\n            this.elements[2] = cosx * cosy * sinz - sinx * siny * cosz;\r\n            this.elements[3] = cosx * cosy * cosz + sinx * siny * sinz;\r\n        }\r\n        else if(this.axisOrder === \"YZX\") {\r\n            this.elements[0] = sinx * cosy * cosz + cosx * siny * sinz;\r\n            this.elements[1] = cosx * siny * cosz + sinx * cosy * sinz;\r\n            this.elements[2] = cosx * cosy * sinz - sinx * siny * cosz;\r\n            this.elements[3] = cosx * cosy * cosz - sinx * siny * sinz;\r\n        }\r\n        else if(this.axisOrder === \"XZY\") {\r\n            this.elements[0] = sinx * cosy * cosz - cosx * siny * sinz;\r\n            this.elements[1] = cosx * siny * cosz - sinx * cosy * sinz;\r\n            this.elements[2] = cosx * cosy * sinz + sinx * siny * cosz;\r\n            this.elements[3] = cosx * cosy * cosz + sinx * siny * sinz;\r\n        }\r\n\r\n        return this;\r\n    }\r\n}","import {DOMMesh} from \"./DOMMesh.js\";\r\nimport {Camera} from \"../camera/Camera.js\";\r\nimport {Mat4} from '../math/Mat4.js';\r\nimport {Vec2} from '../math/Vec2.js';\r\nimport {Vec3} from '../math/Vec3.js';\r\nimport {Quat} from '../math/Quat.js';\r\nimport {throwWarning} from '../utils/utils.js';\r\n\r\n/***\r\n Here we create our Plane object\r\n We will extend our DOMMesh class that handles all the WebGL part and basic HTML sizings\r\n\r\n Plane class will add:\r\n - sizing and positioning and everything that relates to the DOM like draw checks (frustum culling) and reenter/leave events\r\n - projection (using Camera class object) and view matrices and everything that is related like perspective, scale, rotation...\r\n\r\n params :\r\n @renderer (Curtains renderer or Renderer class object): our curtains object OR our curtains renderer object\r\n @plane (html element): the html element that we will use for our Plane object\r\n\r\n @Meshparams (object): see Mesh class object\r\n\r\n @alwaysDraw (boolean, optionnal): if the plane should always be drawn or if it should use frustum culling. Default to false.\r\n @visible (boolean, optional): if the plane should be drawn or not. Default to true.\r\n @transparent (boolean, optional): if the plane should handle transparency. Default to false.\r\n @drawCheckMargins (object, optional): defines the margins in pixels to add to the frustum culling check to determine if the plane should be drawn. Default to 0.\r\n @autoloadSources (boolean, optional): if the sources should be loaded on init automatically. Default to true\r\n @watchScroll (boolean, optional): if the plane should auto update its position based on the scroll value. Default to true.\r\n @fov (float, optional): defines the perspective field of view used by the camera. Default to 50.\r\n\r\n returns :\r\n @this: our Plane\r\n ***/\r\n\r\n// avoid reinstancing those during runtime\r\nconst tempScale = new Vec2();\r\n\r\n// positions\r\nconst tempWorldPos1 = new Vec3();\r\nconst tempWorldPos2 = new Vec3();\r\n\r\n// frustum culling\r\nconst tempCorner1 = new Vec3();\r\nconst tempCorner2 = new Vec3();\r\nconst tempCorner3 = new Vec3();\r\nconst tempCorner4 = new Vec3();\r\nconst tempCulledCorner1 = new Vec3();\r\nconst tempCulledCorner2 = new Vec3();\r\n\r\n// raycasting\r\nconst identityQuat = new Quat();\r\nconst defaultTransformOrigin = new Vec3(0.5, 0.5, 0);\r\nconst tempRayDirection = new Vec3();\r\nconst tempNormals = new Vec3();\r\nconst tempRotatedOrigin = new Vec3();\r\nconst tempRaycast = new Vec3();\r\nconst castedMouseCoords = new Vec2();\r\n\r\nexport class Plane extends DOMMesh {\r\n    constructor(renderer, htmlElement, {\r\n        // Mesh params\r\n        widthSegments,\r\n        heightSegments,\r\n        renderOrder,\r\n        depthTest,\r\n        cullFace,\r\n        uniforms,\r\n        vertexShaderID,\r\n        fragmentShaderID,\r\n        vertexShader,\r\n        fragmentShader,\r\n        texturesOptions,\r\n        crossOrigin,\r\n\r\n        // Plane specific params\r\n        alwaysDraw = false,\r\n        visible = true,\r\n        transparent = false,\r\n        drawCheckMargins = {\r\n            top: 0,\r\n            right: 0,\r\n            bottom: 0,\r\n            left: 0,\r\n        },\r\n        autoloadSources = true,\r\n        watchScroll = true,\r\n        fov = 50,\r\n    } = {}) {\r\n        super(renderer, htmlElement, \"Plane\", {\r\n            widthSegments,\r\n            heightSegments,\r\n            renderOrder,\r\n            depthTest,\r\n            cullFace,\r\n            uniforms,\r\n            vertexShaderID,\r\n            fragmentShaderID,\r\n            vertexShader,\r\n            fragmentShader,\r\n            texturesOptions,\r\n            crossOrigin,\r\n        });\r\n\r\n        // return if no gl context\r\n        if(!this.gl) {\r\n            return;\r\n        }\r\n\r\n        this.index = this.renderer.planes.length;\r\n\r\n        // used for FBOs\r\n        this.target = null;\r\n\r\n        // use frustum culling or not\r\n        this.alwaysDraw = alwaysDraw;\r\n        // should draw is set to true by default, we'll check it later\r\n        this._shouldDraw = true;\r\n\r\n        this.visible = visible;\r\n\r\n        // if the plane has transparency\r\n        this._transparent = transparent;\r\n\r\n        // draw check margins in pixels\r\n        // positive numbers means it can be displayed even when outside the viewport\r\n        // negative numbers means it can be hidden even when inside the viewport\r\n        this.drawCheckMargins = drawCheckMargins;\r\n\r\n        // if we decide to load all sources on init or let the user do it manually\r\n        this.autoloadSources = autoloadSources;\r\n\r\n        // if we should watch scroll\r\n        this.watchScroll = watchScroll;\r\n\r\n        // define if we should update the plane's matrices when called in the draw loop\r\n        this._updateMVMatrix = false;\r\n\r\n        // init camera\r\n        this.camera = new Camera({\r\n            fov: fov,\r\n            width: this.renderer._boundingRect.width,\r\n            height: this.renderer._boundingRect.height,\r\n            pixelRatio: this.renderer.pixelRatio,\r\n        });\r\n\r\n        // if program is valid, go on\r\n        if(this._program.compiled) {\r\n            // init our plane\r\n            this._initPlane();\r\n\r\n            // add our plane to the scene stack and the renderer array\r\n            this.renderer.scene.addPlane(this);\r\n            this.renderer.planes.push(this);\r\n        }\r\n    }\r\n\r\n\r\n    /*** RESTORING CONTEXT ***/\r\n\r\n    /***\r\n     Used internally to handle context restoration after the program has been successfully compiled again\r\n     ***/\r\n    _programRestored() {\r\n        if(this.target) {\r\n            // reset its render target if needed\r\n            this.setRenderTarget(this.renderer.renderTargets[this.target.index]);\r\n        }\r\n\r\n        this._initMatrices();\r\n\r\n        // set our initial perspective matrix\r\n        this.setPerspective(this.camera.fov, this.camera.near, this.camera.far);\r\n\r\n        this._setWorldSizes();\r\n        this._applyWorldPositions();\r\n\r\n        // add the plane to our draw stack again as it have been emptied\r\n        this.renderer.scene.addPlane(this);\r\n\r\n        // reset textures\r\n        for(let i = 0; i < this.textures.length; i++) {\r\n            this.textures[i]._parent = this;\r\n            this.textures[i]._restoreContext();\r\n        }\r\n\r\n        this._canDraw = true;\r\n    }\r\n\r\n    /***\r\n     Init our basic plane values (transformations, positions, camera, sources)\r\n     ***/\r\n    _initPlane() {\r\n        // init transformation values\r\n        this._initTransformValues();\r\n\r\n        // init its position values\r\n        this._initPositions();\r\n        // set camera values\r\n        this.setPerspective(this.camera.fov, this.camera.near, this.camera.far);\r\n        // load sources\r\n        this._initSources();\r\n    }\r\n\r\n\r\n    /*** TRANSFORMATIONS, PROJECTION & MATRICES ***/\r\n\r\n    /***\r\n     Set/reset plane's transformation values: rotation, scale, translation, transform origin\r\n     ***/\r\n    _initTransformValues() {\r\n        this.rotation = new Vec3();\r\n        this.rotation.onChange(() => this._applyRotation());\r\n\r\n        // initial quaternion\r\n        this.quaternion = new Quat();\r\n\r\n        // translation in viewport coordinates\r\n        this.relativeTranslation = new Vec3();\r\n        this.relativeTranslation.onChange(() => this._setTranslation());\r\n\r\n        // translation in webgl coordinates\r\n        this._translation = new Vec3();\r\n\r\n        // scale is a Vec3 with z always equal to 1\r\n        this.scale = new Vec3(1);\r\n        this.scale.onChange(() => {\r\n            this.scale.z = 1;\r\n            this._applyScale();\r\n        });\r\n\r\n        // set plane transform origin to center\r\n        this.transformOrigin = new Vec3(0.5, 0.5, 0);\r\n        this.transformOrigin.onChange(() => {\r\n            // set transformation origin relative to world space as well\r\n            this._setWorldTransformOrigin();\r\n            this._updateMVMatrix = true;\r\n        });\r\n    }\r\n\r\n\r\n    /***\r\n     Reset our plane transformation values and HTML element if specified (and valid)\r\n\r\n     params :\r\n     @htmlElement (HTML element, optional) : if provided, new HTML element to use as a reference for sizes and position syncing.\r\n     ***/\r\n    resetPlane(htmlElement) {\r\n        this._initTransformValues();\r\n\r\n        // reset transformation origin relative to world space as well\r\n        this._setWorldTransformOrigin();\r\n\r\n        if(htmlElement !== null && !!htmlElement) {\r\n            this.htmlElement = htmlElement;\r\n\r\n            this.resize();\r\n        }\r\n        else if(!htmlElement && !this.renderer.production) {\r\n            throwWarning(this.type + \": You are trying to reset a plane with a HTML element that does not exist. The old HTML element will be kept instead.\");\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     This function removes the plane current render target\r\n     ***/\r\n    removeRenderTarget() {\r\n        if(this.target) {\r\n            // reset our planes stacks\r\n            this.renderer.scene.removePlane(this);\r\n            this.target = null;\r\n            this.renderer.scene.addPlane(this);\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     Init our plane position: set its matrices, its position and perspective\r\n     ***/\r\n    _initPositions() {\r\n        // set its matrices\r\n        this._initMatrices();\r\n\r\n        // apply our css positions\r\n        this._setWorldSizes();\r\n        this._applyWorldPositions();\r\n    }\r\n\r\n\r\n    /***\r\n     Init our plane model view and projection matrices and set their uniform locations\r\n     ***/\r\n    _initMatrices() {\r\n        // create our matrices, they will be set after\r\n        const matrix = new Mat4();\r\n        this._matrices = {\r\n            world: {\r\n                // world matrix (global transformation)\r\n                matrix: matrix,\r\n            },\r\n            modelView: {\r\n                // model view matrix (world matrix multiplied by camera view matrix)\r\n                name: \"uMVMatrix\",\r\n                matrix: matrix,\r\n                location: this.gl.getUniformLocation(this._program.program, \"uMVMatrix\"),\r\n            },\r\n            projection: {\r\n                // camera projection matrix\r\n                name: \"uPMatrix\",\r\n                matrix: matrix,\r\n                location: this.gl.getUniformLocation(this._program.program, \"uPMatrix\"),\r\n            },\r\n            modelViewProjection: {\r\n                // model view projection matrix (model view matrix multiplied by projection)\r\n                matrix: matrix,\r\n            }\r\n        };\r\n    }\r\n\r\n\r\n    /*** PLANES PERSPECTIVES, SCALES AND ROTATIONS ***/\r\n\r\n    /***\r\n     This will set our perspective matrix and update our perspective matrix uniform\r\n     used internally at each draw call if needed\r\n     ***/\r\n    _setPerspectiveMatrix() {\r\n        // update our matrix uniform if we actually have updated its values\r\n        if(this.camera._shouldUpdate) {\r\n            this.renderer.useProgram(this._program);\r\n            this.gl.uniformMatrix4fv(this._matrices.projection.location, false, this._matrices.projection.matrix.elements);\r\n        }\r\n\r\n        // reset camera shouldUpdate flag\r\n        this.camera.cancelUpdate();\r\n    }\r\n\r\n\r\n    /***\r\n     This will set our perspective matrix new parameters (fov, near plane and far plane)\r\n     used internally but can be used externally as well to change fov for example\r\n\r\n     params :\r\n     @fov (float): the field of view\r\n     @near (float): the nearest point where object are displayed\r\n     @far (float): the farthest point where object are displayed\r\n     ***/\r\n    setPerspective(fov, near, far) {\r\n        this.camera.setPerspective(fov, near, far, this.renderer._boundingRect.width, this.renderer._boundingRect.height, this.renderer.pixelRatio);\r\n\r\n        // force camera update on context restoration\r\n        if(this.renderer.state.isContextLost) {\r\n            this.camera.forceUpdate();\r\n        }\r\n\r\n        this._matrices.projection.matrix = this.camera.projectionMatrix;\r\n\r\n        if(this.camera._shouldUpdate) {\r\n            // we changed the fov, update world sizes and world positions\r\n            this._setWorldSizes();\r\n            this._applyWorldPositions();\r\n\r\n            // translation along the Z axis is dependant of camera CSSPerspective\r\n            // we're computing it here because it changes when the fov changes\r\n            this._translation.z = this.relativeTranslation.z / this.camera.CSSPerspective;\r\n        }\r\n\r\n        // if camera settings changed update the mvMatrix as well cause we need to update z translation based on new fov\r\n        this._updateMVMatrix = this.camera._shouldUpdate;\r\n    }\r\n\r\n\r\n    /***\r\n     This will set our model view matrix\r\n     used internally at each draw call if needed\r\n     It will calculate our matrix based on its plane translation, rotation and scale\r\n     ***/\r\n    _setMVMatrix() {\r\n        if(this._updateMVMatrix) {\r\n            // compose our world transformation matrix from custom origin\r\n            this._matrices.world.matrix = this._matrices.world.matrix.composeFromOrigin(this._translation, this.quaternion, this.scale, this._boundingRect.world.transformOrigin);\r\n\r\n            // we need to scale our planes, from a square to a right sized rectangle\r\n            // we're doing this after our transformation matrix because this scale transformation always have the same origin\r\n            this._matrices.world.matrix.scale({\r\n                x: this._boundingRect.world.width,\r\n                y: this._boundingRect.world.height,\r\n                z: 1\r\n            });\r\n\r\n\r\n            // our model view matrix is our world matrix multiplied with our camera view matrix\r\n            // in our case we're just subtracting the camera Z position to our world matrix\r\n            this._matrices.modelView.matrix.copy(this._matrices.world.matrix);\r\n            this._matrices.modelView.matrix.elements[14] -= this.camera.position.z;\r\n\r\n            // our modelViewProjection matrix, useful for bounding box calculations and frustum culling\r\n            // this is the result of our projection matrix multiplied by our modelView matrix\r\n            this._matrices.modelViewProjection.matrix = this._matrices.projection.matrix.multiply(this._matrices.modelView.matrix);\r\n\r\n            // check if we should draw the plane but only if everything has been initialized\r\n            if(!this.alwaysDraw) {\r\n                this._shouldDrawCheck();\r\n            }\r\n\r\n            // update our matrix uniform\r\n            this.renderer.useProgram(this._program);\r\n            this.gl.uniformMatrix4fv(this._matrices.modelView.location, false, this._matrices.modelView.matrix.elements);\r\n        }\r\n\r\n        // reset our flag\r\n        this._updateMVMatrix = false;\r\n    }\r\n\r\n\r\n    /*** SCREEN TO WORLD CALCS ***/\r\n\r\n    /***\r\n     Convert our transform origin point from plane space to world space\r\n     ***/\r\n    _setWorldTransformOrigin() {\r\n        // set transformation origin relative to world space as well\r\n        this._boundingRect.world.transformOrigin = new Vec3(\r\n            (this.transformOrigin.x * 2 - 1) // between -1 and 1\r\n            * this._boundingRect.world.width,\r\n            -(this.transformOrigin.y * 2 - 1) // between -1 and 1\r\n            * this._boundingRect.world.height,\r\n            this.transformOrigin.z\r\n        );\r\n    }\r\n\r\n\r\n    /***\r\n     This function takes pixel values along X and Y axis and convert them to world space coordinates\r\n\r\n     params :\r\n     @vector (Vec3): position to convert on X, Y and Z axes\r\n\r\n     returns :\r\n     @worldPosition: plane's position in WebGL space\r\n     ***/\r\n    _documentToWorldSpace(vector) {\r\n        return tempWorldPos2.set(\r\n            (vector.x * this.renderer.pixelRatio / this.renderer._boundingRect.width) * this._boundingRect.world.ratios.width,\r\n            -(vector.y * this.renderer.pixelRatio / this.renderer._boundingRect.height) * this._boundingRect.world.ratios.height,\r\n            vector.z,\r\n        );\r\n    }\r\n\r\n    /***\r\n     Set our plane dimensions relative to clip spaces\r\n     ***/\r\n    _setWorldSizes() {\r\n        const ratios = this.camera.getScreenRatiosFromFov();\r\n\r\n        // our plane world informations\r\n        // since our vertices values range from -1 to 1, it is supposed to draw a square\r\n        // we need to scale them under the hood relatively to our canvas\r\n        // to display an accurately sized plane\r\n        this._boundingRect.world = {\r\n            width: (this._boundingRect.document.width / this.renderer._boundingRect.width) * ratios.width / 2,\r\n            height: (this._boundingRect.document.height / this.renderer._boundingRect.height) * ratios.height / 2,\r\n            ratios\r\n        };\r\n\r\n        // set transformation origin relative to world space as well\r\n        this._setWorldTransformOrigin();\r\n    }\r\n\r\n\r\n    /***\r\n     Set our plane position relative to clip spaces\r\n     ***/\r\n    _setWorldPosition() {\r\n        // dimensions and positions of our plane in the document and clip spaces\r\n        // don't forget translations in webgl space are referring to the center of our plane and canvas\r\n        const planeCenter = {\r\n            x: (this._boundingRect.document.width / 2) + this._boundingRect.document.left,\r\n            y: (this._boundingRect.document.height / 2) + this._boundingRect.document.top,\r\n        };\r\n\r\n        const containerCenter = {\r\n            x: (this.renderer._boundingRect.width / 2) + this.renderer._boundingRect.left,\r\n            y: (this.renderer._boundingRect.height / 2) + this.renderer._boundingRect.top,\r\n        };\r\n\r\n        this._boundingRect.world.top = ((containerCenter.y - planeCenter.y) / this.renderer._boundingRect.height) * this._boundingRect.world.ratios.height;\r\n        this._boundingRect.world.left = ((planeCenter.x - containerCenter.x) / this.renderer._boundingRect.width) * this._boundingRect.world.ratios.width;\r\n    }\r\n\r\n\r\n    /*** TRANSFORMATIONS ***/\r\n\r\n    /***\r\n     This will set our plane scale\r\n     used internally but can be used externally as well\r\n\r\n     params :\r\n     @scale (Vec2 object): scale to apply on X and Y axes\r\n     ***/\r\n    setScale(scale) {\r\n        if(!scale.type || scale.type !== \"Vec2\") {\r\n            if(!this.renderer.production) {\r\n                throwWarning(this.type + \": Cannot set scale because the parameter passed is not of Vec2 type:\", scale);\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        scale.sanitizeNaNValuesWith(this.scale).max(tempScale.set(0.001, 0.001));\r\n\r\n        // only apply if values changed\r\n        if(scale.x !== this.scale.x || scale.y !== this.scale.y) {\r\n            this.scale.set(scale.x, scale.y, 1);\r\n\r\n            this._applyScale();\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     This will apply our scale and tells our model view matrix to update\r\n     ***/\r\n    _applyScale() {\r\n        // adjust textures size\r\n        for(let i = 0; i < this.textures.length; i++) {\r\n            this.textures[i].resize();\r\n        }\r\n\r\n        // we should update the plane mvMatrix\r\n        this._updateMVMatrix = true;\r\n    }\r\n\r\n\r\n    /***\r\n     This will set our plane rotation\r\n     used internally but can be used externally as well\r\n\r\n     params :\r\n     @rotation (Vec3 object): rotation to apply on X, Y and Z axes (in radians)\r\n     ***/\r\n    setRotation(rotation) {\r\n        if(!rotation.type || rotation.type !== \"Vec3\") {\r\n            if(!this.renderer.production) {\r\n                throwWarning(this.type + \": Cannot set rotation because the parameter passed is not of Vec3 type:\", rotation);\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        rotation.sanitizeNaNValuesWith(this.rotation);\r\n\r\n        // only apply if values changed\r\n        if(!rotation.equals(this.rotation)) {\r\n            this.rotation.copy(rotation);\r\n\r\n            this._applyRotation();\r\n        }\r\n    }\r\n\r\n    /***\r\n     This will apply our rotation and tells our model view matrix to update\r\n     ***/\r\n    _applyRotation() {\r\n        this.quaternion.setFromVec3(this.rotation);\r\n        // we should update the plane mvMatrix\r\n        this._updateMVMatrix = true;\r\n    }\r\n\r\n\r\n    /***\r\n     This will set our plane transform origin\r\n     (0, 0, 0) means plane's top left corner\r\n     (1, 1, 0) means plane's bottom right corner\r\n     (0.5, 0.5, -1) means behind plane's center\r\n\r\n     params :\r\n     @origin (Vec3 object): coordinate of transformation origin X, Y and Z axes\r\n     ***/\r\n    setTransformOrigin(origin) {\r\n        if(!origin.type || origin.type !== \"Vec3\") {\r\n            if(!this.renderer.production) {\r\n                throwWarning(this.type + \": Cannot set transform origin because the parameter passed is not of Vec3 type:\", origin);\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        origin.sanitizeNaNValuesWith(this.transformOrigin);\r\n\r\n        if(!origin.equals(this.transformOrigin)) {\r\n            this.transformOrigin.copy(origin);\r\n\r\n            // set transformation origin relative to world space as well\r\n            this._setWorldTransformOrigin();\r\n\r\n            this._updateMVMatrix = true;\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     This will set our plane translation by adding plane computed bounding box values and computed relative position values\r\n     ***/\r\n    _setTranslation() {\r\n        // avoid unnecessary calculations if we don't have a users set relative position\r\n        let worldPosition = tempWorldPos1.set(0, 0, 0);\r\n        if(!this.relativeTranslation.equals(worldPosition)) {\r\n            worldPosition = this._documentToWorldSpace(this.relativeTranslation);\r\n        }\r\n\r\n        this._translation.set(\r\n            this._boundingRect.world.left + worldPosition.x,\r\n            this._boundingRect.world.top + worldPosition.y,\r\n            //this._translation.z,\r\n            this.relativeTranslation.z / this.camera.CSSPerspective\r\n        );\r\n\r\n        // we should update the plane mvMatrix\r\n        this._updateMVMatrix = true;\r\n    }\r\n\r\n\r\n    /***\r\n     This function takes pixel values along X and Y axis and convert them to clip space coordinates, and then apply the corresponding translation\r\n\r\n     params :\r\n     @translation (Vec3): translation to apply on X, Y and Z axes\r\n     ***/\r\n    setRelativeTranslation(translation) {\r\n        if(!translation.type || translation.type !== \"Vec3\") {\r\n            if(!this.renderer.production) {\r\n                throwWarning(this.type + \": Cannot set translation because the parameter passed is not of Vec3 type:\", translation);\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        translation.sanitizeNaNValuesWith(this.relativeTranslation);\r\n\r\n        // only apply if values changed\r\n        if(!translation.equals(this.relativeTranslation)) {\r\n            this.relativeTranslation.copy(translation);\r\n\r\n            this._setTranslation();\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     This function uses our plane HTML Element bounding rectangle values and convert them to the world clip space coordinates, and then apply the corresponding translation\r\n     ***/\r\n    _applyWorldPositions() {\r\n        // set our plane sizes and positions relative to the world clipspace\r\n        this._setWorldPosition();\r\n\r\n        // set the translation values\r\n        this._setTranslation();\r\n    }\r\n\r\n\r\n    /***\r\n     This function updates the plane position based on its CSS positions and transformations values.\r\n     Useful if the HTML element has been moved while the container size has not changed.\r\n     ***/\r\n    updatePosition() {\r\n        // set the new plane sizes and positions relative to document by triggering getBoundingClientRect()\r\n        this._setDocumentSizes();\r\n\r\n        // apply them\r\n        this._applyWorldPositions();\r\n    }\r\n\r\n\r\n    /***\r\n     This function updates the plane position based on the Curtains class scroll manager values\r\n\r\n     params:\r\n     @lastXDelta (float): last scroll value along X axis\r\n     @lastYDelta (float): last scroll value along Y axis\r\n     ***/\r\n    updateScrollPosition(lastXDelta, lastYDelta) {\r\n        // actually update the plane position only if last X delta or last Y delta is not equal to 0\r\n        if(lastXDelta || lastYDelta) {\r\n            // set new positions based on our delta without triggering reflow\r\n            this._boundingRect.document.top += lastYDelta * this.renderer.pixelRatio;\r\n            this._boundingRect.document.left += lastXDelta * this.renderer.pixelRatio;\r\n\r\n            // apply them\r\n            this._applyWorldPositions();\r\n        }\r\n    }\r\n\r\n\r\n    /*** FRUSTUM CULLING (DRAW CHECK) ***/\r\n\r\n\r\n    /***\r\n     Find the intersection point by adding a vector starting from a corner till we reach the near plane\r\n\r\n     params:\r\n     @refPoint (Vec3 class object): corner of the plane from which we start to iterate from\r\n     @secondPoint (Vec3 class object): second point near the refPoint to get a direction to use for iteration\r\n\r\n     returns:\r\n     @intersection (Vec3 class object): intersection between our plane and the camera near plane\r\n     ***/\r\n    _getIntersection(refPoint, secondPoint) {\r\n        // direction vector to add\r\n        let direction = secondPoint.clone().sub(refPoint);\r\n\r\n        // copy our corner refpoint\r\n        let intersection = refPoint.clone();\r\n        // iterate till we reach near plane\r\n        while(intersection.z > -1) {\r\n            intersection.add(direction);\r\n        }\r\n\r\n        return intersection;\r\n    }\r\n\r\n    /***\r\n     Get intersection points between a plane and the camera near plane\r\n     When a plane gets clipped by the camera near plane, the clipped corner projected coords returned by _applyMat4() are erronate\r\n     We need to find the intersection points using another approach\r\n     Here I chose to use non clipped corners projected coords and a really small vector parallel to the plane's side\r\n     We're adding that vector again and again to our corner projected coords until the Z coordinate matches the near plane: we got our intersection\r\n\r\n     params:\r\n     @corners (array): our original corners vertices coordinates\r\n     @mvpCorners (array): the projected corners of our plane\r\n     @clippedCorners (array): index of the corners that are clipped\r\n\r\n     returns:\r\n     @mvpCorners (array): the corrected projected corners of our plane\r\n     ***/\r\n    _getNearPlaneIntersections(corners, mvpCorners, clippedCorners) {\r\n        // rebuild the clipped corners based on non clipped ones\r\n        const mVPMatrix = this._matrices.modelViewProjection.matrix;\r\n\r\n        if(clippedCorners.length === 1) {\r\n            // we will have 5 corners to check so we'll need to push a new entry in our mvpCorners array\r\n            if(clippedCorners[0] === 0) {\r\n                // top left is culled\r\n                // get intersection iterating from top right\r\n                mvpCorners[0] = this._getIntersection(mvpCorners[1], tempCulledCorner1.set(0.95, 1, 0).applyMat4(mVPMatrix));\r\n\r\n                // get intersection iterating from bottom left\r\n                mvpCorners.push(this._getIntersection(mvpCorners[3], tempCulledCorner2.set(-1, -0.95, 0).applyMat4(mVPMatrix)));\r\n            }\r\n            else if(clippedCorners[0] === 1) {\r\n                // top right is culled\r\n                // get intersection iterating from top left\r\n                mvpCorners[1] = this._getIntersection(mvpCorners[0], tempCulledCorner1.set(-0.95, 1, 0).applyMat4(mVPMatrix));\r\n\r\n                // get intersection iterating from bottom right\r\n                mvpCorners.push(this._getIntersection(mvpCorners[2], tempCulledCorner2.set(1, -0.95, 0).applyMat4(mVPMatrix)));\r\n            }\r\n            else if(clippedCorners[0] === 2) {\r\n                // bottom right is culled\r\n                // get intersection iterating from bottom left\r\n                mvpCorners[2] = this._getIntersection(mvpCorners[3], tempCulledCorner1.set(-0.95, -1, 0).applyMat4(mVPMatrix));\r\n\r\n                // get intersection iterating from top right\r\n                mvpCorners.push(this._getIntersection(mvpCorners[1], tempCulledCorner2.set(1, 0.95, 0).applyMat4(mVPMatrix)));\r\n            }\r\n            else if(clippedCorners[0] === 3) {\r\n                // bottom left is culled\r\n                // get intersection iterating from bottom right\r\n                mvpCorners[3] = this._getIntersection(mvpCorners[2], tempCulledCorner1.set(0.95, -1, 0).applyMat4(mVPMatrix));\r\n\r\n                // get intersection iterating from top left\r\n                mvpCorners.push(this._getIntersection(mvpCorners[0], tempCulledCorner2.set( -1, 0.95, 0).applyMat4(mVPMatrix)));\r\n            }\r\n        }\r\n        else if(clippedCorners.length === 2) {\r\n            if(clippedCorners[0] === 0 && clippedCorners[1] === 1) {\r\n                // top part of the plane is culled by near plane\r\n                // find intersection using bottom corners\r\n                mvpCorners[0] = this._getIntersection(mvpCorners[3], tempCulledCorner1.set(-1, -0.95, 0).applyMat4(mVPMatrix));\r\n                mvpCorners[1] = this._getIntersection(mvpCorners[2], tempCulledCorner2.set( 1, -0.95, 0).applyMat4(mVPMatrix));\r\n            }\r\n            else if(clippedCorners[0] === 1 && clippedCorners[1] === 2) {\r\n                // right part of the plane is culled by near plane\r\n                // find intersection using left corners\r\n                mvpCorners[1] = this._getIntersection(mvpCorners[0], tempCulledCorner1.set(-0.95, 1, 0).applyMat4(mVPMatrix));\r\n                mvpCorners[2] = this._getIntersection(mvpCorners[3], tempCulledCorner2.set(-0.95, -1, 0).applyMat4(mVPMatrix));\r\n            }\r\n            else if(clippedCorners[0] === 2 && clippedCorners[1] === 3) {\r\n                // bottom part of the plane is culled by near plane\r\n                // find intersection using top corners\r\n                mvpCorners[2] = this._getIntersection(mvpCorners[1], tempCulledCorner1.set(1, 0.95, 0).applyMat4(mVPMatrix));\r\n                mvpCorners[3] = this._getIntersection(mvpCorners[0], tempCulledCorner2.set(-1, 0.95, 0).applyMat4(mVPMatrix));\r\n            }\r\n            else if(clippedCorners[0] === 0 && clippedCorners[1] === 3) {\r\n                // left part of the plane is culled by near plane\r\n                // find intersection using right corners\r\n                mvpCorners[0] = this._getIntersection(mvpCorners[1], tempCulledCorner1.set(0.95, 1, 0).applyMat4(mVPMatrix));\r\n                mvpCorners[3] = this._getIntersection(mvpCorners[2], tempCulledCorner2.set(0.95, -1, 0).applyMat4(mVPMatrix));\r\n            }\r\n        }\r\n        else if(clippedCorners.length === 3) {\r\n            // get the corner that is not clipped\r\n            let nonClippedCorner = 0;\r\n            for(let i = 0; i < corners.length; i++) {\r\n                if(!clippedCorners.includes(i)) {\r\n                    nonClippedCorner = i;\r\n                }\r\n            }\r\n\r\n            // we will have just 3 corners so reset our mvpCorners array with just the visible corner\r\n            mvpCorners = [\r\n                mvpCorners[nonClippedCorner]\r\n            ];\r\n            if(nonClippedCorner === 0) {\r\n                // from top left corner to right\r\n                mvpCorners.push(this._getIntersection(mvpCorners[0], tempCulledCorner1.set(-0.95, 1, 0).applyMat4(mVPMatrix)));\r\n                // from top left corner to bottom\r\n                mvpCorners.push(this._getIntersection(mvpCorners[0], tempCulledCorner2.set(-1, 0.95, 0).applyMat4(mVPMatrix)));\r\n            }\r\n            else if(nonClippedCorner === 1) {\r\n                // from top right corner to left\r\n                mvpCorners.push(this._getIntersection(mvpCorners[0], tempCulledCorner1.set(0.95, 1, 0).applyMat4(mVPMatrix)));\r\n                // from top right corner to bottom\r\n                mvpCorners.push(this._getIntersection(mvpCorners[0], tempCulledCorner2.set(1, 0.95, 0).applyMat4(mVPMatrix)));\r\n            }\r\n            else if(nonClippedCorner === 2) {\r\n                // from bottom right corner to left\r\n                mvpCorners.push(this._getIntersection(mvpCorners[0], tempCulledCorner1.set(0.95, -1, 0).applyMat4(mVPMatrix)));\r\n                // from bottom right corner to top\r\n                mvpCorners.push(this._getIntersection(mvpCorners[0], tempCulledCorner2.set(1,-0.95, 0).applyMat4(mVPMatrix)));\r\n            }\r\n            else if(nonClippedCorner === 3) {\r\n                // from bottom left corner to right\r\n                mvpCorners.push(this._getIntersection(mvpCorners[0], tempCulledCorner1.set(-0.95, -1, 0).applyMat4(mVPMatrix)));\r\n                // from bottom left corner to top\r\n                mvpCorners.push(this._getIntersection(mvpCorners[0], tempCulledCorner2.set(-1 -0.95, 0).applyMat4(mVPMatrix)));\r\n            }\r\n        }\r\n        else {\r\n            // all 4 corners are culled! artificially apply wrong coords to force plane culling\r\n            for(let i = 0; i < corners.length; i++) {\r\n                mvpCorners[i][0] = 10000;\r\n                mvpCorners[i][1] = 10000;\r\n            }\r\n        }\r\n\r\n        return mvpCorners;\r\n    };\r\n\r\n\r\n    /***\r\n     Useful to get our WebGL plane bounding box in the world space\r\n     Takes all transformations into account\r\n     Used internally for frustum culling\r\n\r\n     returns :\r\n     @boundingRectangle (obj): an object containing our plane WebGL element 4 corners coordinates: top left corner is [-1, 1] and bottom right corner is [1, -1]\r\n     ***/\r\n    _getWorldCoords() {\r\n        const corners = [\r\n            tempCorner1.set(-1, 1, 0), // plane's top left corner\r\n            tempCorner2.set(1, 1, 0), // plane's top right corner\r\n            tempCorner3.set(1, -1, 0), // plane's bottom right corner\r\n            tempCorner4.set(-1, -1, 0), // plane's bottom left corner\r\n        ];\r\n\r\n        // corners with model view projection matrix applied\r\n        let mvpCorners = [];\r\n        // eventual clipped corners\r\n        let clippedCorners = [];\r\n\r\n        // we are going to get our plane's four corners relative to our model view projection matrix\r\n        for(let i = 0; i < corners.length; i++) {\r\n            const mvpCorner = corners[i].applyMat4(this._matrices.modelViewProjection.matrix);\r\n            mvpCorners.push(mvpCorner);\r\n\r\n            // Z position is > 1 or < -1 means the corner is clipped\r\n            if(Math.abs(mvpCorner.z) > 1) {\r\n                clippedCorners.push(i);\r\n            }\r\n        }\r\n\r\n        // near plane is clipping, get intersections between plane and near plane\r\n        if(clippedCorners.length) {\r\n            mvpCorners = this._getNearPlaneIntersections(corners, mvpCorners, clippedCorners);\r\n        }\r\n\r\n        // we need to check for the X and Y min and max values\r\n        // use arbitrary integers that will be overriden anyway\r\n        let minX = Infinity;\r\n        let maxX = -Infinity;\r\n\r\n        let minY = Infinity;\r\n        let maxY = -Infinity;\r\n\r\n        for(let i = 0; i < mvpCorners.length; i++) {\r\n            const corner = mvpCorners[i];\r\n\r\n            if(corner.x < minX) {\r\n                minX = corner.x;\r\n            }\r\n            if(corner.x > maxX) {\r\n                maxX = corner.x;\r\n            }\r\n\r\n            if(corner.y < minY) {\r\n                minY = corner.y;\r\n            }\r\n            if(corner.y > maxY) {\r\n                maxY = corner.y;\r\n            }\r\n        }\r\n\r\n        return {\r\n            top: maxY,\r\n            right: maxX,\r\n            bottom: minY,\r\n            left: minX,\r\n        };\r\n    };\r\n\r\n\r\n    /***\r\n     Transpose our plane corners coordinates from world space to document space\r\n     Sets an object with the accurate plane WebGL bounding rect relative to document\r\n     ***/\r\n    _computeWebGLBoundingRect() {\r\n        // get our world space bouding rect\r\n        const worldBBox = this._getWorldCoords();\r\n\r\n        // normalize worldBBox to (0 -> 1) screen coordinates with [0, 0] being the top left corner and [1, 1] being the bottom right\r\n        let screenBBox = {\r\n            top: 1 - (worldBBox.top + 1) / 2,\r\n            right: (worldBBox.right + 1) / 2,\r\n            bottom: 1 - (worldBBox.bottom + 1) / 2,\r\n            left: (worldBBox.left + 1) / 2,\r\n        };\r\n\r\n        screenBBox.width = screenBBox.right - screenBBox.left;\r\n        screenBBox.height = screenBBox.bottom - screenBBox.top;\r\n\r\n        // return our values ranging from 0 to 1 multiplied by our canvas sizes + canvas top and left offsets\r\n        this._boundingRect.worldToDocument = {\r\n            width: screenBBox.width * this.renderer._boundingRect.width,\r\n            height: screenBBox.height * this.renderer._boundingRect.height,\r\n            top: screenBBox.top * this.renderer._boundingRect.height + this.renderer._boundingRect.top,\r\n            left: screenBBox.left * this.renderer._boundingRect.width + this.renderer._boundingRect.left,\r\n\r\n            // add left and width to get right property\r\n            right: screenBBox.left * this.renderer._boundingRect.width + this.renderer._boundingRect.left + screenBBox.width * this.renderer._boundingRect.width,\r\n            // add top and height to get bottom property\r\n            bottom: screenBBox.top * this.renderer._boundingRect.height + this.renderer._boundingRect.top + screenBBox.height * this.renderer._boundingRect.height,\r\n        };\r\n    }\r\n\r\n\r\n    /***\r\n     Returns our plane WebGL bounding rect relative to document\r\n\r\n     returns :\r\n     @boundingRectangle (obj): an object containing our plane WebGL element bounding rectangle (width, height, top, bottom, right and left properties)\r\n     ***/\r\n    getWebGLBoundingRect() {\r\n        if(!this._matrices.modelViewProjection) {\r\n            return this._boundingRect.document;\r\n        }\r\n        else if(!this._boundingRect.worldToDocument || this.alwaysDraw) {\r\n            this._computeWebGLBoundingRect();\r\n        }\r\n\r\n        return this._boundingRect.worldToDocument;\r\n    }\r\n\r\n\r\n    /***\r\n     Returns our plane WebGL bounding rectangle in document coordinates including additional drawCheckMargins\r\n\r\n     returns :\r\n     @boundingRectangle (obj): an object containing our plane WebGL element bounding rectangle including the draw check margins (top, bottom, right and left properties)\r\n     ***/\r\n    _getWebGLDrawRect() {\r\n        this._computeWebGLBoundingRect();\r\n\r\n        return {\r\n            top: this._boundingRect.worldToDocument.top - this.drawCheckMargins.top,\r\n            right: this._boundingRect.worldToDocument.right + this.drawCheckMargins.right,\r\n            bottom: this._boundingRect.worldToDocument.bottom + this.drawCheckMargins.bottom,\r\n            left: this._boundingRect.worldToDocument.left - this.drawCheckMargins.left,\r\n        };\r\n    }\r\n\r\n\r\n    /***\r\n     This function checks if the plane is currently visible in the canvas and sets _shouldDraw property according to this test\r\n     This is our real frustum culling check\r\n     ***/\r\n    _shouldDrawCheck() {\r\n        // get plane bounding rect\r\n        const actualPlaneBounds = this._getWebGLDrawRect();\r\n\r\n        // if we decide to draw the plane only when visible inside the canvas\r\n        // we got to check if its actually inside the canvas\r\n        if(\r\n            Math.round(actualPlaneBounds.right) <= this.renderer._boundingRect.left\r\n            || Math.round(actualPlaneBounds.left) >= this.renderer._boundingRect.left + this.renderer._boundingRect.width\r\n            || Math.round(actualPlaneBounds.bottom) <= this.renderer._boundingRect.top\r\n            || Math.round(actualPlaneBounds.top) >= this.renderer._boundingRect.top + this.renderer._boundingRect.height\r\n        ) {\r\n            if(this._shouldDraw) {\r\n                this._shouldDraw = false;\r\n                // callback for leaving view\r\n                this.renderer.nextRender.add(() => this._onLeaveViewCallback && this._onLeaveViewCallback());\r\n            }\r\n        }\r\n        else {\r\n            if(!this._shouldDraw) {\r\n                // callback for entering view\r\n                this.renderer.nextRender.add(() => this._onReEnterViewCallback && this._onReEnterViewCallback());\r\n            }\r\n            this._shouldDraw = true;\r\n        }\r\n    }\r\n\r\n\r\n    /***\r\n     This function returns if the plane is actually drawn (ie fully initiated, visible property set to true and not culled)\r\n     ***/\r\n    isDrawn() {\r\n        return this._canDraw && this.visible && (this._shouldDraw || this.alwaysDraw);\r\n    }\r\n\r\n\r\n    /*** DEPTH AND RENDER ORDER ***/\r\n\r\n    /***\r\n     This function set/unset the depth test for that plane\r\n\r\n     params :\r\n     @shouldEnableDepthTest (bool): enable/disable depth test for that plane\r\n     ***/\r\n    enableDepthTest(shouldEnableDepthTest) {\r\n        this._depthTest = shouldEnableDepthTest;\r\n    }\r\n\r\n\r\n    /*** SOURCES ***/\r\n\r\n    /***\r\n     Load our initial sources if needed and calls onReady callback\r\n     ***/\r\n    _initSources() {\r\n        // finally load every sources already in our plane html element\r\n        // load plane sources\r\n        let loaderSize = 0;\r\n        if(this.autoloadSources) {\r\n            const images = this.htmlElement.getElementsByTagName(\"img\");\r\n            const videos = this.htmlElement.getElementsByTagName(\"video\");\r\n            const canvases = this.htmlElement.getElementsByTagName(\"canvas\");\r\n\r\n            // load images\r\n            if(images.length) {\r\n                this.loadImages(images);\r\n            }\r\n\r\n            // load videos\r\n            if(videos.length) {\r\n                this.loadVideos(videos);\r\n            }\r\n\r\n            // load canvases\r\n            if(canvases.length) {\r\n                this.loadCanvases(canvases);\r\n            }\r\n\r\n            loaderSize = images.length + videos.length + canvases.length;\r\n        }\r\n\r\n        this.loader._setLoaderSize(loaderSize);\r\n\r\n        this._canDraw = true;\r\n    }\r\n\r\n\r\n    /*** DRAWING ***/\r\n\r\n    /***\r\n     Specific instructions for the Plane class to execute before drawing it\r\n     ***/\r\n    _startDrawing() {\r\n        // check if our plane is ready to draw\r\n        if(this._canDraw) {\r\n            // even if our plane should not be drawn we still execute its onRender callback and update its uniforms\r\n            if(this._onRenderCallback) {\r\n                this._onRenderCallback();\r\n            }\r\n\r\n            // to improve webgl pipeline performace, we might want to update each texture that needs an update here\r\n            // see https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#texImagetexSubImage_uploads_particularly_with_videos_can_cause_pipeline_flushes\r\n\r\n\r\n            // if we should render to a render target\r\n            if(this.target) {\r\n                this.renderer.bindFrameBuffer(this.target);\r\n            }\r\n            else if(this.renderer.state.scenePassIndex === null) {\r\n                this.renderer.bindFrameBuffer(null);\r\n            }\r\n\r\n            // update our perspective matrix\r\n            this._setPerspectiveMatrix();\r\n\r\n            // update our mv matrix\r\n            this._setMVMatrix();\r\n\r\n            // now check if we really need to draw it and its textures\r\n            if((this.alwaysDraw || this._shouldDraw) && this.visible) {\r\n                this._draw();\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /*** INTERACTION ***/\r\n\r\n    /***\r\n     This function takes the mouse position relative to the document and returns it relative to our plane\r\n     It ranges from -1 to 1 on both axis\r\n\r\n     params :\r\n     @mouseCoordinates (Vec2 object): coordinates of the mouse\r\n\r\n     returns :\r\n     @mousePosition (Vec2 object): the mouse position relative to our plane in WebGL space coordinates\r\n     ***/\r\n    mouseToPlaneCoords(mouseCoordinates) {\r\n        identityQuat.setAxisOrder(this.quaternion.axisOrder);\r\n\r\n        // plane has no rotation and transform origin is set to default, no need for real raycasting\r\n        if(identityQuat.equals(this.quaternion) && defaultTransformOrigin.equals(this.transformOrigin)) {\r\n            return super.mouseToPlaneCoords(mouseCoordinates);\r\n        }\r\n        else {\r\n            // raycasting\r\n            // based on https://people.cs.clemson.edu/~dhouse/courses/405/notes/raycast.pdf\r\n\r\n            // convert mouse position to 3d normalised device coordinates (from [-1, -1] to [1, 1])\r\n            const worldMouse = {\r\n                x: 2 * (mouseCoordinates.x / (this.renderer._boundingRect.width / this.renderer.pixelRatio)) - 1,\r\n                y: 2 * (1 - (mouseCoordinates.y / (this.renderer._boundingRect.height / this.renderer.pixelRatio))) - 1\r\n            };\r\n\r\n            const rayOrigin = this.camera.position.clone();\r\n\r\n            // ray direction based on normalised coordinates and plane translation\r\n            const rayDirection = tempRayDirection.set(\r\n                worldMouse.x,\r\n                worldMouse.y,\r\n                -0.5,\r\n            );\r\n\r\n            // unproject ray direction\r\n            rayDirection.unproject(this.camera);\r\n            rayDirection.sub(rayOrigin).normalize();\r\n\r\n\r\n            // plane normals (could also be [0, 0, 1], makes no difference, raycasting lands the same result for both face)\r\n            const planeNormals = tempNormals.set(0, 0, -1);\r\n\r\n            // apply plane quaternion to plane normals\r\n            planeNormals.applyQuat(this.quaternion).normalize();\r\n\r\n            const result = tempRaycast.set(0, 0, 0);\r\n\r\n            const denominator = planeNormals.dot(rayDirection);\r\n\r\n            if(Math.abs(denominator) >= 0.0001) {\r\n                const inverseViewMatrix = this._matrices.world.matrix.getInverse().multiply(this.camera.viewMatrix);\r\n\r\n                // get the plane's center coordinates\r\n                // start with our transform origin point\r\n                const planeOrigin = this._boundingRect.world.transformOrigin.clone().add(this._translation);\r\n\r\n                // rotate our transform origin about world center\r\n                const rotatedOrigin = tempRotatedOrigin.set(\r\n                    this._translation.x - planeOrigin.x,\r\n                    this._translation.y - planeOrigin.y,\r\n                    this._translation.z - planeOrigin.z,\r\n                );\r\n                rotatedOrigin.applyQuat(this.quaternion);\r\n\r\n                // add it to our plane origin\r\n                planeOrigin.add(rotatedOrigin);\r\n\r\n                // distance from ray origin to plane\r\n                const distance = planeNormals.dot(planeOrigin.clone().sub(rayOrigin)) / denominator;\r\n                result.copy(\r\n                    rayOrigin.add(rayDirection.multiplyScalar(distance))\r\n                );\r\n\r\n                result.applyMat4(inverseViewMatrix);\r\n            }\r\n            else {\r\n                // no intersection!\r\n                result.set(Infinity, Infinity, Infinity);\r\n            }\r\n\r\n            return castedMouseCoords.set(result.x, result.y);\r\n        }\r\n    }\r\n\r\n\r\n    /*** EVENTS ***/\r\n\r\n    /***\r\n     This is called each time a plane is entering again the view bounding box\r\n\r\n     params :\r\n     @callback (function) : a function to execute\r\n\r\n     returns :\r\n     @this: our plane to handle chaining\r\n     ***/\r\n    onReEnterView(callback) {\r\n        if(callback) {\r\n            this._onReEnterViewCallback = callback;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n\r\n    /***\r\n     This is called each time a plane is leaving the view bounding box\r\n\r\n     params :\r\n     @callback (function) : a function to execute\r\n\r\n     returns :\r\n     @this: our plane to handle chaining\r\n     ***/\r\n    onLeaveView(callback) {\r\n        if(callback) {\r\n            this._onLeaveViewCallback = callback;\r\n        }\r\n\r\n        return this;\r\n    }\r\n}","function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\n/*!\n * GSAP 3.12.7\n * https://gsap.com\n *\n * @license Copyright 2008-2025, GreenSock. All rights reserved.\n * Subject to the terms at https://gsap.com/standard-license or for\n * Club GSAP members, the agreement issued with that membership.\n * @author: Jack Doyle, jack@greensock.com\n*/\n\n/* eslint-disable */\nvar _config = {\n  autoSleep: 120,\n  force3D: \"auto\",\n  nullTargetWarn: 1,\n  units: {\n    lineHeight: \"\"\n  }\n},\n    _defaults = {\n  duration: .5,\n  overwrite: false,\n  delay: 0\n},\n    _suppressOverwrites,\n    _reverting,\n    _context,\n    _bigNum = 1e8,\n    _tinyNum = 1 / _bigNum,\n    _2PI = Math.PI * 2,\n    _HALF_PI = _2PI / 4,\n    _gsID = 0,\n    _sqrt = Math.sqrt,\n    _cos = Math.cos,\n    _sin = Math.sin,\n    _isString = function _isString(value) {\n  return typeof value === \"string\";\n},\n    _isFunction = function _isFunction(value) {\n  return typeof value === \"function\";\n},\n    _isNumber = function _isNumber(value) {\n  return typeof value === \"number\";\n},\n    _isUndefined = function _isUndefined(value) {\n  return typeof value === \"undefined\";\n},\n    _isObject = function _isObject(value) {\n  return typeof value === \"object\";\n},\n    _isNotFalse = function _isNotFalse(value) {\n  return value !== false;\n},\n    _windowExists = function _windowExists() {\n  return typeof window !== \"undefined\";\n},\n    _isFuncOrString = function _isFuncOrString(value) {\n  return _isFunction(value) || _isString(value);\n},\n    _isTypedArray = typeof ArrayBuffer === \"function\" && ArrayBuffer.isView || function () {},\n    // note: IE10 has ArrayBuffer, but NOT ArrayBuffer.isView().\n_isArray = Array.isArray,\n    _strictNumExp = /(?:-?\\.?\\d|\\.)+/gi,\n    //only numbers (including negatives and decimals) but NOT relative values.\n_numExp = /[-+=.]*\\d+[.e\\-+]*\\d*[e\\-+]*\\d*/g,\n    //finds any numbers, including ones that start with += or -=, negative numbers, and ones in scientific notation like 1e-8.\n_numWithUnitExp = /[-+=.]*\\d+[.e-]*\\d*[a-z%]*/g,\n    _complexStringNumExp = /[-+=.]*\\d+\\.?\\d*(?:e-|e\\+)?\\d*/gi,\n    //duplicate so that while we're looping through matches from exec(), it doesn't contaminate the lastIndex of _numExp which we use to search for colors too.\n_relExp = /[+-]=-?[.\\d]+/,\n    _delimitedValueExp = /[^,'\"\\[\\]\\s]+/gi,\n    // previously /[#\\-+.]*\\b[a-z\\d\\-=+%.]+/gi but didn't catch special characters.\n_unitExp = /^[+\\-=e\\s\\d]*\\d+[.\\d]*([a-z]*|%)\\s*$/i,\n    _globalTimeline,\n    _win,\n    _coreInitted,\n    _doc,\n    _globals = {},\n    _installScope = {},\n    _coreReady,\n    _install = function _install(scope) {\n  return (_installScope = _merge(scope, _globals)) && gsap;\n},\n    _missingPlugin = function _missingPlugin(property, value) {\n  return console.warn(\"Invalid property\", property, \"set to\", value, \"Missing plugin? gsap.registerPlugin()\");\n},\n    _warn = function _warn(message, suppress) {\n  return !suppress && console.warn(message);\n},\n    _addGlobal = function _addGlobal(name, obj) {\n  return name && (_globals[name] = obj) && _installScope && (_installScope[name] = obj) || _globals;\n},\n    _emptyFunc = function _emptyFunc() {\n  return 0;\n},\n    _startAtRevertConfig = {\n  suppressEvents: true,\n  isStart: true,\n  kill: false\n},\n    _revertConfigNoKill = {\n  suppressEvents: true,\n  kill: false\n},\n    _revertConfig = {\n  suppressEvents: true\n},\n    _reservedProps = {},\n    _lazyTweens = [],\n    _lazyLookup = {},\n    _lastRenderedFrame,\n    _plugins = {},\n    _effects = {},\n    _nextGCFrame = 30,\n    _harnessPlugins = [],\n    _callbackNames = \"\",\n    _harness = function _harness(targets) {\n  var target = targets[0],\n      harnessPlugin,\n      i;\n  _isObject(target) || _isFunction(target) || (targets = [targets]);\n\n  if (!(harnessPlugin = (target._gsap || {}).harness)) {\n    // find the first target with a harness. We assume targets passed into an animation will be of similar type, meaning the same kind of harness can be used for them all (performance optimization)\n    i = _harnessPlugins.length;\n\n    while (i-- && !_harnessPlugins[i].targetTest(target)) {}\n\n    harnessPlugin = _harnessPlugins[i];\n  }\n\n  i = targets.length;\n\n  while (i--) {\n    targets[i] && (targets[i]._gsap || (targets[i]._gsap = new GSCache(targets[i], harnessPlugin))) || targets.splice(i, 1);\n  }\n\n  return targets;\n},\n    _getCache = function _getCache(target) {\n  return target._gsap || _harness(toArray(target))[0]._gsap;\n},\n    _getProperty = function _getProperty(target, property, v) {\n  return (v = target[property]) && _isFunction(v) ? target[property]() : _isUndefined(v) && target.getAttribute && target.getAttribute(property) || v;\n},\n    _forEachName = function _forEachName(names, func) {\n  return (names = names.split(\",\")).forEach(func) || names;\n},\n    //split a comma-delimited list of names into an array, then run a forEach() function and return the split array (this is just a way to consolidate/shorten some code).\n_round = function _round(value) {\n  return Math.round(value * 100000) / 100000 || 0;\n},\n    _roundPrecise = function _roundPrecise(value) {\n  return Math.round(value * 10000000) / 10000000 || 0;\n},\n    // increased precision mostly for timing values.\n_parseRelative = function _parseRelative(start, value) {\n  var operator = value.charAt(0),\n      end = parseFloat(value.substr(2));\n  start = parseFloat(start);\n  return operator === \"+\" ? start + end : operator === \"-\" ? start - end : operator === \"*\" ? start * end : start / end;\n},\n    _arrayContainsAny = function _arrayContainsAny(toSearch, toFind) {\n  //searches one array to find matches for any of the items in the toFind array. As soon as one is found, it returns true. It does NOT return all the matches; it's simply a boolean search.\n  var l = toFind.length,\n      i = 0;\n\n  for (; toSearch.indexOf(toFind[i]) < 0 && ++i < l;) {}\n\n  return i < l;\n},\n    _lazyRender = function _lazyRender() {\n  var l = _lazyTweens.length,\n      a = _lazyTweens.slice(0),\n      i,\n      tween;\n\n  _lazyLookup = {};\n  _lazyTweens.length = 0;\n\n  for (i = 0; i < l; i++) {\n    tween = a[i];\n    tween && tween._lazy && (tween.render(tween._lazy[0], tween._lazy[1], true)._lazy = 0);\n  }\n},\n    _lazySafeRender = function _lazySafeRender(animation, time, suppressEvents, force) {\n  _lazyTweens.length && !_reverting && _lazyRender();\n  animation.render(time, suppressEvents, force || _reverting && time < 0 && (animation._initted || animation._startAt));\n  _lazyTweens.length && !_reverting && _lazyRender(); //in case rendering caused any tweens to lazy-init, we should render them because typically when someone calls seek() or time() or progress(), they expect an immediate render.\n},\n    _numericIfPossible = function _numericIfPossible(value) {\n  var n = parseFloat(value);\n  return (n || n === 0) && (value + \"\").match(_delimitedValueExp).length < 2 ? n : _isString(value) ? value.trim() : value;\n},\n    _passThrough = function _passThrough(p) {\n  return p;\n},\n    _setDefaults = function _setDefaults(obj, defaults) {\n  for (var p in defaults) {\n    p in obj || (obj[p] = defaults[p]);\n  }\n\n  return obj;\n},\n    _setKeyframeDefaults = function _setKeyframeDefaults(excludeDuration) {\n  return function (obj, defaults) {\n    for (var p in defaults) {\n      p in obj || p === \"duration\" && excludeDuration || p === \"ease\" || (obj[p] = defaults[p]);\n    }\n  };\n},\n    _merge = function _merge(base, toMerge) {\n  for (var p in toMerge) {\n    base[p] = toMerge[p];\n  }\n\n  return base;\n},\n    _mergeDeep = function _mergeDeep(base, toMerge) {\n  for (var p in toMerge) {\n    p !== \"__proto__\" && p !== \"constructor\" && p !== \"prototype\" && (base[p] = _isObject(toMerge[p]) ? _mergeDeep(base[p] || (base[p] = {}), toMerge[p]) : toMerge[p]);\n  }\n\n  return base;\n},\n    _copyExcluding = function _copyExcluding(obj, excluding) {\n  var copy = {},\n      p;\n\n  for (p in obj) {\n    p in excluding || (copy[p] = obj[p]);\n  }\n\n  return copy;\n},\n    _inheritDefaults = function _inheritDefaults(vars) {\n  var parent = vars.parent || _globalTimeline,\n      func = vars.keyframes ? _setKeyframeDefaults(_isArray(vars.keyframes)) : _setDefaults;\n\n  if (_isNotFalse(vars.inherit)) {\n    while (parent) {\n      func(vars, parent.vars.defaults);\n      parent = parent.parent || parent._dp;\n    }\n  }\n\n  return vars;\n},\n    _arraysMatch = function _arraysMatch(a1, a2) {\n  var i = a1.length,\n      match = i === a2.length;\n\n  while (match && i-- && a1[i] === a2[i]) {}\n\n  return i < 0;\n},\n    _addLinkedListItem = function _addLinkedListItem(parent, child, firstProp, lastProp, sortBy) {\n  if (firstProp === void 0) {\n    firstProp = \"_first\";\n  }\n\n  if (lastProp === void 0) {\n    lastProp = \"_last\";\n  }\n\n  var prev = parent[lastProp],\n      t;\n\n  if (sortBy) {\n    t = child[sortBy];\n\n    while (prev && prev[sortBy] > t) {\n      prev = prev._prev;\n    }\n  }\n\n  if (prev) {\n    child._next = prev._next;\n    prev._next = child;\n  } else {\n    child._next = parent[firstProp];\n    parent[firstProp] = child;\n  }\n\n  if (child._next) {\n    child._next._prev = child;\n  } else {\n    parent[lastProp] = child;\n  }\n\n  child._prev = prev;\n  child.parent = child._dp = parent;\n  return child;\n},\n    _removeLinkedListItem = function _removeLinkedListItem(parent, child, firstProp, lastProp) {\n  if (firstProp === void 0) {\n    firstProp = \"_first\";\n  }\n\n  if (lastProp === void 0) {\n    lastProp = \"_last\";\n  }\n\n  var prev = child._prev,\n      next = child._next;\n\n  if (prev) {\n    prev._next = next;\n  } else if (parent[firstProp] === child) {\n    parent[firstProp] = next;\n  }\n\n  if (next) {\n    next._prev = prev;\n  } else if (parent[lastProp] === child) {\n    parent[lastProp] = prev;\n  }\n\n  child._next = child._prev = child.parent = null; // don't delete the _dp just so we can revert if necessary. But parent should be null to indicate the item isn't in a linked list.\n},\n    _removeFromParent = function _removeFromParent(child, onlyIfParentHasAutoRemove) {\n  child.parent && (!onlyIfParentHasAutoRemove || child.parent.autoRemoveChildren) && child.parent.remove && child.parent.remove(child);\n  child._act = 0;\n},\n    _uncache = function _uncache(animation, child) {\n  if (animation && (!child || child._end > animation._dur || child._start < 0)) {\n    // performance optimization: if a child animation is passed in we should only uncache if that child EXTENDS the animation (its end time is beyond the end)\n    var a = animation;\n\n    while (a) {\n      a._dirty = 1;\n      a = a.parent;\n    }\n  }\n\n  return animation;\n},\n    _recacheAncestors = function _recacheAncestors(animation) {\n  var parent = animation.parent;\n\n  while (parent && parent.parent) {\n    //sometimes we must force a re-sort of all children and update the duration/totalDuration of all ancestor timelines immediately in case, for example, in the middle of a render loop, one tween alters another tween's timeScale which shoves its startTime before 0, forcing the parent timeline to shift around and shiftChildren() which could affect that next tween's render (startTime). Doesn't matter for the root timeline though.\n    parent._dirty = 1;\n    parent.totalDuration();\n    parent = parent.parent;\n  }\n\n  return animation;\n},\n    _rewindStartAt = function _rewindStartAt(tween, totalTime, suppressEvents, force) {\n  return tween._startAt && (_reverting ? tween._startAt.revert(_revertConfigNoKill) : tween.vars.immediateRender && !tween.vars.autoRevert || tween._startAt.render(totalTime, true, force));\n},\n    _hasNoPausedAncestors = function _hasNoPausedAncestors(animation) {\n  return !animation || animation._ts && _hasNoPausedAncestors(animation.parent);\n},\n    _elapsedCycleDuration = function _elapsedCycleDuration(animation) {\n  return animation._repeat ? _animationCycle(animation._tTime, animation = animation.duration() + animation._rDelay) * animation : 0;\n},\n    // feed in the totalTime and cycleDuration and it'll return the cycle (iteration minus 1) and if the playhead is exactly at the very END, it will NOT bump up to the next cycle.\n_animationCycle = function _animationCycle(tTime, cycleDuration) {\n  var whole = Math.floor(tTime = _roundPrecise(tTime / cycleDuration));\n  return tTime && whole === tTime ? whole - 1 : whole;\n},\n    _parentToChildTotalTime = function _parentToChildTotalTime(parentTime, child) {\n  return (parentTime - child._start) * child._ts + (child._ts >= 0 ? 0 : child._dirty ? child.totalDuration() : child._tDur);\n},\n    _setEnd = function _setEnd(animation) {\n  return animation._end = _roundPrecise(animation._start + (animation._tDur / Math.abs(animation._ts || animation._rts || _tinyNum) || 0));\n},\n    _alignPlayhead = function _alignPlayhead(animation, totalTime) {\n  // adjusts the animation's _start and _end according to the provided totalTime (only if the parent's smoothChildTiming is true and the animation isn't paused). It doesn't do any rendering or forcing things back into parent timelines, etc. - that's what totalTime() is for.\n  var parent = animation._dp;\n\n  if (parent && parent.smoothChildTiming && animation._ts) {\n    animation._start = _roundPrecise(parent._time - (animation._ts > 0 ? totalTime / animation._ts : ((animation._dirty ? animation.totalDuration() : animation._tDur) - totalTime) / -animation._ts));\n\n    _setEnd(animation);\n\n    parent._dirty || _uncache(parent, animation); //for performance improvement. If the parent's cache is already dirty, it already took care of marking the ancestors as dirty too, so skip the function call here.\n  }\n\n  return animation;\n},\n\n/*\n_totalTimeToTime = (clampedTotalTime, duration, repeat, repeatDelay, yoyo) => {\n\tlet cycleDuration = duration + repeatDelay,\n\t\ttime = _round(clampedTotalTime % cycleDuration);\n\tif (time > duration) {\n\t\ttime = duration;\n\t}\n\treturn (yoyo && (~~(clampedTotalTime / cycleDuration) & 1)) ? duration - time : time;\n},\n*/\n_postAddChecks = function _postAddChecks(timeline, child) {\n  var t;\n\n  if (child._time || !child._dur && child._initted || child._start < timeline._time && (child._dur || !child.add)) {\n    // in case, for example, the _start is moved on a tween that has already rendered, or if it's being inserted into a timeline BEFORE where the playhead is currently. Imagine it's at its end state, then the startTime is moved WAY later (after the end of this timeline), it should render at its beginning. Special case: if it's a timeline (has .add() method) and no duration, we can skip rendering because the user may be populating it AFTER adding it to a parent timeline (unconventional, but possible, and we wouldn't want it to get removed if the parent's autoRemoveChildren is true).\n    t = _parentToChildTotalTime(timeline.rawTime(), child);\n\n    if (!child._dur || _clamp(0, child.totalDuration(), t) - child._tTime > _tinyNum) {\n      child.render(t, true);\n    }\n  } //if the timeline has already ended but the inserted tween/timeline extends the duration, we should enable this timeline again so that it renders properly. We should also align the playhead with the parent timeline's when appropriate.\n\n\n  if (_uncache(timeline, child)._dp && timeline._initted && timeline._time >= timeline._dur && timeline._ts) {\n    //in case any of the ancestors had completed but should now be enabled...\n    if (timeline._dur < timeline.duration()) {\n      t = timeline;\n\n      while (t._dp) {\n        t.rawTime() >= 0 && t.totalTime(t._tTime); //moves the timeline (shifts its startTime) if necessary, and also enables it. If it's currently zero, though, it may not be scheduled to render until later so there's no need to force it to align with the current playhead position. Only move to catch up with the playhead.\n\n        t = t._dp;\n      }\n    }\n\n    timeline._zTime = -_tinyNum; // helps ensure that the next render() will be forced (crossingStart = true in render()), even if the duration hasn't changed (we're adding a child which would need to get rendered). Definitely an edge case. Note: we MUST do this AFTER the loop above where the totalTime() might trigger a render() because this _addToTimeline() method gets called from the Animation constructor, BEFORE tweens even record their targets, etc. so we wouldn't want things to get triggered in the wrong order.\n  }\n},\n    _addToTimeline = function _addToTimeline(timeline, child, position, skipChecks) {\n  child.parent && _removeFromParent(child);\n  child._start = _roundPrecise((_isNumber(position) ? position : position || timeline !== _globalTimeline ? _parsePosition(timeline, position, child) : timeline._time) + child._delay);\n  child._end = _roundPrecise(child._start + (child.totalDuration() / Math.abs(child.timeScale()) || 0));\n\n  _addLinkedListItem(timeline, child, \"_first\", \"_last\", timeline._sort ? \"_start\" : 0);\n\n  _isFromOrFromStart(child) || (timeline._recent = child);\n  skipChecks || _postAddChecks(timeline, child);\n  timeline._ts < 0 && _alignPlayhead(timeline, timeline._tTime); // if the timeline is reversed and the new child makes it longer, we may need to adjust the parent's _start (push it back)\n\n  return timeline;\n},\n    _scrollTrigger = function _scrollTrigger(animation, trigger) {\n  return (_globals.ScrollTrigger || _missingPlugin(\"scrollTrigger\", trigger)) && _globals.ScrollTrigger.create(trigger, animation);\n},\n    _attemptInitTween = function _attemptInitTween(tween, time, force, suppressEvents, tTime) {\n  _initTween(tween, time, tTime);\n\n  if (!tween._initted) {\n    return 1;\n  }\n\n  if (!force && tween._pt && !_reverting && (tween._dur && tween.vars.lazy !== false || !tween._dur && tween.vars.lazy) && _lastRenderedFrame !== _ticker.frame) {\n    _lazyTweens.push(tween);\n\n    tween._lazy = [tTime, suppressEvents];\n    return 1;\n  }\n},\n    _parentPlayheadIsBeforeStart = function _parentPlayheadIsBeforeStart(_ref) {\n  var parent = _ref.parent;\n  return parent && parent._ts && parent._initted && !parent._lock && (parent.rawTime() < 0 || _parentPlayheadIsBeforeStart(parent));\n},\n    // check parent's _lock because when a timeline repeats/yoyos and does its artificial wrapping, we shouldn't force the ratio back to 0\n_isFromOrFromStart = function _isFromOrFromStart(_ref2) {\n  var data = _ref2.data;\n  return data === \"isFromStart\" || data === \"isStart\";\n},\n    _renderZeroDurationTween = function _renderZeroDurationTween(tween, totalTime, suppressEvents, force) {\n  var prevRatio = tween.ratio,\n      ratio = totalTime < 0 || !totalTime && (!tween._start && _parentPlayheadIsBeforeStart(tween) && !(!tween._initted && _isFromOrFromStart(tween)) || (tween._ts < 0 || tween._dp._ts < 0) && !_isFromOrFromStart(tween)) ? 0 : 1,\n      // if the tween or its parent is reversed and the totalTime is 0, we should go to a ratio of 0. Edge case: if a from() or fromTo() stagger tween is placed later in a timeline, the \"startAt\" zero-duration tween could initially render at a time when the parent timeline's playhead is technically BEFORE where this tween is, so make sure that any \"from\" and \"fromTo\" startAt tweens are rendered the first time at a ratio of 1.\n  repeatDelay = tween._rDelay,\n      tTime = 0,\n      pt,\n      iteration,\n      prevIteration;\n\n  if (repeatDelay && tween._repeat) {\n    // in case there's a zero-duration tween that has a repeat with a repeatDelay\n    tTime = _clamp(0, tween._tDur, totalTime);\n    iteration = _animationCycle(tTime, repeatDelay);\n    tween._yoyo && iteration & 1 && (ratio = 1 - ratio);\n\n    if (iteration !== _animationCycle(tween._tTime, repeatDelay)) {\n      // if iteration changed\n      prevRatio = 1 - ratio;\n      tween.vars.repeatRefresh && tween._initted && tween.invalidate();\n    }\n  }\n\n  if (ratio !== prevRatio || _reverting || force || tween._zTime === _tinyNum || !totalTime && tween._zTime) {\n    if (!tween._initted && _attemptInitTween(tween, totalTime, force, suppressEvents, tTime)) {\n      // if we render the very beginning (time == 0) of a fromTo(), we must force the render (normal tweens wouldn't need to render at a time of 0 when the prevTime was also 0). This is also mandatory to make sure overwriting kicks in immediately.\n      return;\n    }\n\n    prevIteration = tween._zTime;\n    tween._zTime = totalTime || (suppressEvents ? _tinyNum : 0); // when the playhead arrives at EXACTLY time 0 (right on top) of a zero-duration tween, we need to discern if events are suppressed so that when the playhead moves again (next time), it'll trigger the callback. If events are NOT suppressed, obviously the callback would be triggered in this render. Basically, the callback should fire either when the playhead ARRIVES or LEAVES this exact spot, not both. Imagine doing a timeline.seek(0) and there's a callback that sits at 0. Since events are suppressed on that seek() by default, nothing will fire, but when the playhead moves off of that position, the callback should fire. This behavior is what people intuitively expect.\n\n    suppressEvents || (suppressEvents = totalTime && !prevIteration); // if it was rendered previously at exactly 0 (_zTime) and now the playhead is moving away, DON'T fire callbacks otherwise they'll seem like duplicates.\n\n    tween.ratio = ratio;\n    tween._from && (ratio = 1 - ratio);\n    tween._time = 0;\n    tween._tTime = tTime;\n    pt = tween._pt;\n\n    while (pt) {\n      pt.r(ratio, pt.d);\n      pt = pt._next;\n    }\n\n    totalTime < 0 && _rewindStartAt(tween, totalTime, suppressEvents, true);\n    tween._onUpdate && !suppressEvents && _callback(tween, \"onUpdate\");\n    tTime && tween._repeat && !suppressEvents && tween.parent && _callback(tween, \"onRepeat\");\n\n    if ((totalTime >= tween._tDur || totalTime < 0) && tween.ratio === ratio) {\n      ratio && _removeFromParent(tween, 1);\n\n      if (!suppressEvents && !_reverting) {\n        _callback(tween, ratio ? \"onComplete\" : \"onReverseComplete\", true);\n\n        tween._prom && tween._prom();\n      }\n    }\n  } else if (!tween._zTime) {\n    tween._zTime = totalTime;\n  }\n},\n    _findNextPauseTween = function _findNextPauseTween(animation, prevTime, time) {\n  var child;\n\n  if (time > prevTime) {\n    child = animation._first;\n\n    while (child && child._start <= time) {\n      if (child.data === \"isPause\" && child._start > prevTime) {\n        return child;\n      }\n\n      child = child._next;\n    }\n  } else {\n    child = animation._last;\n\n    while (child && child._start >= time) {\n      if (child.data === \"isPause\" && child._start < prevTime) {\n        return child;\n      }\n\n      child = child._prev;\n    }\n  }\n},\n    _setDuration = function _setDuration(animation, duration, skipUncache, leavePlayhead) {\n  var repeat = animation._repeat,\n      dur = _roundPrecise(duration) || 0,\n      totalProgress = animation._tTime / animation._tDur;\n  totalProgress && !leavePlayhead && (animation._time *= dur / animation._dur);\n  animation._dur = dur;\n  animation._tDur = !repeat ? dur : repeat < 0 ? 1e10 : _roundPrecise(dur * (repeat + 1) + animation._rDelay * repeat);\n  totalProgress > 0 && !leavePlayhead && _alignPlayhead(animation, animation._tTime = animation._tDur * totalProgress);\n  animation.parent && _setEnd(animation);\n  skipUncache || _uncache(animation.parent, animation);\n  return animation;\n},\n    _onUpdateTotalDuration = function _onUpdateTotalDuration(animation) {\n  return animation instanceof Timeline ? _uncache(animation) : _setDuration(animation, animation._dur);\n},\n    _zeroPosition = {\n  _start: 0,\n  endTime: _emptyFunc,\n  totalDuration: _emptyFunc\n},\n    _parsePosition = function _parsePosition(animation, position, percentAnimation) {\n  var labels = animation.labels,\n      recent = animation._recent || _zeroPosition,\n      clippedDuration = animation.duration() >= _bigNum ? recent.endTime(false) : animation._dur,\n      //in case there's a child that infinitely repeats, users almost never intend for the insertion point of a new child to be based on a SUPER long value like that so we clip it and assume the most recently-added child's endTime should be used instead.\n  i,\n      offset,\n      isPercent;\n\n  if (_isString(position) && (isNaN(position) || position in labels)) {\n    //if the string is a number like \"1\", check to see if there's a label with that name, otherwise interpret it as a number (absolute value).\n    offset = position.charAt(0);\n    isPercent = position.substr(-1) === \"%\";\n    i = position.indexOf(\"=\");\n\n    if (offset === \"<\" || offset === \">\") {\n      i >= 0 && (position = position.replace(/=/, \"\"));\n      return (offset === \"<\" ? recent._start : recent.endTime(recent._repeat >= 0)) + (parseFloat(position.substr(1)) || 0) * (isPercent ? (i < 0 ? recent : percentAnimation).totalDuration() / 100 : 1);\n    }\n\n    if (i < 0) {\n      position in labels || (labels[position] = clippedDuration);\n      return labels[position];\n    }\n\n    offset = parseFloat(position.charAt(i - 1) + position.substr(i + 1));\n\n    if (isPercent && percentAnimation) {\n      offset = offset / 100 * (_isArray(percentAnimation) ? percentAnimation[0] : percentAnimation).totalDuration();\n    }\n\n    return i > 1 ? _parsePosition(animation, position.substr(0, i - 1), percentAnimation) + offset : clippedDuration + offset;\n  }\n\n  return position == null ? clippedDuration : +position;\n},\n    _createTweenType = function _createTweenType(type, params, timeline) {\n  var isLegacy = _isNumber(params[1]),\n      varsIndex = (isLegacy ? 2 : 1) + (type < 2 ? 0 : 1),\n      vars = params[varsIndex],\n      irVars,\n      parent;\n\n  isLegacy && (vars.duration = params[1]);\n  vars.parent = timeline;\n\n  if (type) {\n    irVars = vars;\n    parent = timeline;\n\n    while (parent && !(\"immediateRender\" in irVars)) {\n      // inheritance hasn't happened yet, but someone may have set a default in an ancestor timeline. We could do vars.immediateRender = _isNotFalse(_inheritDefaults(vars).immediateRender) but that'd exact a slight performance penalty because _inheritDefaults() also runs in the Tween constructor. We're paying a small kb price here to gain speed.\n      irVars = parent.vars.defaults || {};\n      parent = _isNotFalse(parent.vars.inherit) && parent.parent;\n    }\n\n    vars.immediateRender = _isNotFalse(irVars.immediateRender);\n    type < 2 ? vars.runBackwards = 1 : vars.startAt = params[varsIndex - 1]; // \"from\" vars\n  }\n\n  return new Tween(params[0], vars, params[varsIndex + 1]);\n},\n    _conditionalReturn = function _conditionalReturn(value, func) {\n  return value || value === 0 ? func(value) : func;\n},\n    _clamp = function _clamp(min, max, value) {\n  return value < min ? min : value > max ? max : value;\n},\n    getUnit = function getUnit(value, v) {\n  return !_isString(value) || !(v = _unitExp.exec(value)) ? \"\" : v[1];\n},\n    // note: protect against padded numbers as strings, like \"100.100\". That shouldn't return \"00\" as the unit. If it's numeric, return no unit.\nclamp = function clamp(min, max, value) {\n  return _conditionalReturn(value, function (v) {\n    return _clamp(min, max, v);\n  });\n},\n    _slice = [].slice,\n    _isArrayLike = function _isArrayLike(value, nonEmpty) {\n  return value && _isObject(value) && \"length\" in value && (!nonEmpty && !value.length || value.length - 1 in value && _isObject(value[0])) && !value.nodeType && value !== _win;\n},\n    _flatten = function _flatten(ar, leaveStrings, accumulator) {\n  if (accumulator === void 0) {\n    accumulator = [];\n  }\n\n  return ar.forEach(function (value) {\n    var _accumulator;\n\n    return _isString(value) && !leaveStrings || _isArrayLike(value, 1) ? (_accumulator = accumulator).push.apply(_accumulator, toArray(value)) : accumulator.push(value);\n  }) || accumulator;\n},\n    //takes any value and returns an array. If it's a string (and leaveStrings isn't true), it'll use document.querySelectorAll() and convert that to an array. It'll also accept iterables like jQuery objects.\ntoArray = function toArray(value, scope, leaveStrings) {\n  return _context && !scope && _context.selector ? _context.selector(value) : _isString(value) && !leaveStrings && (_coreInitted || !_wake()) ? _slice.call((scope || _doc).querySelectorAll(value), 0) : _isArray(value) ? _flatten(value, leaveStrings) : _isArrayLike(value) ? _slice.call(value, 0) : value ? [value] : [];\n},\n    selector = function selector(value) {\n  value = toArray(value)[0] || _warn(\"Invalid scope\") || {};\n  return function (v) {\n    var el = value.current || value.nativeElement || value;\n    return toArray(v, el.querySelectorAll ? el : el === value ? _warn(\"Invalid scope\") || _doc.createElement(\"div\") : value);\n  };\n},\n    shuffle = function shuffle(a) {\n  return a.sort(function () {\n    return .5 - Math.random();\n  });\n},\n    // alternative that's a bit faster and more reliably diverse but bigger:   for (let j, v, i = a.length; i; j = (Math.random() * i) | 0, v = a[--i], a[i] = a[j], a[j] = v); return a;\n//for distributing values across an array. Can accept a number, a function or (most commonly) a function which can contain the following properties: {base, amount, from, ease, grid, axis, length, each}. Returns a function that expects the following parameters: index, target, array. Recognizes the following\ndistribute = function distribute(v) {\n  if (_isFunction(v)) {\n    return v;\n  }\n\n  var vars = _isObject(v) ? v : {\n    each: v\n  },\n      //n:1 is just to indicate v was a number; we leverage that later to set v according to the length we get. If a number is passed in, we treat it like the old stagger value where 0.1, for example, would mean that things would be distributed with 0.1 between each element in the array rather than a total \"amount\" that's chunked out among them all.\n  ease = _parseEase(vars.ease),\n      from = vars.from || 0,\n      base = parseFloat(vars.base) || 0,\n      cache = {},\n      isDecimal = from > 0 && from < 1,\n      ratios = isNaN(from) || isDecimal,\n      axis = vars.axis,\n      ratioX = from,\n      ratioY = from;\n\n  if (_isString(from)) {\n    ratioX = ratioY = {\n      center: .5,\n      edges: .5,\n      end: 1\n    }[from] || 0;\n  } else if (!isDecimal && ratios) {\n    ratioX = from[0];\n    ratioY = from[1];\n  }\n\n  return function (i, target, a) {\n    var l = (a || vars).length,\n        distances = cache[l],\n        originX,\n        originY,\n        x,\n        y,\n        d,\n        j,\n        max,\n        min,\n        wrapAt;\n\n    if (!distances) {\n      wrapAt = vars.grid === \"auto\" ? 0 : (vars.grid || [1, _bigNum])[1];\n\n      if (!wrapAt) {\n        max = -_bigNum;\n\n        while (max < (max = a[wrapAt++].getBoundingClientRect().left) && wrapAt < l) {}\n\n        wrapAt < l && wrapAt--;\n      }\n\n      distances = cache[l] = [];\n      originX = ratios ? Math.min(wrapAt, l) * ratioX - .5 : from % wrapAt;\n      originY = wrapAt === _bigNum ? 0 : ratios ? l * ratioY / wrapAt - .5 : from / wrapAt | 0;\n      max = 0;\n      min = _bigNum;\n\n      for (j = 0; j < l; j++) {\n        x = j % wrapAt - originX;\n        y = originY - (j / wrapAt | 0);\n        distances[j] = d = !axis ? _sqrt(x * x + y * y) : Math.abs(axis === \"y\" ? y : x);\n        d > max && (max = d);\n        d < min && (min = d);\n      }\n\n      from === \"random\" && shuffle(distances);\n      distances.max = max - min;\n      distances.min = min;\n      distances.v = l = (parseFloat(vars.amount) || parseFloat(vars.each) * (wrapAt > l ? l - 1 : !axis ? Math.max(wrapAt, l / wrapAt) : axis === \"y\" ? l / wrapAt : wrapAt) || 0) * (from === \"edges\" ? -1 : 1);\n      distances.b = l < 0 ? base - l : base;\n      distances.u = getUnit(vars.amount || vars.each) || 0; //unit\n\n      ease = ease && l < 0 ? _invertEase(ease) : ease;\n    }\n\n    l = (distances[i] - distances.min) / distances.max || 0;\n    return _roundPrecise(distances.b + (ease ? ease(l) : l) * distances.v) + distances.u; //round in order to work around floating point errors\n  };\n},\n    _roundModifier = function _roundModifier(v) {\n  //pass in 0.1 get a function that'll round to the nearest tenth, or 5 to round to the closest 5, or 0.001 to the closest 1000th, etc.\n  var p = Math.pow(10, ((v + \"\").split(\".\")[1] || \"\").length); //to avoid floating point math errors (like 24 * 0.1 == 2.4000000000000004), we chop off at a specific number of decimal places (much faster than toFixed())\n\n  return function (raw) {\n    var n = _roundPrecise(Math.round(parseFloat(raw) / v) * v * p);\n\n    return (n - n % 1) / p + (_isNumber(raw) ? 0 : getUnit(raw)); // n - n % 1 replaces Math.floor() in order to handle negative values properly. For example, Math.floor(-150.00000000000003) is 151!\n  };\n},\n    snap = function snap(snapTo, value) {\n  var isArray = _isArray(snapTo),\n      radius,\n      is2D;\n\n  if (!isArray && _isObject(snapTo)) {\n    radius = isArray = snapTo.radius || _bigNum;\n\n    if (snapTo.values) {\n      snapTo = toArray(snapTo.values);\n\n      if (is2D = !_isNumber(snapTo[0])) {\n        radius *= radius; //performance optimization so we don't have to Math.sqrt() in the loop.\n      }\n    } else {\n      snapTo = _roundModifier(snapTo.increment);\n    }\n  }\n\n  return _conditionalReturn(value, !isArray ? _roundModifier(snapTo) : _isFunction(snapTo) ? function (raw) {\n    is2D = snapTo(raw);\n    return Math.abs(is2D - raw) <= radius ? is2D : raw;\n  } : function (raw) {\n    var x = parseFloat(is2D ? raw.x : raw),\n        y = parseFloat(is2D ? raw.y : 0),\n        min = _bigNum,\n        closest = 0,\n        i = snapTo.length,\n        dx,\n        dy;\n\n    while (i--) {\n      if (is2D) {\n        dx = snapTo[i].x - x;\n        dy = snapTo[i].y - y;\n        dx = dx * dx + dy * dy;\n      } else {\n        dx = Math.abs(snapTo[i] - x);\n      }\n\n      if (dx < min) {\n        min = dx;\n        closest = i;\n      }\n    }\n\n    closest = !radius || min <= radius ? snapTo[closest] : raw;\n    return is2D || closest === raw || _isNumber(raw) ? closest : closest + getUnit(raw);\n  });\n},\n    random = function random(min, max, roundingIncrement, returnFunction) {\n  return _conditionalReturn(_isArray(min) ? !max : roundingIncrement === true ? !!(roundingIncrement = 0) : !returnFunction, function () {\n    return _isArray(min) ? min[~~(Math.random() * min.length)] : (roundingIncrement = roundingIncrement || 1e-5) && (returnFunction = roundingIncrement < 1 ? Math.pow(10, (roundingIncrement + \"\").length - 2) : 1) && Math.floor(Math.round((min - roundingIncrement / 2 + Math.random() * (max - min + roundingIncrement * .99)) / roundingIncrement) * roundingIncrement * returnFunction) / returnFunction;\n  });\n},\n    pipe = function pipe() {\n  for (var _len = arguments.length, functions = new Array(_len), _key = 0; _key < _len; _key++) {\n    functions[_key] = arguments[_key];\n  }\n\n  return function (value) {\n    return functions.reduce(function (v, f) {\n      return f(v);\n    }, value);\n  };\n},\n    unitize = function unitize(func, unit) {\n  return function (value) {\n    return func(parseFloat(value)) + (unit || getUnit(value));\n  };\n},\n    normalize = function normalize(min, max, value) {\n  return mapRange(min, max, 0, 1, value);\n},\n    _wrapArray = function _wrapArray(a, wrapper, value) {\n  return _conditionalReturn(value, function (index) {\n    return a[~~wrapper(index)];\n  });\n},\n    wrap = function wrap(min, max, value) {\n  // NOTE: wrap() CANNOT be an arrow function! A very odd compiling bug causes problems (unrelated to GSAP).\n  var range = max - min;\n  return _isArray(min) ? _wrapArray(min, wrap(0, min.length), max) : _conditionalReturn(value, function (value) {\n    return (range + (value - min) % range) % range + min;\n  });\n},\n    wrapYoyo = function wrapYoyo(min, max, value) {\n  var range = max - min,\n      total = range * 2;\n  return _isArray(min) ? _wrapArray(min, wrapYoyo(0, min.length - 1), max) : _conditionalReturn(value, function (value) {\n    value = (total + (value - min) % total) % total || 0;\n    return min + (value > range ? total - value : value);\n  });\n},\n    _replaceRandom = function _replaceRandom(value) {\n  //replaces all occurrences of random(...) in a string with the calculated random value. can be a range like random(-100, 100, 5) or an array like random([0, 100, 500])\n  var prev = 0,\n      s = \"\",\n      i,\n      nums,\n      end,\n      isArray;\n\n  while (~(i = value.indexOf(\"random(\", prev))) {\n    end = value.indexOf(\")\", i);\n    isArray = value.charAt(i + 7) === \"[\";\n    nums = value.substr(i + 7, end - i - 7).match(isArray ? _delimitedValueExp : _strictNumExp);\n    s += value.substr(prev, i - prev) + random(isArray ? nums : +nums[0], isArray ? 0 : +nums[1], +nums[2] || 1e-5);\n    prev = end + 1;\n  }\n\n  return s + value.substr(prev, value.length - prev);\n},\n    mapRange = function mapRange(inMin, inMax, outMin, outMax, value) {\n  var inRange = inMax - inMin,\n      outRange = outMax - outMin;\n  return _conditionalReturn(value, function (value) {\n    return outMin + ((value - inMin) / inRange * outRange || 0);\n  });\n},\n    interpolate = function interpolate(start, end, progress, mutate) {\n  var func = isNaN(start + end) ? 0 : function (p) {\n    return (1 - p) * start + p * end;\n  };\n\n  if (!func) {\n    var isString = _isString(start),\n        master = {},\n        p,\n        i,\n        interpolators,\n        l,\n        il;\n\n    progress === true && (mutate = 1) && (progress = null);\n\n    if (isString) {\n      start = {\n        p: start\n      };\n      end = {\n        p: end\n      };\n    } else if (_isArray(start) && !_isArray(end)) {\n      interpolators = [];\n      l = start.length;\n      il = l - 2;\n\n      for (i = 1; i < l; i++) {\n        interpolators.push(interpolate(start[i - 1], start[i])); //build the interpolators up front as a performance optimization so that when the function is called many times, it can just reuse them.\n      }\n\n      l--;\n\n      func = function func(p) {\n        p *= l;\n        var i = Math.min(il, ~~p);\n        return interpolators[i](p - i);\n      };\n\n      progress = end;\n    } else if (!mutate) {\n      start = _merge(_isArray(start) ? [] : {}, start);\n    }\n\n    if (!interpolators) {\n      for (p in end) {\n        _addPropTween.call(master, start, p, \"get\", end[p]);\n      }\n\n      func = function func(p) {\n        return _renderPropTweens(p, master) || (isString ? start.p : start);\n      };\n    }\n  }\n\n  return _conditionalReturn(progress, func);\n},\n    _getLabelInDirection = function _getLabelInDirection(timeline, fromTime, backward) {\n  //used for nextLabel() and previousLabel()\n  var labels = timeline.labels,\n      min = _bigNum,\n      p,\n      distance,\n      label;\n\n  for (p in labels) {\n    distance = labels[p] - fromTime;\n\n    if (distance < 0 === !!backward && distance && min > (distance = Math.abs(distance))) {\n      label = p;\n      min = distance;\n    }\n  }\n\n  return label;\n},\n    _callback = function _callback(animation, type, executeLazyFirst) {\n  var v = animation.vars,\n      callback = v[type],\n      prevContext = _context,\n      context = animation._ctx,\n      params,\n      scope,\n      result;\n\n  if (!callback) {\n    return;\n  }\n\n  params = v[type + \"Params\"];\n  scope = v.callbackScope || animation;\n  executeLazyFirst && _lazyTweens.length && _lazyRender(); //in case rendering caused any tweens to lazy-init, we should render them because typically when a timeline finishes, users expect things to have rendered fully. Imagine an onUpdate on a timeline that reports/checks tweened values.\n\n  context && (_context = context);\n  result = params ? callback.apply(scope, params) : callback.call(scope);\n  _context = prevContext;\n  return result;\n},\n    _interrupt = function _interrupt(animation) {\n  _removeFromParent(animation);\n\n  animation.scrollTrigger && animation.scrollTrigger.kill(!!_reverting);\n  animation.progress() < 1 && _callback(animation, \"onInterrupt\");\n  return animation;\n},\n    _quickTween,\n    _registerPluginQueue = [],\n    _createPlugin = function _createPlugin(config) {\n  if (!config) return;\n  config = !config.name && config[\"default\"] || config; // UMD packaging wraps things oddly, so for example MotionPathHelper becomes {MotionPathHelper:MotionPathHelper, default:MotionPathHelper}.\n\n  if (_windowExists() || config.headless) {\n    // edge case: some build tools may pass in a null/undefined value\n    var name = config.name,\n        isFunc = _isFunction(config),\n        Plugin = name && !isFunc && config.init ? function () {\n      this._props = [];\n    } : config,\n        //in case someone passes in an object that's not a plugin, like CustomEase\n    instanceDefaults = {\n      init: _emptyFunc,\n      render: _renderPropTweens,\n      add: _addPropTween,\n      kill: _killPropTweensOf,\n      modifier: _addPluginModifier,\n      rawVars: 0\n    },\n        statics = {\n      targetTest: 0,\n      get: 0,\n      getSetter: _getSetter,\n      aliases: {},\n      register: 0\n    };\n\n    _wake();\n\n    if (config !== Plugin) {\n      if (_plugins[name]) {\n        return;\n      }\n\n      _setDefaults(Plugin, _setDefaults(_copyExcluding(config, instanceDefaults), statics)); //static methods\n\n\n      _merge(Plugin.prototype, _merge(instanceDefaults, _copyExcluding(config, statics))); //instance methods\n\n\n      _plugins[Plugin.prop = name] = Plugin;\n\n      if (config.targetTest) {\n        _harnessPlugins.push(Plugin);\n\n        _reservedProps[name] = 1;\n      }\n\n      name = (name === \"css\" ? \"CSS\" : name.charAt(0).toUpperCase() + name.substr(1)) + \"Plugin\"; //for the global name. \"motionPath\" should become MotionPathPlugin\n    }\n\n    _addGlobal(name, Plugin);\n\n    config.register && config.register(gsap, Plugin, PropTween);\n  } else {\n    _registerPluginQueue.push(config);\n  }\n},\n\n/*\n * --------------------------------------------------------------------------------------\n * COLORS\n * --------------------------------------------------------------------------------------\n */\n_255 = 255,\n    _colorLookup = {\n  aqua: [0, _255, _255],\n  lime: [0, _255, 0],\n  silver: [192, 192, 192],\n  black: [0, 0, 0],\n  maroon: [128, 0, 0],\n  teal: [0, 128, 128],\n  blue: [0, 0, _255],\n  navy: [0, 0, 128],\n  white: [_255, _255, _255],\n  olive: [128, 128, 0],\n  yellow: [_255, _255, 0],\n  orange: [_255, 165, 0],\n  gray: [128, 128, 128],\n  purple: [128, 0, 128],\n  green: [0, 128, 0],\n  red: [_255, 0, 0],\n  pink: [_255, 192, 203],\n  cyan: [0, _255, _255],\n  transparent: [_255, _255, _255, 0]\n},\n    // possible future idea to replace the hard-coded color name values - put this in the ticker.wake() where we set the _doc:\n// let ctx = _doc.createElement(\"canvas\").getContext(\"2d\");\n// _forEachName(\"aqua,lime,silver,black,maroon,teal,blue,navy,white,olive,yellow,orange,gray,purple,green,red,pink,cyan\", color => {ctx.fillStyle = color; _colorLookup[color] = splitColor(ctx.fillStyle)});\n_hue = function _hue(h, m1, m2) {\n  h += h < 0 ? 1 : h > 1 ? -1 : 0;\n  return (h * 6 < 1 ? m1 + (m2 - m1) * h * 6 : h < .5 ? m2 : h * 3 < 2 ? m1 + (m2 - m1) * (2 / 3 - h) * 6 : m1) * _255 + .5 | 0;\n},\n    splitColor = function splitColor(v, toHSL, forceAlpha) {\n  var a = !v ? _colorLookup.black : _isNumber(v) ? [v >> 16, v >> 8 & _255, v & _255] : 0,\n      r,\n      g,\n      b,\n      h,\n      s,\n      l,\n      max,\n      min,\n      d,\n      wasHSL;\n\n  if (!a) {\n    if (v.substr(-1) === \",\") {\n      //sometimes a trailing comma is included and we should chop it off (typically from a comma-delimited list of values like a textShadow:\"2px 2px 2px blue, 5px 5px 5px rgb(255,0,0)\" - in this example \"blue,\" has a trailing comma. We could strip it out inside parseComplex() but we'd need to do it to the beginning and ending values plus it wouldn't provide protection from other potential scenarios like if the user passes in a similar value.\n      v = v.substr(0, v.length - 1);\n    }\n\n    if (_colorLookup[v]) {\n      a = _colorLookup[v];\n    } else if (v.charAt(0) === \"#\") {\n      if (v.length < 6) {\n        //for shorthand like #9F0 or #9F0F (could have alpha)\n        r = v.charAt(1);\n        g = v.charAt(2);\n        b = v.charAt(3);\n        v = \"#\" + r + r + g + g + b + b + (v.length === 5 ? v.charAt(4) + v.charAt(4) : \"\");\n      }\n\n      if (v.length === 9) {\n        // hex with alpha, like #fd5e53ff\n        a = parseInt(v.substr(1, 6), 16);\n        return [a >> 16, a >> 8 & _255, a & _255, parseInt(v.substr(7), 16) / 255];\n      }\n\n      v = parseInt(v.substr(1), 16);\n      a = [v >> 16, v >> 8 & _255, v & _255];\n    } else if (v.substr(0, 3) === \"hsl\") {\n      a = wasHSL = v.match(_strictNumExp);\n\n      if (!toHSL) {\n        h = +a[0] % 360 / 360;\n        s = +a[1] / 100;\n        l = +a[2] / 100;\n        g = l <= .5 ? l * (s + 1) : l + s - l * s;\n        r = l * 2 - g;\n        a.length > 3 && (a[3] *= 1); //cast as number\n\n        a[0] = _hue(h + 1 / 3, r, g);\n        a[1] = _hue(h, r, g);\n        a[2] = _hue(h - 1 / 3, r, g);\n      } else if (~v.indexOf(\"=\")) {\n        //if relative values are found, just return the raw strings with the relative prefixes in place.\n        a = v.match(_numExp);\n        forceAlpha && a.length < 4 && (a[3] = 1);\n        return a;\n      }\n    } else {\n      a = v.match(_strictNumExp) || _colorLookup.transparent;\n    }\n\n    a = a.map(Number);\n  }\n\n  if (toHSL && !wasHSL) {\n    r = a[0] / _255;\n    g = a[1] / _255;\n    b = a[2] / _255;\n    max = Math.max(r, g, b);\n    min = Math.min(r, g, b);\n    l = (max + min) / 2;\n\n    if (max === min) {\n      h = s = 0;\n    } else {\n      d = max - min;\n      s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n      h = max === r ? (g - b) / d + (g < b ? 6 : 0) : max === g ? (b - r) / d + 2 : (r - g) / d + 4;\n      h *= 60;\n    }\n\n    a[0] = ~~(h + .5);\n    a[1] = ~~(s * 100 + .5);\n    a[2] = ~~(l * 100 + .5);\n  }\n\n  forceAlpha && a.length < 4 && (a[3] = 1);\n  return a;\n},\n    _colorOrderData = function _colorOrderData(v) {\n  // strips out the colors from the string, finds all the numeric slots (with units) and returns an array of those. The Array also has a \"c\" property which is an Array of the index values where the colors belong. This is to help work around issues where there's a mis-matched order of color/numeric data like drop-shadow(#f00 0px 1px 2px) and drop-shadow(0x 1px 2px #f00). This is basically a helper function used in _formatColors()\n  var values = [],\n      c = [],\n      i = -1;\n  v.split(_colorExp).forEach(function (v) {\n    var a = v.match(_numWithUnitExp) || [];\n    values.push.apply(values, a);\n    c.push(i += a.length + 1);\n  });\n  values.c = c;\n  return values;\n},\n    _formatColors = function _formatColors(s, toHSL, orderMatchData) {\n  var result = \"\",\n      colors = (s + result).match(_colorExp),\n      type = toHSL ? \"hsla(\" : \"rgba(\",\n      i = 0,\n      c,\n      shell,\n      d,\n      l;\n\n  if (!colors) {\n    return s;\n  }\n\n  colors = colors.map(function (color) {\n    return (color = splitColor(color, toHSL, 1)) && type + (toHSL ? color[0] + \",\" + color[1] + \"%,\" + color[2] + \"%,\" + color[3] : color.join(\",\")) + \")\";\n  });\n\n  if (orderMatchData) {\n    d = _colorOrderData(s);\n    c = orderMatchData.c;\n\n    if (c.join(result) !== d.c.join(result)) {\n      shell = s.replace(_colorExp, \"1\").split(_numWithUnitExp);\n      l = shell.length - 1;\n\n      for (; i < l; i++) {\n        result += shell[i] + (~c.indexOf(i) ? colors.shift() || type + \"0,0,0,0)\" : (d.length ? d : colors.length ? colors : orderMatchData).shift());\n      }\n    }\n  }\n\n  if (!shell) {\n    shell = s.split(_colorExp);\n    l = shell.length - 1;\n\n    for (; i < l; i++) {\n      result += shell[i] + colors[i];\n    }\n  }\n\n  return result + shell[l];\n},\n    _colorExp = function () {\n  var s = \"(?:\\\\b(?:(?:rgb|rgba|hsl|hsla)\\\\(.+?\\\\))|\\\\B#(?:[0-9a-f]{3,4}){1,2}\\\\b\",\n      //we'll dynamically build this Regular Expression to conserve file size. After building it, it will be able to find rgb(), rgba(), # (hexadecimal), and named color values like red, blue, purple, etc.,\n  p;\n\n  for (p in _colorLookup) {\n    s += \"|\" + p + \"\\\\b\";\n  }\n\n  return new RegExp(s + \")\", \"gi\");\n}(),\n    _hslExp = /hsl[a]?\\(/,\n    _colorStringFilter = function _colorStringFilter(a) {\n  var combined = a.join(\" \"),\n      toHSL;\n  _colorExp.lastIndex = 0;\n\n  if (_colorExp.test(combined)) {\n    toHSL = _hslExp.test(combined);\n    a[1] = _formatColors(a[1], toHSL);\n    a[0] = _formatColors(a[0], toHSL, _colorOrderData(a[1])); // make sure the order of numbers/colors match with the END value.\n\n    return true;\n  }\n},\n\n/*\n * --------------------------------------------------------------------------------------\n * TICKER\n * --------------------------------------------------------------------------------------\n */\n_tickerActive,\n    _ticker = function () {\n  var _getTime = Date.now,\n      _lagThreshold = 500,\n      _adjustedLag = 33,\n      _startTime = _getTime(),\n      _lastUpdate = _startTime,\n      _gap = 1000 / 240,\n      _nextTime = _gap,\n      _listeners = [],\n      _id,\n      _req,\n      _raf,\n      _self,\n      _delta,\n      _i,\n      _tick = function _tick(v) {\n    var elapsed = _getTime() - _lastUpdate,\n        manual = v === true,\n        overlap,\n        dispatch,\n        time,\n        frame;\n\n    (elapsed > _lagThreshold || elapsed < 0) && (_startTime += elapsed - _adjustedLag);\n    _lastUpdate += elapsed;\n    time = _lastUpdate - _startTime;\n    overlap = time - _nextTime;\n\n    if (overlap > 0 || manual) {\n      frame = ++_self.frame;\n      _delta = time - _self.time * 1000;\n      _self.time = time = time / 1000;\n      _nextTime += overlap + (overlap >= _gap ? 4 : _gap - overlap);\n      dispatch = 1;\n    }\n\n    manual || (_id = _req(_tick)); //make sure the request is made before we dispatch the \"tick\" event so that timing is maintained. Otherwise, if processing the \"tick\" requires a bunch of time (like 15ms) and we're using a setTimeout() that's based on 16.7ms, it'd technically take 31.7ms between frames otherwise.\n\n    if (dispatch) {\n      for (_i = 0; _i < _listeners.length; _i++) {\n        // use _i and check _listeners.length instead of a variable because a listener could get removed during the loop, and if that happens to an element less than the current index, it'd throw things off in the loop.\n        _listeners[_i](time, _delta, frame, v);\n      }\n    }\n  };\n\n  _self = {\n    time: 0,\n    frame: 0,\n    tick: function tick() {\n      _tick(true);\n    },\n    deltaRatio: function deltaRatio(fps) {\n      return _delta / (1000 / (fps || 60));\n    },\n    wake: function wake() {\n      if (_coreReady) {\n        if (!_coreInitted && _windowExists()) {\n          _win = _coreInitted = window;\n          _doc = _win.document || {};\n          _globals.gsap = gsap;\n          (_win.gsapVersions || (_win.gsapVersions = [])).push(gsap.version);\n\n          _install(_installScope || _win.GreenSockGlobals || !_win.gsap && _win || {});\n\n          _registerPluginQueue.forEach(_createPlugin);\n        }\n\n        _raf = typeof requestAnimationFrame !== \"undefined\" && requestAnimationFrame;\n        _id && _self.sleep();\n\n        _req = _raf || function (f) {\n          return setTimeout(f, _nextTime - _self.time * 1000 + 1 | 0);\n        };\n\n        _tickerActive = 1;\n\n        _tick(2);\n      }\n    },\n    sleep: function sleep() {\n      (_raf ? cancelAnimationFrame : clearTimeout)(_id);\n      _tickerActive = 0;\n      _req = _emptyFunc;\n    },\n    lagSmoothing: function lagSmoothing(threshold, adjustedLag) {\n      _lagThreshold = threshold || Infinity; // zero should be interpreted as basically unlimited\n\n      _adjustedLag = Math.min(adjustedLag || 33, _lagThreshold);\n    },\n    fps: function fps(_fps) {\n      _gap = 1000 / (_fps || 240);\n      _nextTime = _self.time * 1000 + _gap;\n    },\n    add: function add(callback, once, prioritize) {\n      var func = once ? function (t, d, f, v) {\n        callback(t, d, f, v);\n\n        _self.remove(func);\n      } : callback;\n\n      _self.remove(callback);\n\n      _listeners[prioritize ? \"unshift\" : \"push\"](func);\n\n      _wake();\n\n      return func;\n    },\n    remove: function remove(callback, i) {\n      ~(i = _listeners.indexOf(callback)) && _listeners.splice(i, 1) && _i >= i && _i--;\n    },\n    _listeners: _listeners\n  };\n  return _self;\n}(),\n    _wake = function _wake() {\n  return !_tickerActive && _ticker.wake();\n},\n    //also ensures the core classes are initialized.\n\n/*\n* -------------------------------------------------\n* EASING\n* -------------------------------------------------\n*/\n_easeMap = {},\n    _customEaseExp = /^[\\d.\\-M][\\d.\\-,\\s]/,\n    _quotesExp = /[\"']/g,\n    _parseObjectInString = function _parseObjectInString(value) {\n  //takes a string like \"{wiggles:10, type:anticipate})\" and turns it into a real object. Notice it ends in \")\" and includes the {} wrappers. This is because we only use this function for parsing ease configs and prioritized optimization rather than reusability.\n  var obj = {},\n      split = value.substr(1, value.length - 3).split(\":\"),\n      key = split[0],\n      i = 1,\n      l = split.length,\n      index,\n      val,\n      parsedVal;\n\n  for (; i < l; i++) {\n    val = split[i];\n    index = i !== l - 1 ? val.lastIndexOf(\",\") : val.length;\n    parsedVal = val.substr(0, index);\n    obj[key] = isNaN(parsedVal) ? parsedVal.replace(_quotesExp, \"\").trim() : +parsedVal;\n    key = val.substr(index + 1).trim();\n  }\n\n  return obj;\n},\n    _valueInParentheses = function _valueInParentheses(value) {\n  var open = value.indexOf(\"(\") + 1,\n      close = value.indexOf(\")\"),\n      nested = value.indexOf(\"(\", open);\n  return value.substring(open, ~nested && nested < close ? value.indexOf(\")\", close + 1) : close);\n},\n    _configEaseFromString = function _configEaseFromString(name) {\n  //name can be a string like \"elastic.out(1,0.5)\", and pass in _easeMap as obj and it'll parse it out and call the actual function like _easeMap.Elastic.easeOut.config(1,0.5). It will also parse custom ease strings as long as CustomEase is loaded and registered (internally as _easeMap._CE).\n  var split = (name + \"\").split(\"(\"),\n      ease = _easeMap[split[0]];\n  return ease && split.length > 1 && ease.config ? ease.config.apply(null, ~name.indexOf(\"{\") ? [_parseObjectInString(split[1])] : _valueInParentheses(name).split(\",\").map(_numericIfPossible)) : _easeMap._CE && _customEaseExp.test(name) ? _easeMap._CE(\"\", name) : ease;\n},\n    _invertEase = function _invertEase(ease) {\n  return function (p) {\n    return 1 - ease(1 - p);\n  };\n},\n    // allow yoyoEase to be set in children and have those affected when the parent/ancestor timeline yoyos.\n_propagateYoyoEase = function _propagateYoyoEase(timeline, isYoyo) {\n  var child = timeline._first,\n      ease;\n\n  while (child) {\n    if (child instanceof Timeline) {\n      _propagateYoyoEase(child, isYoyo);\n    } else if (child.vars.yoyoEase && (!child._yoyo || !child._repeat) && child._yoyo !== isYoyo) {\n      if (child.timeline) {\n        _propagateYoyoEase(child.timeline, isYoyo);\n      } else {\n        ease = child._ease;\n        child._ease = child._yEase;\n        child._yEase = ease;\n        child._yoyo = isYoyo;\n      }\n    }\n\n    child = child._next;\n  }\n},\n    _parseEase = function _parseEase(ease, defaultEase) {\n  return !ease ? defaultEase : (_isFunction(ease) ? ease : _easeMap[ease] || _configEaseFromString(ease)) || defaultEase;\n},\n    _insertEase = function _insertEase(names, easeIn, easeOut, easeInOut) {\n  if (easeOut === void 0) {\n    easeOut = function easeOut(p) {\n      return 1 - easeIn(1 - p);\n    };\n  }\n\n  if (easeInOut === void 0) {\n    easeInOut = function easeInOut(p) {\n      return p < .5 ? easeIn(p * 2) / 2 : 1 - easeIn((1 - p) * 2) / 2;\n    };\n  }\n\n  var ease = {\n    easeIn: easeIn,\n    easeOut: easeOut,\n    easeInOut: easeInOut\n  },\n      lowercaseName;\n\n  _forEachName(names, function (name) {\n    _easeMap[name] = _globals[name] = ease;\n    _easeMap[lowercaseName = name.toLowerCase()] = easeOut;\n\n    for (var p in ease) {\n      _easeMap[lowercaseName + (p === \"easeIn\" ? \".in\" : p === \"easeOut\" ? \".out\" : \".inOut\")] = _easeMap[name + \".\" + p] = ease[p];\n    }\n  });\n\n  return ease;\n},\n    _easeInOutFromOut = function _easeInOutFromOut(easeOut) {\n  return function (p) {\n    return p < .5 ? (1 - easeOut(1 - p * 2)) / 2 : .5 + easeOut((p - .5) * 2) / 2;\n  };\n},\n    _configElastic = function _configElastic(type, amplitude, period) {\n  var p1 = amplitude >= 1 ? amplitude : 1,\n      //note: if amplitude is < 1, we simply adjust the period for a more natural feel. Otherwise the math doesn't work right and the curve starts at 1.\n  p2 = (period || (type ? .3 : .45)) / (amplitude < 1 ? amplitude : 1),\n      p3 = p2 / _2PI * (Math.asin(1 / p1) || 0),\n      easeOut = function easeOut(p) {\n    return p === 1 ? 1 : p1 * Math.pow(2, -10 * p) * _sin((p - p3) * p2) + 1;\n  },\n      ease = type === \"out\" ? easeOut : type === \"in\" ? function (p) {\n    return 1 - easeOut(1 - p);\n  } : _easeInOutFromOut(easeOut);\n\n  p2 = _2PI / p2; //precalculate to optimize\n\n  ease.config = function (amplitude, period) {\n    return _configElastic(type, amplitude, period);\n  };\n\n  return ease;\n},\n    _configBack = function _configBack(type, overshoot) {\n  if (overshoot === void 0) {\n    overshoot = 1.70158;\n  }\n\n  var easeOut = function easeOut(p) {\n    return p ? --p * p * ((overshoot + 1) * p + overshoot) + 1 : 0;\n  },\n      ease = type === \"out\" ? easeOut : type === \"in\" ? function (p) {\n    return 1 - easeOut(1 - p);\n  } : _easeInOutFromOut(easeOut);\n\n  ease.config = function (overshoot) {\n    return _configBack(type, overshoot);\n  };\n\n  return ease;\n}; // a cheaper (kb and cpu) but more mild way to get a parameterized weighted ease by feeding in a value between -1 (easeIn) and 1 (easeOut) where 0 is linear.\n// _weightedEase = ratio => {\n// \tlet y = 0.5 + ratio / 2;\n// \treturn p => (2 * (1 - p) * p * y + p * p);\n// },\n// a stronger (but more expensive kb/cpu) parameterized weighted ease that lets you feed in a value between -1 (easeIn) and 1 (easeOut) where 0 is linear.\n// _weightedEaseStrong = ratio => {\n// \tratio = .5 + ratio / 2;\n// \tlet o = 1 / 3 * (ratio < .5 ? ratio : 1 - ratio),\n// \t\tb = ratio - o,\n// \t\tc = ratio + o;\n// \treturn p => p === 1 ? p : 3 * b * (1 - p) * (1 - p) * p + 3 * c * (1 - p) * p * p + p * p * p;\n// };\n\n\n_forEachName(\"Linear,Quad,Cubic,Quart,Quint,Strong\", function (name, i) {\n  var power = i < 5 ? i + 1 : i;\n\n  _insertEase(name + \",Power\" + (power - 1), i ? function (p) {\n    return Math.pow(p, power);\n  } : function (p) {\n    return p;\n  }, function (p) {\n    return 1 - Math.pow(1 - p, power);\n  }, function (p) {\n    return p < .5 ? Math.pow(p * 2, power) / 2 : 1 - Math.pow((1 - p) * 2, power) / 2;\n  });\n});\n\n_easeMap.Linear.easeNone = _easeMap.none = _easeMap.Linear.easeIn;\n\n_insertEase(\"Elastic\", _configElastic(\"in\"), _configElastic(\"out\"), _configElastic());\n\n(function (n, c) {\n  var n1 = 1 / c,\n      n2 = 2 * n1,\n      n3 = 2.5 * n1,\n      easeOut = function easeOut(p) {\n    return p < n1 ? n * p * p : p < n2 ? n * Math.pow(p - 1.5 / c, 2) + .75 : p < n3 ? n * (p -= 2.25 / c) * p + .9375 : n * Math.pow(p - 2.625 / c, 2) + .984375;\n  };\n\n  _insertEase(\"Bounce\", function (p) {\n    return 1 - easeOut(1 - p);\n  }, easeOut);\n})(7.5625, 2.75);\n\n_insertEase(\"Expo\", function (p) {\n  return Math.pow(2, 10 * (p - 1)) * p + p * p * p * p * p * p * (1 - p);\n}); // previously 2 ** (10 * (p - 1)) but that doesn't end up with the value quite at the right spot so we do a blended ease to ensure it lands where it should perfectly.\n\n\n_insertEase(\"Circ\", function (p) {\n  return -(_sqrt(1 - p * p) - 1);\n});\n\n_insertEase(\"Sine\", function (p) {\n  return p === 1 ? 1 : -_cos(p * _HALF_PI) + 1;\n});\n\n_insertEase(\"Back\", _configBack(\"in\"), _configBack(\"out\"), _configBack());\n\n_easeMap.SteppedEase = _easeMap.steps = _globals.SteppedEase = {\n  config: function config(steps, immediateStart) {\n    if (steps === void 0) {\n      steps = 1;\n    }\n\n    var p1 = 1 / steps,\n        p2 = steps + (immediateStart ? 0 : 1),\n        p3 = immediateStart ? 1 : 0,\n        max = 1 - _tinyNum;\n    return function (p) {\n      return ((p2 * _clamp(0, max, p) | 0) + p3) * p1;\n    };\n  }\n};\n_defaults.ease = _easeMap[\"quad.out\"];\n\n_forEachName(\"onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt\", function (name) {\n  return _callbackNames += name + \",\" + name + \"Params,\";\n});\n/*\n * --------------------------------------------------------------------------------------\n * CACHE\n * --------------------------------------------------------------------------------------\n */\n\n\nexport var GSCache = function GSCache(target, harness) {\n  this.id = _gsID++;\n  target._gsap = this;\n  this.target = target;\n  this.harness = harness;\n  this.get = harness ? harness.get : _getProperty;\n  this.set = harness ? harness.getSetter : _getSetter;\n};\n/*\n * --------------------------------------------------------------------------------------\n * ANIMATION\n * --------------------------------------------------------------------------------------\n */\n\nexport var Animation = /*#__PURE__*/function () {\n  function Animation(vars) {\n    this.vars = vars;\n    this._delay = +vars.delay || 0;\n\n    if (this._repeat = vars.repeat === Infinity ? -2 : vars.repeat || 0) {\n      // TODO: repeat: Infinity on a timeline's children must flag that timeline internally and affect its totalDuration, otherwise it'll stop in the negative direction when reaching the start.\n      this._rDelay = vars.repeatDelay || 0;\n      this._yoyo = !!vars.yoyo || !!vars.yoyoEase;\n    }\n\n    this._ts = 1;\n\n    _setDuration(this, +vars.duration, 1, 1);\n\n    this.data = vars.data;\n\n    if (_context) {\n      this._ctx = _context;\n\n      _context.data.push(this);\n    }\n\n    _tickerActive || _ticker.wake();\n  }\n\n  var _proto = Animation.prototype;\n\n  _proto.delay = function delay(value) {\n    if (value || value === 0) {\n      this.parent && this.parent.smoothChildTiming && this.startTime(this._start + value - this._delay);\n      this._delay = value;\n      return this;\n    }\n\n    return this._delay;\n  };\n\n  _proto.duration = function duration(value) {\n    return arguments.length ? this.totalDuration(this._repeat > 0 ? value + (value + this._rDelay) * this._repeat : value) : this.totalDuration() && this._dur;\n  };\n\n  _proto.totalDuration = function totalDuration(value) {\n    if (!arguments.length) {\n      return this._tDur;\n    }\n\n    this._dirty = 0;\n    return _setDuration(this, this._repeat < 0 ? value : (value - this._repeat * this._rDelay) / (this._repeat + 1));\n  };\n\n  _proto.totalTime = function totalTime(_totalTime, suppressEvents) {\n    _wake();\n\n    if (!arguments.length) {\n      return this._tTime;\n    }\n\n    var parent = this._dp;\n\n    if (parent && parent.smoothChildTiming && this._ts) {\n      _alignPlayhead(this, _totalTime);\n\n      !parent._dp || parent.parent || _postAddChecks(parent, this); // edge case: if this is a child of a timeline that already completed, for example, we must re-activate the parent.\n      //in case any of the ancestor timelines had completed but should now be enabled, we should reset their totalTime() which will also ensure that they're lined up properly and enabled. Skip for animations that are on the root (wasteful). Example: a TimelineLite.exportRoot() is performed when there's a paused tween on the root, the export will not complete until that tween is unpaused, but imagine a child gets restarted later, after all [unpaused] tweens have completed. The start of that child would get pushed out, but one of the ancestors may have completed.\n\n      while (parent && parent.parent) {\n        if (parent.parent._time !== parent._start + (parent._ts >= 0 ? parent._tTime / parent._ts : (parent.totalDuration() - parent._tTime) / -parent._ts)) {\n          parent.totalTime(parent._tTime, true);\n        }\n\n        parent = parent.parent;\n      }\n\n      if (!this.parent && this._dp.autoRemoveChildren && (this._ts > 0 && _totalTime < this._tDur || this._ts < 0 && _totalTime > 0 || !this._tDur && !_totalTime)) {\n        //if the animation doesn't have a parent, put it back into its last parent (recorded as _dp for exactly cases like this). Limit to parents with autoRemoveChildren (like globalTimeline) so that if the user manually removes an animation from a timeline and then alters its playhead, it doesn't get added back in.\n        _addToTimeline(this._dp, this, this._start - this._delay);\n      }\n    }\n\n    if (this._tTime !== _totalTime || !this._dur && !suppressEvents || this._initted && Math.abs(this._zTime) === _tinyNum || !_totalTime && !this._initted && (this.add || this._ptLookup)) {\n      // check for _ptLookup on a Tween instance to ensure it has actually finished being instantiated, otherwise if this.reverse() gets called in the Animation constructor, it could trigger a render() here even though the _targets weren't populated, thus when _init() is called there won't be any PropTweens (it'll act like the tween is non-functional)\n      this._ts || (this._pTime = _totalTime); // otherwise, if an animation is paused, then the playhead is moved back to zero, then resumed, it'd revert back to the original time at the pause\n      //if (!this._lock) { // avoid endless recursion (not sure we need this yet or if it's worth the performance hit)\n      //   this._lock = 1;\n\n      _lazySafeRender(this, _totalTime, suppressEvents); //   this._lock = 0;\n      //}\n\n    }\n\n    return this;\n  };\n\n  _proto.time = function time(value, suppressEvents) {\n    return arguments.length ? this.totalTime(Math.min(this.totalDuration(), value + _elapsedCycleDuration(this)) % (this._dur + this._rDelay) || (value ? this._dur : 0), suppressEvents) : this._time; // note: if the modulus results in 0, the playhead could be exactly at the end or the beginning, and we always defer to the END with a non-zero value, otherwise if you set the time() to the very end (duration()), it would render at the START!\n  };\n\n  _proto.totalProgress = function totalProgress(value, suppressEvents) {\n    return arguments.length ? this.totalTime(this.totalDuration() * value, suppressEvents) : this.totalDuration() ? Math.min(1, this._tTime / this._tDur) : this.rawTime() >= 0 && this._initted ? 1 : 0;\n  };\n\n  _proto.progress = function progress(value, suppressEvents) {\n    return arguments.length ? this.totalTime(this.duration() * (this._yoyo && !(this.iteration() & 1) ? 1 - value : value) + _elapsedCycleDuration(this), suppressEvents) : this.duration() ? Math.min(1, this._time / this._dur) : this.rawTime() > 0 ? 1 : 0;\n  };\n\n  _proto.iteration = function iteration(value, suppressEvents) {\n    var cycleDuration = this.duration() + this._rDelay;\n\n    return arguments.length ? this.totalTime(this._time + (value - 1) * cycleDuration, suppressEvents) : this._repeat ? _animationCycle(this._tTime, cycleDuration) + 1 : 1;\n  } // potential future addition:\n  // isPlayingBackwards() {\n  // \tlet animation = this,\n  // \t\torientation = 1; // 1 = forward, -1 = backward\n  // \twhile (animation) {\n  // \t\torientation *= animation.reversed() || (animation.repeat() && !(animation.iteration() & 1)) ? -1 : 1;\n  // \t\tanimation = animation.parent;\n  // \t}\n  // \treturn orientation < 0;\n  // }\n  ;\n\n  _proto.timeScale = function timeScale(value, suppressEvents) {\n    if (!arguments.length) {\n      return this._rts === -_tinyNum ? 0 : this._rts; // recorded timeScale. Special case: if someone calls reverse() on an animation with timeScale of 0, we assign it -_tinyNum to remember it's reversed.\n    }\n\n    if (this._rts === value) {\n      return this;\n    }\n\n    var tTime = this.parent && this._ts ? _parentToChildTotalTime(this.parent._time, this) : this._tTime; // make sure to do the parentToChildTotalTime() BEFORE setting the new _ts because the old one must be used in that calculation.\n    // future addition? Up side: fast and minimal file size. Down side: only works on this animation; if a timeline is reversed, for example, its childrens' onReverse wouldn't get called.\n    //(+value < 0 && this._rts >= 0) && _callback(this, \"onReverse\", true);\n    // prioritize rendering where the parent's playhead lines up instead of this._tTime because there could be a tween that's animating another tween's timeScale in the same rendering loop (same parent), thus if the timeScale tween renders first, it would alter _start BEFORE _tTime was set on that tick (in the rendering loop), effectively freezing it until the timeScale tween finishes.\n\n    this._rts = +value || 0;\n    this._ts = this._ps || value === -_tinyNum ? 0 : this._rts; // _ts is the functional timeScale which would be 0 if the animation is paused.\n\n    this.totalTime(_clamp(-Math.abs(this._delay), this._tDur, tTime), suppressEvents !== false);\n\n    _setEnd(this); // if parent.smoothChildTiming was false, the end time didn't get updated in the _alignPlayhead() method, so do it here.\n\n\n    return _recacheAncestors(this);\n  };\n\n  _proto.paused = function paused(value) {\n    if (!arguments.length) {\n      return this._ps;\n    } // possible future addition - if an animation is removed from its parent and then .restart() or .play() or .resume() is called, perhaps we should force it back into the globalTimeline but be careful because what if it's already at its end? We don't want it to just persist forever and not get released for GC.\n    // !this.parent && !value && this._tTime < this._tDur && this !== _globalTimeline && _globalTimeline.add(this);\n\n\n    if (this._ps !== value) {\n      this._ps = value;\n\n      if (value) {\n        this._pTime = this._tTime || Math.max(-this._delay, this.rawTime()); // if the pause occurs during the delay phase, make sure that's factored in when resuming.\n\n        this._ts = this._act = 0; // _ts is the functional timeScale, so a paused tween would effectively have a timeScale of 0. We record the \"real\" timeScale as _rts (recorded time scale)\n      } else {\n        _wake();\n\n        this._ts = this._rts; //only defer to _pTime (pauseTime) if tTime is zero. Remember, someone could pause() an animation, then scrub the playhead and resume(). If the parent doesn't have smoothChildTiming, we render at the rawTime() because the startTime won't get updated.\n\n        this.totalTime(this.parent && !this.parent.smoothChildTiming ? this.rawTime() : this._tTime || this._pTime, this.progress() === 1 && Math.abs(this._zTime) !== _tinyNum && (this._tTime -= _tinyNum)); // edge case: animation.progress(1).pause().play() wouldn't render again because the playhead is already at the end, but the call to totalTime() below will add it back to its parent...and not remove it again (since removing only happens upon rendering at a new time). Offsetting the _tTime slightly is done simply to cause the final render in totalTime() that'll pop it off its timeline (if autoRemoveChildren is true, of course). Check to make sure _zTime isn't -_tinyNum to avoid an edge case where the playhead is pushed to the end but INSIDE a tween/callback, the timeline itself is paused thus halting rendering and leaving a few unrendered. When resuming, it wouldn't render those otherwise.\n      }\n    }\n\n    return this;\n  };\n\n  _proto.startTime = function startTime(value) {\n    if (arguments.length) {\n      this._start = value;\n      var parent = this.parent || this._dp;\n      parent && (parent._sort || !this.parent) && _addToTimeline(parent, this, value - this._delay);\n      return this;\n    }\n\n    return this._start;\n  };\n\n  _proto.endTime = function endTime(includeRepeats) {\n    return this._start + (_isNotFalse(includeRepeats) ? this.totalDuration() : this.duration()) / Math.abs(this._ts || 1);\n  };\n\n  _proto.rawTime = function rawTime(wrapRepeats) {\n    var parent = this.parent || this._dp; // _dp = detached parent\n\n    return !parent ? this._tTime : wrapRepeats && (!this._ts || this._repeat && this._time && this.totalProgress() < 1) ? this._tTime % (this._dur + this._rDelay) : !this._ts ? this._tTime : _parentToChildTotalTime(parent.rawTime(wrapRepeats), this);\n  };\n\n  _proto.revert = function revert(config) {\n    if (config === void 0) {\n      config = _revertConfig;\n    }\n\n    var prevIsReverting = _reverting;\n    _reverting = config;\n\n    if (this._initted || this._startAt) {\n      this.timeline && this.timeline.revert(config);\n      this.totalTime(-0.01, config.suppressEvents);\n    }\n\n    this.data !== \"nested\" && config.kill !== false && this.kill();\n    _reverting = prevIsReverting;\n    return this;\n  };\n\n  _proto.globalTime = function globalTime(rawTime) {\n    var animation = this,\n        time = arguments.length ? rawTime : animation.rawTime();\n\n    while (animation) {\n      time = animation._start + time / (Math.abs(animation._ts) || 1);\n      animation = animation._dp;\n    }\n\n    return !this.parent && this._sat ? this._sat.globalTime(rawTime) : time; // the _startAt tweens for .fromTo() and .from() that have immediateRender should always be FIRST in the timeline (important for context.revert()). \"_sat\" stands for _startAtTween, referring to the parent tween that created the _startAt. We must discern if that tween had immediateRender so that we can know whether or not to prioritize it in revert().\n  };\n\n  _proto.repeat = function repeat(value) {\n    if (arguments.length) {\n      this._repeat = value === Infinity ? -2 : value;\n      return _onUpdateTotalDuration(this);\n    }\n\n    return this._repeat === -2 ? Infinity : this._repeat;\n  };\n\n  _proto.repeatDelay = function repeatDelay(value) {\n    if (arguments.length) {\n      var time = this._time;\n      this._rDelay = value;\n\n      _onUpdateTotalDuration(this);\n\n      return time ? this.time(time) : this;\n    }\n\n    return this._rDelay;\n  };\n\n  _proto.yoyo = function yoyo(value) {\n    if (arguments.length) {\n      this._yoyo = value;\n      return this;\n    }\n\n    return this._yoyo;\n  };\n\n  _proto.seek = function seek(position, suppressEvents) {\n    return this.totalTime(_parsePosition(this, position), _isNotFalse(suppressEvents));\n  };\n\n  _proto.restart = function restart(includeDelay, suppressEvents) {\n    this.play().totalTime(includeDelay ? -this._delay : 0, _isNotFalse(suppressEvents));\n    this._dur || (this._zTime = -_tinyNum); // ensures onComplete fires on a zero-duration animation that gets restarted.\n\n    return this;\n  };\n\n  _proto.play = function play(from, suppressEvents) {\n    from != null && this.seek(from, suppressEvents);\n    return this.reversed(false).paused(false);\n  };\n\n  _proto.reverse = function reverse(from, suppressEvents) {\n    from != null && this.seek(from || this.totalDuration(), suppressEvents);\n    return this.reversed(true).paused(false);\n  };\n\n  _proto.pause = function pause(atTime, suppressEvents) {\n    atTime != null && this.seek(atTime, suppressEvents);\n    return this.paused(true);\n  };\n\n  _proto.resume = function resume() {\n    return this.paused(false);\n  };\n\n  _proto.reversed = function reversed(value) {\n    if (arguments.length) {\n      !!value !== this.reversed() && this.timeScale(-this._rts || (value ? -_tinyNum : 0)); // in case timeScale is zero, reversing would have no effect so we use _tinyNum.\n\n      return this;\n    }\n\n    return this._rts < 0;\n  };\n\n  _proto.invalidate = function invalidate() {\n    this._initted = this._act = 0;\n    this._zTime = -_tinyNum;\n    return this;\n  };\n\n  _proto.isActive = function isActive() {\n    var parent = this.parent || this._dp,\n        start = this._start,\n        rawTime;\n    return !!(!parent || this._ts && this._initted && parent.isActive() && (rawTime = parent.rawTime(true)) >= start && rawTime < this.endTime(true) - _tinyNum);\n  };\n\n  _proto.eventCallback = function eventCallback(type, callback, params) {\n    var vars = this.vars;\n\n    if (arguments.length > 1) {\n      if (!callback) {\n        delete vars[type];\n      } else {\n        vars[type] = callback;\n        params && (vars[type + \"Params\"] = params);\n        type === \"onUpdate\" && (this._onUpdate = callback);\n      }\n\n      return this;\n    }\n\n    return vars[type];\n  };\n\n  _proto.then = function then(onFulfilled) {\n    var self = this;\n    return new Promise(function (resolve) {\n      var f = _isFunction(onFulfilled) ? onFulfilled : _passThrough,\n          _resolve = function _resolve() {\n        var _then = self.then;\n        self.then = null; // temporarily null the then() method to avoid an infinite loop (see https://github.com/greensock/GSAP/issues/322)\n\n        _isFunction(f) && (f = f(self)) && (f.then || f === self) && (self.then = _then);\n        resolve(f);\n        self.then = _then;\n      };\n\n      if (self._initted && self.totalProgress() === 1 && self._ts >= 0 || !self._tTime && self._ts < 0) {\n        _resolve();\n      } else {\n        self._prom = _resolve;\n      }\n    });\n  };\n\n  _proto.kill = function kill() {\n    _interrupt(this);\n  };\n\n  return Animation;\n}();\n\n_setDefaults(Animation.prototype, {\n  _time: 0,\n  _start: 0,\n  _end: 0,\n  _tTime: 0,\n  _tDur: 0,\n  _dirty: 0,\n  _repeat: 0,\n  _yoyo: false,\n  parent: null,\n  _initted: false,\n  _rDelay: 0,\n  _ts: 1,\n  _dp: 0,\n  ratio: 0,\n  _zTime: -_tinyNum,\n  _prom: 0,\n  _ps: false,\n  _rts: 1\n});\n/*\n * -------------------------------------------------\n * TIMELINE\n * -------------------------------------------------\n */\n\n\nexport var Timeline = /*#__PURE__*/function (_Animation) {\n  _inheritsLoose(Timeline, _Animation);\n\n  function Timeline(vars, position) {\n    var _this;\n\n    if (vars === void 0) {\n      vars = {};\n    }\n\n    _this = _Animation.call(this, vars) || this;\n    _this.labels = {};\n    _this.smoothChildTiming = !!vars.smoothChildTiming;\n    _this.autoRemoveChildren = !!vars.autoRemoveChildren;\n    _this._sort = _isNotFalse(vars.sortChildren);\n    _globalTimeline && _addToTimeline(vars.parent || _globalTimeline, _assertThisInitialized(_this), position);\n    vars.reversed && _this.reverse();\n    vars.paused && _this.paused(true);\n    vars.scrollTrigger && _scrollTrigger(_assertThisInitialized(_this), vars.scrollTrigger);\n    return _this;\n  }\n\n  var _proto2 = Timeline.prototype;\n\n  _proto2.to = function to(targets, vars, position) {\n    _createTweenType(0, arguments, this);\n\n    return this;\n  };\n\n  _proto2.from = function from(targets, vars, position) {\n    _createTweenType(1, arguments, this);\n\n    return this;\n  };\n\n  _proto2.fromTo = function fromTo(targets, fromVars, toVars, position) {\n    _createTweenType(2, arguments, this);\n\n    return this;\n  };\n\n  _proto2.set = function set(targets, vars, position) {\n    vars.duration = 0;\n    vars.parent = this;\n    _inheritDefaults(vars).repeatDelay || (vars.repeat = 0);\n    vars.immediateRender = !!vars.immediateRender;\n    new Tween(targets, vars, _parsePosition(this, position), 1);\n    return this;\n  };\n\n  _proto2.call = function call(callback, params, position) {\n    return _addToTimeline(this, Tween.delayedCall(0, callback, params), position);\n  } //ONLY for backward compatibility! Maybe delete?\n  ;\n\n  _proto2.staggerTo = function staggerTo(targets, duration, vars, stagger, position, onCompleteAll, onCompleteAllParams) {\n    vars.duration = duration;\n    vars.stagger = vars.stagger || stagger;\n    vars.onComplete = onCompleteAll;\n    vars.onCompleteParams = onCompleteAllParams;\n    vars.parent = this;\n    new Tween(targets, vars, _parsePosition(this, position));\n    return this;\n  };\n\n  _proto2.staggerFrom = function staggerFrom(targets, duration, vars, stagger, position, onCompleteAll, onCompleteAllParams) {\n    vars.runBackwards = 1;\n    _inheritDefaults(vars).immediateRender = _isNotFalse(vars.immediateRender);\n    return this.staggerTo(targets, duration, vars, stagger, position, onCompleteAll, onCompleteAllParams);\n  };\n\n  _proto2.staggerFromTo = function staggerFromTo(targets, duration, fromVars, toVars, stagger, position, onCompleteAll, onCompleteAllParams) {\n    toVars.startAt = fromVars;\n    _inheritDefaults(toVars).immediateRender = _isNotFalse(toVars.immediateRender);\n    return this.staggerTo(targets, duration, toVars, stagger, position, onCompleteAll, onCompleteAllParams);\n  };\n\n  _proto2.render = function render(totalTime, suppressEvents, force) {\n    var prevTime = this._time,\n        tDur = this._dirty ? this.totalDuration() : this._tDur,\n        dur = this._dur,\n        tTime = totalTime <= 0 ? 0 : _roundPrecise(totalTime),\n        // if a paused timeline is resumed (or its _start is updated for another reason...which rounds it), that could result in the playhead shifting a **tiny** amount and a zero-duration child at that spot may get rendered at a different ratio, like its totalTime in render() may be 1e-17 instead of 0, for example.\n    crossingStart = this._zTime < 0 !== totalTime < 0 && (this._initted || !dur),\n        time,\n        child,\n        next,\n        iteration,\n        cycleDuration,\n        prevPaused,\n        pauseTween,\n        timeScale,\n        prevStart,\n        prevIteration,\n        yoyo,\n        isYoyo;\n    this !== _globalTimeline && tTime > tDur && totalTime >= 0 && (tTime = tDur);\n\n    if (tTime !== this._tTime || force || crossingStart) {\n      if (prevTime !== this._time && dur) {\n        //if totalDuration() finds a child with a negative startTime and smoothChildTiming is true, things get shifted around internally so we need to adjust the time accordingly. For example, if a tween starts at -30 we must shift EVERYTHING forward 30 seconds and move this timeline's startTime backward by 30 seconds so that things align with the playhead (no jump).\n        tTime += this._time - prevTime;\n        totalTime += this._time - prevTime;\n      }\n\n      time = tTime;\n      prevStart = this._start;\n      timeScale = this._ts;\n      prevPaused = !timeScale;\n\n      if (crossingStart) {\n        dur || (prevTime = this._zTime); //when the playhead arrives at EXACTLY time 0 (right on top) of a zero-duration timeline, we need to discern if events are suppressed so that when the playhead moves again (next time), it'll trigger the callback. If events are NOT suppressed, obviously the callback would be triggered in this render. Basically, the callback should fire either when the playhead ARRIVES or LEAVES this exact spot, not both. Imagine doing a timeline.seek(0) and there's a callback that sits at 0. Since events are suppressed on that seek() by default, nothing will fire, but when the playhead moves off of that position, the callback should fire. This behavior is what people intuitively expect.\n\n        (totalTime || !suppressEvents) && (this._zTime = totalTime);\n      }\n\n      if (this._repeat) {\n        //adjust the time for repeats and yoyos\n        yoyo = this._yoyo;\n        cycleDuration = dur + this._rDelay;\n\n        if (this._repeat < -1 && totalTime < 0) {\n          return this.totalTime(cycleDuration * 100 + totalTime, suppressEvents, force);\n        }\n\n        time = _roundPrecise(tTime % cycleDuration); //round to avoid floating point errors. (4 % 0.8 should be 0 but some browsers report it as 0.79999999!)\n\n        if (tTime === tDur) {\n          // the tDur === tTime is for edge cases where there's a lengthy decimal on the duration and it may reach the very end but the time is rendered as not-quite-there (remember, tDur is rounded to 4 decimals whereas dur isn't)\n          iteration = this._repeat;\n          time = dur;\n        } else {\n          prevIteration = _roundPrecise(tTime / cycleDuration); // full decimal version of iterations, not the previous iteration (we're reusing prevIteration variable for efficiency)\n\n          iteration = ~~prevIteration;\n\n          if (iteration && iteration === prevIteration) {\n            time = dur;\n            iteration--;\n          }\n\n          time > dur && (time = dur);\n        }\n\n        prevIteration = _animationCycle(this._tTime, cycleDuration);\n        !prevTime && this._tTime && prevIteration !== iteration && this._tTime - prevIteration * cycleDuration - this._dur <= 0 && (prevIteration = iteration); // edge case - if someone does addPause() at the very beginning of a repeating timeline, that pause is technically at the same spot as the end which causes this._time to get set to 0 when the totalTime would normally place the playhead at the end. See https://gsap.com/forums/topic/23823-closing-nav-animation-not-working-on-ie-and-iphone-6-maybe-other-older-browser/?tab=comments#comment-113005 also, this._tTime - prevIteration * cycleDuration - this._dur <= 0 just checks to make sure it wasn't previously in the \"repeatDelay\" portion\n\n        if (yoyo && iteration & 1) {\n          time = dur - time;\n          isYoyo = 1;\n        }\n        /*\n        make sure children at the end/beginning of the timeline are rendered properly. If, for example,\n        a 3-second long timeline rendered at 2.9 seconds previously, and now renders at 3.2 seconds (which\n        would get translated to 2.8 seconds if the timeline yoyos or 0.2 seconds if it just repeats), there\n        could be a callback or a short tween that's at 2.95 or 3 seconds in which wouldn't render. So\n        we need to push the timeline to the end (and/or beginning depending on its yoyo value). Also we must\n        ensure that zero-duration tweens at the very beginning or end of the Timeline work.\n        */\n\n\n        if (iteration !== prevIteration && !this._lock) {\n          var rewinding = yoyo && prevIteration & 1,\n              doesWrap = rewinding === (yoyo && iteration & 1);\n          iteration < prevIteration && (rewinding = !rewinding);\n          prevTime = rewinding ? 0 : tTime % dur ? dur : tTime; // if the playhead is landing exactly at the end of an iteration, use that totalTime rather than only the duration, otherwise it'll skip the 2nd render since it's effectively at the same time.\n\n          this._lock = 1;\n          this.render(prevTime || (isYoyo ? 0 : _roundPrecise(iteration * cycleDuration)), suppressEvents, !dur)._lock = 0;\n          this._tTime = tTime; // if a user gets the iteration() inside the onRepeat, for example, it should be accurate.\n\n          !suppressEvents && this.parent && _callback(this, \"onRepeat\");\n          this.vars.repeatRefresh && !isYoyo && (this.invalidate()._lock = 1);\n\n          if (prevTime && prevTime !== this._time || prevPaused !== !this._ts || this.vars.onRepeat && !this.parent && !this._act) {\n            // if prevTime is 0 and we render at the very end, _time will be the end, thus won't match. So in this edge case, prevTime won't match _time but that's okay. If it gets killed in the onRepeat, eject as well.\n            return this;\n          }\n\n          dur = this._dur; // in case the duration changed in the onRepeat\n\n          tDur = this._tDur;\n\n          if (doesWrap) {\n            this._lock = 2;\n            prevTime = rewinding ? dur : -0.0001;\n            this.render(prevTime, true);\n            this.vars.repeatRefresh && !isYoyo && this.invalidate();\n          }\n\n          this._lock = 0;\n\n          if (!this._ts && !prevPaused) {\n            return this;\n          } //in order for yoyoEase to work properly when there's a stagger, we must swap out the ease in each sub-tween.\n\n\n          _propagateYoyoEase(this, isYoyo);\n        }\n      }\n\n      if (this._hasPause && !this._forcing && this._lock < 2) {\n        pauseTween = _findNextPauseTween(this, _roundPrecise(prevTime), _roundPrecise(time));\n\n        if (pauseTween) {\n          tTime -= time - (time = pauseTween._start);\n        }\n      }\n\n      this._tTime = tTime;\n      this._time = time;\n      this._act = !timeScale; //as long as it's not paused, force it to be active so that if the user renders independent of the parent timeline, it'll be forced to re-render on the next tick.\n\n      if (!this._initted) {\n        this._onUpdate = this.vars.onUpdate;\n        this._initted = 1;\n        this._zTime = totalTime;\n        prevTime = 0; // upon init, the playhead should always go forward; someone could invalidate() a completed timeline and then if they restart(), that would make child tweens render in reverse order which could lock in the wrong starting values if they build on each other, like tl.to(obj, {x: 100}).to(obj, {x: 0}).\n      }\n\n      if (!prevTime && time && !suppressEvents && !iteration) {\n        _callback(this, \"onStart\");\n\n        if (this._tTime !== tTime) {\n          // in case the onStart triggered a render at a different spot, eject. Like if someone did animation.pause(0.5) or something inside the onStart.\n          return this;\n        }\n      }\n\n      if (time >= prevTime && totalTime >= 0) {\n        child = this._first;\n\n        while (child) {\n          next = child._next;\n\n          if ((child._act || time >= child._start) && child._ts && pauseTween !== child) {\n            if (child.parent !== this) {\n              // an extreme edge case - the child's render could do something like kill() the \"next\" one in the linked list, or reparent it. In that case we must re-initiate the whole render to be safe.\n              return this.render(totalTime, suppressEvents, force);\n            }\n\n            child.render(child._ts > 0 ? (time - child._start) * child._ts : (child._dirty ? child.totalDuration() : child._tDur) + (time - child._start) * child._ts, suppressEvents, force);\n\n            if (time !== this._time || !this._ts && !prevPaused) {\n              //in case a tween pauses or seeks the timeline when rendering, like inside of an onUpdate/onComplete\n              pauseTween = 0;\n              next && (tTime += this._zTime = -_tinyNum); // it didn't finish rendering, so flag zTime as negative so that the next time render() is called it'll be forced (to render any remaining children)\n\n              break;\n            }\n          }\n\n          child = next;\n        }\n      } else {\n        child = this._last;\n        var adjustedTime = totalTime < 0 ? totalTime : time; //when the playhead goes backward beyond the start of this timeline, we must pass that information down to the child animations so that zero-duration tweens know whether to render their starting or ending values.\n\n        while (child) {\n          next = child._prev;\n\n          if ((child._act || adjustedTime <= child._end) && child._ts && pauseTween !== child) {\n            if (child.parent !== this) {\n              // an extreme edge case - the child's render could do something like kill() the \"next\" one in the linked list, or reparent it. In that case we must re-initiate the whole render to be safe.\n              return this.render(totalTime, suppressEvents, force);\n            }\n\n            child.render(child._ts > 0 ? (adjustedTime - child._start) * child._ts : (child._dirty ? child.totalDuration() : child._tDur) + (adjustedTime - child._start) * child._ts, suppressEvents, force || _reverting && (child._initted || child._startAt)); // if reverting, we should always force renders of initted tweens (but remember that .fromTo() or .from() may have a _startAt but not _initted yet). If, for example, a .fromTo() tween with a stagger (which creates an internal timeline) gets reverted BEFORE some of its child tweens render for the first time, it may not properly trigger them to revert.\n\n            if (time !== this._time || !this._ts && !prevPaused) {\n              //in case a tween pauses or seeks the timeline when rendering, like inside of an onUpdate/onComplete\n              pauseTween = 0;\n              next && (tTime += this._zTime = adjustedTime ? -_tinyNum : _tinyNum); // it didn't finish rendering, so adjust zTime so that so that the next time render() is called it'll be forced (to render any remaining children)\n\n              break;\n            }\n          }\n\n          child = next;\n        }\n      }\n\n      if (pauseTween && !suppressEvents) {\n        this.pause();\n        pauseTween.render(time >= prevTime ? 0 : -_tinyNum)._zTime = time >= prevTime ? 1 : -1;\n\n        if (this._ts) {\n          //the callback resumed playback! So since we may have held back the playhead due to where the pause is positioned, go ahead and jump to where it's SUPPOSED to be (if no pause happened).\n          this._start = prevStart; //if the pause was at an earlier time and the user resumed in the callback, it could reposition the timeline (changing its startTime), throwing things off slightly, so we make sure the _start doesn't shift.\n\n          _setEnd(this);\n\n          return this.render(totalTime, suppressEvents, force);\n        }\n      }\n\n      this._onUpdate && !suppressEvents && _callback(this, \"onUpdate\", true);\n      if (tTime === tDur && this._tTime >= this.totalDuration() || !tTime && prevTime) if (prevStart === this._start || Math.abs(timeScale) !== Math.abs(this._ts)) if (!this._lock) {\n        // remember, a child's callback may alter this timeline's playhead or timeScale which is why we need to add some of these checks.\n        (totalTime || !dur) && (tTime === tDur && this._ts > 0 || !tTime && this._ts < 0) && _removeFromParent(this, 1); // don't remove if the timeline is reversed and the playhead isn't at 0, otherwise tl.progress(1).reverse() won't work. Only remove if the playhead is at the end and timeScale is positive, or if the playhead is at 0 and the timeScale is negative.\n\n        if (!suppressEvents && !(totalTime < 0 && !prevTime) && (tTime || prevTime || !tDur)) {\n          _callback(this, tTime === tDur && totalTime >= 0 ? \"onComplete\" : \"onReverseComplete\", true);\n\n          this._prom && !(tTime < tDur && this.timeScale() > 0) && this._prom();\n        }\n      }\n    }\n\n    return this;\n  };\n\n  _proto2.add = function add(child, position) {\n    var _this2 = this;\n\n    _isNumber(position) || (position = _parsePosition(this, position, child));\n\n    if (!(child instanceof Animation)) {\n      if (_isArray(child)) {\n        child.forEach(function (obj) {\n          return _this2.add(obj, position);\n        });\n        return this;\n      }\n\n      if (_isString(child)) {\n        return this.addLabel(child, position);\n      }\n\n      if (_isFunction(child)) {\n        child = Tween.delayedCall(0, child);\n      } else {\n        return this;\n      }\n    }\n\n    return this !== child ? _addToTimeline(this, child, position) : this; //don't allow a timeline to be added to itself as a child!\n  };\n\n  _proto2.getChildren = function getChildren(nested, tweens, timelines, ignoreBeforeTime) {\n    if (nested === void 0) {\n      nested = true;\n    }\n\n    if (tweens === void 0) {\n      tweens = true;\n    }\n\n    if (timelines === void 0) {\n      timelines = true;\n    }\n\n    if (ignoreBeforeTime === void 0) {\n      ignoreBeforeTime = -_bigNum;\n    }\n\n    var a = [],\n        child = this._first;\n\n    while (child) {\n      if (child._start >= ignoreBeforeTime) {\n        if (child instanceof Tween) {\n          tweens && a.push(child);\n        } else {\n          timelines && a.push(child);\n          nested && a.push.apply(a, child.getChildren(true, tweens, timelines));\n        }\n      }\n\n      child = child._next;\n    }\n\n    return a;\n  };\n\n  _proto2.getById = function getById(id) {\n    var animations = this.getChildren(1, 1, 1),\n        i = animations.length;\n\n    while (i--) {\n      if (animations[i].vars.id === id) {\n        return animations[i];\n      }\n    }\n  };\n\n  _proto2.remove = function remove(child) {\n    if (_isString(child)) {\n      return this.removeLabel(child);\n    }\n\n    if (_isFunction(child)) {\n      return this.killTweensOf(child);\n    }\n\n    child.parent === this && _removeLinkedListItem(this, child);\n\n    if (child === this._recent) {\n      this._recent = this._last;\n    }\n\n    return _uncache(this);\n  };\n\n  _proto2.totalTime = function totalTime(_totalTime2, suppressEvents) {\n    if (!arguments.length) {\n      return this._tTime;\n    }\n\n    this._forcing = 1;\n\n    if (!this._dp && this._ts) {\n      //special case for the global timeline (or any other that has no parent or detached parent).\n      this._start = _roundPrecise(_ticker.time - (this._ts > 0 ? _totalTime2 / this._ts : (this.totalDuration() - _totalTime2) / -this._ts));\n    }\n\n    _Animation.prototype.totalTime.call(this, _totalTime2, suppressEvents);\n\n    this._forcing = 0;\n    return this;\n  };\n\n  _proto2.addLabel = function addLabel(label, position) {\n    this.labels[label] = _parsePosition(this, position);\n    return this;\n  };\n\n  _proto2.removeLabel = function removeLabel(label) {\n    delete this.labels[label];\n    return this;\n  };\n\n  _proto2.addPause = function addPause(position, callback, params) {\n    var t = Tween.delayedCall(0, callback || _emptyFunc, params);\n    t.data = \"isPause\";\n    this._hasPause = 1;\n    return _addToTimeline(this, t, _parsePosition(this, position));\n  };\n\n  _proto2.removePause = function removePause(position) {\n    var child = this._first;\n    position = _parsePosition(this, position);\n\n    while (child) {\n      if (child._start === position && child.data === \"isPause\") {\n        _removeFromParent(child);\n      }\n\n      child = child._next;\n    }\n  };\n\n  _proto2.killTweensOf = function killTweensOf(targets, props, onlyActive) {\n    var tweens = this.getTweensOf(targets, onlyActive),\n        i = tweens.length;\n\n    while (i--) {\n      _overwritingTween !== tweens[i] && tweens[i].kill(targets, props);\n    }\n\n    return this;\n  };\n\n  _proto2.getTweensOf = function getTweensOf(targets, onlyActive) {\n    var a = [],\n        parsedTargets = toArray(targets),\n        child = this._first,\n        isGlobalTime = _isNumber(onlyActive),\n        // a number is interpreted as a global time. If the animation spans\n    children;\n\n    while (child) {\n      if (child instanceof Tween) {\n        if (_arrayContainsAny(child._targets, parsedTargets) && (isGlobalTime ? (!_overwritingTween || child._initted && child._ts) && child.globalTime(0) <= onlyActive && child.globalTime(child.totalDuration()) > onlyActive : !onlyActive || child.isActive())) {\n          // note: if this is for overwriting, it should only be for tweens that aren't paused and are initted.\n          a.push(child);\n        }\n      } else if ((children = child.getTweensOf(parsedTargets, onlyActive)).length) {\n        a.push.apply(a, children);\n      }\n\n      child = child._next;\n    }\n\n    return a;\n  } // potential future feature - targets() on timelines\n  // targets() {\n  // \tlet result = [];\n  // \tthis.getChildren(true, true, false).forEach(t => result.push(...t.targets()));\n  // \treturn result.filter((v, i) => result.indexOf(v) === i);\n  // }\n  ;\n\n  _proto2.tweenTo = function tweenTo(position, vars) {\n    vars = vars || {};\n\n    var tl = this,\n        endTime = _parsePosition(tl, position),\n        _vars = vars,\n        startAt = _vars.startAt,\n        _onStart = _vars.onStart,\n        onStartParams = _vars.onStartParams,\n        immediateRender = _vars.immediateRender,\n        initted,\n        tween = Tween.to(tl, _setDefaults({\n      ease: vars.ease || \"none\",\n      lazy: false,\n      immediateRender: false,\n      time: endTime,\n      overwrite: \"auto\",\n      duration: vars.duration || Math.abs((endTime - (startAt && \"time\" in startAt ? startAt.time : tl._time)) / tl.timeScale()) || _tinyNum,\n      onStart: function onStart() {\n        tl.pause();\n\n        if (!initted) {\n          var duration = vars.duration || Math.abs((endTime - (startAt && \"time\" in startAt ? startAt.time : tl._time)) / tl.timeScale());\n          tween._dur !== duration && _setDuration(tween, duration, 0, 1).render(tween._time, true, true);\n          initted = 1;\n        }\n\n        _onStart && _onStart.apply(tween, onStartParams || []); //in case the user had an onStart in the vars - we don't want to overwrite it.\n      }\n    }, vars));\n\n    return immediateRender ? tween.render(0) : tween;\n  };\n\n  _proto2.tweenFromTo = function tweenFromTo(fromPosition, toPosition, vars) {\n    return this.tweenTo(toPosition, _setDefaults({\n      startAt: {\n        time: _parsePosition(this, fromPosition)\n      }\n    }, vars));\n  };\n\n  _proto2.recent = function recent() {\n    return this._recent;\n  };\n\n  _proto2.nextLabel = function nextLabel(afterTime) {\n    if (afterTime === void 0) {\n      afterTime = this._time;\n    }\n\n    return _getLabelInDirection(this, _parsePosition(this, afterTime));\n  };\n\n  _proto2.previousLabel = function previousLabel(beforeTime) {\n    if (beforeTime === void 0) {\n      beforeTime = this._time;\n    }\n\n    return _getLabelInDirection(this, _parsePosition(this, beforeTime), 1);\n  };\n\n  _proto2.currentLabel = function currentLabel(value) {\n    return arguments.length ? this.seek(value, true) : this.previousLabel(this._time + _tinyNum);\n  };\n\n  _proto2.shiftChildren = function shiftChildren(amount, adjustLabels, ignoreBeforeTime) {\n    if (ignoreBeforeTime === void 0) {\n      ignoreBeforeTime = 0;\n    }\n\n    var child = this._first,\n        labels = this.labels,\n        p;\n\n    while (child) {\n      if (child._start >= ignoreBeforeTime) {\n        child._start += amount;\n        child._end += amount;\n      }\n\n      child = child._next;\n    }\n\n    if (adjustLabels) {\n      for (p in labels) {\n        if (labels[p] >= ignoreBeforeTime) {\n          labels[p] += amount;\n        }\n      }\n    }\n\n    return _uncache(this);\n  };\n\n  _proto2.invalidate = function invalidate(soft) {\n    var child = this._first;\n    this._lock = 0;\n\n    while (child) {\n      child.invalidate(soft);\n      child = child._next;\n    }\n\n    return _Animation.prototype.invalidate.call(this, soft);\n  };\n\n  _proto2.clear = function clear(includeLabels) {\n    if (includeLabels === void 0) {\n      includeLabels = true;\n    }\n\n    var child = this._first,\n        next;\n\n    while (child) {\n      next = child._next;\n      this.remove(child);\n      child = next;\n    }\n\n    this._dp && (this._time = this._tTime = this._pTime = 0);\n    includeLabels && (this.labels = {});\n    return _uncache(this);\n  };\n\n  _proto2.totalDuration = function totalDuration(value) {\n    var max = 0,\n        self = this,\n        child = self._last,\n        prevStart = _bigNum,\n        prev,\n        start,\n        parent;\n\n    if (arguments.length) {\n      return self.timeScale((self._repeat < 0 ? self.duration() : self.totalDuration()) / (self.reversed() ? -value : value));\n    }\n\n    if (self._dirty) {\n      parent = self.parent;\n\n      while (child) {\n        prev = child._prev; //record it here in case the tween changes position in the sequence...\n\n        child._dirty && child.totalDuration(); //could change the tween._startTime, so make sure the animation's cache is clean before analyzing it.\n\n        start = child._start;\n\n        if (start > prevStart && self._sort && child._ts && !self._lock) {\n          //in case one of the tweens shifted out of order, it needs to be re-inserted into the correct position in the sequence\n          self._lock = 1; //prevent endless recursive calls - there are methods that get triggered that check duration/totalDuration when we add().\n\n          _addToTimeline(self, child, start - child._delay, 1)._lock = 0;\n        } else {\n          prevStart = start;\n        }\n\n        if (start < 0 && child._ts) {\n          //children aren't allowed to have negative startTimes unless smoothChildTiming is true, so adjust here if one is found.\n          max -= start;\n\n          if (!parent && !self._dp || parent && parent.smoothChildTiming) {\n            self._start += start / self._ts;\n            self._time -= start;\n            self._tTime -= start;\n          }\n\n          self.shiftChildren(-start, false, -1e999);\n          prevStart = 0;\n        }\n\n        child._end > max && child._ts && (max = child._end);\n        child = prev;\n      }\n\n      _setDuration(self, self === _globalTimeline && self._time > max ? self._time : max, 1, 1);\n\n      self._dirty = 0;\n    }\n\n    return self._tDur;\n  };\n\n  Timeline.updateRoot = function updateRoot(time) {\n    if (_globalTimeline._ts) {\n      _lazySafeRender(_globalTimeline, _parentToChildTotalTime(time, _globalTimeline));\n\n      _lastRenderedFrame = _ticker.frame;\n    }\n\n    if (_ticker.frame >= _nextGCFrame) {\n      _nextGCFrame += _config.autoSleep || 120;\n      var child = _globalTimeline._first;\n      if (!child || !child._ts) if (_config.autoSleep && _ticker._listeners.length < 2) {\n        while (child && !child._ts) {\n          child = child._next;\n        }\n\n        child || _ticker.sleep();\n      }\n    }\n  };\n\n  return Timeline;\n}(Animation);\n\n_setDefaults(Timeline.prototype, {\n  _lock: 0,\n  _hasPause: 0,\n  _forcing: 0\n});\n\nvar _addComplexStringPropTween = function _addComplexStringPropTween(target, prop, start, end, setter, stringFilter, funcParam) {\n  //note: we call _addComplexStringPropTween.call(tweenInstance...) to ensure that it's scoped properly. We may call it from within a plugin too, thus \"this\" would refer to the plugin.\n  var pt = new PropTween(this._pt, target, prop, 0, 1, _renderComplexString, null, setter),\n      index = 0,\n      matchIndex = 0,\n      result,\n      startNums,\n      color,\n      endNum,\n      chunk,\n      startNum,\n      hasRandom,\n      a;\n  pt.b = start;\n  pt.e = end;\n  start += \"\"; //ensure values are strings\n\n  end += \"\";\n\n  if (hasRandom = ~end.indexOf(\"random(\")) {\n    end = _replaceRandom(end);\n  }\n\n  if (stringFilter) {\n    a = [start, end];\n    stringFilter(a, target, prop); //pass an array with the starting and ending values and let the filter do whatever it needs to the values.\n\n    start = a[0];\n    end = a[1];\n  }\n\n  startNums = start.match(_complexStringNumExp) || [];\n\n  while (result = _complexStringNumExp.exec(end)) {\n    endNum = result[0];\n    chunk = end.substring(index, result.index);\n\n    if (color) {\n      color = (color + 1) % 5;\n    } else if (chunk.substr(-5) === \"rgba(\") {\n      color = 1;\n    }\n\n    if (endNum !== startNums[matchIndex++]) {\n      startNum = parseFloat(startNums[matchIndex - 1]) || 0; //these nested PropTweens are handled in a special way - we'll never actually call a render or setter method on them. We'll just loop through them in the parent complex string PropTween's render method.\n\n      pt._pt = {\n        _next: pt._pt,\n        p: chunk || matchIndex === 1 ? chunk : \",\",\n        //note: SVG spec allows omission of comma/space when a negative sign is wedged between two numbers, like 2.5-5.3 instead of 2.5,-5.3 but when tweening, the negative value may switch to positive, so we insert the comma just in case.\n        s: startNum,\n        c: endNum.charAt(1) === \"=\" ? _parseRelative(startNum, endNum) - startNum : parseFloat(endNum) - startNum,\n        m: color && color < 4 ? Math.round : 0\n      };\n      index = _complexStringNumExp.lastIndex;\n    }\n  }\n\n  pt.c = index < end.length ? end.substring(index, end.length) : \"\"; //we use the \"c\" of the PropTween to store the final part of the string (after the last number)\n\n  pt.fp = funcParam;\n\n  if (_relExp.test(end) || hasRandom) {\n    pt.e = 0; //if the end string contains relative values or dynamic random(...) values, delete the end it so that on the final render we don't actually set it to the string with += or -= characters (forces it to use the calculated value).\n  }\n\n  this._pt = pt; //start the linked list with this new PropTween. Remember, we call _addComplexStringPropTween.call(tweenInstance...) to ensure that it's scoped properly. We may call it from within a plugin too, thus \"this\" would refer to the plugin.\n\n  return pt;\n},\n    _addPropTween = function _addPropTween(target, prop, start, end, index, targets, modifier, stringFilter, funcParam, optional) {\n  _isFunction(end) && (end = end(index || 0, target, targets));\n  var currentValue = target[prop],\n      parsedStart = start !== \"get\" ? start : !_isFunction(currentValue) ? currentValue : funcParam ? target[prop.indexOf(\"set\") || !_isFunction(target[\"get\" + prop.substr(3)]) ? prop : \"get\" + prop.substr(3)](funcParam) : target[prop](),\n      setter = !_isFunction(currentValue) ? _setterPlain : funcParam ? _setterFuncWithParam : _setterFunc,\n      pt;\n\n  if (_isString(end)) {\n    if (~end.indexOf(\"random(\")) {\n      end = _replaceRandom(end);\n    }\n\n    if (end.charAt(1) === \"=\") {\n      pt = _parseRelative(parsedStart, end) + (getUnit(parsedStart) || 0);\n\n      if (pt || pt === 0) {\n        // to avoid isNaN, like if someone passes in a value like \"!= whatever\"\n        end = pt;\n      }\n    }\n  }\n\n  if (!optional || parsedStart !== end || _forceAllPropTweens) {\n    if (!isNaN(parsedStart * end) && end !== \"\") {\n      // fun fact: any number multiplied by \"\" is evaluated as the number 0!\n      pt = new PropTween(this._pt, target, prop, +parsedStart || 0, end - (parsedStart || 0), typeof currentValue === \"boolean\" ? _renderBoolean : _renderPlain, 0, setter);\n      funcParam && (pt.fp = funcParam);\n      modifier && pt.modifier(modifier, this, target);\n      return this._pt = pt;\n    }\n\n    !currentValue && !(prop in target) && _missingPlugin(prop, end);\n    return _addComplexStringPropTween.call(this, target, prop, parsedStart, end, setter, stringFilter || _config.stringFilter, funcParam);\n  }\n},\n    //creates a copy of the vars object and processes any function-based values (putting the resulting values directly into the copy) as well as strings with \"random()\" in them. It does NOT process relative values.\n_processVars = function _processVars(vars, index, target, targets, tween) {\n  _isFunction(vars) && (vars = _parseFuncOrString(vars, tween, index, target, targets));\n\n  if (!_isObject(vars) || vars.style && vars.nodeType || _isArray(vars) || _isTypedArray(vars)) {\n    return _isString(vars) ? _parseFuncOrString(vars, tween, index, target, targets) : vars;\n  }\n\n  var copy = {},\n      p;\n\n  for (p in vars) {\n    copy[p] = _parseFuncOrString(vars[p], tween, index, target, targets);\n  }\n\n  return copy;\n},\n    _checkPlugin = function _checkPlugin(property, vars, tween, index, target, targets) {\n  var plugin, pt, ptLookup, i;\n\n  if (_plugins[property] && (plugin = new _plugins[property]()).init(target, plugin.rawVars ? vars[property] : _processVars(vars[property], index, target, targets, tween), tween, index, targets) !== false) {\n    tween._pt = pt = new PropTween(tween._pt, target, property, 0, 1, plugin.render, plugin, 0, plugin.priority);\n\n    if (tween !== _quickTween) {\n      ptLookup = tween._ptLookup[tween._targets.indexOf(target)]; //note: we can't use tween._ptLookup[index] because for staggered tweens, the index from the fullTargets array won't match what it is in each individual tween that spawns from the stagger.\n\n      i = plugin._props.length;\n\n      while (i--) {\n        ptLookup[plugin._props[i]] = pt;\n      }\n    }\n  }\n\n  return plugin;\n},\n    _overwritingTween,\n    //store a reference temporarily so we can avoid overwriting itself.\n_forceAllPropTweens,\n    _initTween = function _initTween(tween, time, tTime) {\n  var vars = tween.vars,\n      ease = vars.ease,\n      startAt = vars.startAt,\n      immediateRender = vars.immediateRender,\n      lazy = vars.lazy,\n      onUpdate = vars.onUpdate,\n      runBackwards = vars.runBackwards,\n      yoyoEase = vars.yoyoEase,\n      keyframes = vars.keyframes,\n      autoRevert = vars.autoRevert,\n      dur = tween._dur,\n      prevStartAt = tween._startAt,\n      targets = tween._targets,\n      parent = tween.parent,\n      fullTargets = parent && parent.data === \"nested\" ? parent.vars.targets : targets,\n      autoOverwrite = tween._overwrite === \"auto\" && !_suppressOverwrites,\n      tl = tween.timeline,\n      cleanVars,\n      i,\n      p,\n      pt,\n      target,\n      hasPriority,\n      gsData,\n      harness,\n      plugin,\n      ptLookup,\n      index,\n      harnessVars,\n      overwritten;\n  tl && (!keyframes || !ease) && (ease = \"none\");\n  tween._ease = _parseEase(ease, _defaults.ease);\n  tween._yEase = yoyoEase ? _invertEase(_parseEase(yoyoEase === true ? ease : yoyoEase, _defaults.ease)) : 0;\n\n  if (yoyoEase && tween._yoyo && !tween._repeat) {\n    //there must have been a parent timeline with yoyo:true that is currently in its yoyo phase, so flip the eases.\n    yoyoEase = tween._yEase;\n    tween._yEase = tween._ease;\n    tween._ease = yoyoEase;\n  }\n\n  tween._from = !tl && !!vars.runBackwards; //nested timelines should never run backwards - the backwards-ness is in the child tweens.\n\n  if (!tl || keyframes && !vars.stagger) {\n    //if there's an internal timeline, skip all the parsing because we passed that task down the chain.\n    harness = targets[0] ? _getCache(targets[0]).harness : 0;\n    harnessVars = harness && vars[harness.prop]; //someone may need to specify CSS-specific values AND non-CSS values, like if the element has an \"x\" property plus it's a standard DOM element. We allow people to distinguish by wrapping plugin-specific stuff in a css:{} object for example.\n\n    cleanVars = _copyExcluding(vars, _reservedProps);\n\n    if (prevStartAt) {\n      prevStartAt._zTime < 0 && prevStartAt.progress(1); // in case it's a lazy startAt that hasn't rendered yet.\n\n      time < 0 && runBackwards && immediateRender && !autoRevert ? prevStartAt.render(-1, true) : prevStartAt.revert(runBackwards && dur ? _revertConfigNoKill : _startAtRevertConfig); // if it's a \"startAt\" (not \"from()\" or runBackwards: true), we only need to do a shallow revert (keep transforms cached in CSSPlugin)\n      // don't just _removeFromParent(prevStartAt.render(-1, true)) because that'll leave inline styles. We're creating a new _startAt for \"startAt\" tweens that re-capture things to ensure that if the pre-tween values changed since the tween was created, they're recorded.\n\n      prevStartAt._lazy = 0;\n    }\n\n    if (startAt) {\n      _removeFromParent(tween._startAt = Tween.set(targets, _setDefaults({\n        data: \"isStart\",\n        overwrite: false,\n        parent: parent,\n        immediateRender: true,\n        lazy: !prevStartAt && _isNotFalse(lazy),\n        startAt: null,\n        delay: 0,\n        onUpdate: onUpdate && function () {\n          return _callback(tween, \"onUpdate\");\n        },\n        stagger: 0\n      }, startAt))); //copy the properties/values into a new object to avoid collisions, like var to = {x:0}, from = {x:500}; timeline.fromTo(e, from, to).fromTo(e, to, from);\n\n\n      tween._startAt._dp = 0; // don't allow it to get put back into root timeline! Like when revert() is called and totalTime() gets set.\n\n      tween._startAt._sat = tween; // used in globalTime(). _sat stands for _startAtTween\n\n      time < 0 && (_reverting || !immediateRender && !autoRevert) && tween._startAt.revert(_revertConfigNoKill); // rare edge case, like if a render is forced in the negative direction of a non-initted tween.\n\n      if (immediateRender) {\n        if (dur && time <= 0 && tTime <= 0) {\n          // check tTime here because in the case of a yoyo tween whose playhead gets pushed to the end like tween.progress(1), we should allow it through so that the onComplete gets fired properly.\n          time && (tween._zTime = time);\n          return; //we skip initialization here so that overwriting doesn't occur until the tween actually begins. Otherwise, if you create several immediateRender:true tweens of the same target/properties to drop into a Timeline, the last one created would overwrite the first ones because they didn't get placed into the timeline yet before the first render occurs and kicks in overwriting.\n        }\n      }\n    } else if (runBackwards && dur) {\n      //from() tweens must be handled uniquely: their beginning values must be rendered but we don't want overwriting to occur yet (when time is still 0). Wait until the tween actually begins before doing all the routines like overwriting. At that time, we should render at the END of the tween to ensure that things initialize correctly (remember, from() tweens go backwards)\n      if (!prevStartAt) {\n        time && (immediateRender = false); //in rare cases (like if a from() tween runs and then is invalidate()-ed), immediateRender could be true but the initial forced-render gets skipped, so there's no need to force the render in this context when the _time is greater than 0\n\n        p = _setDefaults({\n          overwrite: false,\n          data: \"isFromStart\",\n          //we tag the tween with as \"isFromStart\" so that if [inside a plugin] we need to only do something at the very END of a tween, we have a way of identifying this tween as merely the one that's setting the beginning values for a \"from()\" tween. For example, clearProps in CSSPlugin should only get applied at the very END of a tween and without this tag, from(...{height:100, clearProps:\"height\", delay:1}) would wipe the height at the beginning of the tween and after 1 second, it'd kick back in.\n          lazy: immediateRender && !prevStartAt && _isNotFalse(lazy),\n          immediateRender: immediateRender,\n          //zero-duration tweens render immediately by default, but if we're not specifically instructed to render this tween immediately, we should skip this and merely _init() to record the starting values (rendering them immediately would push them to completion which is wasteful in that case - we'd have to render(-1) immediately after)\n          stagger: 0,\n          parent: parent //ensures that nested tweens that had a stagger are handled properly, like gsap.from(\".class\", {y: gsap.utils.wrap([-100,100]), stagger: 0.5})\n\n        }, cleanVars);\n        harnessVars && (p[harness.prop] = harnessVars); // in case someone does something like .from(..., {css:{}})\n\n        _removeFromParent(tween._startAt = Tween.set(targets, p));\n\n        tween._startAt._dp = 0; // don't allow it to get put back into root timeline!\n\n        tween._startAt._sat = tween; // used in globalTime()\n\n        time < 0 && (_reverting ? tween._startAt.revert(_revertConfigNoKill) : tween._startAt.render(-1, true));\n        tween._zTime = time;\n\n        if (!immediateRender) {\n          _initTween(tween._startAt, _tinyNum, _tinyNum); //ensures that the initial values are recorded\n\n        } else if (!time) {\n          return;\n        }\n      }\n    }\n\n    tween._pt = tween._ptCache = 0;\n    lazy = dur && _isNotFalse(lazy) || lazy && !dur;\n\n    for (i = 0; i < targets.length; i++) {\n      target = targets[i];\n      gsData = target._gsap || _harness(targets)[i]._gsap;\n      tween._ptLookup[i] = ptLookup = {};\n      _lazyLookup[gsData.id] && _lazyTweens.length && _lazyRender(); //if other tweens of the same target have recently initted but haven't rendered yet, we've got to force the render so that the starting values are correct (imagine populating a timeline with a bunch of sequential tweens and then jumping to the end)\n\n      index = fullTargets === targets ? i : fullTargets.indexOf(target);\n\n      if (harness && (plugin = new harness()).init(target, harnessVars || cleanVars, tween, index, fullTargets) !== false) {\n        tween._pt = pt = new PropTween(tween._pt, target, plugin.name, 0, 1, plugin.render, plugin, 0, plugin.priority);\n\n        plugin._props.forEach(function (name) {\n          ptLookup[name] = pt;\n        });\n\n        plugin.priority && (hasPriority = 1);\n      }\n\n      if (!harness || harnessVars) {\n        for (p in cleanVars) {\n          if (_plugins[p] && (plugin = _checkPlugin(p, cleanVars, tween, index, target, fullTargets))) {\n            plugin.priority && (hasPriority = 1);\n          } else {\n            ptLookup[p] = pt = _addPropTween.call(tween, target, p, \"get\", cleanVars[p], index, fullTargets, 0, vars.stringFilter);\n          }\n        }\n      }\n\n      tween._op && tween._op[i] && tween.kill(target, tween._op[i]);\n\n      if (autoOverwrite && tween._pt) {\n        _overwritingTween = tween;\n\n        _globalTimeline.killTweensOf(target, ptLookup, tween.globalTime(time)); // make sure the overwriting doesn't overwrite THIS tween!!!\n\n\n        overwritten = !tween.parent;\n        _overwritingTween = 0;\n      }\n\n      tween._pt && lazy && (_lazyLookup[gsData.id] = 1);\n    }\n\n    hasPriority && _sortPropTweensByPriority(tween);\n    tween._onInit && tween._onInit(tween); //plugins like RoundProps must wait until ALL of the PropTweens are instantiated. In the plugin's init() function, it sets the _onInit on the tween instance. May not be pretty/intuitive, but it's fast and keeps file size down.\n  }\n\n  tween._onUpdate = onUpdate;\n  tween._initted = (!tween._op || tween._pt) && !overwritten; // if overwrittenProps resulted in the entire tween being killed, do NOT flag it as initted or else it may render for one tick.\n\n  keyframes && time <= 0 && tl.render(_bigNum, true, true); // if there's a 0% keyframe, it'll render in the \"before\" state for any staggered/delayed animations thus when the following tween initializes, it'll use the \"before\" state instead of the \"after\" state as the initial values.\n},\n    _updatePropTweens = function _updatePropTweens(tween, property, value, start, startIsRelative, ratio, time, skipRecursion) {\n  var ptCache = (tween._pt && tween._ptCache || (tween._ptCache = {}))[property],\n      pt,\n      rootPT,\n      lookup,\n      i;\n\n  if (!ptCache) {\n    ptCache = tween._ptCache[property] = [];\n    lookup = tween._ptLookup;\n    i = tween._targets.length;\n\n    while (i--) {\n      pt = lookup[i][property];\n\n      if (pt && pt.d && pt.d._pt) {\n        // it's a plugin, so find the nested PropTween\n        pt = pt.d._pt;\n\n        while (pt && pt.p !== property && pt.fp !== property) {\n          // \"fp\" is functionParam for things like setting CSS variables which require .setProperty(\"--var-name\", value)\n          pt = pt._next;\n        }\n      }\n\n      if (!pt) {\n        // there is no PropTween associated with that property, so we must FORCE one to be created and ditch out of this\n        // if the tween has other properties that already rendered at new positions, we'd normally have to rewind to put them back like tween.render(0, true) before forcing an _initTween(), but that can create another edge case like tweening a timeline's progress would trigger onUpdates to fire which could move other things around. It's better to just inform users that .resetTo() should ONLY be used for tweens that already have that property. For example, you can't gsap.to(...{ y: 0 }) and then tween.restTo(\"x\", 200) for example.\n        _forceAllPropTweens = 1; // otherwise, when we _addPropTween() and it finds no change between the start and end values, it skips creating a PropTween (for efficiency...why tween when there's no difference?) but in this case we NEED that PropTween created so we can edit it.\n\n        tween.vars[property] = \"+=0\";\n\n        _initTween(tween, time);\n\n        _forceAllPropTweens = 0;\n        return skipRecursion ? _warn(property + \" not eligible for reset\") : 1; // if someone tries to do a quickTo() on a special property like borderRadius which must get split into 4 different properties, that's not eligible for .resetTo().\n      }\n\n      ptCache.push(pt);\n    }\n  }\n\n  i = ptCache.length;\n\n  while (i--) {\n    rootPT = ptCache[i];\n    pt = rootPT._pt || rootPT; // complex values may have nested PropTweens. We only accommodate the FIRST value.\n\n    pt.s = (start || start === 0) && !startIsRelative ? start : pt.s + (start || 0) + ratio * pt.c;\n    pt.c = value - pt.s;\n    rootPT.e && (rootPT.e = _round(value) + getUnit(rootPT.e)); // mainly for CSSPlugin (end value)\n\n    rootPT.b && (rootPT.b = pt.s + getUnit(rootPT.b)); // (beginning value)\n  }\n},\n    _addAliasesToVars = function _addAliasesToVars(targets, vars) {\n  var harness = targets[0] ? _getCache(targets[0]).harness : 0,\n      propertyAliases = harness && harness.aliases,\n      copy,\n      p,\n      i,\n      aliases;\n\n  if (!propertyAliases) {\n    return vars;\n  }\n\n  copy = _merge({}, vars);\n\n  for (p in propertyAliases) {\n    if (p in copy) {\n      aliases = propertyAliases[p].split(\",\");\n      i = aliases.length;\n\n      while (i--) {\n        copy[aliases[i]] = copy[p];\n      }\n    }\n  }\n\n  return copy;\n},\n    // parses multiple formats, like {\"0%\": {x: 100}, {\"50%\": {x: -20}} and { x: {\"0%\": 100, \"50%\": -20} }, and an \"ease\" can be set on any object. We populate an \"allProps\" object with an Array for each property, like {x: [{}, {}], y:[{}, {}]} with data for each property tween. The objects have a \"t\" (time), \"v\", (value), and \"e\" (ease) property. This allows us to piece together a timeline later.\n_parseKeyframe = function _parseKeyframe(prop, obj, allProps, easeEach) {\n  var ease = obj.ease || easeEach || \"power1.inOut\",\n      p,\n      a;\n\n  if (_isArray(obj)) {\n    a = allProps[prop] || (allProps[prop] = []); // t = time (out of 100), v = value, e = ease\n\n    obj.forEach(function (value, i) {\n      return a.push({\n        t: i / (obj.length - 1) * 100,\n        v: value,\n        e: ease\n      });\n    });\n  } else {\n    for (p in obj) {\n      a = allProps[p] || (allProps[p] = []);\n      p === \"ease\" || a.push({\n        t: parseFloat(prop),\n        v: obj[p],\n        e: ease\n      });\n    }\n  }\n},\n    _parseFuncOrString = function _parseFuncOrString(value, tween, i, target, targets) {\n  return _isFunction(value) ? value.call(tween, i, target, targets) : _isString(value) && ~value.indexOf(\"random(\") ? _replaceRandom(value) : value;\n},\n    _staggerTweenProps = _callbackNames + \"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert\",\n    _staggerPropsToSkip = {};\n\n_forEachName(_staggerTweenProps + \",id,stagger,delay,duration,paused,scrollTrigger\", function (name) {\n  return _staggerPropsToSkip[name] = 1;\n});\n/*\n * --------------------------------------------------------------------------------------\n * TWEEN\n * --------------------------------------------------------------------------------------\n */\n\n\nexport var Tween = /*#__PURE__*/function (_Animation2) {\n  _inheritsLoose(Tween, _Animation2);\n\n  function Tween(targets, vars, position, skipInherit) {\n    var _this3;\n\n    if (typeof vars === \"number\") {\n      position.duration = vars;\n      vars = position;\n      position = null;\n    }\n\n    _this3 = _Animation2.call(this, skipInherit ? vars : _inheritDefaults(vars)) || this;\n    var _this3$vars = _this3.vars,\n        duration = _this3$vars.duration,\n        delay = _this3$vars.delay,\n        immediateRender = _this3$vars.immediateRender,\n        stagger = _this3$vars.stagger,\n        overwrite = _this3$vars.overwrite,\n        keyframes = _this3$vars.keyframes,\n        defaults = _this3$vars.defaults,\n        scrollTrigger = _this3$vars.scrollTrigger,\n        yoyoEase = _this3$vars.yoyoEase,\n        parent = vars.parent || _globalTimeline,\n        parsedTargets = (_isArray(targets) || _isTypedArray(targets) ? _isNumber(targets[0]) : \"length\" in vars) ? [targets] : toArray(targets),\n        tl,\n        i,\n        copy,\n        l,\n        p,\n        curTarget,\n        staggerFunc,\n        staggerVarsToMerge;\n    _this3._targets = parsedTargets.length ? _harness(parsedTargets) : _warn(\"GSAP target \" + targets + \" not found. https://gsap.com\", !_config.nullTargetWarn) || [];\n    _this3._ptLookup = []; //PropTween lookup. An array containing an object for each target, having keys for each tweening property\n\n    _this3._overwrite = overwrite;\n\n    if (keyframes || stagger || _isFuncOrString(duration) || _isFuncOrString(delay)) {\n      vars = _this3.vars;\n      tl = _this3.timeline = new Timeline({\n        data: \"nested\",\n        defaults: defaults || {},\n        targets: parent && parent.data === \"nested\" ? parent.vars.targets : parsedTargets\n      }); // we need to store the targets because for staggers and keyframes, we end up creating an individual tween for each but function-based values need to know the index and the whole Array of targets.\n\n      tl.kill();\n      tl.parent = tl._dp = _assertThisInitialized(_this3);\n      tl._start = 0;\n\n      if (stagger || _isFuncOrString(duration) || _isFuncOrString(delay)) {\n        l = parsedTargets.length;\n        staggerFunc = stagger && distribute(stagger);\n\n        if (_isObject(stagger)) {\n          //users can pass in callbacks like onStart/onComplete in the stagger object. These should fire with each individual tween.\n          for (p in stagger) {\n            if (~_staggerTweenProps.indexOf(p)) {\n              staggerVarsToMerge || (staggerVarsToMerge = {});\n              staggerVarsToMerge[p] = stagger[p];\n            }\n          }\n        }\n\n        for (i = 0; i < l; i++) {\n          copy = _copyExcluding(vars, _staggerPropsToSkip);\n          copy.stagger = 0;\n          yoyoEase && (copy.yoyoEase = yoyoEase);\n          staggerVarsToMerge && _merge(copy, staggerVarsToMerge);\n          curTarget = parsedTargets[i]; //don't just copy duration or delay because if they're a string or function, we'd end up in an infinite loop because _isFuncOrString() would evaluate as true in the child tweens, entering this loop, etc. So we parse the value straight from vars and default to 0.\n\n          copy.duration = +_parseFuncOrString(duration, _assertThisInitialized(_this3), i, curTarget, parsedTargets);\n          copy.delay = (+_parseFuncOrString(delay, _assertThisInitialized(_this3), i, curTarget, parsedTargets) || 0) - _this3._delay;\n\n          if (!stagger && l === 1 && copy.delay) {\n            // if someone does delay:\"random(1, 5)\", repeat:-1, for example, the delay shouldn't be inside the repeat.\n            _this3._delay = delay = copy.delay;\n            _this3._start += delay;\n            copy.delay = 0;\n          }\n\n          tl.to(curTarget, copy, staggerFunc ? staggerFunc(i, curTarget, parsedTargets) : 0);\n          tl._ease = _easeMap.none;\n        }\n\n        tl.duration() ? duration = delay = 0 : _this3.timeline = 0; // if the timeline's duration is 0, we don't need a timeline internally!\n      } else if (keyframes) {\n        _inheritDefaults(_setDefaults(tl.vars.defaults, {\n          ease: \"none\"\n        }));\n\n        tl._ease = _parseEase(keyframes.ease || vars.ease || \"none\");\n        var time = 0,\n            a,\n            kf,\n            v;\n\n        if (_isArray(keyframes)) {\n          keyframes.forEach(function (frame) {\n            return tl.to(parsedTargets, frame, \">\");\n          });\n          tl.duration(); // to ensure tl._dur is cached because we tap into it for performance purposes in the render() method.\n        } else {\n          copy = {};\n\n          for (p in keyframes) {\n            p === \"ease\" || p === \"easeEach\" || _parseKeyframe(p, keyframes[p], copy, keyframes.easeEach);\n          }\n\n          for (p in copy) {\n            a = copy[p].sort(function (a, b) {\n              return a.t - b.t;\n            });\n            time = 0;\n\n            for (i = 0; i < a.length; i++) {\n              kf = a[i];\n              v = {\n                ease: kf.e,\n                duration: (kf.t - (i ? a[i - 1].t : 0)) / 100 * duration\n              };\n              v[p] = kf.v;\n              tl.to(parsedTargets, v, time);\n              time += v.duration;\n            }\n          }\n\n          tl.duration() < duration && tl.to({}, {\n            duration: duration - tl.duration()\n          }); // in case keyframes didn't go to 100%\n        }\n      }\n\n      duration || _this3.duration(duration = tl.duration());\n    } else {\n      _this3.timeline = 0; //speed optimization, faster lookups (no going up the prototype chain)\n    }\n\n    if (overwrite === true && !_suppressOverwrites) {\n      _overwritingTween = _assertThisInitialized(_this3);\n\n      _globalTimeline.killTweensOf(parsedTargets);\n\n      _overwritingTween = 0;\n    }\n\n    _addToTimeline(parent, _assertThisInitialized(_this3), position);\n\n    vars.reversed && _this3.reverse();\n    vars.paused && _this3.paused(true);\n\n    if (immediateRender || !duration && !keyframes && _this3._start === _roundPrecise(parent._time) && _isNotFalse(immediateRender) && _hasNoPausedAncestors(_assertThisInitialized(_this3)) && parent.data !== \"nested\") {\n      _this3._tTime = -_tinyNum; //forces a render without having to set the render() \"force\" parameter to true because we want to allow lazying by default (using the \"force\" parameter always forces an immediate full render)\n\n      _this3.render(Math.max(0, -delay) || 0); //in case delay is negative\n\n    }\n\n    scrollTrigger && _scrollTrigger(_assertThisInitialized(_this3), scrollTrigger);\n    return _this3;\n  }\n\n  var _proto3 = Tween.prototype;\n\n  _proto3.render = function render(totalTime, suppressEvents, force) {\n    var prevTime = this._time,\n        tDur = this._tDur,\n        dur = this._dur,\n        isNegative = totalTime < 0,\n        tTime = totalTime > tDur - _tinyNum && !isNegative ? tDur : totalTime < _tinyNum ? 0 : totalTime,\n        time,\n        pt,\n        iteration,\n        cycleDuration,\n        prevIteration,\n        isYoyo,\n        ratio,\n        timeline,\n        yoyoEase;\n\n    if (!dur) {\n      _renderZeroDurationTween(this, totalTime, suppressEvents, force);\n    } else if (tTime !== this._tTime || !totalTime || force || !this._initted && this._tTime || this._startAt && this._zTime < 0 !== isNegative || this._lazy) {\n      // this senses if we're crossing over the start time, in which case we must record _zTime and force the render, but we do it in this lengthy conditional way for performance reasons (usually we can skip the calculations): this._initted && (this._zTime < 0) !== (totalTime < 0)\n      time = tTime;\n      timeline = this.timeline;\n\n      if (this._repeat) {\n        //adjust the time for repeats and yoyos\n        cycleDuration = dur + this._rDelay;\n\n        if (this._repeat < -1 && isNegative) {\n          return this.totalTime(cycleDuration * 100 + totalTime, suppressEvents, force);\n        }\n\n        time = _roundPrecise(tTime % cycleDuration); //round to avoid floating point errors. (4 % 0.8 should be 0 but some browsers report it as 0.79999999!)\n\n        if (tTime === tDur) {\n          // the tDur === tTime is for edge cases where there's a lengthy decimal on the duration and it may reach the very end but the time is rendered as not-quite-there (remember, tDur is rounded to 4 decimals whereas dur isn't)\n          iteration = this._repeat;\n          time = dur;\n        } else {\n          prevIteration = _roundPrecise(tTime / cycleDuration); // full decimal version of iterations, not the previous iteration (we're reusing prevIteration variable for efficiency)\n\n          iteration = ~~prevIteration;\n\n          if (iteration && iteration === prevIteration) {\n            time = dur;\n            iteration--;\n          } else if (time > dur) {\n            time = dur;\n          }\n        }\n\n        isYoyo = this._yoyo && iteration & 1;\n\n        if (isYoyo) {\n          yoyoEase = this._yEase;\n          time = dur - time;\n        }\n\n        prevIteration = _animationCycle(this._tTime, cycleDuration);\n\n        if (time === prevTime && !force && this._initted && iteration === prevIteration) {\n          //could be during the repeatDelay part. No need to render and fire callbacks.\n          this._tTime = tTime;\n          return this;\n        }\n\n        if (iteration !== prevIteration) {\n          timeline && this._yEase && _propagateYoyoEase(timeline, isYoyo); //repeatRefresh functionality\n\n          if (this.vars.repeatRefresh && !isYoyo && !this._lock && time !== cycleDuration && this._initted) {\n            // this._time will === cycleDuration when we render at EXACTLY the end of an iteration. Without this condition, it'd often do the repeatRefresh render TWICE (again on the very next tick).\n            this._lock = force = 1; //force, otherwise if lazy is true, the _attemptInitTween() will return and we'll jump out and get caught bouncing on each tick.\n\n            this.render(_roundPrecise(cycleDuration * iteration), true).invalidate()._lock = 0;\n          }\n        }\n      }\n\n      if (!this._initted) {\n        if (_attemptInitTween(this, isNegative ? totalTime : time, force, suppressEvents, tTime)) {\n          this._tTime = 0; // in constructor if immediateRender is true, we set _tTime to -_tinyNum to have the playhead cross the starting point but we can't leave _tTime as a negative number.\n\n          return this;\n        }\n\n        if (prevTime !== this._time && !(force && this.vars.repeatRefresh && iteration !== prevIteration)) {\n          // rare edge case - during initialization, an onUpdate in the _startAt (.fromTo()) might force this tween to render at a different spot in which case we should ditch this render() call so that it doesn't revert the values. But we also don't want to dump if we're doing a repeatRefresh render!\n          return this;\n        }\n\n        if (dur !== this._dur) {\n          // while initting, a plugin like InertiaPlugin might alter the duration, so rerun from the start to ensure everything renders as it should.\n          return this.render(totalTime, suppressEvents, force);\n        }\n      }\n\n      this._tTime = tTime;\n      this._time = time;\n\n      if (!this._act && this._ts) {\n        this._act = 1; //as long as it's not paused, force it to be active so that if the user renders independent of the parent timeline, it'll be forced to re-render on the next tick.\n\n        this._lazy = 0;\n      }\n\n      this.ratio = ratio = (yoyoEase || this._ease)(time / dur);\n\n      if (this._from) {\n        this.ratio = ratio = 1 - ratio;\n      }\n\n      if (time && !prevTime && !suppressEvents && !iteration) {\n        _callback(this, \"onStart\");\n\n        if (this._tTime !== tTime) {\n          // in case the onStart triggered a render at a different spot, eject. Like if someone did animation.pause(0.5) or something inside the onStart.\n          return this;\n        }\n      }\n\n      pt = this._pt;\n\n      while (pt) {\n        pt.r(ratio, pt.d);\n        pt = pt._next;\n      }\n\n      timeline && timeline.render(totalTime < 0 ? totalTime : timeline._dur * timeline._ease(time / this._dur), suppressEvents, force) || this._startAt && (this._zTime = totalTime);\n\n      if (this._onUpdate && !suppressEvents) {\n        isNegative && _rewindStartAt(this, totalTime, suppressEvents, force); //note: for performance reasons, we tuck this conditional logic inside less traveled areas (most tweens don't have an onUpdate). We'd just have it at the end before the onComplete, but the values should be updated before any onUpdate is called, so we ALSO put it here and then if it's not called, we do so later near the onComplete.\n\n        _callback(this, \"onUpdate\");\n      }\n\n      this._repeat && iteration !== prevIteration && this.vars.onRepeat && !suppressEvents && this.parent && _callback(this, \"onRepeat\");\n\n      if ((tTime === this._tDur || !tTime) && this._tTime === tTime) {\n        isNegative && !this._onUpdate && _rewindStartAt(this, totalTime, true, true);\n        (totalTime || !dur) && (tTime === this._tDur && this._ts > 0 || !tTime && this._ts < 0) && _removeFromParent(this, 1); // don't remove if we're rendering at exactly a time of 0, as there could be autoRevert values that should get set on the next tick (if the playhead goes backward beyond the startTime, negative totalTime). Don't remove if the timeline is reversed and the playhead isn't at 0, otherwise tl.progress(1).reverse() won't work. Only remove if the playhead is at the end and timeScale is positive, or if the playhead is at 0 and the timeScale is negative.\n\n        if (!suppressEvents && !(isNegative && !prevTime) && (tTime || prevTime || isYoyo)) {\n          // if prevTime and tTime are zero, we shouldn't fire the onReverseComplete. This could happen if you gsap.to(... {paused:true}).play();\n          _callback(this, tTime === tDur ? \"onComplete\" : \"onReverseComplete\", true);\n\n          this._prom && !(tTime < tDur && this.timeScale() > 0) && this._prom();\n        }\n      }\n    }\n\n    return this;\n  };\n\n  _proto3.targets = function targets() {\n    return this._targets;\n  };\n\n  _proto3.invalidate = function invalidate(soft) {\n    // \"soft\" gives us a way to clear out everything EXCEPT the recorded pre-\"from\" portion of from() tweens. Otherwise, for example, if you tween.progress(1).render(0, true true).invalidate(), the \"from\" values would persist and then on the next render, the from() tweens would initialize and the current value would match the \"from\" values, thus animate from the same value to the same value (no animation). We tap into this in ScrollTrigger's refresh() where we must push a tween to completion and then back again but honor its init state in case the tween is dependent on another tween further up on the page.\n    (!soft || !this.vars.runBackwards) && (this._startAt = 0);\n    this._pt = this._op = this._onUpdate = this._lazy = this.ratio = 0;\n    this._ptLookup = [];\n    this.timeline && this.timeline.invalidate(soft);\n    return _Animation2.prototype.invalidate.call(this, soft);\n  };\n\n  _proto3.resetTo = function resetTo(property, value, start, startIsRelative, skipRecursion) {\n    _tickerActive || _ticker.wake();\n    this._ts || this.play();\n    var time = Math.min(this._dur, (this._dp._time - this._start) * this._ts),\n        ratio;\n    this._initted || _initTween(this, time);\n    ratio = this._ease(time / this._dur); // don't just get tween.ratio because it may not have rendered yet.\n    // possible future addition to allow an object with multiple values to update, like tween.resetTo({x: 100, y: 200}); At this point, it doesn't seem worth the added kb given the fact that most users will likely opt for the convenient gsap.quickTo() way of interacting with this method.\n    // if (_isObject(property)) { // performance optimization\n    // \tfor (p in property) {\n    // \t\tif (_updatePropTweens(this, p, property[p], value ? value[p] : null, start, ratio, time)) {\n    // \t\t\treturn this.resetTo(property, value, start, startIsRelative); // if a PropTween wasn't found for the property, it'll get forced with a re-initialization so we need to jump out and start over again.\n    // \t\t}\n    // \t}\n    // } else {\n\n    if (_updatePropTweens(this, property, value, start, startIsRelative, ratio, time, skipRecursion)) {\n      return this.resetTo(property, value, start, startIsRelative, 1); // if a PropTween wasn't found for the property, it'll get forced with a re-initialization so we need to jump out and start over again.\n    } //}\n\n\n    _alignPlayhead(this, 0);\n\n    this.parent || _addLinkedListItem(this._dp, this, \"_first\", \"_last\", this._dp._sort ? \"_start\" : 0);\n    return this.render(0);\n  };\n\n  _proto3.kill = function kill(targets, vars) {\n    if (vars === void 0) {\n      vars = \"all\";\n    }\n\n    if (!targets && (!vars || vars === \"all\")) {\n      this._lazy = this._pt = 0;\n      this.parent ? _interrupt(this) : this.scrollTrigger && this.scrollTrigger.kill(!!_reverting);\n      return this;\n    }\n\n    if (this.timeline) {\n      var tDur = this.timeline.totalDuration();\n      this.timeline.killTweensOf(targets, vars, _overwritingTween && _overwritingTween.vars.overwrite !== true)._first || _interrupt(this); // if nothing is left tweening, interrupt.\n\n      this.parent && tDur !== this.timeline.totalDuration() && _setDuration(this, this._dur * this.timeline._tDur / tDur, 0, 1); // if a nested tween is killed that changes the duration, it should affect this tween's duration. We must use the ratio, though, because sometimes the internal timeline is stretched like for keyframes where they don't all add up to whatever the parent tween's duration was set to.\n\n      return this;\n    }\n\n    var parsedTargets = this._targets,\n        killingTargets = targets ? toArray(targets) : parsedTargets,\n        propTweenLookup = this._ptLookup,\n        firstPT = this._pt,\n        overwrittenProps,\n        curLookup,\n        curOverwriteProps,\n        props,\n        p,\n        pt,\n        i;\n\n    if ((!vars || vars === \"all\") && _arraysMatch(parsedTargets, killingTargets)) {\n      vars === \"all\" && (this._pt = 0);\n      return _interrupt(this);\n    }\n\n    overwrittenProps = this._op = this._op || [];\n\n    if (vars !== \"all\") {\n      //so people can pass in a comma-delimited list of property names\n      if (_isString(vars)) {\n        p = {};\n\n        _forEachName(vars, function (name) {\n          return p[name] = 1;\n        });\n\n        vars = p;\n      }\n\n      vars = _addAliasesToVars(parsedTargets, vars);\n    }\n\n    i = parsedTargets.length;\n\n    while (i--) {\n      if (~killingTargets.indexOf(parsedTargets[i])) {\n        curLookup = propTweenLookup[i];\n\n        if (vars === \"all\") {\n          overwrittenProps[i] = vars;\n          props = curLookup;\n          curOverwriteProps = {};\n        } else {\n          curOverwriteProps = overwrittenProps[i] = overwrittenProps[i] || {};\n          props = vars;\n        }\n\n        for (p in props) {\n          pt = curLookup && curLookup[p];\n\n          if (pt) {\n            if (!(\"kill\" in pt.d) || pt.d.kill(p) === true) {\n              _removeLinkedListItem(this, pt, \"_pt\");\n            }\n\n            delete curLookup[p];\n          }\n\n          if (curOverwriteProps !== \"all\") {\n            curOverwriteProps[p] = 1;\n          }\n        }\n      }\n    }\n\n    this._initted && !this._pt && firstPT && _interrupt(this); //if all tweening properties are killed, kill the tween. Without this line, if there's a tween with multiple targets and then you killTweensOf() each target individually, the tween would technically still remain active and fire its onComplete even though there aren't any more properties tweening.\n\n    return this;\n  };\n\n  Tween.to = function to(targets, vars) {\n    return new Tween(targets, vars, arguments[2]);\n  };\n\n  Tween.from = function from(targets, vars) {\n    return _createTweenType(1, arguments);\n  };\n\n  Tween.delayedCall = function delayedCall(delay, callback, params, scope) {\n    return new Tween(callback, 0, {\n      immediateRender: false,\n      lazy: false,\n      overwrite: false,\n      delay: delay,\n      onComplete: callback,\n      onReverseComplete: callback,\n      onCompleteParams: params,\n      onReverseCompleteParams: params,\n      callbackScope: scope\n    }); // we must use onReverseComplete too for things like timeline.add(() => {...}) which should be triggered in BOTH directions (forward and reverse)\n  };\n\n  Tween.fromTo = function fromTo(targets, fromVars, toVars) {\n    return _createTweenType(2, arguments);\n  };\n\n  Tween.set = function set(targets, vars) {\n    vars.duration = 0;\n    vars.repeatDelay || (vars.repeat = 0);\n    return new Tween(targets, vars);\n  };\n\n  Tween.killTweensOf = function killTweensOf(targets, props, onlyActive) {\n    return _globalTimeline.killTweensOf(targets, props, onlyActive);\n  };\n\n  return Tween;\n}(Animation);\n\n_setDefaults(Tween.prototype, {\n  _targets: [],\n  _lazy: 0,\n  _startAt: 0,\n  _op: 0,\n  _onInit: 0\n}); //add the pertinent timeline methods to Tween instances so that users can chain conveniently and create a timeline automatically. (removed due to concerns that it'd ultimately add to more confusion especially for beginners)\n// _forEachName(\"to,from,fromTo,set,call,add,addLabel,addPause\", name => {\n// \tTween.prototype[name] = function() {\n// \t\tlet tl = new Timeline();\n// \t\treturn _addToTimeline(tl, this)[name].apply(tl, toArray(arguments));\n// \t}\n// });\n//for backward compatibility. Leverage the timeline calls.\n\n\n_forEachName(\"staggerTo,staggerFrom,staggerFromTo\", function (name) {\n  Tween[name] = function () {\n    var tl = new Timeline(),\n        params = _slice.call(arguments, 0);\n\n    params.splice(name === \"staggerFromTo\" ? 5 : 4, 0, 0);\n    return tl[name].apply(tl, params);\n  };\n});\n/*\n * --------------------------------------------------------------------------------------\n * PROPTWEEN\n * --------------------------------------------------------------------------------------\n */\n\n\nvar _setterPlain = function _setterPlain(target, property, value) {\n  return target[property] = value;\n},\n    _setterFunc = function _setterFunc(target, property, value) {\n  return target[property](value);\n},\n    _setterFuncWithParam = function _setterFuncWithParam(target, property, value, data) {\n  return target[property](data.fp, value);\n},\n    _setterAttribute = function _setterAttribute(target, property, value) {\n  return target.setAttribute(property, value);\n},\n    _getSetter = function _getSetter(target, property) {\n  return _isFunction(target[property]) ? _setterFunc : _isUndefined(target[property]) && target.setAttribute ? _setterAttribute : _setterPlain;\n},\n    _renderPlain = function _renderPlain(ratio, data) {\n  return data.set(data.t, data.p, Math.round((data.s + data.c * ratio) * 1000000) / 1000000, data);\n},\n    _renderBoolean = function _renderBoolean(ratio, data) {\n  return data.set(data.t, data.p, !!(data.s + data.c * ratio), data);\n},\n    _renderComplexString = function _renderComplexString(ratio, data) {\n  var pt = data._pt,\n      s = \"\";\n\n  if (!ratio && data.b) {\n    //b = beginning string\n    s = data.b;\n  } else if (ratio === 1 && data.e) {\n    //e = ending string\n    s = data.e;\n  } else {\n    while (pt) {\n      s = pt.p + (pt.m ? pt.m(pt.s + pt.c * ratio) : Math.round((pt.s + pt.c * ratio) * 10000) / 10000) + s; //we use the \"p\" property for the text inbetween (like a suffix). And in the context of a complex string, the modifier (m) is typically just Math.round(), like for RGB colors.\n\n      pt = pt._next;\n    }\n\n    s += data.c; //we use the \"c\" of the PropTween to store the final chunk of non-numeric text.\n  }\n\n  data.set(data.t, data.p, s, data);\n},\n    _renderPropTweens = function _renderPropTweens(ratio, data) {\n  var pt = data._pt;\n\n  while (pt) {\n    pt.r(ratio, pt.d);\n    pt = pt._next;\n  }\n},\n    _addPluginModifier = function _addPluginModifier(modifier, tween, target, property) {\n  var pt = this._pt,\n      next;\n\n  while (pt) {\n    next = pt._next;\n    pt.p === property && pt.modifier(modifier, tween, target);\n    pt = next;\n  }\n},\n    _killPropTweensOf = function _killPropTweensOf(property) {\n  var pt = this._pt,\n      hasNonDependentRemaining,\n      next;\n\n  while (pt) {\n    next = pt._next;\n\n    if (pt.p === property && !pt.op || pt.op === property) {\n      _removeLinkedListItem(this, pt, \"_pt\");\n    } else if (!pt.dep) {\n      hasNonDependentRemaining = 1;\n    }\n\n    pt = next;\n  }\n\n  return !hasNonDependentRemaining;\n},\n    _setterWithModifier = function _setterWithModifier(target, property, value, data) {\n  data.mSet(target, property, data.m.call(data.tween, value, data.mt), data);\n},\n    _sortPropTweensByPriority = function _sortPropTweensByPriority(parent) {\n  var pt = parent._pt,\n      next,\n      pt2,\n      first,\n      last; //sorts the PropTween linked list in order of priority because some plugins need to do their work after ALL of the PropTweens were created (like RoundPropsPlugin and ModifiersPlugin)\n\n  while (pt) {\n    next = pt._next;\n    pt2 = first;\n\n    while (pt2 && pt2.pr > pt.pr) {\n      pt2 = pt2._next;\n    }\n\n    if (pt._prev = pt2 ? pt2._prev : last) {\n      pt._prev._next = pt;\n    } else {\n      first = pt;\n    }\n\n    if (pt._next = pt2) {\n      pt2._prev = pt;\n    } else {\n      last = pt;\n    }\n\n    pt = next;\n  }\n\n  parent._pt = first;\n}; //PropTween key: t = target, p = prop, r = renderer, d = data, s = start, c = change, op = overwriteProperty (ONLY populated when it's different than p), pr = priority, _next/_prev for the linked list siblings, set = setter, m = modifier, mSet = modifierSetter (the original setter, before a modifier was added)\n\n\nexport var PropTween = /*#__PURE__*/function () {\n  function PropTween(next, target, prop, start, change, renderer, data, setter, priority) {\n    this.t = target;\n    this.s = start;\n    this.c = change;\n    this.p = prop;\n    this.r = renderer || _renderPlain;\n    this.d = data || this;\n    this.set = setter || _setterPlain;\n    this.pr = priority || 0;\n    this._next = next;\n\n    if (next) {\n      next._prev = this;\n    }\n  }\n\n  var _proto4 = PropTween.prototype;\n\n  _proto4.modifier = function modifier(func, tween, target) {\n    this.mSet = this.mSet || this.set; //in case it was already set (a PropTween can only have one modifier)\n\n    this.set = _setterWithModifier;\n    this.m = func;\n    this.mt = target; //modifier target\n\n    this.tween = tween;\n  };\n\n  return PropTween;\n}(); //Initialization tasks\n\n_forEachName(_callbackNames + \"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger\", function (name) {\n  return _reservedProps[name] = 1;\n});\n\n_globals.TweenMax = _globals.TweenLite = Tween;\n_globals.TimelineLite = _globals.TimelineMax = Timeline;\n_globalTimeline = new Timeline({\n  sortChildren: false,\n  defaults: _defaults,\n  autoRemoveChildren: true,\n  id: \"root\",\n  smoothChildTiming: true\n});\n_config.stringFilter = _colorStringFilter;\n\nvar _media = [],\n    _listeners = {},\n    _emptyArray = [],\n    _lastMediaTime = 0,\n    _contextID = 0,\n    _dispatch = function _dispatch(type) {\n  return (_listeners[type] || _emptyArray).map(function (f) {\n    return f();\n  });\n},\n    _onMediaChange = function _onMediaChange() {\n  var time = Date.now(),\n      matches = [];\n\n  if (time - _lastMediaTime > 2) {\n    _dispatch(\"matchMediaInit\");\n\n    _media.forEach(function (c) {\n      var queries = c.queries,\n          conditions = c.conditions,\n          match,\n          p,\n          anyMatch,\n          toggled;\n\n      for (p in queries) {\n        match = _win.matchMedia(queries[p]).matches; // Firefox doesn't update the \"matches\" property of the MediaQueryList object correctly - it only does so as it calls its change handler - so we must re-create a media query here to ensure it's accurate.\n\n        match && (anyMatch = 1);\n\n        if (match !== conditions[p]) {\n          conditions[p] = match;\n          toggled = 1;\n        }\n      }\n\n      if (toggled) {\n        c.revert();\n        anyMatch && matches.push(c);\n      }\n    });\n\n    _dispatch(\"matchMediaRevert\");\n\n    matches.forEach(function (c) {\n      return c.onMatch(c, function (func) {\n        return c.add(null, func);\n      });\n    });\n    _lastMediaTime = time;\n\n    _dispatch(\"matchMedia\");\n  }\n};\n\nvar Context = /*#__PURE__*/function () {\n  function Context(func, scope) {\n    this.selector = scope && selector(scope);\n    this.data = [];\n    this._r = []; // returned/cleanup functions\n\n    this.isReverted = false;\n    this.id = _contextID++; // to work around issues that frameworks like Vue cause by making things into Proxies which make it impossible to do something like _media.indexOf(this) because \"this\" would no longer refer to the Context instance itself - it'd refer to a Proxy! We needed a way to identify the context uniquely\n\n    func && this.add(func);\n  }\n\n  var _proto5 = Context.prototype;\n\n  _proto5.add = function add(name, func, scope) {\n    // possible future addition if we need the ability to add() an animation to a context and for whatever reason cannot create that animation inside of a context.add(() => {...}) function.\n    // if (name && _isFunction(name.revert)) {\n    // \tthis.data.push(name);\n    // \treturn (name._ctx = this);\n    // }\n    if (_isFunction(name)) {\n      scope = func;\n      func = name;\n      name = _isFunction;\n    }\n\n    var self = this,\n        f = function f() {\n      var prev = _context,\n          prevSelector = self.selector,\n          result;\n      prev && prev !== self && prev.data.push(self);\n      scope && (self.selector = selector(scope));\n      _context = self;\n      result = func.apply(self, arguments);\n      _isFunction(result) && self._r.push(result);\n      _context = prev;\n      self.selector = prevSelector;\n      self.isReverted = false;\n      return result;\n    };\n\n    self.last = f;\n    return name === _isFunction ? f(self, function (func) {\n      return self.add(null, func);\n    }) : name ? self[name] = f : f;\n  };\n\n  _proto5.ignore = function ignore(func) {\n    var prev = _context;\n    _context = null;\n    func(this);\n    _context = prev;\n  };\n\n  _proto5.getTweens = function getTweens() {\n    var a = [];\n    this.data.forEach(function (e) {\n      return e instanceof Context ? a.push.apply(a, e.getTweens()) : e instanceof Tween && !(e.parent && e.parent.data === \"nested\") && a.push(e);\n    });\n    return a;\n  };\n\n  _proto5.clear = function clear() {\n    this._r.length = this.data.length = 0;\n  };\n\n  _proto5.kill = function kill(revert, matchMedia) {\n    var _this4 = this;\n\n    if (revert) {\n      (function () {\n        var tweens = _this4.getTweens(),\n            i = _this4.data.length,\n            t;\n\n        while (i--) {\n          // Flip plugin tweens are very different in that they should actually be pushed to their end. The plugin replaces the timeline's .revert() method to do exactly that. But we also need to remove any of those nested tweens inside the flip timeline so that they don't get individually reverted.\n          t = _this4.data[i];\n\n          if (t.data === \"isFlip\") {\n            t.revert();\n            t.getChildren(true, true, false).forEach(function (tween) {\n              return tweens.splice(tweens.indexOf(tween), 1);\n            });\n          }\n        } // save as an object so that we can cache the globalTime for each tween to optimize performance during the sort\n\n\n        tweens.map(function (t) {\n          return {\n            g: t._dur || t._delay || t._sat && !t._sat.vars.immediateRender ? t.globalTime(0) : -Infinity,\n            t: t\n          };\n        }).sort(function (a, b) {\n          return b.g - a.g || -Infinity;\n        }).forEach(function (o) {\n          return o.t.revert(revert);\n        }); // note: all of the _startAt tweens should be reverted in reverse order that they were created, and they'll all have the same globalTime (-1) so the \" || -1\" in the sort keeps the order properly.\n\n        i = _this4.data.length;\n\n        while (i--) {\n          // make sure we loop backwards so that, for example, SplitTexts that were created later on the same element get reverted first\n          t = _this4.data[i];\n\n          if (t instanceof Timeline) {\n            if (t.data !== \"nested\") {\n              t.scrollTrigger && t.scrollTrigger.revert();\n              t.kill(); // don't revert() the timeline because that's duplicating efforts since we already reverted all the tweens\n            }\n          } else {\n            !(t instanceof Tween) && t.revert && t.revert(revert);\n          }\n        }\n\n        _this4._r.forEach(function (f) {\n          return f(revert, _this4);\n        });\n\n        _this4.isReverted = true;\n      })();\n    } else {\n      this.data.forEach(function (e) {\n        return e.kill && e.kill();\n      });\n    }\n\n    this.clear();\n\n    if (matchMedia) {\n      var i = _media.length;\n\n      while (i--) {\n        // previously, we checked _media.indexOf(this), but some frameworks like Vue enforce Proxy objects that make it impossible to get the proper result that way, so we must use a unique ID number instead.\n        _media[i].id === this.id && _media.splice(i, 1);\n      }\n    }\n  } // killWithCleanup() {\n  // \tthis.kill();\n  // \tthis._r.forEach(f => f(false, this));\n  // }\n  ;\n\n  _proto5.revert = function revert(config) {\n    this.kill(config || {});\n  };\n\n  return Context;\n}();\n\nvar MatchMedia = /*#__PURE__*/function () {\n  function MatchMedia(scope) {\n    this.contexts = [];\n    this.scope = scope;\n    _context && _context.data.push(this);\n  }\n\n  var _proto6 = MatchMedia.prototype;\n\n  _proto6.add = function add(conditions, func, scope) {\n    _isObject(conditions) || (conditions = {\n      matches: conditions\n    });\n    var context = new Context(0, scope || this.scope),\n        cond = context.conditions = {},\n        mq,\n        p,\n        active;\n    _context && !context.selector && (context.selector = _context.selector); // in case a context is created inside a context. Like a gsap.matchMedia() that's inside a scoped gsap.context()\n\n    this.contexts.push(context);\n    func = context.add(\"onMatch\", func);\n    context.queries = conditions;\n\n    for (p in conditions) {\n      if (p === \"all\") {\n        active = 1;\n      } else {\n        mq = _win.matchMedia(conditions[p]);\n\n        if (mq) {\n          _media.indexOf(context) < 0 && _media.push(context);\n          (cond[p] = mq.matches) && (active = 1);\n          mq.addListener ? mq.addListener(_onMediaChange) : mq.addEventListener(\"change\", _onMediaChange);\n        }\n      }\n    }\n\n    active && func(context, function (f) {\n      return context.add(null, f);\n    });\n    return this;\n  } // refresh() {\n  // \tlet time = _lastMediaTime,\n  // \t\tmedia = _media;\n  // \t_lastMediaTime = -1;\n  // \t_media = this.contexts;\n  // \t_onMediaChange();\n  // \t_lastMediaTime = time;\n  // \t_media = media;\n  // }\n  ;\n\n  _proto6.revert = function revert(config) {\n    this.kill(config || {});\n  };\n\n  _proto6.kill = function kill(revert) {\n    this.contexts.forEach(function (c) {\n      return c.kill(revert, true);\n    });\n  };\n\n  return MatchMedia;\n}();\n/*\n * --------------------------------------------------------------------------------------\n * GSAP\n * --------------------------------------------------------------------------------------\n */\n\n\nvar _gsap = {\n  registerPlugin: function registerPlugin() {\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    args.forEach(function (config) {\n      return _createPlugin(config);\n    });\n  },\n  timeline: function timeline(vars) {\n    return new Timeline(vars);\n  },\n  getTweensOf: function getTweensOf(targets, onlyActive) {\n    return _globalTimeline.getTweensOf(targets, onlyActive);\n  },\n  getProperty: function getProperty(target, property, unit, uncache) {\n    _isString(target) && (target = toArray(target)[0]); //in case selector text or an array is passed in\n\n    var getter = _getCache(target || {}).get,\n        format = unit ? _passThrough : _numericIfPossible;\n\n    unit === \"native\" && (unit = \"\");\n    return !target ? target : !property ? function (property, unit, uncache) {\n      return format((_plugins[property] && _plugins[property].get || getter)(target, property, unit, uncache));\n    } : format((_plugins[property] && _plugins[property].get || getter)(target, property, unit, uncache));\n  },\n  quickSetter: function quickSetter(target, property, unit) {\n    target = toArray(target);\n\n    if (target.length > 1) {\n      var setters = target.map(function (t) {\n        return gsap.quickSetter(t, property, unit);\n      }),\n          l = setters.length;\n      return function (value) {\n        var i = l;\n\n        while (i--) {\n          setters[i](value);\n        }\n      };\n    }\n\n    target = target[0] || {};\n\n    var Plugin = _plugins[property],\n        cache = _getCache(target),\n        p = cache.harness && (cache.harness.aliases || {})[property] || property,\n        // in case it's an alias, like \"rotate\" for \"rotation\".\n    setter = Plugin ? function (value) {\n      var p = new Plugin();\n      _quickTween._pt = 0;\n      p.init(target, unit ? value + unit : value, _quickTween, 0, [target]);\n      p.render(1, p);\n      _quickTween._pt && _renderPropTweens(1, _quickTween);\n    } : cache.set(target, p);\n\n    return Plugin ? setter : function (value) {\n      return setter(target, p, unit ? value + unit : value, cache, 1);\n    };\n  },\n  quickTo: function quickTo(target, property, vars) {\n    var _setDefaults2;\n\n    var tween = gsap.to(target, _setDefaults((_setDefaults2 = {}, _setDefaults2[property] = \"+=0.1\", _setDefaults2.paused = true, _setDefaults2.stagger = 0, _setDefaults2), vars || {})),\n        func = function func(value, start, startIsRelative) {\n      return tween.resetTo(property, value, start, startIsRelative);\n    };\n\n    func.tween = tween;\n    return func;\n  },\n  isTweening: function isTweening(targets) {\n    return _globalTimeline.getTweensOf(targets, true).length > 0;\n  },\n  defaults: function defaults(value) {\n    value && value.ease && (value.ease = _parseEase(value.ease, _defaults.ease));\n    return _mergeDeep(_defaults, value || {});\n  },\n  config: function config(value) {\n    return _mergeDeep(_config, value || {});\n  },\n  registerEffect: function registerEffect(_ref3) {\n    var name = _ref3.name,\n        effect = _ref3.effect,\n        plugins = _ref3.plugins,\n        defaults = _ref3.defaults,\n        extendTimeline = _ref3.extendTimeline;\n    (plugins || \"\").split(\",\").forEach(function (pluginName) {\n      return pluginName && !_plugins[pluginName] && !_globals[pluginName] && _warn(name + \" effect requires \" + pluginName + \" plugin.\");\n    });\n\n    _effects[name] = function (targets, vars, tl) {\n      return effect(toArray(targets), _setDefaults(vars || {}, defaults), tl);\n    };\n\n    if (extendTimeline) {\n      Timeline.prototype[name] = function (targets, vars, position) {\n        return this.add(_effects[name](targets, _isObject(vars) ? vars : (position = vars) && {}, this), position);\n      };\n    }\n  },\n  registerEase: function registerEase(name, ease) {\n    _easeMap[name] = _parseEase(ease);\n  },\n  parseEase: function parseEase(ease, defaultEase) {\n    return arguments.length ? _parseEase(ease, defaultEase) : _easeMap;\n  },\n  getById: function getById(id) {\n    return _globalTimeline.getById(id);\n  },\n  exportRoot: function exportRoot(vars, includeDelayedCalls) {\n    if (vars === void 0) {\n      vars = {};\n    }\n\n    var tl = new Timeline(vars),\n        child,\n        next;\n    tl.smoothChildTiming = _isNotFalse(vars.smoothChildTiming);\n\n    _globalTimeline.remove(tl);\n\n    tl._dp = 0; //otherwise it'll get re-activated when adding children and be re-introduced into _globalTimeline's linked list (then added to itself).\n\n    tl._time = tl._tTime = _globalTimeline._time;\n    child = _globalTimeline._first;\n\n    while (child) {\n      next = child._next;\n\n      if (includeDelayedCalls || !(!child._dur && child instanceof Tween && child.vars.onComplete === child._targets[0])) {\n        _addToTimeline(tl, child, child._start - child._delay);\n      }\n\n      child = next;\n    }\n\n    _addToTimeline(_globalTimeline, tl, 0);\n\n    return tl;\n  },\n  context: function context(func, scope) {\n    return func ? new Context(func, scope) : _context;\n  },\n  matchMedia: function matchMedia(scope) {\n    return new MatchMedia(scope);\n  },\n  matchMediaRefresh: function matchMediaRefresh() {\n    return _media.forEach(function (c) {\n      var cond = c.conditions,\n          found,\n          p;\n\n      for (p in cond) {\n        if (cond[p]) {\n          cond[p] = false;\n          found = 1;\n        }\n      }\n\n      found && c.revert();\n    }) || _onMediaChange();\n  },\n  addEventListener: function addEventListener(type, callback) {\n    var a = _listeners[type] || (_listeners[type] = []);\n    ~a.indexOf(callback) || a.push(callback);\n  },\n  removeEventListener: function removeEventListener(type, callback) {\n    var a = _listeners[type],\n        i = a && a.indexOf(callback);\n    i >= 0 && a.splice(i, 1);\n  },\n  utils: {\n    wrap: wrap,\n    wrapYoyo: wrapYoyo,\n    distribute: distribute,\n    random: random,\n    snap: snap,\n    normalize: normalize,\n    getUnit: getUnit,\n    clamp: clamp,\n    splitColor: splitColor,\n    toArray: toArray,\n    selector: selector,\n    mapRange: mapRange,\n    pipe: pipe,\n    unitize: unitize,\n    interpolate: interpolate,\n    shuffle: shuffle\n  },\n  install: _install,\n  effects: _effects,\n  ticker: _ticker,\n  updateRoot: Timeline.updateRoot,\n  plugins: _plugins,\n  globalTimeline: _globalTimeline,\n  core: {\n    PropTween: PropTween,\n    globals: _addGlobal,\n    Tween: Tween,\n    Timeline: Timeline,\n    Animation: Animation,\n    getCache: _getCache,\n    _removeLinkedListItem: _removeLinkedListItem,\n    reverting: function reverting() {\n      return _reverting;\n    },\n    context: function context(toAdd) {\n      if (toAdd && _context) {\n        _context.data.push(toAdd);\n\n        toAdd._ctx = _context;\n      }\n\n      return _context;\n    },\n    suppressOverwrites: function suppressOverwrites(value) {\n      return _suppressOverwrites = value;\n    }\n  }\n};\n\n_forEachName(\"to,from,fromTo,delayedCall,set,killTweensOf\", function (name) {\n  return _gsap[name] = Tween[name];\n});\n\n_ticker.add(Timeline.updateRoot);\n\n_quickTween = _gsap.to({}, {\n  duration: 0\n}); // ---- EXTRA PLUGINS --------------------------------------------------------\n\nvar _getPluginPropTween = function _getPluginPropTween(plugin, prop) {\n  var pt = plugin._pt;\n\n  while (pt && pt.p !== prop && pt.op !== prop && pt.fp !== prop) {\n    pt = pt._next;\n  }\n\n  return pt;\n},\n    _addModifiers = function _addModifiers(tween, modifiers) {\n  var targets = tween._targets,\n      p,\n      i,\n      pt;\n\n  for (p in modifiers) {\n    i = targets.length;\n\n    while (i--) {\n      pt = tween._ptLookup[i][p];\n\n      if (pt && (pt = pt.d)) {\n        if (pt._pt) {\n          // is a plugin\n          pt = _getPluginPropTween(pt, p);\n        }\n\n        pt && pt.modifier && pt.modifier(modifiers[p], tween, targets[i], p);\n      }\n    }\n  }\n},\n    _buildModifierPlugin = function _buildModifierPlugin(name, modifier) {\n  return {\n    name: name,\n    rawVars: 1,\n    //don't pre-process function-based values or \"random()\" strings.\n    init: function init(target, vars, tween) {\n      tween._onInit = function (tween) {\n        var temp, p;\n\n        if (_isString(vars)) {\n          temp = {};\n\n          _forEachName(vars, function (name) {\n            return temp[name] = 1;\n          }); //if the user passes in a comma-delimited list of property names to roundProps, like \"x,y\", we round to whole numbers.\n\n\n          vars = temp;\n        }\n\n        if (modifier) {\n          temp = {};\n\n          for (p in vars) {\n            temp[p] = modifier(vars[p]);\n          }\n\n          vars = temp;\n        }\n\n        _addModifiers(tween, vars);\n      };\n    }\n  };\n}; //register core plugins\n\n\nexport var gsap = _gsap.registerPlugin({\n  name: \"attr\",\n  init: function init(target, vars, tween, index, targets) {\n    var p, pt, v;\n    this.tween = tween;\n\n    for (p in vars) {\n      v = target.getAttribute(p) || \"\";\n      pt = this.add(target, \"setAttribute\", (v || 0) + \"\", vars[p], index, targets, 0, 0, p);\n      pt.op = p;\n      pt.b = v; // record the beginning value so we can revert()\n\n      this._props.push(p);\n    }\n  },\n  render: function render(ratio, data) {\n    var pt = data._pt;\n\n    while (pt) {\n      _reverting ? pt.set(pt.t, pt.p, pt.b, pt) : pt.r(ratio, pt.d); // if reverting, go back to the original (pt.b)\n\n      pt = pt._next;\n    }\n  }\n}, {\n  name: \"endArray\",\n  init: function init(target, value) {\n    var i = value.length;\n\n    while (i--) {\n      this.add(target, i, target[i] || 0, value[i], 0, 0, 0, 0, 0, 1);\n    }\n  }\n}, _buildModifierPlugin(\"roundProps\", _roundModifier), _buildModifierPlugin(\"modifiers\"), _buildModifierPlugin(\"snap\", snap)) || _gsap; //to prevent the core plugins from being dropped via aggressive tree shaking, we must include them in the variable declaration in this way.\n\nTween.version = Timeline.version = gsap.version = \"3.12.7\";\n_coreReady = 1;\n_windowExists() && _wake();\nvar Power0 = _easeMap.Power0,\n    Power1 = _easeMap.Power1,\n    Power2 = _easeMap.Power2,\n    Power3 = _easeMap.Power3,\n    Power4 = _easeMap.Power4,\n    Linear = _easeMap.Linear,\n    Quad = _easeMap.Quad,\n    Cubic = _easeMap.Cubic,\n    Quart = _easeMap.Quart,\n    Quint = _easeMap.Quint,\n    Strong = _easeMap.Strong,\n    Elastic = _easeMap.Elastic,\n    Back = _easeMap.Back,\n    SteppedEase = _easeMap.SteppedEase,\n    Bounce = _easeMap.Bounce,\n    Sine = _easeMap.Sine,\n    Expo = _easeMap.Expo,\n    Circ = _easeMap.Circ;\nexport { Power0, Power1, Power2, Power3, Power4, Linear, Quad, Cubic, Quart, Quint, Strong, Elastic, Back, SteppedEase, Bounce, Sine, Expo, Circ };\nexport { Tween as TweenMax, Tween as TweenLite, Timeline as TimelineMax, Timeline as TimelineLite, gsap as default, wrap, wrapYoyo, distribute, random, snap, normalize, getUnit, clamp, splitColor, toArray, selector, mapRange, pipe, unitize, interpolate, shuffle }; //export some internal methods/orojects for use in CSSPlugin so that we can externalize that file and allow custom builds that exclude it.\n\nexport { _getProperty, _numExp, _numWithUnitExp, _isString, _isUndefined, _renderComplexString, _relExp, _setDefaults, _removeLinkedListItem, _forEachName, _sortPropTweensByPriority, _colorStringFilter, _replaceRandom, _checkPlugin, _plugins, _ticker, _config, _roundModifier, _round, _missingPlugin, _getSetter, _getCache, _colorExp, _parseRelative };","/*!\n * CSSPlugin 3.12.7\n * https://gsap.com\n *\n * Copyright 2008-2025, GreenSock. All rights reserved.\n * Subject to the terms at https://gsap.com/standard-license or for\n * Club GSAP members, the agreement issued with that membership.\n * @author: Jack Doyle, jack@greensock.com\n*/\n\n/* eslint-disable */\nimport { gsap, _getProperty, _numExp, _numWithUnitExp, getUnit, _isString, _isUndefined, _renderComplexString, _relExp, _forEachName, _sortPropTweensByPriority, _colorStringFilter, _checkPlugin, _replaceRandom, _plugins, GSCache, PropTween, _config, _ticker, _round, _missingPlugin, _getSetter, _getCache, _colorExp, _parseRelative, _setDefaults, _removeLinkedListItem //for the commented-out className feature.\n} from \"./gsap-core.js\";\n\nvar _win,\n    _doc,\n    _docElement,\n    _pluginInitted,\n    _tempDiv,\n    _tempDivStyler,\n    _recentSetterPlugin,\n    _reverting,\n    _windowExists = function _windowExists() {\n  return typeof window !== \"undefined\";\n},\n    _transformProps = {},\n    _RAD2DEG = 180 / Math.PI,\n    _DEG2RAD = Math.PI / 180,\n    _atan2 = Math.atan2,\n    _bigNum = 1e8,\n    _capsExp = /([A-Z])/g,\n    _horizontalExp = /(left|right|width|margin|padding|x)/i,\n    _complexExp = /[\\s,\\(]\\S/,\n    _propertyAliases = {\n  autoAlpha: \"opacity,visibility\",\n  scale: \"scaleX,scaleY\",\n  alpha: \"opacity\"\n},\n    _renderCSSProp = function _renderCSSProp(ratio, data) {\n  return data.set(data.t, data.p, Math.round((data.s + data.c * ratio) * 10000) / 10000 + data.u, data);\n},\n    _renderPropWithEnd = function _renderPropWithEnd(ratio, data) {\n  return data.set(data.t, data.p, ratio === 1 ? data.e : Math.round((data.s + data.c * ratio) * 10000) / 10000 + data.u, data);\n},\n    _renderCSSPropWithBeginning = function _renderCSSPropWithBeginning(ratio, data) {\n  return data.set(data.t, data.p, ratio ? Math.round((data.s + data.c * ratio) * 10000) / 10000 + data.u : data.b, data);\n},\n    //if units change, we need a way to render the original unit/value when the tween goes all the way back to the beginning (ratio:0)\n_renderRoundedCSSProp = function _renderRoundedCSSProp(ratio, data) {\n  var value = data.s + data.c * ratio;\n  data.set(data.t, data.p, ~~(value + (value < 0 ? -.5 : .5)) + data.u, data);\n},\n    _renderNonTweeningValue = function _renderNonTweeningValue(ratio, data) {\n  return data.set(data.t, data.p, ratio ? data.e : data.b, data);\n},\n    _renderNonTweeningValueOnlyAtEnd = function _renderNonTweeningValueOnlyAtEnd(ratio, data) {\n  return data.set(data.t, data.p, ratio !== 1 ? data.b : data.e, data);\n},\n    _setterCSSStyle = function _setterCSSStyle(target, property, value) {\n  return target.style[property] = value;\n},\n    _setterCSSProp = function _setterCSSProp(target, property, value) {\n  return target.style.setProperty(property, value);\n},\n    _setterTransform = function _setterTransform(target, property, value) {\n  return target._gsap[property] = value;\n},\n    _setterScale = function _setterScale(target, property, value) {\n  return target._gsap.scaleX = target._gsap.scaleY = value;\n},\n    _setterScaleWithRender = function _setterScaleWithRender(target, property, value, data, ratio) {\n  var cache = target._gsap;\n  cache.scaleX = cache.scaleY = value;\n  cache.renderTransform(ratio, cache);\n},\n    _setterTransformWithRender = function _setterTransformWithRender(target, property, value, data, ratio) {\n  var cache = target._gsap;\n  cache[property] = value;\n  cache.renderTransform(ratio, cache);\n},\n    _transformProp = \"transform\",\n    _transformOriginProp = _transformProp + \"Origin\",\n    _saveStyle = function _saveStyle(property, isNotCSS) {\n  var _this = this;\n\n  var target = this.target,\n      style = target.style,\n      cache = target._gsap;\n\n  if (property in _transformProps && style) {\n    this.tfm = this.tfm || {};\n\n    if (property !== \"transform\") {\n      property = _propertyAliases[property] || property;\n      ~property.indexOf(\",\") ? property.split(\",\").forEach(function (a) {\n        return _this.tfm[a] = _get(target, a);\n      }) : this.tfm[property] = cache.x ? cache[property] : _get(target, property); // note: scale would map to \"scaleX,scaleY\", thus we loop and apply them both.\n\n      property === _transformOriginProp && (this.tfm.zOrigin = cache.zOrigin);\n    } else {\n      return _propertyAliases.transform.split(\",\").forEach(function (p) {\n        return _saveStyle.call(_this, p, isNotCSS);\n      });\n    }\n\n    if (this.props.indexOf(_transformProp) >= 0) {\n      return;\n    }\n\n    if (cache.svg) {\n      this.svgo = target.getAttribute(\"data-svg-origin\");\n      this.props.push(_transformOriginProp, isNotCSS, \"\");\n    }\n\n    property = _transformProp;\n  }\n\n  (style || isNotCSS) && this.props.push(property, isNotCSS, style[property]);\n},\n    _removeIndependentTransforms = function _removeIndependentTransforms(style) {\n  if (style.translate) {\n    style.removeProperty(\"translate\");\n    style.removeProperty(\"scale\");\n    style.removeProperty(\"rotate\");\n  }\n},\n    _revertStyle = function _revertStyle() {\n  var props = this.props,\n      target = this.target,\n      style = target.style,\n      cache = target._gsap,\n      i,\n      p;\n\n  for (i = 0; i < props.length; i += 3) {\n    // stored like this: property, isNotCSS, value\n    if (!props[i + 1]) {\n      props[i + 2] ? style[props[i]] = props[i + 2] : style.removeProperty(props[i].substr(0, 2) === \"--\" ? props[i] : props[i].replace(_capsExp, \"-$1\").toLowerCase());\n    } else if (props[i + 1] === 2) {\n      // non-CSS value (function-based)\n      target[props[i]](props[i + 2]);\n    } else {\n      // non-CSS value (not function-based)\n      target[props[i]] = props[i + 2];\n    }\n  }\n\n  if (this.tfm) {\n    for (p in this.tfm) {\n      cache[p] = this.tfm[p];\n    }\n\n    if (cache.svg) {\n      cache.renderTransform();\n      target.setAttribute(\"data-svg-origin\", this.svgo || \"\");\n    }\n\n    i = _reverting();\n\n    if ((!i || !i.isStart) && !style[_transformProp]) {\n      _removeIndependentTransforms(style);\n\n      if (cache.zOrigin && style[_transformOriginProp]) {\n        style[_transformOriginProp] += \" \" + cache.zOrigin + \"px\"; // since we're uncaching, we must put the zOrigin back into the transformOrigin so that we can pull it out accurately when we parse again. Otherwise, we'd lose the z portion of the origin since we extract it to protect from Safari bugs.\n\n        cache.zOrigin = 0;\n        cache.renderTransform();\n      }\n\n      cache.uncache = 1; // if it's a startAt that's being reverted in the _initTween() of the core, we don't need to uncache transforms. This is purely a performance optimization.\n    }\n  }\n},\n    _getStyleSaver = function _getStyleSaver(target, properties) {\n  var saver = {\n    target: target,\n    props: [],\n    revert: _revertStyle,\n    save: _saveStyle\n  };\n  target._gsap || gsap.core.getCache(target); // just make sure there's a _gsap cache defined because we read from it in _saveStyle() and it's more efficient to just check it here once.\n\n  properties && target.style && target.nodeType && properties.split(\",\").forEach(function (p) {\n    return saver.save(p);\n  }); // make sure it's a DOM node too.\n\n  return saver;\n},\n    _supports3D,\n    _createElement = function _createElement(type, ns) {\n  var e = _doc.createElementNS ? _doc.createElementNS((ns || \"http://www.w3.org/1999/xhtml\").replace(/^https/, \"http\"), type) : _doc.createElement(type); //some servers swap in https for http in the namespace which can break things, making \"style\" inaccessible.\n\n  return e && e.style ? e : _doc.createElement(type); //some environments won't allow access to the element's style when created with a namespace in which case we default to the standard createElement() to work around the issue. Also note that when GSAP is embedded directly inside an SVG file, createElement() won't allow access to the style object in Firefox (see https://gsap.com/forums/topic/20215-problem-using-tweenmax-in-standalone-self-containing-svg-file-err-cannot-set-property-csstext-of-undefined/).\n},\n    _getComputedProperty = function _getComputedProperty(target, property, skipPrefixFallback) {\n  var cs = getComputedStyle(target);\n  return cs[property] || cs.getPropertyValue(property.replace(_capsExp, \"-$1\").toLowerCase()) || cs.getPropertyValue(property) || !skipPrefixFallback && _getComputedProperty(target, _checkPropPrefix(property) || property, 1) || \"\"; //css variables may not need caps swapped out for dashes and lowercase.\n},\n    _prefixes = \"O,Moz,ms,Ms,Webkit\".split(\",\"),\n    _checkPropPrefix = function _checkPropPrefix(property, element, preferPrefix) {\n  var e = element || _tempDiv,\n      s = e.style,\n      i = 5;\n\n  if (property in s && !preferPrefix) {\n    return property;\n  }\n\n  property = property.charAt(0).toUpperCase() + property.substr(1);\n\n  while (i-- && !(_prefixes[i] + property in s)) {}\n\n  return i < 0 ? null : (i === 3 ? \"ms\" : i >= 0 ? _prefixes[i] : \"\") + property;\n},\n    _initCore = function _initCore() {\n  if (_windowExists() && window.document) {\n    _win = window;\n    _doc = _win.document;\n    _docElement = _doc.documentElement;\n    _tempDiv = _createElement(\"div\") || {\n      style: {}\n    };\n    _tempDivStyler = _createElement(\"div\");\n    _transformProp = _checkPropPrefix(_transformProp);\n    _transformOriginProp = _transformProp + \"Origin\";\n    _tempDiv.style.cssText = \"border-width:0;line-height:0;position:absolute;padding:0\"; //make sure to override certain properties that may contaminate measurements, in case the user has overreaching style sheets.\n\n    _supports3D = !!_checkPropPrefix(\"perspective\");\n    _reverting = gsap.core.reverting;\n    _pluginInitted = 1;\n  }\n},\n    _getReparentedCloneBBox = function _getReparentedCloneBBox(target) {\n  //works around issues in some browsers (like Firefox) that don't correctly report getBBox() on SVG elements inside a <defs> element and/or <mask>. We try creating an SVG, adding it to the documentElement and toss the element in there so that it's definitely part of the rendering tree, then grab the bbox and if it works, we actually swap out the original getBBox() method for our own that does these extra steps whenever getBBox is needed. This helps ensure that performance is optimal (only do all these extra steps when absolutely necessary...most elements don't need it).\n  var owner = target.ownerSVGElement,\n      svg = _createElement(\"svg\", owner && owner.getAttribute(\"xmlns\") || \"http://www.w3.org/2000/svg\"),\n      clone = target.cloneNode(true),\n      bbox;\n\n  clone.style.display = \"block\";\n  svg.appendChild(clone);\n\n  _docElement.appendChild(svg);\n\n  try {\n    bbox = clone.getBBox();\n  } catch (e) {}\n\n  svg.removeChild(clone);\n\n  _docElement.removeChild(svg);\n\n  return bbox;\n},\n    _getAttributeFallbacks = function _getAttributeFallbacks(target, attributesArray) {\n  var i = attributesArray.length;\n\n  while (i--) {\n    if (target.hasAttribute(attributesArray[i])) {\n      return target.getAttribute(attributesArray[i]);\n    }\n  }\n},\n    _getBBox = function _getBBox(target) {\n  var bounds, cloned;\n\n  try {\n    bounds = target.getBBox(); //Firefox throws errors if you try calling getBBox() on an SVG element that's not rendered (like in a <symbol> or <defs>). https://bugzilla.mozilla.org/show_bug.cgi?id=612118\n  } catch (error) {\n    bounds = _getReparentedCloneBBox(target);\n    cloned = 1;\n  }\n\n  bounds && (bounds.width || bounds.height) || cloned || (bounds = _getReparentedCloneBBox(target)); //some browsers (like Firefox) misreport the bounds if the element has zero width and height (it just assumes it's at x:0, y:0), thus we need to manually grab the position in that case.\n\n  return bounds && !bounds.width && !bounds.x && !bounds.y ? {\n    x: +_getAttributeFallbacks(target, [\"x\", \"cx\", \"x1\"]) || 0,\n    y: +_getAttributeFallbacks(target, [\"y\", \"cy\", \"y1\"]) || 0,\n    width: 0,\n    height: 0\n  } : bounds;\n},\n    _isSVG = function _isSVG(e) {\n  return !!(e.getCTM && (!e.parentNode || e.ownerSVGElement) && _getBBox(e));\n},\n    //reports if the element is an SVG on which getBBox() actually works\n_removeProperty = function _removeProperty(target, property) {\n  if (property) {\n    var style = target.style,\n        first2Chars;\n\n    if (property in _transformProps && property !== _transformOriginProp) {\n      property = _transformProp;\n    }\n\n    if (style.removeProperty) {\n      first2Chars = property.substr(0, 2);\n\n      if (first2Chars === \"ms\" || property.substr(0, 6) === \"webkit\") {\n        //Microsoft and some Webkit browsers don't conform to the standard of capitalizing the first prefix character, so we adjust so that when we prefix the caps with a dash, it's correct (otherwise it'd be \"ms-transform\" instead of \"-ms-transform\" for IE9, for example)\n        property = \"-\" + property;\n      }\n\n      style.removeProperty(first2Chars === \"--\" ? property : property.replace(_capsExp, \"-$1\").toLowerCase());\n    } else {\n      //note: old versions of IE use \"removeAttribute()\" instead of \"removeProperty()\"\n      style.removeAttribute(property);\n    }\n  }\n},\n    _addNonTweeningPT = function _addNonTweeningPT(plugin, target, property, beginning, end, onlySetAtEnd) {\n  var pt = new PropTween(plugin._pt, target, property, 0, 1, onlySetAtEnd ? _renderNonTweeningValueOnlyAtEnd : _renderNonTweeningValue);\n  plugin._pt = pt;\n  pt.b = beginning;\n  pt.e = end;\n\n  plugin._props.push(property);\n\n  return pt;\n},\n    _nonConvertibleUnits = {\n  deg: 1,\n  rad: 1,\n  turn: 1\n},\n    _nonStandardLayouts = {\n  grid: 1,\n  flex: 1\n},\n    //takes a single value like 20px and converts it to the unit specified, like \"%\", returning only the numeric amount.\n_convertToUnit = function _convertToUnit(target, property, value, unit) {\n  var curValue = parseFloat(value) || 0,\n      curUnit = (value + \"\").trim().substr((curValue + \"\").length) || \"px\",\n      // some browsers leave extra whitespace at the beginning of CSS variables, hence the need to trim()\n  style = _tempDiv.style,\n      horizontal = _horizontalExp.test(property),\n      isRootSVG = target.tagName.toLowerCase() === \"svg\",\n      measureProperty = (isRootSVG ? \"client\" : \"offset\") + (horizontal ? \"Width\" : \"Height\"),\n      amount = 100,\n      toPixels = unit === \"px\",\n      toPercent = unit === \"%\",\n      px,\n      parent,\n      cache,\n      isSVG;\n\n  if (unit === curUnit || !curValue || _nonConvertibleUnits[unit] || _nonConvertibleUnits[curUnit]) {\n    return curValue;\n  }\n\n  curUnit !== \"px\" && !toPixels && (curValue = _convertToUnit(target, property, value, \"px\"));\n  isSVG = target.getCTM && _isSVG(target);\n\n  if ((toPercent || curUnit === \"%\") && (_transformProps[property] || ~property.indexOf(\"adius\"))) {\n    px = isSVG ? target.getBBox()[horizontal ? \"width\" : \"height\"] : target[measureProperty];\n    return _round(toPercent ? curValue / px * amount : curValue / 100 * px);\n  }\n\n  style[horizontal ? \"width\" : \"height\"] = amount + (toPixels ? curUnit : unit);\n  parent = unit !== \"rem\" && ~property.indexOf(\"adius\") || unit === \"em\" && target.appendChild && !isRootSVG ? target : target.parentNode;\n\n  if (isSVG) {\n    parent = (target.ownerSVGElement || {}).parentNode;\n  }\n\n  if (!parent || parent === _doc || !parent.appendChild) {\n    parent = _doc.body;\n  }\n\n  cache = parent._gsap;\n\n  if (cache && toPercent && cache.width && horizontal && cache.time === _ticker.time && !cache.uncache) {\n    return _round(curValue / cache.width * amount);\n  } else {\n    if (toPercent && (property === \"height\" || property === \"width\")) {\n      // if we're dealing with width/height that's inside a container with padding and/or it's a flexbox/grid container, we must apply it to the target itself rather than the _tempDiv in order to ensure complete accuracy, factoring in the parent's padding.\n      var v = target.style[property];\n      target.style[property] = amount + unit;\n      px = target[measureProperty];\n      v ? target.style[property] = v : _removeProperty(target, property);\n    } else {\n      (toPercent || curUnit === \"%\") && !_nonStandardLayouts[_getComputedProperty(parent, \"display\")] && (style.position = _getComputedProperty(target, \"position\"));\n      parent === target && (style.position = \"static\"); // like for borderRadius, if it's a % we must have it relative to the target itself but that may not have position: relative or position: absolute in which case it'd go up the chain until it finds its offsetParent (bad). position: static protects against that.\n\n      parent.appendChild(_tempDiv);\n      px = _tempDiv[measureProperty];\n      parent.removeChild(_tempDiv);\n      style.position = \"absolute\";\n    }\n\n    if (horizontal && toPercent) {\n      cache = _getCache(parent);\n      cache.time = _ticker.time;\n      cache.width = parent[measureProperty];\n    }\n  }\n\n  return _round(toPixels ? px * curValue / amount : px && curValue ? amount / px * curValue : 0);\n},\n    _get = function _get(target, property, unit, uncache) {\n  var value;\n  _pluginInitted || _initCore();\n\n  if (property in _propertyAliases && property !== \"transform\") {\n    property = _propertyAliases[property];\n\n    if (~property.indexOf(\",\")) {\n      property = property.split(\",\")[0];\n    }\n  }\n\n  if (_transformProps[property] && property !== \"transform\") {\n    value = _parseTransform(target, uncache);\n    value = property !== \"transformOrigin\" ? value[property] : value.svg ? value.origin : _firstTwoOnly(_getComputedProperty(target, _transformOriginProp)) + \" \" + value.zOrigin + \"px\";\n  } else {\n    value = target.style[property];\n\n    if (!value || value === \"auto\" || uncache || ~(value + \"\").indexOf(\"calc(\")) {\n      value = _specialProps[property] && _specialProps[property](target, property, unit) || _getComputedProperty(target, property) || _getProperty(target, property) || (property === \"opacity\" ? 1 : 0); // note: some browsers, like Firefox, don't report borderRadius correctly! Instead, it only reports every corner like  borderTopLeftRadius\n    }\n  }\n\n  return unit && !~(value + \"\").trim().indexOf(\" \") ? _convertToUnit(target, property, value, unit) + unit : value;\n},\n    _tweenComplexCSSString = function _tweenComplexCSSString(target, prop, start, end) {\n  // note: we call _tweenComplexCSSString.call(pluginInstance...) to ensure that it's scoped properly. We may call it from within a plugin too, thus \"this\" would refer to the plugin.\n  if (!start || start === \"none\") {\n    // some browsers like Safari actually PREFER the prefixed property and mis-report the unprefixed value like clipPath (BUG). In other words, even though clipPath exists in the style (\"clipPath\" in target.style) and it's set in the CSS properly (along with -webkit-clip-path), Safari reports clipPath as \"none\" whereas WebkitClipPath reports accurately like \"ellipse(100% 0% at 50% 0%)\", so in this case we must SWITCH to using the prefixed property instead. See https://gsap.com/forums/topic/18310-clippath-doesnt-work-on-ios/\n    var p = _checkPropPrefix(prop, target, 1),\n        s = p && _getComputedProperty(target, p, 1);\n\n    if (s && s !== start) {\n      prop = p;\n      start = s;\n    } else if (prop === \"borderColor\") {\n      start = _getComputedProperty(target, \"borderTopColor\"); // Firefox bug: always reports \"borderColor\" as \"\", so we must fall back to borderTopColor. See https://gsap.com/forums/topic/24583-how-to-return-colors-that-i-had-after-reverse/\n    }\n  }\n\n  var pt = new PropTween(this._pt, target.style, prop, 0, 1, _renderComplexString),\n      index = 0,\n      matchIndex = 0,\n      a,\n      result,\n      startValues,\n      startNum,\n      color,\n      startValue,\n      endValue,\n      endNum,\n      chunk,\n      endUnit,\n      startUnit,\n      endValues;\n  pt.b = start;\n  pt.e = end;\n  start += \"\"; // ensure values are strings\n\n  end += \"\";\n\n  if (end === \"auto\") {\n    startValue = target.style[prop];\n    target.style[prop] = end;\n    end = _getComputedProperty(target, prop) || end;\n    startValue ? target.style[prop] = startValue : _removeProperty(target, prop);\n  }\n\n  a = [start, end];\n\n  _colorStringFilter(a); // pass an array with the starting and ending values and let the filter do whatever it needs to the values. If colors are found, it returns true and then we must match where the color shows up order-wise because for things like boxShadow, sometimes the browser provides the computed values with the color FIRST, but the user provides it with the color LAST, so flip them if necessary. Same for drop-shadow().\n\n\n  start = a[0];\n  end = a[1];\n  startValues = start.match(_numWithUnitExp) || [];\n  endValues = end.match(_numWithUnitExp) || [];\n\n  if (endValues.length) {\n    while (result = _numWithUnitExp.exec(end)) {\n      endValue = result[0];\n      chunk = end.substring(index, result.index);\n\n      if (color) {\n        color = (color + 1) % 5;\n      } else if (chunk.substr(-5) === \"rgba(\" || chunk.substr(-5) === \"hsla(\") {\n        color = 1;\n      }\n\n      if (endValue !== (startValue = startValues[matchIndex++] || \"\")) {\n        startNum = parseFloat(startValue) || 0;\n        startUnit = startValue.substr((startNum + \"\").length);\n        endValue.charAt(1) === \"=\" && (endValue = _parseRelative(startNum, endValue) + startUnit);\n        endNum = parseFloat(endValue);\n        endUnit = endValue.substr((endNum + \"\").length);\n        index = _numWithUnitExp.lastIndex - endUnit.length;\n\n        if (!endUnit) {\n          //if something like \"perspective:300\" is passed in and we must add a unit to the end\n          endUnit = endUnit || _config.units[prop] || startUnit;\n\n          if (index === end.length) {\n            end += endUnit;\n            pt.e += endUnit;\n          }\n        }\n\n        if (startUnit !== endUnit) {\n          startNum = _convertToUnit(target, prop, startValue, endUnit) || 0;\n        } // these nested PropTweens are handled in a special way - we'll never actually call a render or setter method on them. We'll just loop through them in the parent complex string PropTween's render method.\n\n\n        pt._pt = {\n          _next: pt._pt,\n          p: chunk || matchIndex === 1 ? chunk : \",\",\n          //note: SVG spec allows omission of comma/space when a negative sign is wedged between two numbers, like 2.5-5.3 instead of 2.5,-5.3 but when tweening, the negative value may switch to positive, so we insert the comma just in case.\n          s: startNum,\n          c: endNum - startNum,\n          m: color && color < 4 || prop === \"zIndex\" ? Math.round : 0\n        };\n      }\n    }\n\n    pt.c = index < end.length ? end.substring(index, end.length) : \"\"; //we use the \"c\" of the PropTween to store the final part of the string (after the last number)\n  } else {\n    pt.r = prop === \"display\" && end === \"none\" ? _renderNonTweeningValueOnlyAtEnd : _renderNonTweeningValue;\n  }\n\n  _relExp.test(end) && (pt.e = 0); //if the end string contains relative values or dynamic random(...) values, delete the end it so that on the final render we don't actually set it to the string with += or -= characters (forces it to use the calculated value).\n\n  this._pt = pt; //start the linked list with this new PropTween. Remember, we call _tweenComplexCSSString.call(pluginInstance...) to ensure that it's scoped properly. We may call it from within another plugin too, thus \"this\" would refer to the plugin.\n\n  return pt;\n},\n    _keywordToPercent = {\n  top: \"0%\",\n  bottom: \"100%\",\n  left: \"0%\",\n  right: \"100%\",\n  center: \"50%\"\n},\n    _convertKeywordsToPercentages = function _convertKeywordsToPercentages(value) {\n  var split = value.split(\" \"),\n      x = split[0],\n      y = split[1] || \"50%\";\n\n  if (x === \"top\" || x === \"bottom\" || y === \"left\" || y === \"right\") {\n    //the user provided them in the wrong order, so flip them\n    value = x;\n    x = y;\n    y = value;\n  }\n\n  split[0] = _keywordToPercent[x] || x;\n  split[1] = _keywordToPercent[y] || y;\n  return split.join(\" \");\n},\n    _renderClearProps = function _renderClearProps(ratio, data) {\n  if (data.tween && data.tween._time === data.tween._dur) {\n    var target = data.t,\n        style = target.style,\n        props = data.u,\n        cache = target._gsap,\n        prop,\n        clearTransforms,\n        i;\n\n    if (props === \"all\" || props === true) {\n      style.cssText = \"\";\n      clearTransforms = 1;\n    } else {\n      props = props.split(\",\");\n      i = props.length;\n\n      while (--i > -1) {\n        prop = props[i];\n\n        if (_transformProps[prop]) {\n          clearTransforms = 1;\n          prop = prop === \"transformOrigin\" ? _transformOriginProp : _transformProp;\n        }\n\n        _removeProperty(target, prop);\n      }\n    }\n\n    if (clearTransforms) {\n      _removeProperty(target, _transformProp);\n\n      if (cache) {\n        cache.svg && target.removeAttribute(\"transform\");\n        style.scale = style.rotate = style.translate = \"none\";\n\n        _parseTransform(target, 1); // force all the cached values back to \"normal\"/identity, otherwise if there's another tween that's already set to render transforms on this element, it could display the wrong values.\n\n\n        cache.uncache = 1;\n\n        _removeIndependentTransforms(style);\n      }\n    }\n  }\n},\n    // note: specialProps should return 1 if (and only if) they have a non-zero priority. It indicates we need to sort the linked list.\n_specialProps = {\n  clearProps: function clearProps(plugin, target, property, endValue, tween) {\n    if (tween.data !== \"isFromStart\") {\n      var pt = plugin._pt = new PropTween(plugin._pt, target, property, 0, 0, _renderClearProps);\n      pt.u = endValue;\n      pt.pr = -10;\n      pt.tween = tween;\n\n      plugin._props.push(property);\n\n      return 1;\n    }\n  }\n  /* className feature (about 0.4kb gzipped).\n  , className(plugin, target, property, endValue, tween) {\n  \tlet _renderClassName = (ratio, data) => {\n  \t\t\tdata.css.render(ratio, data.css);\n  \t\t\tif (!ratio || ratio === 1) {\n  \t\t\t\tlet inline = data.rmv,\n  \t\t\t\t\ttarget = data.t,\n  \t\t\t\t\tp;\n  \t\t\t\ttarget.setAttribute(\"class\", ratio ? data.e : data.b);\n  \t\t\t\tfor (p in inline) {\n  \t\t\t\t\t_removeProperty(target, p);\n  \t\t\t\t}\n  \t\t\t}\n  \t\t},\n  \t\t_getAllStyles = (target) => {\n  \t\t\tlet styles = {},\n  \t\t\t\tcomputed = getComputedStyle(target),\n  \t\t\t\tp;\n  \t\t\tfor (p in computed) {\n  \t\t\t\tif (isNaN(p) && p !== \"cssText\" && p !== \"length\") {\n  \t\t\t\t\tstyles[p] = computed[p];\n  \t\t\t\t}\n  \t\t\t}\n  \t\t\t_setDefaults(styles, _parseTransform(target, 1));\n  \t\t\treturn styles;\n  \t\t},\n  \t\tstartClassList = target.getAttribute(\"class\"),\n  \t\tstyle = target.style,\n  \t\tcssText = style.cssText,\n  \t\tcache = target._gsap,\n  \t\tclassPT = cache.classPT,\n  \t\tinlineToRemoveAtEnd = {},\n  \t\tdata = {t:target, plugin:plugin, rmv:inlineToRemoveAtEnd, b:startClassList, e:(endValue.charAt(1) !== \"=\") ? endValue : startClassList.replace(new RegExp(\"(?:\\\\s|^)\" + endValue.substr(2) + \"(?![\\\\w-])\"), \"\") + ((endValue.charAt(0) === \"+\") ? \" \" + endValue.substr(2) : \"\")},\n  \t\tchangingVars = {},\n  \t\tstartVars = _getAllStyles(target),\n  \t\ttransformRelated = /(transform|perspective)/i,\n  \t\tendVars, p;\n  \tif (classPT) {\n  \t\tclassPT.r(1, classPT.d);\n  \t\t_removeLinkedListItem(classPT.d.plugin, classPT, \"_pt\");\n  \t}\n  \ttarget.setAttribute(\"class\", data.e);\n  \tendVars = _getAllStyles(target, true);\n  \ttarget.setAttribute(\"class\", startClassList);\n  \tfor (p in endVars) {\n  \t\tif (endVars[p] !== startVars[p] && !transformRelated.test(p)) {\n  \t\t\tchangingVars[p] = endVars[p];\n  \t\t\tif (!style[p] && style[p] !== \"0\") {\n  \t\t\t\tinlineToRemoveAtEnd[p] = 1;\n  \t\t\t}\n  \t\t}\n  \t}\n  \tcache.classPT = plugin._pt = new PropTween(plugin._pt, target, \"className\", 0, 0, _renderClassName, data, 0, -11);\n  \tif (style.cssText !== cssText) { //only apply if things change. Otherwise, in cases like a background-image that's pulled dynamically, it could cause a refresh. See https://gsap.com/forums/topic/20368-possible-gsap-bug-switching-classnames-in-chrome/.\n  \t\tstyle.cssText = cssText; //we recorded cssText before we swapped classes and ran _getAllStyles() because in cases when a className tween is overwritten, we remove all the related tweening properties from that class change (otherwise class-specific stuff can't override properties we've directly set on the target's style object due to specificity).\n  \t}\n  \t_parseTransform(target, true); //to clear the caching of transforms\n  \tdata.css = new gsap.plugins.css();\n  \tdata.css.init(target, changingVars, tween);\n  \tplugin._props.push(...data.css._props);\n  \treturn 1;\n  }\n  */\n\n},\n\n/*\n * --------------------------------------------------------------------------------------\n * TRANSFORMS\n * --------------------------------------------------------------------------------------\n */\n_identity2DMatrix = [1, 0, 0, 1, 0, 0],\n    _rotationalProperties = {},\n    _isNullTransform = function _isNullTransform(value) {\n  return value === \"matrix(1, 0, 0, 1, 0, 0)\" || value === \"none\" || !value;\n},\n    _getComputedTransformMatrixAsArray = function _getComputedTransformMatrixAsArray(target) {\n  var matrixString = _getComputedProperty(target, _transformProp);\n\n  return _isNullTransform(matrixString) ? _identity2DMatrix : matrixString.substr(7).match(_numExp).map(_round);\n},\n    _getMatrix = function _getMatrix(target, force2D) {\n  var cache = target._gsap || _getCache(target),\n      style = target.style,\n      matrix = _getComputedTransformMatrixAsArray(target),\n      parent,\n      nextSibling,\n      temp,\n      addedToDOM;\n\n  if (cache.svg && target.getAttribute(\"transform\")) {\n    temp = target.transform.baseVal.consolidate().matrix; //ensures that even complex values like \"translate(50,60) rotate(135,0,0)\" are parsed because it mashes it into a matrix.\n\n    matrix = [temp.a, temp.b, temp.c, temp.d, temp.e, temp.f];\n    return matrix.join(\",\") === \"1,0,0,1,0,0\" ? _identity2DMatrix : matrix;\n  } else if (matrix === _identity2DMatrix && !target.offsetParent && target !== _docElement && !cache.svg) {\n    //note: if offsetParent is null, that means the element isn't in the normal document flow, like if it has display:none or one of its ancestors has display:none). Firefox returns null for getComputedStyle() if the element is in an iframe that has display:none. https://bugzilla.mozilla.org/show_bug.cgi?id=548397\n    //browsers don't report transforms accurately unless the element is in the DOM and has a display value that's not \"none\". Firefox and Microsoft browsers have a partial bug where they'll report transforms even if display:none BUT not any percentage-based values like translate(-50%, 8px) will be reported as if it's translate(0, 8px).\n    temp = style.display;\n    style.display = \"block\";\n    parent = target.parentNode;\n\n    if (!parent || !target.offsetParent && !target.getBoundingClientRect().width) {\n      // note: in 3.3.0 we switched target.offsetParent to _doc.body.contains(target) to avoid [sometimes unnecessary] MutationObserver calls but that wasn't adequate because there are edge cases where nested position: fixed elements need to get reparented to accurately sense transforms. See https://github.com/greensock/GSAP/issues/388 and https://github.com/greensock/GSAP/issues/375. Note: position: fixed elements report a null offsetParent but they could also be invisible because they're in an ancestor with display: none, so we check getBoundingClientRect(). We only want to alter the DOM if we absolutely have to because it can cause iframe content to reload, like a Vimeo video.\n      addedToDOM = 1; //flag\n\n      nextSibling = target.nextElementSibling;\n\n      _docElement.appendChild(target); //we must add it to the DOM in order to get values properly\n\n    }\n\n    matrix = _getComputedTransformMatrixAsArray(target);\n    temp ? style.display = temp : _removeProperty(target, \"display\");\n\n    if (addedToDOM) {\n      nextSibling ? parent.insertBefore(target, nextSibling) : parent ? parent.appendChild(target) : _docElement.removeChild(target);\n    }\n  }\n\n  return force2D && matrix.length > 6 ? [matrix[0], matrix[1], matrix[4], matrix[5], matrix[12], matrix[13]] : matrix;\n},\n    _applySVGOrigin = function _applySVGOrigin(target, origin, originIsAbsolute, smooth, matrixArray, pluginToAddPropTweensTo) {\n  var cache = target._gsap,\n      matrix = matrixArray || _getMatrix(target, true),\n      xOriginOld = cache.xOrigin || 0,\n      yOriginOld = cache.yOrigin || 0,\n      xOffsetOld = cache.xOffset || 0,\n      yOffsetOld = cache.yOffset || 0,\n      a = matrix[0],\n      b = matrix[1],\n      c = matrix[2],\n      d = matrix[3],\n      tx = matrix[4],\n      ty = matrix[5],\n      originSplit = origin.split(\" \"),\n      xOrigin = parseFloat(originSplit[0]) || 0,\n      yOrigin = parseFloat(originSplit[1]) || 0,\n      bounds,\n      determinant,\n      x,\n      y;\n\n  if (!originIsAbsolute) {\n    bounds = _getBBox(target);\n    xOrigin = bounds.x + (~originSplit[0].indexOf(\"%\") ? xOrigin / 100 * bounds.width : xOrigin);\n    yOrigin = bounds.y + (~(originSplit[1] || originSplit[0]).indexOf(\"%\") ? yOrigin / 100 * bounds.height : yOrigin); // if (!(\"xOrigin\" in cache) && (xOrigin || yOrigin)) { // added in 3.12.3, reverted in 3.12.4; requires more exploration\n    // \txOrigin -= bounds.x;\n    // \tyOrigin -= bounds.y;\n    // }\n  } else if (matrix !== _identity2DMatrix && (determinant = a * d - b * c)) {\n    //if it's zero (like if scaleX and scaleY are zero), skip it to avoid errors with dividing by zero.\n    x = xOrigin * (d / determinant) + yOrigin * (-c / determinant) + (c * ty - d * tx) / determinant;\n    y = xOrigin * (-b / determinant) + yOrigin * (a / determinant) - (a * ty - b * tx) / determinant;\n    xOrigin = x;\n    yOrigin = y; // theory: we only had to do this for smoothing and it assumes that the previous one was not originIsAbsolute.\n  }\n\n  if (smooth || smooth !== false && cache.smooth) {\n    tx = xOrigin - xOriginOld;\n    ty = yOrigin - yOriginOld;\n    cache.xOffset = xOffsetOld + (tx * a + ty * c) - tx;\n    cache.yOffset = yOffsetOld + (tx * b + ty * d) - ty;\n  } else {\n    cache.xOffset = cache.yOffset = 0;\n  }\n\n  cache.xOrigin = xOrigin;\n  cache.yOrigin = yOrigin;\n  cache.smooth = !!smooth;\n  cache.origin = origin;\n  cache.originIsAbsolute = !!originIsAbsolute;\n  target.style[_transformOriginProp] = \"0px 0px\"; //otherwise, if someone sets  an origin via CSS, it will likely interfere with the SVG transform attribute ones (because remember, we're baking the origin into the matrix() value).\n\n  if (pluginToAddPropTweensTo) {\n    _addNonTweeningPT(pluginToAddPropTweensTo, cache, \"xOrigin\", xOriginOld, xOrigin);\n\n    _addNonTweeningPT(pluginToAddPropTweensTo, cache, \"yOrigin\", yOriginOld, yOrigin);\n\n    _addNonTweeningPT(pluginToAddPropTweensTo, cache, \"xOffset\", xOffsetOld, cache.xOffset);\n\n    _addNonTweeningPT(pluginToAddPropTweensTo, cache, \"yOffset\", yOffsetOld, cache.yOffset);\n  }\n\n  target.setAttribute(\"data-svg-origin\", xOrigin + \" \" + yOrigin);\n},\n    _parseTransform = function _parseTransform(target, uncache) {\n  var cache = target._gsap || new GSCache(target);\n\n  if (\"x\" in cache && !uncache && !cache.uncache) {\n    return cache;\n  }\n\n  var style = target.style,\n      invertedScaleX = cache.scaleX < 0,\n      px = \"px\",\n      deg = \"deg\",\n      cs = getComputedStyle(target),\n      origin = _getComputedProperty(target, _transformOriginProp) || \"0\",\n      x,\n      y,\n      z,\n      scaleX,\n      scaleY,\n      rotation,\n      rotationX,\n      rotationY,\n      skewX,\n      skewY,\n      perspective,\n      xOrigin,\n      yOrigin,\n      matrix,\n      angle,\n      cos,\n      sin,\n      a,\n      b,\n      c,\n      d,\n      a12,\n      a22,\n      t1,\n      t2,\n      t3,\n      a13,\n      a23,\n      a33,\n      a42,\n      a43,\n      a32;\n  x = y = z = rotation = rotationX = rotationY = skewX = skewY = perspective = 0;\n  scaleX = scaleY = 1;\n  cache.svg = !!(target.getCTM && _isSVG(target));\n\n  if (cs.translate) {\n    // accommodate independent transforms by combining them into normal ones.\n    if (cs.translate !== \"none\" || cs.scale !== \"none\" || cs.rotate !== \"none\") {\n      style[_transformProp] = (cs.translate !== \"none\" ? \"translate3d(\" + (cs.translate + \" 0 0\").split(\" \").slice(0, 3).join(\", \") + \") \" : \"\") + (cs.rotate !== \"none\" ? \"rotate(\" + cs.rotate + \") \" : \"\") + (cs.scale !== \"none\" ? \"scale(\" + cs.scale.split(\" \").join(\",\") + \") \" : \"\") + (cs[_transformProp] !== \"none\" ? cs[_transformProp] : \"\");\n    }\n\n    style.scale = style.rotate = style.translate = \"none\";\n  }\n\n  matrix = _getMatrix(target, cache.svg);\n\n  if (cache.svg) {\n    if (cache.uncache) {\n      // if cache.uncache is true (and maybe if origin is 0,0), we need to set element.style.transformOrigin = (cache.xOrigin - bbox.x) + \"px \" + (cache.yOrigin - bbox.y) + \"px\". Previously we let the data-svg-origin stay instead, but when introducing revert(), it complicated things.\n      t2 = target.getBBox();\n      origin = cache.xOrigin - t2.x + \"px \" + (cache.yOrigin - t2.y) + \"px\";\n      t1 = \"\";\n    } else {\n      t1 = !uncache && target.getAttribute(\"data-svg-origin\"); //  Remember, to work around browser inconsistencies we always force SVG elements' transformOrigin to 0,0 and offset the translation accordingly.\n    }\n\n    _applySVGOrigin(target, t1 || origin, !!t1 || cache.originIsAbsolute, cache.smooth !== false, matrix);\n  }\n\n  xOrigin = cache.xOrigin || 0;\n  yOrigin = cache.yOrigin || 0;\n\n  if (matrix !== _identity2DMatrix) {\n    a = matrix[0]; //a11\n\n    b = matrix[1]; //a21\n\n    c = matrix[2]; //a31\n\n    d = matrix[3]; //a41\n\n    x = a12 = matrix[4];\n    y = a22 = matrix[5]; //2D matrix\n\n    if (matrix.length === 6) {\n      scaleX = Math.sqrt(a * a + b * b);\n      scaleY = Math.sqrt(d * d + c * c);\n      rotation = a || b ? _atan2(b, a) * _RAD2DEG : 0; //note: if scaleX is 0, we cannot accurately measure rotation. Same for skewX with a scaleY of 0. Therefore, we default to the previously recorded value (or zero if that doesn't exist).\n\n      skewX = c || d ? _atan2(c, d) * _RAD2DEG + rotation : 0;\n      skewX && (scaleY *= Math.abs(Math.cos(skewX * _DEG2RAD)));\n\n      if (cache.svg) {\n        x -= xOrigin - (xOrigin * a + yOrigin * c);\n        y -= yOrigin - (xOrigin * b + yOrigin * d);\n      } //3D matrix\n\n    } else {\n      a32 = matrix[6];\n      a42 = matrix[7];\n      a13 = matrix[8];\n      a23 = matrix[9];\n      a33 = matrix[10];\n      a43 = matrix[11];\n      x = matrix[12];\n      y = matrix[13];\n      z = matrix[14];\n      angle = _atan2(a32, a33);\n      rotationX = angle * _RAD2DEG; //rotationX\n\n      if (angle) {\n        cos = Math.cos(-angle);\n        sin = Math.sin(-angle);\n        t1 = a12 * cos + a13 * sin;\n        t2 = a22 * cos + a23 * sin;\n        t3 = a32 * cos + a33 * sin;\n        a13 = a12 * -sin + a13 * cos;\n        a23 = a22 * -sin + a23 * cos;\n        a33 = a32 * -sin + a33 * cos;\n        a43 = a42 * -sin + a43 * cos;\n        a12 = t1;\n        a22 = t2;\n        a32 = t3;\n      } //rotationY\n\n\n      angle = _atan2(-c, a33);\n      rotationY = angle * _RAD2DEG;\n\n      if (angle) {\n        cos = Math.cos(-angle);\n        sin = Math.sin(-angle);\n        t1 = a * cos - a13 * sin;\n        t2 = b * cos - a23 * sin;\n        t3 = c * cos - a33 * sin;\n        a43 = d * sin + a43 * cos;\n        a = t1;\n        b = t2;\n        c = t3;\n      } //rotationZ\n\n\n      angle = _atan2(b, a);\n      rotation = angle * _RAD2DEG;\n\n      if (angle) {\n        cos = Math.cos(angle);\n        sin = Math.sin(angle);\n        t1 = a * cos + b * sin;\n        t2 = a12 * cos + a22 * sin;\n        b = b * cos - a * sin;\n        a22 = a22 * cos - a12 * sin;\n        a = t1;\n        a12 = t2;\n      }\n\n      if (rotationX && Math.abs(rotationX) + Math.abs(rotation) > 359.9) {\n        //when rotationY is set, it will often be parsed as 180 degrees different than it should be, and rotationX and rotation both being 180 (it looks the same), so we adjust for that here.\n        rotationX = rotation = 0;\n        rotationY = 180 - rotationY;\n      }\n\n      scaleX = _round(Math.sqrt(a * a + b * b + c * c));\n      scaleY = _round(Math.sqrt(a22 * a22 + a32 * a32));\n      angle = _atan2(a12, a22);\n      skewX = Math.abs(angle) > 0.0002 ? angle * _RAD2DEG : 0;\n      perspective = a43 ? 1 / (a43 < 0 ? -a43 : a43) : 0;\n    }\n\n    if (cache.svg) {\n      //sense if there are CSS transforms applied on an SVG element in which case we must overwrite them when rendering. The transform attribute is more reliable cross-browser, but we can't just remove the CSS ones because they may be applied in a CSS rule somewhere (not just inline).\n      t1 = target.getAttribute(\"transform\");\n      cache.forceCSS = target.setAttribute(\"transform\", \"\") || !_isNullTransform(_getComputedProperty(target, _transformProp));\n      t1 && target.setAttribute(\"transform\", t1);\n    }\n  }\n\n  if (Math.abs(skewX) > 90 && Math.abs(skewX) < 270) {\n    if (invertedScaleX) {\n      scaleX *= -1;\n      skewX += rotation <= 0 ? 180 : -180;\n      rotation += rotation <= 0 ? 180 : -180;\n    } else {\n      scaleY *= -1;\n      skewX += skewX <= 0 ? 180 : -180;\n    }\n  }\n\n  uncache = uncache || cache.uncache;\n  cache.x = x - ((cache.xPercent = x && (!uncache && cache.xPercent || (Math.round(target.offsetWidth / 2) === Math.round(-x) ? -50 : 0))) ? target.offsetWidth * cache.xPercent / 100 : 0) + px;\n  cache.y = y - ((cache.yPercent = y && (!uncache && cache.yPercent || (Math.round(target.offsetHeight / 2) === Math.round(-y) ? -50 : 0))) ? target.offsetHeight * cache.yPercent / 100 : 0) + px;\n  cache.z = z + px;\n  cache.scaleX = _round(scaleX);\n  cache.scaleY = _round(scaleY);\n  cache.rotation = _round(rotation) + deg;\n  cache.rotationX = _round(rotationX) + deg;\n  cache.rotationY = _round(rotationY) + deg;\n  cache.skewX = skewX + deg;\n  cache.skewY = skewY + deg;\n  cache.transformPerspective = perspective + px;\n\n  if (cache.zOrigin = parseFloat(origin.split(\" \")[2]) || !uncache && cache.zOrigin || 0) {\n    style[_transformOriginProp] = _firstTwoOnly(origin);\n  }\n\n  cache.xOffset = cache.yOffset = 0;\n  cache.force3D = _config.force3D;\n  cache.renderTransform = cache.svg ? _renderSVGTransforms : _supports3D ? _renderCSSTransforms : _renderNon3DTransforms;\n  cache.uncache = 0;\n  return cache;\n},\n    _firstTwoOnly = function _firstTwoOnly(value) {\n  return (value = value.split(\" \"))[0] + \" \" + value[1];\n},\n    //for handling transformOrigin values, stripping out the 3rd dimension\n_addPxTranslate = function _addPxTranslate(target, start, value) {\n  var unit = getUnit(start);\n  return _round(parseFloat(start) + parseFloat(_convertToUnit(target, \"x\", value + \"px\", unit))) + unit;\n},\n    _renderNon3DTransforms = function _renderNon3DTransforms(ratio, cache) {\n  cache.z = \"0px\";\n  cache.rotationY = cache.rotationX = \"0deg\";\n  cache.force3D = 0;\n\n  _renderCSSTransforms(ratio, cache);\n},\n    _zeroDeg = \"0deg\",\n    _zeroPx = \"0px\",\n    _endParenthesis = \") \",\n    _renderCSSTransforms = function _renderCSSTransforms(ratio, cache) {\n  var _ref = cache || this,\n      xPercent = _ref.xPercent,\n      yPercent = _ref.yPercent,\n      x = _ref.x,\n      y = _ref.y,\n      z = _ref.z,\n      rotation = _ref.rotation,\n      rotationY = _ref.rotationY,\n      rotationX = _ref.rotationX,\n      skewX = _ref.skewX,\n      skewY = _ref.skewY,\n      scaleX = _ref.scaleX,\n      scaleY = _ref.scaleY,\n      transformPerspective = _ref.transformPerspective,\n      force3D = _ref.force3D,\n      target = _ref.target,\n      zOrigin = _ref.zOrigin,\n      transforms = \"\",\n      use3D = force3D === \"auto\" && ratio && ratio !== 1 || force3D === true; // Safari has a bug that causes it not to render 3D transform-origin values properly, so we force the z origin to 0, record it in the cache, and then do the math here to offset the translate values accordingly (basically do the 3D transform-origin part manually)\n\n\n  if (zOrigin && (rotationX !== _zeroDeg || rotationY !== _zeroDeg)) {\n    var angle = parseFloat(rotationY) * _DEG2RAD,\n        a13 = Math.sin(angle),\n        a33 = Math.cos(angle),\n        cos;\n\n    angle = parseFloat(rotationX) * _DEG2RAD;\n    cos = Math.cos(angle);\n    x = _addPxTranslate(target, x, a13 * cos * -zOrigin);\n    y = _addPxTranslate(target, y, -Math.sin(angle) * -zOrigin);\n    z = _addPxTranslate(target, z, a33 * cos * -zOrigin + zOrigin);\n  }\n\n  if (transformPerspective !== _zeroPx) {\n    transforms += \"perspective(\" + transformPerspective + _endParenthesis;\n  }\n\n  if (xPercent || yPercent) {\n    transforms += \"translate(\" + xPercent + \"%, \" + yPercent + \"%) \";\n  }\n\n  if (use3D || x !== _zeroPx || y !== _zeroPx || z !== _zeroPx) {\n    transforms += z !== _zeroPx || use3D ? \"translate3d(\" + x + \", \" + y + \", \" + z + \") \" : \"translate(\" + x + \", \" + y + _endParenthesis;\n  }\n\n  if (rotation !== _zeroDeg) {\n    transforms += \"rotate(\" + rotation + _endParenthesis;\n  }\n\n  if (rotationY !== _zeroDeg) {\n    transforms += \"rotateY(\" + rotationY + _endParenthesis;\n  }\n\n  if (rotationX !== _zeroDeg) {\n    transforms += \"rotateX(\" + rotationX + _endParenthesis;\n  }\n\n  if (skewX !== _zeroDeg || skewY !== _zeroDeg) {\n    transforms += \"skew(\" + skewX + \", \" + skewY + _endParenthesis;\n  }\n\n  if (scaleX !== 1 || scaleY !== 1) {\n    transforms += \"scale(\" + scaleX + \", \" + scaleY + _endParenthesis;\n  }\n\n  target.style[_transformProp] = transforms || \"translate(0, 0)\";\n},\n    _renderSVGTransforms = function _renderSVGTransforms(ratio, cache) {\n  var _ref2 = cache || this,\n      xPercent = _ref2.xPercent,\n      yPercent = _ref2.yPercent,\n      x = _ref2.x,\n      y = _ref2.y,\n      rotation = _ref2.rotation,\n      skewX = _ref2.skewX,\n      skewY = _ref2.skewY,\n      scaleX = _ref2.scaleX,\n      scaleY = _ref2.scaleY,\n      target = _ref2.target,\n      xOrigin = _ref2.xOrigin,\n      yOrigin = _ref2.yOrigin,\n      xOffset = _ref2.xOffset,\n      yOffset = _ref2.yOffset,\n      forceCSS = _ref2.forceCSS,\n      tx = parseFloat(x),\n      ty = parseFloat(y),\n      a11,\n      a21,\n      a12,\n      a22,\n      temp;\n\n  rotation = parseFloat(rotation);\n  skewX = parseFloat(skewX);\n  skewY = parseFloat(skewY);\n\n  if (skewY) {\n    //for performance reasons, we combine all skewing into the skewX and rotation values. Remember, a skewY of 10 degrees looks the same as a rotation of 10 degrees plus a skewX of 10 degrees.\n    skewY = parseFloat(skewY);\n    skewX += skewY;\n    rotation += skewY;\n  }\n\n  if (rotation || skewX) {\n    rotation *= _DEG2RAD;\n    skewX *= _DEG2RAD;\n    a11 = Math.cos(rotation) * scaleX;\n    a21 = Math.sin(rotation) * scaleX;\n    a12 = Math.sin(rotation - skewX) * -scaleY;\n    a22 = Math.cos(rotation - skewX) * scaleY;\n\n    if (skewX) {\n      skewY *= _DEG2RAD;\n      temp = Math.tan(skewX - skewY);\n      temp = Math.sqrt(1 + temp * temp);\n      a12 *= temp;\n      a22 *= temp;\n\n      if (skewY) {\n        temp = Math.tan(skewY);\n        temp = Math.sqrt(1 + temp * temp);\n        a11 *= temp;\n        a21 *= temp;\n      }\n    }\n\n    a11 = _round(a11);\n    a21 = _round(a21);\n    a12 = _round(a12);\n    a22 = _round(a22);\n  } else {\n    a11 = scaleX;\n    a22 = scaleY;\n    a21 = a12 = 0;\n  }\n\n  if (tx && !~(x + \"\").indexOf(\"px\") || ty && !~(y + \"\").indexOf(\"px\")) {\n    tx = _convertToUnit(target, \"x\", x, \"px\");\n    ty = _convertToUnit(target, \"y\", y, \"px\");\n  }\n\n  if (xOrigin || yOrigin || xOffset || yOffset) {\n    tx = _round(tx + xOrigin - (xOrigin * a11 + yOrigin * a12) + xOffset);\n    ty = _round(ty + yOrigin - (xOrigin * a21 + yOrigin * a22) + yOffset);\n  }\n\n  if (xPercent || yPercent) {\n    //The SVG spec doesn't support percentage-based translation in the \"transform\" attribute, so we merge it into the translation to simulate it.\n    temp = target.getBBox();\n    tx = _round(tx + xPercent / 100 * temp.width);\n    ty = _round(ty + yPercent / 100 * temp.height);\n  }\n\n  temp = \"matrix(\" + a11 + \",\" + a21 + \",\" + a12 + \",\" + a22 + \",\" + tx + \",\" + ty + \")\";\n  target.setAttribute(\"transform\", temp);\n  forceCSS && (target.style[_transformProp] = temp); //some browsers prioritize CSS transforms over the transform attribute. When we sense that the user has CSS transforms applied, we must overwrite them this way (otherwise some browser simply won't render the transform attribute changes!)\n},\n    _addRotationalPropTween = function _addRotationalPropTween(plugin, target, property, startNum, endValue) {\n  var cap = 360,\n      isString = _isString(endValue),\n      endNum = parseFloat(endValue) * (isString && ~endValue.indexOf(\"rad\") ? _RAD2DEG : 1),\n      change = endNum - startNum,\n      finalValue = startNum + change + \"deg\",\n      direction,\n      pt;\n\n  if (isString) {\n    direction = endValue.split(\"_\")[1];\n\n    if (direction === \"short\") {\n      change %= cap;\n\n      if (change !== change % (cap / 2)) {\n        change += change < 0 ? cap : -cap;\n      }\n    }\n\n    if (direction === \"cw\" && change < 0) {\n      change = (change + cap * _bigNum) % cap - ~~(change / cap) * cap;\n    } else if (direction === \"ccw\" && change > 0) {\n      change = (change - cap * _bigNum) % cap - ~~(change / cap) * cap;\n    }\n  }\n\n  plugin._pt = pt = new PropTween(plugin._pt, target, property, startNum, change, _renderPropWithEnd);\n  pt.e = finalValue;\n  pt.u = \"deg\";\n\n  plugin._props.push(property);\n\n  return pt;\n},\n    _assign = function _assign(target, source) {\n  // Internet Explorer doesn't have Object.assign(), so we recreate it here.\n  for (var p in source) {\n    target[p] = source[p];\n  }\n\n  return target;\n},\n    _addRawTransformPTs = function _addRawTransformPTs(plugin, transforms, target) {\n  //for handling cases where someone passes in a whole transform string, like transform: \"scale(2, 3) rotate(20deg) translateY(30em)\"\n  var startCache = _assign({}, target._gsap),\n      exclude = \"perspective,force3D,transformOrigin,svgOrigin\",\n      style = target.style,\n      endCache,\n      p,\n      startValue,\n      endValue,\n      startNum,\n      endNum,\n      startUnit,\n      endUnit;\n\n  if (startCache.svg) {\n    startValue = target.getAttribute(\"transform\");\n    target.setAttribute(\"transform\", \"\");\n    style[_transformProp] = transforms;\n    endCache = _parseTransform(target, 1);\n\n    _removeProperty(target, _transformProp);\n\n    target.setAttribute(\"transform\", startValue);\n  } else {\n    startValue = getComputedStyle(target)[_transformProp];\n    style[_transformProp] = transforms;\n    endCache = _parseTransform(target, 1);\n    style[_transformProp] = startValue;\n  }\n\n  for (p in _transformProps) {\n    startValue = startCache[p];\n    endValue = endCache[p];\n\n    if (startValue !== endValue && exclude.indexOf(p) < 0) {\n      //tweening to no perspective gives very unintuitive results - just keep the same perspective in that case.\n      startUnit = getUnit(startValue);\n      endUnit = getUnit(endValue);\n      startNum = startUnit !== endUnit ? _convertToUnit(target, p, startValue, endUnit) : parseFloat(startValue);\n      endNum = parseFloat(endValue);\n      plugin._pt = new PropTween(plugin._pt, endCache, p, startNum, endNum - startNum, _renderCSSProp);\n      plugin._pt.u = endUnit || 0;\n\n      plugin._props.push(p);\n    }\n  }\n\n  _assign(endCache, startCache);\n}; // handle splitting apart padding, margin, borderWidth, and borderRadius into their 4 components. Firefox, for example, won't report borderRadius correctly - it will only do borderTopLeftRadius and the other corners. We also want to handle paddingTop, marginLeft, borderRightWidth, etc.\n\n\n_forEachName(\"padding,margin,Width,Radius\", function (name, index) {\n  var t = \"Top\",\n      r = \"Right\",\n      b = \"Bottom\",\n      l = \"Left\",\n      props = (index < 3 ? [t, r, b, l] : [t + l, t + r, b + r, b + l]).map(function (side) {\n    return index < 2 ? name + side : \"border\" + side + name;\n  });\n\n  _specialProps[index > 1 ? \"border\" + name : name] = function (plugin, target, property, endValue, tween) {\n    var a, vars;\n\n    if (arguments.length < 4) {\n      // getter, passed target, property, and unit (from _get())\n      a = props.map(function (prop) {\n        return _get(plugin, prop, property);\n      });\n      vars = a.join(\" \");\n      return vars.split(a[0]).length === 5 ? a[0] : vars;\n    }\n\n    a = (endValue + \"\").split(\" \");\n    vars = {};\n    props.forEach(function (prop, i) {\n      return vars[prop] = a[i] = a[i] || a[(i - 1) / 2 | 0];\n    });\n    plugin.init(target, vars, tween);\n  };\n});\n\nexport var CSSPlugin = {\n  name: \"css\",\n  register: _initCore,\n  targetTest: function targetTest(target) {\n    return target.style && target.nodeType;\n  },\n  init: function init(target, vars, tween, index, targets) {\n    var props = this._props,\n        style = target.style,\n        startAt = tween.vars.startAt,\n        startValue,\n        endValue,\n        endNum,\n        startNum,\n        type,\n        specialProp,\n        p,\n        startUnit,\n        endUnit,\n        relative,\n        isTransformRelated,\n        transformPropTween,\n        cache,\n        smooth,\n        hasPriority,\n        inlineProps;\n    _pluginInitted || _initCore(); // we may call init() multiple times on the same plugin instance, like when adding special properties, so make sure we don't overwrite the revert data or inlineProps\n\n    this.styles = this.styles || _getStyleSaver(target);\n    inlineProps = this.styles.props;\n    this.tween = tween;\n\n    for (p in vars) {\n      if (p === \"autoRound\") {\n        continue;\n      }\n\n      endValue = vars[p];\n\n      if (_plugins[p] && _checkPlugin(p, vars, tween, index, target, targets)) {\n        // plugins\n        continue;\n      }\n\n      type = typeof endValue;\n      specialProp = _specialProps[p];\n\n      if (type === \"function\") {\n        endValue = endValue.call(tween, index, target, targets);\n        type = typeof endValue;\n      }\n\n      if (type === \"string\" && ~endValue.indexOf(\"random(\")) {\n        endValue = _replaceRandom(endValue);\n      }\n\n      if (specialProp) {\n        specialProp(this, target, p, endValue, tween) && (hasPriority = 1);\n      } else if (p.substr(0, 2) === \"--\") {\n        //CSS variable\n        startValue = (getComputedStyle(target).getPropertyValue(p) + \"\").trim();\n        endValue += \"\";\n        _colorExp.lastIndex = 0;\n\n        if (!_colorExp.test(startValue)) {\n          // colors don't have units\n          startUnit = getUnit(startValue);\n          endUnit = getUnit(endValue);\n        }\n\n        endUnit ? startUnit !== endUnit && (startValue = _convertToUnit(target, p, startValue, endUnit) + endUnit) : startUnit && (endValue += startUnit);\n        this.add(style, \"setProperty\", startValue, endValue, index, targets, 0, 0, p);\n        props.push(p);\n        inlineProps.push(p, 0, style[p]);\n      } else if (type !== \"undefined\") {\n        if (startAt && p in startAt) {\n          // in case someone hard-codes a complex value as the start, like top: \"calc(2vh / 2)\". Without this, it'd use the computed value (always in px)\n          startValue = typeof startAt[p] === \"function\" ? startAt[p].call(tween, index, target, targets) : startAt[p];\n          _isString(startValue) && ~startValue.indexOf(\"random(\") && (startValue = _replaceRandom(startValue));\n          getUnit(startValue + \"\") || startValue === \"auto\" || (startValue += _config.units[p] || getUnit(_get(target, p)) || \"\"); // for cases when someone passes in a unitless value like {x: 100}; if we try setting translate(100, 0px) it won't work.\n\n          (startValue + \"\").charAt(1) === \"=\" && (startValue = _get(target, p)); // can't work with relative values\n        } else {\n          startValue = _get(target, p);\n        }\n\n        startNum = parseFloat(startValue);\n        relative = type === \"string\" && endValue.charAt(1) === \"=\" && endValue.substr(0, 2);\n        relative && (endValue = endValue.substr(2));\n        endNum = parseFloat(endValue);\n\n        if (p in _propertyAliases) {\n          if (p === \"autoAlpha\") {\n            //special case where we control the visibility along with opacity. We still allow the opacity value to pass through and get tweened.\n            if (startNum === 1 && _get(target, \"visibility\") === \"hidden\" && endNum) {\n              //if visibility is initially set to \"hidden\", we should interpret that as intent to make opacity 0 (a convenience)\n              startNum = 0;\n            }\n\n            inlineProps.push(\"visibility\", 0, style.visibility);\n\n            _addNonTweeningPT(this, style, \"visibility\", startNum ? \"inherit\" : \"hidden\", endNum ? \"inherit\" : \"hidden\", !endNum);\n          }\n\n          if (p !== \"scale\" && p !== \"transform\") {\n            p = _propertyAliases[p];\n            ~p.indexOf(\",\") && (p = p.split(\",\")[0]);\n          }\n        }\n\n        isTransformRelated = p in _transformProps; //--- TRANSFORM-RELATED ---\n\n        if (isTransformRelated) {\n          this.styles.save(p);\n\n          if (!transformPropTween) {\n            cache = target._gsap;\n            cache.renderTransform && !vars.parseTransform || _parseTransform(target, vars.parseTransform); // if, for example, gsap.set(... {transform:\"translateX(50vw)\"}), the _get() call doesn't parse the transform, thus cache.renderTransform won't be set yet so force the parsing of the transform here.\n\n            smooth = vars.smoothOrigin !== false && cache.smooth;\n            transformPropTween = this._pt = new PropTween(this._pt, style, _transformProp, 0, 1, cache.renderTransform, cache, 0, -1); //the first time through, create the rendering PropTween so that it runs LAST (in the linked list, we keep adding to the beginning)\n\n            transformPropTween.dep = 1; //flag it as dependent so that if things get killed/overwritten and this is the only PropTween left, we can safely kill the whole tween.\n          }\n\n          if (p === \"scale\") {\n            this._pt = new PropTween(this._pt, cache, \"scaleY\", cache.scaleY, (relative ? _parseRelative(cache.scaleY, relative + endNum) : endNum) - cache.scaleY || 0, _renderCSSProp);\n            this._pt.u = 0;\n            props.push(\"scaleY\", p);\n            p += \"X\";\n          } else if (p === \"transformOrigin\") {\n            inlineProps.push(_transformOriginProp, 0, style[_transformOriginProp]);\n            endValue = _convertKeywordsToPercentages(endValue); //in case something like \"left top\" or \"bottom right\" is passed in. Convert to percentages.\n\n            if (cache.svg) {\n              _applySVGOrigin(target, endValue, 0, smooth, 0, this);\n            } else {\n              endUnit = parseFloat(endValue.split(\" \")[2]) || 0; //handle the zOrigin separately!\n\n              endUnit !== cache.zOrigin && _addNonTweeningPT(this, cache, \"zOrigin\", cache.zOrigin, endUnit);\n\n              _addNonTweeningPT(this, style, p, _firstTwoOnly(startValue), _firstTwoOnly(endValue));\n            }\n\n            continue;\n          } else if (p === \"svgOrigin\") {\n            _applySVGOrigin(target, endValue, 1, smooth, 0, this);\n\n            continue;\n          } else if (p in _rotationalProperties) {\n            _addRotationalPropTween(this, cache, p, startNum, relative ? _parseRelative(startNum, relative + endValue) : endValue);\n\n            continue;\n          } else if (p === \"smoothOrigin\") {\n            _addNonTweeningPT(this, cache, \"smooth\", cache.smooth, endValue);\n\n            continue;\n          } else if (p === \"force3D\") {\n            cache[p] = endValue;\n            continue;\n          } else if (p === \"transform\") {\n            _addRawTransformPTs(this, endValue, target);\n\n            continue;\n          }\n        } else if (!(p in style)) {\n          p = _checkPropPrefix(p) || p;\n        }\n\n        if (isTransformRelated || (endNum || endNum === 0) && (startNum || startNum === 0) && !_complexExp.test(endValue) && p in style) {\n          startUnit = (startValue + \"\").substr((startNum + \"\").length);\n          endNum || (endNum = 0); // protect against NaN\n\n          endUnit = getUnit(endValue) || (p in _config.units ? _config.units[p] : startUnit);\n          startUnit !== endUnit && (startNum = _convertToUnit(target, p, startValue, endUnit));\n          this._pt = new PropTween(this._pt, isTransformRelated ? cache : style, p, startNum, (relative ? _parseRelative(startNum, relative + endNum) : endNum) - startNum, !isTransformRelated && (endUnit === \"px\" || p === \"zIndex\") && vars.autoRound !== false ? _renderRoundedCSSProp : _renderCSSProp);\n          this._pt.u = endUnit || 0;\n\n          if (startUnit !== endUnit && endUnit !== \"%\") {\n            //when the tween goes all the way back to the beginning, we need to revert it to the OLD/ORIGINAL value (with those units). We record that as a \"b\" (beginning) property and point to a render method that handles that. (performance optimization)\n            this._pt.b = startValue;\n            this._pt.r = _renderCSSPropWithBeginning;\n          }\n        } else if (!(p in style)) {\n          if (p in target) {\n            //maybe it's not a style - it could be a property added directly to an element in which case we'll try to animate that.\n            this.add(target, p, startValue || target[p], relative ? relative + endValue : endValue, index, targets);\n          } else if (p !== \"parseTransform\") {\n            _missingPlugin(p, endValue);\n\n            continue;\n          }\n        } else {\n          _tweenComplexCSSString.call(this, target, p, startValue, relative ? relative + endValue : endValue);\n        }\n\n        isTransformRelated || (p in style ? inlineProps.push(p, 0, style[p]) : typeof target[p] === \"function\" ? inlineProps.push(p, 2, target[p]()) : inlineProps.push(p, 1, startValue || target[p]));\n        props.push(p);\n      }\n    }\n\n    hasPriority && _sortPropTweensByPriority(this);\n  },\n  render: function render(ratio, data) {\n    if (data.tween._time || !_reverting()) {\n      var pt = data._pt;\n\n      while (pt) {\n        pt.r(ratio, pt.d);\n        pt = pt._next;\n      }\n    } else {\n      data.styles.revert();\n    }\n  },\n  get: _get,\n  aliases: _propertyAliases,\n  getSetter: function getSetter(target, property, plugin) {\n    //returns a setter function that accepts target, property, value and applies it accordingly. Remember, properties like \"x\" aren't as simple as target.style.property = value because they've got to be applied to a proxy object and then merged into a transform string in a renderer.\n    var p = _propertyAliases[property];\n    p && p.indexOf(\",\") < 0 && (property = p);\n    return property in _transformProps && property !== _transformOriginProp && (target._gsap.x || _get(target, \"x\")) ? plugin && _recentSetterPlugin === plugin ? property === \"scale\" ? _setterScale : _setterTransform : (_recentSetterPlugin = plugin || {}) && (property === \"scale\" ? _setterScaleWithRender : _setterTransformWithRender) : target.style && !_isUndefined(target.style[property]) ? _setterCSSStyle : ~property.indexOf(\"-\") ? _setterCSSProp : _getSetter(target, property);\n  },\n  core: {\n    _removeProperty: _removeProperty,\n    _getMatrix: _getMatrix\n  }\n};\ngsap.utils.checkPrefix = _checkPropPrefix;\ngsap.core.getStyleSaver = _getStyleSaver;\n\n(function (positionAndScale, rotation, others, aliases) {\n  var all = _forEachName(positionAndScale + \",\" + rotation + \",\" + others, function (name) {\n    _transformProps[name] = 1;\n  });\n\n  _forEachName(rotation, function (name) {\n    _config.units[name] = \"deg\";\n    _rotationalProperties[name] = 1;\n  });\n\n  _propertyAliases[all[13]] = positionAndScale + \",\" + rotation;\n\n  _forEachName(aliases, function (name) {\n    var split = name.split(\":\");\n    _propertyAliases[split[1]] = all[split[0]];\n  });\n})(\"x,y,z,scale,scaleX,scaleY,xPercent,yPercent\", \"rotation,rotationX,rotationY,skewX,skewY\", \"transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective\", \"0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY\");\n\n_forEachName(\"x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective\", function (name) {\n  _config.units[name] = \"px\";\n});\n\ngsap.registerPlugin(CSSPlugin);\nexport { CSSPlugin as default, _getBBox, _createElement, _checkPropPrefix as checkPrefix };","import { gsap, Power0, Power1, Power2, Power3, Power4, Linear, Quad, Cubic, Quart, Quint, Strong, Elastic, Back, SteppedEase, Bounce, Sine, Expo, Circ, TweenLite, TimelineLite, TimelineMax } from \"./gsap-core.js\";\nimport { CSSPlugin } from \"./CSSPlugin.js\";\nvar gsapWithCSS = gsap.registerPlugin(CSSPlugin) || gsap,\n    // to protect from tree shaking\nTweenMaxWithCSS = gsapWithCSS.core.Tween;\nexport { gsapWithCSS as gsap, gsapWithCSS as default, CSSPlugin, TweenMaxWithCSS as TweenMax, TweenLite, TimelineMax, TimelineLite, Power0, Power1, Power2, Power3, Power4, Linear, Quad, Cubic, Quart, Quint, Strong, Elastic, Back, SteppedEase, Bounce, Sine, Expo, Circ };","import { Curtains, Plane, Texture } from \"curtainsjs\";\nimport gsap from \"gsap\";\n\nexport const init = async (imagesSrc, index = 0) => {\n    class WEBGL {\n        constructor(set) {\n            this.canvas = set.canvas;\n            this.imagesSrc = set.imagesSrc;\n            this.webGLCurtain = new Curtains({ container: this.canvas });\n            this.plane = null;\n\n            this.textures = {\n                texture0: null,\n                texture1: null,\n                map: null\n            };\n\n            this.currentIndex = 0;\n            this.gsapAnimation = null;\n\n            this.params = {\n                vertexShader: vs,\n                fragmentShader: fs,\n                widthSegments: 40,\n                heightSegments: 40,\n                width: 475, // ← фиксированные размеры\n                height: 677,\n                uniforms: {\n                    time: { name: \"uTime\", type: \"1f\", value: 0 },\n                    mousepos: { name: \"uMouse\", type: \"2f\", value: [0, 0] },\n                    resolution: { name: \"uReso\", type: \"2f\", value: [innerWidth, innerHeight] },\n                    progress: { name: \"uProgress\", type: \"1f\", value: 0 }\n                }\n            };\n        }\n\n        async loadTexture(url, samplerName) {\n            const img = document.createElement(\"img\");\n            img.crossOrigin = \"anonymous\";\n            img.src = url;\n            await img.decode();\n\n            return new Texture(this.webGLCurtain, {\n                sampler: samplerName,\n                fromTexture: img\n            });\n        }\n\n        async initPlane(index = 0) {\n            const box = document.getElementById('wrap-texture-box');\n            box.innerHTML = \"\"; // ← очищаем перед созданием новой плоскости\n\n            const div = document.createElement(\"div\");\n            div.className = \"plane\";\n            box.appendChild(div);\n\n            const texture0 = await this.loadTexture(this.imagesSrc[index], \"texture0\");\n            const texture1 = await this.loadTexture(this.imagesSrc[index + 1] || this.imagesSrc[0], \"texture1\");\n            const map = await this.loadTexture(\"https://i.ibb.co/n8MjCrk/seed129873123-scale10-fbm-worley-quintic-octaves2.jpg\", \"map\");\n\n            const img0 = document.createElement(\"img\");\n            img0.setAttribute(\"data-sampler\", \"texture0\");\n            img0.src = this.imagesSrc[index];\n\n            const img1 = document.createElement(\"img\");\n            img1.setAttribute(\"data-sampler\", \"texture1\");\n            img1.src = this.imagesSrc[index + 1] || this.imagesSrc[0];\n\n            const mapImg = document.createElement(\"img\");\n            mapImg.setAttribute(\"data-sampler\", \"map\");\n            mapImg.src = \"https://i.ibb.co/n8MjCrk/seed129873123-scale10-fbm-worley-quintic-octaves2.jpg\";\n\n            div.appendChild(img0);\n            div.appendChild(img1);\n            div.appendChild(mapImg);\n\n            this.plane = new Plane(this.webGLCurtain, div, this.params);\n\n            this.plane.onReady(() => {\n                this.textures.texture0 = this.plane.textures[0];\n                this.textures.texture1 = this.plane.textures[1];\n                this.textures.map = this.plane.textures[2];\n                this.textures.texture0.setScale(1, 1);\n                this.textures.texture1.setScale(1, 1);\n                this.textures.map.setScale(1, 1);\n                this.update();\n            });\n        }\n\n        update() {\n            this.plane.onRender(() => {\n                this.plane.uniforms.time.value += 0.01;\n                this.plane.uniforms.resolution.value = [innerWidth, innerHeight];\n            });\n\n            window.addEventListener(\"resize\", () => {\n                this.plane.uniforms.resolution.value = [innerWidth, innerHeight];\n            });\n        }\n\n        async goToIndex(index) {\n            if (index < 0 || index >= this.imagesSrc.length || index === this.currentIndex) return;\n\n            const nextImage = this.imagesSrc[index];\n            const img = new Image();\n            img.crossOrigin = \"anonymous\";\n            img.src = nextImage;\n            await img.decode();\n\n            this.textures.texture1.setSource(img, () => {\n                this.plane.textures[1].resize();\n            });\n\n            this.plane.uniforms.progress.value = 0;\n\n            if (this.gsapAnimation) this.gsapAnimation.kill();\n\n            this.gsapAnimation = gsap.to(this.plane.uniforms.progress, {\n                value: 1,\n                duration: 0.7,\n                onComplete: () => {\n                    this.textures.texture0.setSource(img, () => {\n                        this.plane.textures[0].resize();\n                    });\n\n                    this.plane.uniforms.progress.value = 0;\n                    this.currentIndex = index;\n                    this.gsapAnimation = null;\n                }\n            });\n        }\n    }\n\n    const webgl = new WEBGL({\n        canvas: document.getElementById(\"canvas\"),\n        imagesSrc\n    });\n\n    await webgl.initPlane(index);\n\n\n    return webgl;\n};\n\n\nconst fs = `\n   #ifdef GL_ES\n    precision mediump float;\n    #endif\n\n    #define PI2 6.28318530718\n    #define PI 3.14159265359\n    #define S(a,b,n) smoothstep(a,b,n)\n\n    uniform float uTime;\n    uniform float uProgress;\n    uniform vec2 uReso;\n    uniform vec2 uMouse;\n\n    varying vec3 vVertexPosition;\n    varying vec2 vTextureCoord0;\n    varying vec2 vTextureCoord1;\n    varying vec2 vTextureCoordMap;\n\n    uniform sampler2D texture0;\n    uniform sampler2D texture1;\n    uniform sampler2D map;\n\n    float exponentialEasing (float x, float a){\n      float epsilon = 0.00001;\n      float min_param_a = 0.0 + epsilon;\n      float max_param_a = 1.0 - epsilon;\n      a = max(min_param_a, min(max_param_a, a));\n      if (a < 0.5){\n        a = 2.0 * a;\n        return pow(x, a);\n      } else {\n        a = 2.0 * (a - 0.5);\n        return pow(x, 1.0 / (1.0 - a));\n      }\n    }\n\n    vec4 blur13(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n      vec4 color = vec4(0.0);\n      vec2 off1 = vec2(1.41176) * direction;\n      vec2 off2 = vec2(3.29411) * direction;\n      vec2 off3 = vec2(5.17647) * direction;\n      color += texture2D(image, uv) * 0.19648;\n      color += texture2D(image, uv + (off1 / resolution)) * 0.29691;\n      color += texture2D(image, uv - (off1 / resolution)) * 0.29691;\n      color += texture2D(image, uv + (off2 / resolution)) * 0.09447;\n      color += texture2D(image, uv - (off2 / resolution)) * 0.09447;\n      color += texture2D(image, uv + (off3 / resolution)) * 0.01038;\n      color += texture2D(image, uv - (off3 / resolution)) * 0.01038;\n      return color;\n    }\n\n    void main() {\n        vec2 uv0 = vTextureCoord0;\n        vec2 uv1 = vTextureCoord1;\n\n        float progress0 = uProgress;\n        float progress1 = 1.0 - uProgress;\n\n        vec4 mapTex = blur13(map, vTextureCoordMap, uReso, vec2(2.0)) + 0.5;\n\n        uv0.x += progress0 * mapTex.r;\n        uv1.x -= progress1 * mapTex.r;\n\n        vec4 color = texture2D(texture0, uv0);\n        vec4 color1 = texture2D(texture1, uv1);\n\n        gl_FragColor = mix(color, color1, progress0);\n    }\n`;\n\nconst vs = `\n   #ifdef GL_ES\n    precision mediump float;\n    #endif\n\n    attribute vec3 aVertexPosition;\n    attribute vec2 aTextureCoord;\n\n    uniform mat4 uMVMatrix;\n    uniform mat4 uPMatrix;\n\n    uniform mat4 texture0Matrix;\n    uniform mat4 texture1Matrix;\n    uniform mat4 mapMatrix;\n\n    varying vec3 vVertexPosition;\n    varying vec2 vTextureCoord0;\n    varying vec2 vTextureCoord1;\n    varying vec2 vTextureCoordMap;\n\n    void main() {\n        vec3 vertexPosition = aVertexPosition;\n\n        gl_Position = uPMatrix * uMVMatrix * vec4(vertexPosition, 1.0);\n\n        vTextureCoord0 = (texture0Matrix * vec4(aTextureCoord, 0.0, 1.0)).xy;\n        vTextureCoord1 = (texture1Matrix * vec4(aTextureCoord, 0.0, 1.0)).xy;\n        vTextureCoordMap = (mapMatrix * vec4(aTextureCoord, 0.0, 1.0)).xy;\n        vVertexPosition = vertexPosition;\n    }\n`;\n","import React, { useEffect, useRef, useState } from 'react';\nimport type { DataType, PhotoProviderBase, OverlayRenderProps, ReachType } from './types';\nimport { defaultEasing, defaultSpeed, defaultOpacity, horizontalOffset, maxMoveOffset } from './variables';\nimport isTouchDevice from './utils/isTouchDevice';\nimport { limitNumber } from './utils/limitTarget';\nimport useIsomorphicLayoutEffect from './hooks/useIsomorphicLayoutEffect';\nimport useAdjacentImages from './hooks/useAdjacentImages';\nimport useSetState from './hooks/useSetState';\nimport useEventListener from './hooks/useEventListener';\nimport useAnimationVisible from './hooks/useAnimationVisible';\nimport useMethods from './hooks/useMethods';\nimport SlidePortal from './components/SlidePortal';\nimport CloseIcon from './components/CloseIcon';\nimport ArrowLeft from './components/ArrowLeft';\nimport ArrowRight from './components/ArrowRight';\nimport PreventScroll from './components/PreventScroll';\nimport PhotoBox from './PhotoBox';\nimport './PhotoSlider.less';\nimport { init } from './hooks/webgl';\n\nexport interface IPhotoSliderProps extends PhotoProviderBase {\n  // 图片列表\n  images: DataType[];\n  // 图片当前索引\n  index?: number;\n  // 索引改变回调\n  onIndexChange?: (index: number) => void;\n  // 可见\n  visible: boolean;\n  // 关闭回调\n  onClose: (evt?: React.MouseEvent | React.TouchEvent) => void;\n  // 关闭动画结束后回调\n  afterClose?: () => void;\n\n  direction?: 'ltr' | 'rtl';\n}\n\ntype PhotoSliderState = {\n  // 偏移量\n  x: number;\n  // 图片处于触摸的状态\n  touched: boolean;\n  // 是否暂停 transition\n  pause: boolean;\n  // Reach 开始时 x 坐标\n  lastCX: number | undefined;\n  // Reach 开始时 y 坐标\n  lastCY: number | undefined;\n  // 背景透明度\n  bg: number | null | undefined;\n  // 上次关闭的背景透明度\n  lastBg: number | null | undefined;\n  // 是否显示 overlay\n  overlay: boolean;\n  // 是否为最小状态，可下拉关闭\n  minimal: boolean;\n  // 缩放\n  scale: number;\n  // 旋转\n  rotate: number;\n  // 缩放回调\n  onScale?: (scale: number) => void;\n  // 旋转回调\n  onRotate?: (rotate: number) => void;\n};\n\nconst initialState: PhotoSliderState = {\n  x: 0,\n  touched: false,\n  pause: false,\n  lastCX: undefined,\n  lastCY: undefined,\n  bg: undefined,\n  lastBg: undefined,\n  overlay: true,\n  minimal: true,\n  scale: 1,\n  rotate: 0,\n};\n\nexport default function PhotoSlider(props: IPhotoSliderProps) {\n  const {\n    loop = 3,\n    speed: speedFn,\n    easing: easingFn,\n    photoClosable,\n    maskClosable = true,\n    maskOpacity = defaultOpacity,\n    pullClosable = true,\n    bannerVisible = true,\n    overlayRender,\n    toolbarRender,\n    className,\n    maskClassName,\n    photoClassName,\n    photoWrapClassName,\n    loadingElement,\n    brokenElement,\n    images,\n    index: controlledIndex = 0,\n    onIndexChange: controlledIndexChange,\n    visible,\n    onClose,\n    afterClose,\n    portalContainer,\n  } = props;\n\n  const [state, updateState] = useSetState(initialState);\n  const [innerIndex, updateInnerIndex] = useState(0);\n  const [indexController, setIndexController] = useState<any>(null);\n\n\n\n  const {\n    x,\n    touched,\n    pause,\n\n    lastCX,\n    lastCY,\n\n    bg = maskOpacity,\n    lastBg,\n    overlay,\n    minimal,\n\n    scale,\n    rotate,\n    onScale,\n    onRotate,\n  } = state;\n\n  // 受控 index\n  const isControlled = props.hasOwnProperty('index');\n  const index = isControlled ? controlledIndex : innerIndex;\n  const onIndexChange = isControlled ? controlledIndexChange : updateInnerIndex;\n  // 内部虚拟 index\n  const virtualIndexRef = useRef(index);\n\n  // 当前图片\n  const imageLength = images.length;\n  const currentImage: DataType | undefined = images[index];\n\n  // 是否开启\n  // noinspection SuspiciousTypeOfGuard\n  const enableLoop = typeof loop === 'boolean' ? loop : imageLength > loop;\n\n  // 显示动画处理\n  const [realVisible, activeAnimation, onAnimationEnd] = useAnimationVisible(visible, afterClose);\n\n  useIsomorphicLayoutEffect(() => {\n    // 显示弹出层，修正正确的指向\n    if (realVisible) {\n      updateState({\n        pause: true,\n        x: index * -(innerWidth + horizontalOffset),\n      });\n      virtualIndexRef.current = index;\n      return;\n    }\n    // 关闭后清空状态\n    updateState(initialState);\n  }, [realVisible]);\n\n\n\n  const { close, changeIndex } = useMethods({\n    close(evt?: React.MouseEvent | React.TouchEvent) {\n      if (onRotate) {\n        onRotate(0);\n      }\n      updateState({\n        overlay: true,\n        // 记录当前关闭时的透明度\n        lastBg: bg,\n      });\n      onClose(evt);\n    },\n    changeIndex(nextIndex: number, isPause: boolean = false) {\n\n      const currentIndex = enableLoop ? virtualIndexRef.current + (nextIndex - index) : nextIndex;\n      const max = imageLength - 1;\n      // 虚拟 index\n      // 非循环模式，限制区间\n      const limitIndex = limitNumber(currentIndex, 0, max);\n      const nextVirtualIndex = enableLoop ? currentIndex : limitIndex;\n      // 单个屏幕宽度\n      const singlePageWidth = innerWidth + horizontalOffset;\n\n      const currentTranslateX = -singlePageWidth * virtualIndexRef.current;\n\n\n      updateState({\n        touched: false,\n        x: currentTranslateX,\n        lastCX: undefined,\n        lastCY: undefined,\n        bg: maskOpacity,\n        overlay: overlay\n      });\n      // 当前索引\n\n      console.log('changeIndex');\n\n      updateState({\n        touched: false,\n        lastCX: undefined,\n        lastCY: undefined,\n        x: -singlePageWidth * nextVirtualIndex,\n        pause: isPause,\n      });\n\n\n      virtualIndexRef.current = nextVirtualIndex;\n      // 更新真实的 index\n      const realLoopIndex = nextIndex < 0 ? max : nextIndex > max ? 0 : nextIndex;\n      if (onIndexChange) {\n        onIndexChange(enableLoop ? realLoopIndex : limitIndex);\n\n        indexController?.goToIndex(enableLoop ? realLoopIndex : limitIndex);\n        \n\n      }\n    },\n  });\n\n  useEventListener('keydown', (evt: KeyboardEvent) => {\n    if (visible) {\n      switch (evt.key) {\n        case 'ArrowLeft':\n          changeIndex(index - 1, true);\n          break;\n        case 'ArrowRight':\n          changeIndex(index + 1, true);\n          break;\n        case 'Escape':\n          close();\n          break;\n        default:\n      }\n    }\n  });\n\n  function handlePhotoTap(closeable: boolean | undefined) {\n    return closeable ? close() : updateState({ overlay: !overlay });\n  }\n\n  function handleResize() {\n    updateState({\n      x: -(innerWidth + horizontalOffset) * index,\n      lastCX: undefined,\n      lastCY: undefined,\n      pause: true,\n    });\n    virtualIndexRef.current = index;\n  }\n\n  function handleReachVerticalMove(clientY: number, nextScale?: number) {\n    if (lastCY === undefined) {\n      updateState({\n        touched: true,\n        lastCY: clientY,\n        bg,\n        minimal: true,\n      });\n      return;\n    }\n    const opacity =\n      maskOpacity === null ? null : limitNumber(maskOpacity, 0.01, maskOpacity - Math.abs(clientY - lastCY) / 100 / 4);\n\n    updateState({\n      touched: true,\n      lastCY,\n      bg: nextScale === 1 ? opacity : maskOpacity,\n      minimal: nextScale === 1,\n    });\n  }\n\n  function handleReachHorizontalMove(clientX: number) {\n    if (lastCX === undefined) {\n      updateState({\n        touched: true,\n        lastCX: clientX,\n        x,\n        pause: false,\n      });\n      return;\n    }\n    const originOffsetClientX = clientX - lastCX;\n    let offsetClientX = originOffsetClientX;\n\n    // 第一张和最后一张超出距离减半\n    if (\n      !enableLoop &&\n      ((index === 0 && originOffsetClientX > 0) || (index === imageLength - 1 && originOffsetClientX < 0))\n    ) {\n      offsetClientX = originOffsetClientX / 2;\n    }\n\n    updateState({\n      touched: true,\n      lastCX,\n      x: -(innerWidth + horizontalOffset) * virtualIndexRef.current + offsetClientX,\n      pause: false,\n    });\n  }\n\n  function handleReachMove(reachPosition: ReachType, clientX: number, clientY: number, nextScale?: number) {\n    if (reachPosition === 'x') {\n      handleReachHorizontalMove(clientX);\n    } else if (reachPosition === 'y') {\n      handleReachVerticalMove(clientY, nextScale);\n    }\n  }\n\n  function handleReachUp(clientX: number, clientY: number) {\n    const offsetClientX = clientX - (lastCX ?? clientX);\n    const offsetClientY = clientY - (lastCY ?? clientY);\n    let willClose = false;\n    // 下一张\n    console.log('handleReachUp');\n    if (offsetClientX < -maxMoveOffset) {\n      changeIndex(index + 1);\n      return;\n    }\n    // 上一张\n    if (offsetClientX > maxMoveOffset) {\n      changeIndex(index - 1);\n      return;\n    }\n    const singlePageWidth = innerWidth + horizontalOffset;\n    // 当前偏移\n    const currentTranslateX = -singlePageWidth * virtualIndexRef.current;\n\n    if (Math.abs(offsetClientY) > 100 && minimal && pullClosable) {\n      willClose = true;\n      close();\n    }\n\n    updateState({\n      touched: false,\n      x: currentTranslateX,\n      lastCX: undefined,\n      lastCY: undefined,\n      bg: maskOpacity,\n      overlay: willClose ? true : overlay,\n    });\n  }\n  // 截取相邻的图片\n  const adjacentImages = useAdjacentImages(images, index, enableLoop);\n\n  useEffect(() => {\n    if (!realVisible || !images) return;\n\n    requestAnimationFrame(async() => {\n      const canvasEl = document.getElementById('canvas');\n      if (!canvasEl) return;\n\n      const webgl = await init(images.map((item: DataType) => item.src), index);\n      setIndexController(webgl);\n    });\n  }, [realVisible, images]);\n\n  if (!realVisible) {\n    return null;\n  }\n\n  const currentOverlayVisible = overlay && !activeAnimation;\n  // 关闭过程中使用下拉保存的透明度\n  const currentOpacity = visible ? bg : lastBg;\n  // 覆盖物参数\n  const overlayParams: OverlayRenderProps | undefined = onScale &&\n    onRotate && {\n    images,\n    index,\n    visible,\n    onClose: close,\n    onIndexChange: changeIndex,\n    overlayVisible: currentOverlayVisible,\n    overlay: currentImage && currentImage.overlay,\n    scale,\n    rotate,\n    onScale,\n    onRotate,\n  };\n  // 动画时间\n\n\n  const currentSpeed = speedFn ? speedFn(activeAnimation) : defaultSpeed;\n  const currentEasing = easingFn ? easingFn(activeAnimation) : defaultEasing;\n  const slideSpeed = speedFn ? speedFn(3) : defaultSpeed + 200;\n  const slideEasing = easingFn ? easingFn(3) : defaultEasing;\n\n\n\n\n  return (\n    <SlidePortal\n      className={`PhotoView-Portal${!currentOverlayVisible ? ' PhotoView-Slider__clean' : ''}${!visible ? ' PhotoView-Slider__willClose' : ''\n        }${className ? ` ${className}` : ''}`}\n      role=\"dialog\"\n      onClick={(e) => e.stopPropagation()}\n      container={portalContainer}\n    >\n      {visible && <PreventScroll />}\n      <div\n        className={`PhotoView-Slider__Backdrop${maskClassName ? ` ${maskClassName}` : ''}${activeAnimation === 1\n          ? ' PhotoView-Slider__fadeIn'\n          : activeAnimation === 2\n            ? ' PhotoView-Slider__fadeOut'\n            : ''\n          }`}\n        style={{\n          background: currentOpacity ? `rgba(0, 0, 0, ${currentOpacity})` : undefined,\n          transitionTimingFunction: currentEasing,\n          transitionDuration: `${touched ? 0 : currentSpeed}ms`,\n          animationDuration: `${currentSpeed}ms`,\n        }}\n        onAnimationEnd={onAnimationEnd}\n      />\n      {bannerVisible && (\n        <div className=\"PhotoView-Slider__BannerWrap\">\n          <div className=\"PhotoView-Slider__Counter\">\n            {index + 1} / {imageLength}\n          </div>\n          <div className=\"PhotoView-Slider__BannerRight\">\n            {toolbarRender && overlayParams && toolbarRender(overlayParams)}\n            <CloseIcon className=\"close\" onClick={close} />\n          </div>\n        </div>\n      )}\n      <div id=\"wrap-texture\">\n        <div id=\"canvas\"></div>\n        <div id=\"wrap-texture-box\">\n        </div>\n      </div>\n      {/* {adjacentImages.map((item: DataType, currentIndex) => {\n        // 截取之前的索引位置\n        const nextIndex =\n          !enableLoop && index === 0 ? index + currentIndex : virtualIndexRef.current - 1 + currentIndex;\n\n        return (\n          <PhotoBox\n            key={enableLoop ? `${item.key}/${item.src}/${nextIndex}` : item.key}\n            item={item}\n            speed={currentSpeed}\n            easing={currentEasing}\n            visible={visible}\n            onReachMove={handleReachMove}\n            onReachUp={handleReachUp}\n            onPhotoTap={() => handlePhotoTap(photoClosable)}\n            onMaskTap={() => handlePhotoTap(maskClosable)}\n            wrapClassName={photoWrapClassName}\n            className={photoClassName}\n            style={{\n              left: `${(innerWidth + horizontalOffset) * nextIndex}px`,\n              transform: `translate3d(${x}px, 0px, 0)`,\n              transition: touched || pause ? undefined : `transform ${slideSpeed}ms ${slideEasing}`,\n            }}\n            loadingElement={loadingElement}\n            brokenElement={brokenElement}\n            onPhotoResize={handleResize}\n            isActive={virtualIndexRef.current === nextIndex}\n            expose={updateState}\n          />\n        );\n      })} */}\n      {\n        !isTouchDevice && bannerVisible && (\n          <>\n            {(enableLoop || index !== 0) && (\n              <div className=\"PhotoView-Slider__ArrowLeft\" onClick={() => changeIndex(index - 1)}>\n                <ArrowLeft />\n              </div>\n            )}\n            {(enableLoop || index + 1 < imageLength) && (\n              <div className=\"PhotoView-Slider__ArrowRight\" onClick={() => changeIndex(index + 1)}>\n                <ArrowRight />\n              </div>\n            )}\n          </>\n        )\n      }\n      {\n        overlayRender && overlayParams && (\n          <div className=\"PhotoView-Slider__Overlay\">{overlayRender(overlayParams)}</div>\n        )\n      }\n    </SlidePortal >\n  );\n}\n","import { useReducer, useRef } from 'react';\nimport type { ActiveAnimationType } from '../types';\nimport useForkedVariable from './useForkedVariable';\n\n/**\n * 动画关闭处理真实关闭状态\n * 通过 onAnimationEnd 回调实现 leaveCallback\n */\nexport default function useAnimationVisible(\n  visible: boolean | undefined,\n  afterClose?: () => void,\n): [realVisible: boolean | undefined, activeAnimation: ActiveAnimationType, onAnimationEnd: () => void] {\n  const [, handleRender] = useReducer((c) => !c, false);\n\n  const activeAnimation = useRef<ActiveAnimationType>(0);\n\n  // 可见状态分支\n  const [realVisible, modifyRealVisible] = useForkedVariable(visible, (modify) => {\n    // 可见状态：设置进入动画\n    if (visible) {\n      modify(visible);\n      activeAnimation.current = 1;\n    } else {\n      activeAnimation.current = 2;\n    }\n  });\n\n  function onAnimationEnd() {\n    // 动画结束后触发渲染\n    handleRender();\n    // 结束动画：设置隐藏状态\n    if (activeAnimation.current === 2) {\n      modifyRealVisible(false);\n      // 触发隐藏回调\n      if (afterClose) {\n        afterClose();\n      }\n    }\n    // 重置状态\n    activeAnimation.current = 0;\n  }\n\n  return [\n    /**\n     * 真实可见状态\n     */\n    realVisible,\n    /**\n     * 正在进行的动画\n     */\n    activeAnimation.current,\n    /**\n     * 动画结束后回调\n     */\n    onAnimationEnd,\n  ];\n}\n","import { useRef, useMemo } from 'react';\n\n/**\n * 逻辑分叉变量处理\n * 此 hook 不触发额外渲染\n */\nexport default function useForkedVariable<T>(initial: T, updater: (modify: (variable: T) => void) => void) {\n  // 初始分叉变量\n  const forkedRef = useRef(initial);\n\n  function modify(next: T) {\n    forkedRef.current = next;\n  }\n\n  useMemo(() => {\n    // 参数变化之后同步内部分叉变量\n    updater(modify);\n  }, [initial]);\n\n  return [forkedRef.current, modify] as const;\n}\n","import { maxScale, minScale } from '../variables';\n\nexport const limitNumber = (value: number, min: number, max: number) => {\n  return Math.max(Math.min(value, max), min);\n};\n\n/**\n * 限制最大/最小缩放\n */\nexport const limitScale = (scale: number, max: number = 0, buffer: number = 0) => {\n  return limitNumber(scale, minScale * (1 - buffer), Math.max(maxScale, max) * (1 + buffer));\n};\n","import { useEffect, useRef } from 'react';\n\nexport default function useEventListener<K extends keyof WindowEventMap>(\n  type: K | undefined,\n  fn: (evt: WindowEventMap[K]) => void,\n  options?: AddEventListenerOptions,\n) {\n  const latest = useRef(fn);\n  latest.current = fn;\n\n  useEffect(() => {\n    function wrapper(evt: WindowEventMap[K]) {\n      latest.current(evt);\n    }\n    if (type) {\n      window.addEventListener(type, wrapper, options);\n    }\n    return () => {\n      if (type) {\n        window.removeEventListener(type, wrapper);\n      }\n    };\n  }, [type]);\n}\n","import { useMemo } from 'react';\nimport type { DataType } from '../types';\n\n/**\n * 截取相邻三张图片\n */\nexport default function useAdjacentImages(images: DataType[], index: number, loop: boolean) {\n  return useMemo(() => {\n    const imageLength = images.length;\n    if (loop) {\n      const connected = images.concat(images).concat(images);\n      return connected.slice(imageLength + index - 1, imageLength + index + 2);\n    }\n    return images.slice(Math.max(index - 1, 0), Math.min(index + 2, imageLength + 1));\n  }, [images, index, loop]);\n}\n","import React, { useMemo, useRef } from 'react';\nimport type { DataType, PhotoProviderBase } from './types';\nimport useMethods from './hooks/useMethods';\nimport useSetState from './hooks/useSetState';\nimport PhotoContext from './photo-context';\nimport PhotoSlider from './PhotoSlider';\n\nexport interface PhotoProviderProps extends PhotoProviderBase {\n  children: React.ReactNode;\n  onIndexChange?: (index: number, state: PhotoProviderState) => void;\n  onVisibleChange?: (visible: boolean, index: number, state: PhotoProviderState) => void;\n}\n\ntype PhotoProviderState = {\n  images: DataType[];\n  visible: boolean;\n  index: number;\n};\n\nconst initialState: PhotoProviderState = {\n  images: [],\n  visible: false,\n  index: 0,\n};\n\nexport default function PhotoProvider({ children, onIndexChange, onVisibleChange, ...restProps }: PhotoProviderProps) {\n  const [state, updateState] = useSetState(initialState);\n  const uniqueIdRef = useRef(0);\n  const { images, visible, index } = state;\n\n  const methods = useMethods({\n    nextId() {\n      return (uniqueIdRef.current += 1);\n    },\n    update(imageItem: DataType) {\n      const currentIndex = images.findIndex((n) => n.key === imageItem.key);\n      if (currentIndex > -1) {\n        const nextImages = images.slice();\n        nextImages.splice(currentIndex, 1, imageItem);\n        updateState({\n          images: nextImages,\n        });\n        return;\n      }\n      updateState((prev) => ({\n        images: prev.images.concat(imageItem),\n      }));\n    },\n    remove(key: number) {\n      updateState((prev) => {\n        const nextImages = prev.images.filter((item) => item.key !== key);\n        const nextEndIndex = nextImages.length - 1;\n        return {\n          images: nextImages,\n          index: Math.min(nextEndIndex, index),\n        };\n      });\n    },\n    show(key: number) {\n      const currentIndex = images.findIndex((item) => item.key === key);\n      updateState({\n        visible: true,\n        index: currentIndex,\n      });\n      if (onVisibleChange) {\n        onVisibleChange(true, currentIndex, state);\n      }\n    },\n  });\n\n  const fn = useMethods({\n    close() {\n      updateState({\n        visible: false,\n      });\n\n      if (onVisibleChange) {\n        onVisibleChange(false, index, state);\n      }\n    },\n    changeIndex(nextIndex: number) {\n      updateState({\n        index: nextIndex,\n      });\n\n      if (onIndexChange) {\n        onIndexChange(nextIndex, state);\n      }\n    },\n  });\n\n  const value = useMemo(() => ({ ...state, ...methods }), [state, methods]);\n\n  return (\n    <PhotoContext.Provider value={value}>\n      {children}\n      <PhotoSlider\n        images={images}\n        visible={visible}\n        index={index}\n        onIndexChange={fn.changeIndex}\n        onClose={fn.close}\n        {...restProps}\n      />\n    </PhotoContext.Provider>\n  );\n}\n","import type React from 'react';\nimport { useImperativeHandle, Children, cloneElement, useContext, useEffect, useMemo, useRef } from 'react';\nimport useInitial from './hooks/useInitial';\nimport useMethods from './hooks/useMethods';\nimport type { PhotoContextType } from './photo-context';\nimport PhotoContext from './photo-context';\nimport type { PhotoRenderParams } from './types';\n\nexport interface PhotoViewProps {\n  /**\n   * 图片地址\n   */\n  src?: string;\n  /**\n   * 自定义渲染，优先级比 src 低\n   */\n  render?: (props: PhotoRenderParams) => React.ReactNode;\n  /**\n   * 自定义覆盖节点\n   */\n  overlay?: React.ReactNode;\n  /**\n   * 自定义渲染节点宽度\n   */\n  width?: number;\n  /**\n   * 自定义渲染节点高度\n   */\n  height?: number;\n  /**\n   * 子节点，一般为缩略图\n   */\n  children?: React.ReactElement;\n  /**\n   * 触发的事件\n   */\n  triggers?: ('onClick' | 'onDoubleClick')[];\n}\n\nconst PhotoView: React.FC<PhotoViewProps> = ({\n  src,\n  render,\n  overlay,\n  width,\n  height,\n  triggers = ['onClick'],\n  children,\n}) => {\n  const photoContext = useContext<PhotoContextType>(PhotoContext);\n  const key = useInitial(() => photoContext.nextId());\n  const originRef = useRef<HTMLElement>(null);\n\n  useImperativeHandle((children as React.FunctionComponentElement<HTMLElement>)?.ref, () => originRef.current);\n\n  useEffect(() => {\n    return () => {\n      photoContext.remove(key);\n    };\n  }, []);\n\n  function invokeChildrenFn(eventName: string, e: React.SyntheticEvent) {\n    if (children) {\n      const eventFn = children.props[eventName];\n      if (eventFn) {\n        eventFn(e);\n      }\n    }\n  }\n\n  const fn = useMethods({\n    render(props: PhotoRenderParams) {\n      return render && render(props);\n    },\n    show(eventName: string, e: React.MouseEvent) {\n      photoContext.show(key);\n      invokeChildrenFn(eventName, e);\n    },\n  });\n\n  const eventListeners = useMemo(() => {\n    const listener = {};\n    triggers.forEach((eventName) => {\n      listener[eventName] = fn.show.bind(null, eventName);\n    });\n    return listener;\n  }, []);\n\n  useEffect(() => {\n    photoContext.update({\n      key,\n      src,\n      originRef,\n      render: fn.render,\n      overlay,\n      width,\n      height,\n    });\n  }, [src]);\n\n  if (children) {\n    return Children.only(cloneElement(children, { ...eventListeners, ref: originRef }  as React.HTMLProps<HTMLElement>));\n  }\n  return null;\n};\n\nexport default PhotoView;","import { useRef } from 'react';\n\nexport default function useInitial<T extends (...args: any) => any>(callback: T) {\n  const { current } = useRef({ sign: false, fn: undefined as ReturnType<T> });\n  if (!current.sign) {\n    current.sign = true;\n    current.fn = callback();\n  }\n  return current.fn;\n}\n"],"names":["useMethods","fn","current","useRef","curr","undefined","Object","create","keys","forEach","key","args","call","useSetState","initialState","useReducer","state","action","_extends","createContext","defaultOpacity","isTouchDevice","window","test","navigator","userAgent","useEffect","useLayoutEffect","SlidePortal","_ref","container","document","body","rest","_objectWithoutPropertiesLoose","_excluded","createPortal","_jsx","CloseIcon","props","_jsxs","className","children","ArrowLeft","width","height","viewBox","d","ArrowRight","PreventScroll","style","lastOverflow","overflow","warningThrown","throwWarning","console","warn","Array","prototype","slice","arguments","apply","throwError","error","generateUUID","replace","c","r","Math","random","toString","toUpperCase","isPowerOf2","value","Scene","constructor","renderer","this","type","gl","initStacks","stacks","pingPong","renderTargets","opaque","transparent","renderPasses","scenePasses","resetPlaneStacks","i","planes","length","addPlane","resetShaderPassStacks","shaderPasses","index","_isScenePass","push","scenePassIndex","addToRenderTargetsStack","plane","renderTargetsPlanes","filter","el","target","uuid","siblingPlaneIndex","_depth","findIndex","max","splice","sort","a","b","renderOrder","addToRegularPlaneStack","planeStack","_transparent","_geometry","definition","id","relativeTranslation","z","removePlane","setPlaneRenderOrder","sortShaderPassStack","scenePassWithoutDepth","find","pass","depth","addShaderPass","shaderPass","removeShaderPass","passStack","enableShaderPass","bindFrameBuffer","drawRenderPasses","_startDrawing","clearDepth","drawScenePasses","drawPingPongStack","drawStack","stackType","draw","setBlending","CacheManager","geometries","clear","textures","programs","getGeometryFromID","definitionID","element","addGeometry","vertices","uvs","isSameShader","firstShader","secondShader","localeCompare","getProgramFromShaders","vsCode","fsCode","addProgram","program","getTextureFromSource","source","src","addTexture","texture","removeTexture","CallbackQueueManager","queue","add","callback","keep","queueItem","timeout","setTimeout","execute","map","entry","clearTimeout","Renderer","alpha","antialias","premultipliedAlpha","failIfMajorPerformanceCaveat","preserveDrawingBuffer","stencil","pixelRatio","renderingScale","production","onError","onSuccess","onContextLost","onContextRestored","onDisposed","onSceneChange","_renderingScale","initState","canvas","createElement","glAttributes","getContext","_isWebGL2","isActive","initRenderer","isContextLost","drawingEnabled","forceRender","currentProgramID","currentGeometryID","forceBufferUpdate","depthTest","blending","cullFace","frameBufferID","activeTexture","unpackAlignment","flipY","premultiplyAlpha","initCallbackQueueManager","nextRender","maxTextureSize","getParameter","MAX_TEXTURE_SIZE","setBlendFunc","setDepthFunc","setDepthTest","cache","scene","getExtensions","_contextLostHandler","contextLost","bind","addEventListener","_contextRestoredHandler","contextRestored","extensions","getExtension","event","preventDefault","restoreContext","isContextexFullyRestored","isRestored","_canDraw","j","_restoreContext","isRestoredQueue","needRender","setPixelRatio","setSize","containerBoundingRect","getBoundingClientRect","_boundingRect","top","left","isSafari","match","iOS","MSStream","getTopOffset","topOffset","isNaN","offsetTop","scrollTop","offsetParent","floor","viewport","drawingBufferWidth","drawingBufferHeight","resize","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","clearColor","frameBuffer","cancelClear","bufferId","bindFramebuffer","FRAMEBUFFER","_frameBuffer","_size","_shouldClear","enable","DEPTH_TEST","disable","depthFunc","LEQUAL","enableBlending","BLEND","blendFuncSeparate","ONE","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","setFaceCulling","CULL_FACE","faceCulling","FRONT","BACK","useProgram","removeRenderTarget","renderTarget","hasPlane","enableDrawing","disableDrawing","render","deletePrograms","deleteProgram","dispose","disposeQueue","removeEventListener","loseContext","removeChild","ScrollManager","xOffset","yOffset","lastXDelta","lastYDelta","shouldWatch","onScroll","handler","scroll","passive","updateScrollValues","pageXOffset","pageYOffset","x","y","lastScrollXValue","lastScrollYValue","Curtains","autoResize","autoRender","watchScroll","devicePixelRatio","_autoResize","_autoRender","_watchScroll","parseFloat","min","errors","setContainer","getElementById","setAttribute","appendChild","Element","_initCurtains","_initRenderer","_initScroll","_setSize","_addListeners","log","_animationFrameID","_animate","_onRendererError","_onRendererSuccess","_onRendererContextLost","_onRendererContextRestored","_onRendererDisposed","_keepSync","requestAnimationFrame","isWebGL2","_onRenderCallback","_resizeHandler","triggerCallback","_scrollManager","getBoundingRect","_onAfterResizeCallback","_updateScroll","updateScrollPosition","_onScrollCallback","getScrollDeltas","getScrollValues","lerp","start","end","amount","onAfterResize","_onErrorCallback","_onSuccessCallback","_onContextLostCallback","_onContextRestoredCallback","onRender","cancelAnimationFrame","Uniforms","uniforms","uniform","name","clone","update","handleUniformSetting","setUniform1i","setUniform1iv","setUniform1f","setUniform1fv","setUniform2i","setUniform2iv","setUniform2f","setUniform2fv","setUniform3i","setUniform3iv","setUniform3f","setUniform3fv","setUniform4i","setUniform4iv","setUniform4f","setUniform4fv","setUniformMatrix2fv","setUniformMatrix3fv","setUniformMatrix4fv","setInternalFormat","_internalFormat","lastValue","isArray","from","Float32Array","setUniforms","location","getUniformLocation","updateUniforms","shouldUpdate","equals","copy","JSON","stringify","uniform1i","uniform1iv","uniform1f","uniform1fv","uniform2i","uniform2iv","uniform2f","uniform2fv","uniform3i","uniform3iv","uniform3f","uniform3fv","uniform4i","elements","uniform4iv","uniform4f","uniform4fv","uniformMatrix2fv","uniformMatrix3fv","uniformMatrix4fv","precisionMedium$1","defaultAttributes$1","defaultVaryings$1","planeVS$1","precisionMedium","defaultAttributes","defaultVaryings","planeFS$1","shaderPassVS$1","shaderPassFS$1","Program","parent","vertexShader","fragmentShader","defaultVsCode","planeVS","shaderPassVS","defaultFsCode","planeFS","shaderPassFS","compiled","setupProgram","createShader","shaderCode","shaderType","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","shaderTypeString","VERTEX_SHADER","shaderLines","getShaderSource","split","join","getShaderInfoLog","useNewShaders","FRAGMENT_SHADER","existingProgram","activeUniforms","activeAttributes","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","deleteShader","textureMatrices","numUniforms","ACTIVE_UNIFORMS","activeUniform","getActiveUniform","SAMPLER_2D","FLOAT_MAT4","numAttributes","ACTIVE_ATTRIBUTES","activeAttribute","getActiveAttrib","createUniforms","uniformsManager","Geometry","setDefaultAttributes","setVerticesUVs","setProgram","attributes","vertexPosition","size","textureCoord","cachedGeometry","array","computeVerticesUVs","initAttributes","_vao","createVertexArray","bindVertexArray","createVertexArrayOES","bindVertexArrayOES","initializeBuffers","includes","getAttribLocation","buffer","createBuffer","numberOfItems","v","u","enableVertexAttribArray","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","vertexAttribPointer","FLOAT","bindBuffers","drawArrays","TRIANGLES","deleteVertexArray","deleteVertexArrayOES","deleteBuffer","Mat4","setFromArray","matrix","multiply","result","getInverse","te","out","oe","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","a30","a31","a32","a33","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","scale","vector","compose","translation","quaternion","w","x2","y2","z2","xx","xy","xz","yy","yz","zz","wx","wy","wz","sx","sy","sz","composeFromOrigin","origin","ox","oy","oz","out0","out1","out2","out4","out5","out6","out8","out9","out10","Vec2","_x","_y","changed","_onChangeCallback","onChange","set","addScalar","sub","subScalar","multiplyScalar","sanitizeNaNValuesWith","normalize","len","sqrt","dot","Vec3","_z","applyMat4","mArray","applyQuat","qx","qy","qz","qw","ix","iy","iz","iw","project","camera","viewMatrix","projectionMatrix","unproject","worldMatrix","tempVec2","tempVec3","textureTranslation","Texture","isFBOTexture","fromTexture","loader","sampler","floatingPoint","anisotropy","generateMipmap","wrapS","wrapT","minFilter","magFilter","_globalParameters","shouldPremultiplyAlpha","UNSIGNED_BYTE","internalFormat","RGBA","format","parameters","CLAMP_TO_EDGE","LINEAR","_shouldUpdate","_initState","sourceType","_useCache","_samplerName","_sampler","isTextureBound","createTexture","_textureMatrix","offset","_loader","_sourceLoaded","_uploaded","_willUpdate","_forceUpdate","userData","_copyOnInit","_copiedFrom","_initTexture","_state","bindTexture","TEXTURE_2D","_updateGlobalTexParameters","texImage2D","Uint8Array","_restoreFromTexture","_parent","_setTextureUniforms","_setParent","setSource","needUpdate","addParent","_program","waitForOriginalTexture","_addSourceToParent","_upload","_updateTexParameters","hasParent","textureMatrix","assign","_onSourceLoadedCallback","_onSourceUploadedCallback","_videoFrameCallbackID","tagName","toLowerCase","cachedTexture","naturalWidth","videoWidth","naturalHeight","videoHeight","pixelStorei","UNPACK_ALIGNMENT","UNPACK_FLIP_Y_WEBGL","UNPACK_PREMULTIPLY_ALPHA_WEBGL","RGBA16F","HALF_FLOAT","HALF_FLOAT_OES","_bindTexture","REPEAT","MIRRORED_REPEAT","texParameteri","TEXTURE_WRAP_S","TEXTURE_WRAP_T","NEAREST","NEAREST_MIPMAP_NEAREST","LINEAR_MIPMAP_NEAREST","NEAREST_MIPMAP_LINEAR","LINEAR_MIPMAP_LINEAR","TEXTURE_MIN_FILTER","TEXTURE_MAG_FILTER","anisotropyExt","MAX_TEXTURE_MAX_ANISOTROPY_EXT","texParameterf","TEXTURE_MAX_ANISOTROPY_EXT","setWrapS","setWrapT","setMinFilter","setMagFilter","setAnisotropy","_videoFrameCallback","requestVideoFrameCallback","waitForSource","_getSizes","parentWidth","parentHeight","sourceWidth","sourceHeight","sourceRatio","parentRatio","setScale","setOffset","sizes","_updateTextureMatrix","textureScale","_updateMatrixUniform","_onSourceLoaded","TEXTURE0","TEXTURE_BINDING_2D","_draw","readyState","HAVE_CURRENT_DATA","paused","onSourceLoaded","onSourceUploaded","_dispose","force","_removeSource","deleteTexture","TextureLoader","crossOrigin","_addElement","successCallback","errorCallback","load","_sourceLoadError","_increment","_onLoadingCallback","_getSourceType","_createImage","hasAttribute","image","Image","getAttribute","_createVideo","video","loadSource","textureOptions","loadImage","loadVideo","loadCanvas","loadSources","sources","texturesOptions","options","_texturesOptions","_addToParent","complete","decode","then","catch","loadImages","preload","muted","loop","HAVE_FUTURE_DATA","HTMLVideoElement","videoFrameCallback","loadVideos","loadCanvases","cancelVideoFrameCallback","pause","removeAttribute","PlaneTextureLoader","sourcesLoaded","sourcesToLoad","onComplete","super","_setLoaderSize","parentAssetArray","isSameNode","Mesh","vertexShaderID","fragmentShaderID","widthSegments","heightSegments","_depthTest","innerHTML","_initMesh","parseInt","initSourcesToLoad","_onReadyCallback","images","videos","canvases","_matrices","_programRestored","setRenderTarget","setRenderOrder","sourcesArray","imagesArray","videosArray","canvasesArray","playVideos","playPromise","play","_onAfterRenderCallback","onLoading","onReady","onAfterRender","remove","_shaderPass","shift","tempVec2a","tempVec2b","DOMMesh","htmlElement","_setDocumentSizes","planeBoundingRect","right","bottom","setPerspective","fov","near","far","_setWorldSizes","_applyWorldPositions","mouseToPlaneCoords","mouseCoordinates","scaleAdjustment","Camera","position","setFov","setPosition","setCSSPerspective","setNear","setFar","updateProjectionMatrix","CSSPerspective","pow","tan","PI","getScreenRatiosFromFov","cameraOffset","vFOV","abs","aspect","forceUpdate","cancelUpdate","Quat","axisOrder","setAxisOrder","setFromVec3","ax","ay","az","cosx","cos","cosy","cosz","sinx","sin","siny","sinz","tempScale","tempWorldPos1","tempWorldPos2","tempCorner1","tempCorner2","tempCorner3","tempCorner4","tempCulledCorner1","tempCulledCorner2","identityQuat","defaultTransformOrigin","tempRayDirection","tempNormals","tempRotatedOrigin","tempRaycast","castedMouseCoords","Plane","alwaysDraw","visible","drawCheckMargins","autoloadSources","_shouldDraw","_updateMVMatrix","_initPlane","_initMatrices","_initTransformValues","_initPositions","_initSources","rotation","_applyRotation","_setTranslation","_translation","_applyScale","transformOrigin","_setWorldTransformOrigin","resetPlane","world","modelView","projection","modelViewProjection","_setPerspectiveMatrix","_setMVMatrix","_shouldDrawCheck","_documentToWorldSpace","ratios","_setWorldPosition","planeCenter","containerCenter","setRotation","setTransformOrigin","worldPosition","setRelativeTranslation","updatePosition","_getIntersection","refPoint","secondPoint","direction","intersection","_getNearPlaneIntersections","corners","mvpCorners","clippedCorners","mVPMatrix","nonClippedCorner","_getWorldCoords","mvpCorner","minX","Infinity","maxX","minY","maxY","corner","_computeWebGLBoundingRect","worldBBox","screenBBox","worldToDocument","getWebGLBoundingRect","_getWebGLDrawRect","actualPlaneBounds","round","_onLeaveViewCallback","_onReEnterViewCallback","isDrawn","enableDepthTest","shouldEnableDepthTest","loaderSize","getElementsByTagName","worldMouse","rayOrigin","rayDirection","planeNormals","denominator","inverseViewMatrix","planeOrigin","rotatedOrigin","distance","onReEnterView","onLeaveView","_assertThisInitialized","self","ReferenceError","_inheritsLoose","subClass","superClass","__proto__","_suppressOverwrites","_reverting","_context","_globalTimeline","_win","_coreInitted","_doc","_coreReady","_lastRenderedFrame","_quickTween","_tickerActive","n","n1","n2","n3","easeOut","_config","autoSleep","force3D","nullTargetWarn","units","lineHeight","_defaults","duration","overwrite","delay","_bigNum","_tinyNum","_2PI","_HALF_PI","_gsID","_sqrt","_cos","_sin","_isString","_isFunction","_isNumber","_isUndefined","_isObject","_isNotFalse","_windowExists","_isFuncOrString","_isTypedArray","ArrayBuffer","isView","_isArray","_strictNumExp","_numExp","_numWithUnitExp","_complexStringNumExp","_relExp","_delimitedValueExp","_unitExp","_globals","_installScope","_install","scope","_merge","gsap","_missingPlugin","property","_warn","message","suppress","_addGlobal","obj","_emptyFunc","_startAtRevertConfig","suppressEvents","isStart","kill","_revertConfigNoKill","_revertConfig","_reservedProps","_lazyTweens","_lazyLookup","_plugins","_effects","_nextGCFrame","_harnessPlugins","_callbackNames","_harness","targets","harnessPlugin","_gsap","harness","targetTest","GSCache","_getCache","toArray","_getProperty","_forEachName","names","func","_round","_roundPrecise","_parseRelative","operator","charAt","substr","_arrayContainsAny","toSearch","toFind","l","indexOf","_lazyRender","tween","_lazy","_lazySafeRender","animation","time","_initted","_startAt","_numericIfPossible","trim","_passThrough","p","_setDefaults","defaults","base","toMerge","_mergeDeep","_copyExcluding","excluding","_inheritDefaults","vars","excludeDuration","keyframes","inherit","_dp","_addLinkedListItem","child","firstProp","lastProp","sortBy","t","prev","_prev","_next","_removeLinkedListItem","next","_removeFromParent","onlyIfParentHasAutoRemove","autoRemoveChildren","_act","_uncache","_end","_dur","_start","_dirty","_rewindStartAt","totalTime","revert","immediateRender","autoRevert","_hasNoPausedAncestors","_ts","_elapsedCycleDuration","_repeat","_animationCycle","_tTime","_rDelay","tTime","cycleDuration","whole","_parentToChildTotalTime","parentTime","totalDuration","_tDur","_setEnd","_rts","_alignPlayhead","smoothChildTiming","_time","_postAddChecks","timeline","rawTime","_clamp","_zTime","_addToTimeline","skipChecks","_parsePosition","_delay","timeScale","_sort","_isFromOrFromStart","_recent","_scrollTrigger","trigger","ScrollTrigger","_attemptInitTween","_initTween","_pt","lazy","_ticker","frame","_parentPlayheadIsBeforeStart","_lock","_ref2","data","_setDuration","skipUncache","leavePlayhead","repeat","dur","totalProgress","_onUpdateTotalDuration","Timeline","_zeroPosition","endTime","percentAnimation","isPercent","labels","recent","clippedDuration","_createTweenType","params","irVars","isLegacy","varsIndex","runBackwards","startAt","Tween","_conditionalReturn","getUnit","exec","_slice","_isArrayLike","nonEmpty","nodeType","leaveStrings","selector","_wake","ar","accumulator","_accumulator","_flatten","querySelectorAll","nativeElement","shuffle","distribute","each","ease","_parseEase","isDecimal","axis","ratioX","ratioY","center","edges","originX","originY","wrapAt","distances","grid","_invertEase","_roundModifier","raw","snap","snapTo","radius","is2D","values","increment","dx","dy","closest","roundingIncrement","returnFunction","_wrapArray","wrapper","_replaceRandom","nums","s","mapRange","inMin","inMax","outMin","outMax","inRange","outRange","_getLabelInDirection","fromTime","backward","label","_callback","executeLazyFirst","prevContext","context","_ctx","callbackScope","_interrupt","scrollTrigger","progress","_registerPluginQueue","_createPlugin","config","headless","isFunc","Plugin","init","_props","instanceDefaults","_renderPropTweens","_addPropTween","_killPropTweensOf","modifier","_addPluginModifier","rawVars","statics","get","getSetter","_getSetter","aliases","register","prop","PropTween","_255","_colorLookup","aqua","lime","silver","black","maroon","teal","blue","navy","white","olive","yellow","orange","gray","purple","green","red","pink","cyan","_hue","h","m1","m2","splitColor","toHSL","forceAlpha","g","wasHSL","Number","_colorOrderData","_colorExp","_formatColors","orderMatchData","shell","colors","color","RegExp","_hslExp","_colorStringFilter","combined","lastIndex","_id","_req","_raf","_self","_delta","_i","_getTime","Date","now","_lagThreshold","_adjustedLag","_startTime","_lastUpdate","_gap","_nextTime","_listeners","_tick","overlap","dispatch","elapsed","manual","tick","deltaRatio","fps","wake","gsapVersions","version","GreenSockGlobals","sleep","f","lagSmoothing","threshold","adjustedLag","_fps","once","prioritize","_easeMap","_customEaseExp","_quotesExp","_parseObjectInString","val","parsedVal","lastIndexOf","_propagateYoyoEase","isYoyo","_first","yoyoEase","_yoyo","_ease","_yEase","defaultEase","open","close","nested","substring","_CE","_configEaseFromString","_insertEase","easeIn","easeInOut","lowercaseName","_easeInOutFromOut","_configElastic","amplitude","period","p1","p2","p3","asin","_configBack","overshoot","power","Linear","easeNone","none","SteppedEase","steps","immediateStart","Animation","repeatDelay","yoyo","_proto","startTime","_totalTime","_ptLookup","_pTime","iteration","_ps","_recacheAncestors","includeRepeats","wrapRepeats","prevIsReverting","globalTime","_sat","seek","restart","includeDelay","reversed","reverse","atTime","resume","invalidate","eventCallback","_onUpdate","onFulfilled","Promise","resolve","_resolve","_then","_prom","ratio","_Animation","_this","sortChildren","_proto2","to","fromTo","fromVars","toVars","delayedCall","staggerTo","stagger","onCompleteAll","onCompleteAllParams","onCompleteParams","staggerFrom","staggerFromTo","prevPaused","pauseTween","prevStart","prevIteration","prevTime","tDur","crossingStart","rewinding","doesWrap","repeatRefresh","onRepeat","_hasPause","_forcing","_last","_findNextPauseTween","onUpdate","adjustedTime","_this2","addLabel","getChildren","tweens","timelines","ignoreBeforeTime","getById","animations","removeLabel","killTweensOf","_totalTime2","addPause","removePause","onlyActive","getTweensOf","_overwritingTween","parsedTargets","isGlobalTime","_targets","tweenTo","initted","tl","_onStart","onStart","onStartParams","tweenFromTo","fromPosition","toPosition","nextLabel","afterTime","previousLabel","beforeTime","currentLabel","shiftChildren","adjustLabels","soft","includeLabels","updateRoot","_forceAllPropTweens","_addComplexStringPropTween","setter","stringFilter","funcParam","startNums","endNum","chunk","startNum","hasRandom","pt","_renderComplexString","matchIndex","e","m","fp","optional","currentValue","parsedStart","_setterFuncWithParam","_setterFunc","_setterPlain","_renderBoolean","_renderPlain","_checkPlugin","plugin","ptLookup","_parseFuncOrString","_processVars","priority","cleanVars","hasPriority","gsData","harnessVars","overwritten","prevStartAt","fullTargets","autoOverwrite","_overwrite","_from","_ptCache","_op","_sortPropTweensByPriority","_onInit","_parseKeyframe","allProps","easeEach","_staggerTweenProps","_staggerPropsToSkip","_Animation2","skipInherit","_this3","curTarget","staggerFunc","staggerVarsToMerge","_this3$vars","kf","_proto3","isNegative","prevRatio","_renderZeroDurationTween","resetTo","startIsRelative","skipRecursion","rootPT","lookup","ptCache","_updatePropTweens","overwrittenProps","curLookup","curOverwriteProps","killingTargets","propTweenLookup","firstPT","a1","a2","_arraysMatch","propertyAliases","_addAliasesToVars","onReverseComplete","onReverseCompleteParams","_setterAttribute","hasNonDependentRemaining","op","dep","_setterWithModifier","mSet","mt","pt2","first","last","pr","change","TweenMax","TweenLite","TimelineLite","TimelineMax","_media","_emptyArray","_lastMediaTime","_contextID","_dispatch","_onMediaChange","matches","anyMatch","toggled","queries","conditions","matchMedia","onMatch","Context","_r","isReverted","_proto5","prevSelector","ignore","getTweens","_this4","o","MatchMedia","contexts","_proto6","mq","active","cond","addListener","registerPlugin","_len2","_key2","getProperty","unit","uncache","getter","quickSetter","setters","quickTo","_setDefaults2","isTweening","registerEffect","_ref3","effect","extendTimeline","plugins","pluginName","registerEase","parseEase","exportRoot","includeDelayedCalls","matchMediaRefresh","found","utils","wrap","range","wrapYoyo","total","clamp","pipe","_len","functions","_key","reduce","unitize","interpolate","mutate","interpolators","il","isString","master","install","effects","ticker","globalTimeline","core","globals","getCache","reverting","toAdd","suppressOverwrites","_getPluginPropTween","_buildModifierPlugin","temp","modifiers","_addModifiers","_docElement","_pluginInitted","_tempDiv","_recentSetterPlugin","_supports3D","_transformProps","_RAD2DEG","_DEG2RAD","_atan2","atan2","_capsExp","_horizontalExp","_complexExp","_propertyAliases","autoAlpha","_renderCSSProp","_renderPropWithEnd","_renderCSSPropWithBeginning","_renderRoundedCSSProp","_renderNonTweeningValue","_renderNonTweeningValueOnlyAtEnd","_setterCSSStyle","_setterCSSProp","setProperty","_setterTransform","_setterScale","scaleX","scaleY","_setterScaleWithRender","renderTransform","_setterTransformWithRender","_transformProp","_transformOriginProp","_saveStyle","isNotCSS","tfm","transform","_get","zOrigin","svg","svgo","_removeIndependentTransforms","translate","removeProperty","_revertStyle","_getStyleSaver","properties","saver","save","_createElement","ns","createElementNS","_getComputedProperty","skipPrefixFallback","cs","getComputedStyle","getPropertyValue","_checkPropPrefix","_prefixes","preferPrefix","_initCore","documentElement","cssText","_getReparentedCloneBBox","bbox","owner","ownerSVGElement","cloneNode","display","getBBox","_getAttributeFallbacks","attributesArray","_getBBox","bounds","cloned","_isSVG","getCTM","parentNode","_removeProperty","first2Chars","_addNonTweeningPT","beginning","onlySetAtEnd","_nonConvertibleUnits","deg","rad","turn","_nonStandardLayouts","flex","_convertToUnit","px","isSVG","curValue","curUnit","horizontal","isRootSVG","measureProperty","toPixels","toPercent","_parseTransform","_firstTwoOnly","_specialProps","_tweenComplexCSSString","startValues","startValue","endValue","endUnit","startUnit","_keywordToPercent","_renderClearProps","clearTransforms","rotate","clearProps","_identity2DMatrix","_rotationalProperties","_isNullTransform","_getComputedTransformMatrixAsArray","matrixString","_getMatrix","force2D","nextSibling","addedToDOM","baseVal","consolidate","nextElementSibling","insertBefore","_applySVGOrigin","originIsAbsolute","smooth","matrixArray","pluginToAddPropTweensTo","determinant","xOriginOld","xOrigin","yOriginOld","yOrigin","xOffsetOld","yOffsetOld","tx","ty","originSplit","rotationX","rotationY","skewX","skewY","perspective","angle","t1","t2","t3","a42","a43","invertedScaleX","forceCSS","xPercent","offsetWidth","yPercent","offsetHeight","transformPerspective","_renderSVGTransforms","_renderCSSTransforms","_renderNon3DTransforms","_addPxTranslate","_zeroDeg","_zeroPx","_endParenthesis","transforms","use3D","_addRotationalPropTween","cap","finalValue","_assign","_addRawTransformPTs","endCache","startCache","side","all","CSSPlugin","specialProp","relative","isTransformRelated","transformPropTween","inlineProps","styles","visibility","parseTransform","smoothOrigin","autoRound","checkPrefix","getStyleSaver","positionAndScale","gsapWithCSS","async","imagesSrc","webgl","webGLCurtain","texture0","texture1","currentIndex","gsapAnimation","vs","fs","mousepos","resolution","innerWidth","innerHeight","loadTexture","url","samplerName","img","initPlane","box","div","img0","img1","mapImg","goToIndex","nextImage","touched","lastCX","lastCY","bg","lastBg","overlay","minimal","PhotoSlider","speed","speedFn","easing","easingFn","maskClosable","maskOpacity","pullClosable","bannerVisible","overlayRender","toolbarRender","maskClassName","controlledIndex","onIndexChange","controlledIndexChange","onClose","afterClose","portalContainer","updateState","innerIndex","updateInnerIndex","useState","indexController","setIndexController","onScale","onRotate","isControlled","hasOwnProperty","virtualIndexRef","imageLength","currentImage","enableLoop","realVisible","activeAnimation","onAnimationEnd","handleRender","modifyRealVisible","initial","forkedRef","modify","useMemo","updater","useForkedVariable","useAnimationVisible","useIsomorphicLayoutEffect","changeIndex","evt","nextIndex","isPause","limitIndex","limitNumber","nextVirtualIndex","singlePageWidth","realLoopIndex","latest","useEventListener","concat","useAdjacentImages","item","currentOverlayVisible","currentOpacity","overlayParams","overlayVisible","currentSpeed","currentEasing","role","onClick","stopPropagation","background","transitionTimingFunction","transitionDuration","animationDuration","_Fragment","PhotoProvider","onVisibleChange","restProps","uniqueIdRef","methods","nextId","imageItem","nextImages","show","PhotoContext","Provider","PhotoView","triggers","photoContext","useContext","sign","useInitial","originRef","useImperativeHandle","ref","eventName","eventFn","invokeChildrenFn","eventListeners","listener","Children","only","cloneElement"],"mappings":"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"}