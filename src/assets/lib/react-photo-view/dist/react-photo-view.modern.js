import{jsx as t,jsxs as e,Fragment as i}from"react/jsx-runtime";import{useRef as r,useReducer as s,createContext as n,useEffect as a,useLayoutEffect as o,useMemo as h,useState as l,useContext as u,useImperativeHandle as d,Children as c,cloneElement as p}from"react";import{createPortal as _}from"react-dom";function m(){return m=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)({}).hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},m.apply(null,arguments)}function f(t,e){if(null==t)return{};var i={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(-1!==e.indexOf(r))continue;i[r]=t[r]}return i}function g(t){const{current:e}=r({fn:t,curr:void 0});if(e.fn=t,!e.curr){const i=Object.create(null);Object.keys(t).forEach(t=>{i[t]=(...i)=>e.fn[t].call(e.fn,...i)}),e.curr=i}return e.curr}function v(t){return s((t,e)=>m({},t,"function"==typeof e?e(t):e),t)}var x=n(void 0);const y=1,b="undefined"!=typeof window&&"ontouchstart"in window;var w="undefined"==typeof window||/ServerSideRendering/.test(navigator&&navigator.userAgent)?a:o;const T=["container"];function R(e){let{container:i=document.body}=e,r=f(e,T);return _(t("div",m({},r)),i)}function P(i){return e("button",m({},i,{children:[e("div",{className:"in",children:[t("div",{className:"close-button-block"}),t("div",{className:"close-button-block"})]}),e("div",{className:"out",children:[t("div",{className:"close-button-block"}),t("div",{className:"close-button-block"})]})]}))}function S(e){return t("svg",m({width:"44",height:"44",viewBox:"0 0 768 768"},e,{children:t("path",{d:"M640.5 352.5v63h-390l178.5 180-45 45-256.5-256.5 256.5-256.5 45 45-178.5 180h390z"})}))}function C(e){return t("svg",m({width:"44",height:"44",viewBox:"0 0 768 768"},e,{children:t("path",{d:"M384 127.5l256.5 256.5-256.5 256.5-45-45 178.5-180h-390v-63h390l-178.5-180z"})}))}function M(){return a(()=>{const{style:t}=document.body,e=t.overflow;return t.overflow="hidden",()=>{t.overflow=e}},[]),null}let E=0;function A(){if(!(E>100)){if(100===E)console.warn("Curtains: too many warnings thrown, stop logging.");else{const t=Array.prototype.slice.call(arguments);console.warn.apply(console,t)}E++}}function k(){const t=Array.prototype.slice.call(arguments);console.error.apply(console,t)}function O(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{let e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16).toUpperCase()})}function D(t){return!(t&t-1)}class F{constructor(t){if(this.type="Scene",t&&"Renderer"===t.type){if(!t.gl)return void k(this.type+": Renderer WebGL context is undefined",t)}else k(this.type+": Renderer not passed as first argument",t);this.renderer=t,this.gl=t.gl,this.initStacks()}initStacks(){this.stacks={pingPong:[],renderTargets:[],opaque:[],transparent:[],renderPasses:[],scenePasses:[]}}resetPlaneStacks(){this.stacks.pingPong=[],this.stacks.renderTargets=[],this.stacks.opaque=[],this.stacks.transparent=[];for(let t=0;t<this.renderer.planes.length;t++)this.addPlane(this.renderer.planes[t])}resetShaderPassStacks(){this.stacks.scenePasses=[],this.stacks.renderPasses=[];for(let t=0;t<this.renderer.shaderPasses.length;t++)this.renderer.shaderPasses[t].index=t,this.renderer.shaderPasses[t]._isScenePass?this.stacks.scenePasses.push(this.renderer.shaderPasses[t]):this.stacks.renderPasses.push(this.renderer.shaderPasses[t]);0===this.stacks.scenePasses.length&&(this.renderer.state.scenePassIndex=null)}addToRenderTargetsStack(t){const e=this.renderer.planes.filter(e=>"PingPongPlane"!==e.type&&e.target&&e.uuid!==t.uuid);let i=-1;if(t.target._depth){for(let r=e.length-1;r>=0;r--)if(e[r].target.uuid===t.target.uuid){i=r+1;break}}else i=e.findIndex(e=>e.target.uuid===t.target.uuid);i=Math.max(0,i),e.splice(i,0,t),t.target._depth?(e.sort((t,e)=>t.index-e.index),e.sort((t,e)=>e.renderOrder-t.renderOrder)):(e.sort((t,e)=>e.index-t.index),e.sort((t,e)=>t.renderOrder-e.renderOrder)),e.sort((t,e)=>t.target.index-e.target.index),this.stacks.renderTargets=e}addToRegularPlaneStack(t){const e=this.renderer.planes.filter(e=>"PingPongPlane"!==e.type&&!e.target&&e._transparent===t._transparent&&e.uuid!==t.uuid);let i=-1;for(let r=e.length-1;r>=0;r--)if(e[r]._geometry.definition.id===t._geometry.definition.id){i=r+1;break}return i=Math.max(0,i),e.splice(i,0,t),e.sort((t,e)=>t.index-e.index),e}addPlane(t){if("PingPongPlane"===t.type)this.stacks.pingPong.push(t);else if(t.target)this.addToRenderTargetsStack(t);else if(t._transparent){const e=this.addToRegularPlaneStack(t);e.sort((t,e)=>e.relativeTranslation.z-t.relativeTranslation.z),e.sort((t,e)=>e.renderOrder-t.renderOrder),this.stacks.transparent=e}else{const e=this.addToRegularPlaneStack(t);e.sort((t,e)=>e.renderOrder-t.renderOrder),this.stacks.opaque=e}}removePlane(t){"PingPongPlane"===t.type?this.stacks.pingPong=this.stacks.pingPong.filter(e=>e.uuid!==t.uuid):t.target?this.stacks.renderTargets=this.stacks.renderTargets.filter(e=>e.uuid!==t.uuid):t._transparent?this.stacks.transparent=this.stacks.transparent.filter(e=>e.uuid!==t.uuid):this.stacks.opaque=this.stacks.opaque.filter(e=>e.uuid!==t.uuid)}setPlaneRenderOrder(t){if("ShaderPass"===t.type)this.sortShaderPassStack(t._isScenePass?this.stacks.scenePasses:this.stacks.renderPasses);else if("PingPongPlane"===t.type)return;if(t.target)t.target._depth?(this.stacks.renderTargets.sort((t,e)=>t.index-e.index),this.stacks.renderTargets.sort((t,e)=>e.renderOrder-t.renderOrder)):(this.stacks.renderTargets.sort((t,e)=>e.index-t.index),this.stacks.renderTargets.sort((t,e)=>t.renderOrder-e.renderOrder)),this.stacks.renderTargets.sort((t,e)=>t.target.index-e.target.index);else{const e=t._transparent?this.stacks.transparent:this.stacks.opaque,i=this.stacks.scenePasses.find((t,e)=>t._isScenePass&&!t._depth&&0===e);!this.renderer.depth||i?(e.sort((t,e)=>e.index-t.index),t._transparent&&e.sort((t,e)=>t.relativeTranslation.z-e.relativeTranslation.z),e.sort((t,e)=>t.renderOrder-e.renderOrder)):(e.sort((t,e)=>t.index-e.index),t._transparent&&e.sort((t,e)=>e.relativeTranslation.z-t.relativeTranslation.z),e.sort((t,e)=>e.renderOrder-t.renderOrder))}}addShaderPass(t){t._isScenePass?(this.stacks.scenePasses.push(t),this.sortShaderPassStack(this.stacks.scenePasses)):(this.stacks.renderPasses.push(t),this.sortShaderPassStack(this.stacks.renderPasses))}removeShaderPass(t){this.resetShaderPassStacks()}sortShaderPassStack(t){t.sort((t,e)=>t.index-e.index),t.sort((t,e)=>t.renderOrder-e.renderOrder)}enableShaderPass(){this.stacks.scenePasses.length&&0===this.stacks.renderPasses.length&&this.renderer.planes.length&&(this.renderer.state.scenePassIndex=0,this.renderer.bindFrameBuffer(this.stacks.scenePasses[0].target))}drawRenderPasses(){this.stacks.scenePasses.length&&this.stacks.renderPasses.length&&this.renderer.planes.length&&(this.renderer.state.scenePassIndex=0,this.renderer.bindFrameBuffer(this.stacks.scenePasses[0].target));for(let t=0;t<this.stacks.renderPasses.length;t++)this.stacks.renderPasses[t]._startDrawing(),this.renderer.clearDepth()}drawScenePasses(){for(let t=0;t<this.stacks.scenePasses.length;t++)this.stacks.scenePasses[t]._startDrawing()}drawPingPongStack(){for(let t=0;t<this.stacks.pingPong.length;t++){const e=this.stacks.pingPong[t];e&&e._startDrawing()}}drawStack(t){for(let e=0;e<this.stacks[t].length;e++){const i=this.stacks[t][e];i&&i._startDrawing()}}draw(){this.drawPingPongStack(),this.enableShaderPass(),this.drawStack("renderTargets"),this.drawRenderPasses(),this.renderer.setBlending(!1),this.drawStack("opaque"),this.stacks.transparent.length&&(this.renderer.setBlending(!0),this.drawStack("transparent")),this.drawScenePasses()}}class z{constructor(){this.geometries=[],this.clear()}clear(){this.textures=[],this.programs=[]}getGeometryFromID(t){return this.geometries.find(e=>e.id===t)}addGeometry(t,e,i){this.geometries.push({id:t,vertices:e,uvs:i})}isSameShader(t,e){return 0===t.localeCompare(e)}getProgramFromShaders(t,e){return this.programs.find(i=>this.isSameShader(i.vsCode,t)&&this.isSameShader(i.fsCode,e))}addProgram(t){this.programs.push(t)}getTextureFromSource(t){const e="string"==typeof t?t:t.src;return this.textures.find(t=>t.source&&t.source.src===e)}addTexture(t){this.getTextureFromSource(t.source)||this.textures.push(t)}removeTexture(t){this.textures=this.textures.filter(e=>e.uuid!==t.uuid)}}class L{constructor(){this.clear()}clear(){this.queue=[]}add(t,e=!1){const i={callback:t,keep:e,timeout:null};return i.timeout=setTimeout(()=>{this.queue.push(i)},0),i}execute(){this.queue.map(t=>{t.callback&&t.callback(),clearTimeout(this.queue.timeout)}),this.queue=this.queue.filter(t=>t.keep)}}class I{constructor({alpha:t,antialias:e,premultipliedAlpha:i,depth:r,failIfMajorPerformanceCaveat:s,preserveDrawingBuffer:n,stencil:a,container:o,pixelRatio:h,renderingScale:l,production:u,onError:d,onSuccess:c,onContextLost:p,onContextRestored:_,onDisposed:m,onSceneChange:f}){this.type="Renderer",this.alpha=t,this.antialias=e,this.premultipliedAlpha=i,this.depth=r,this.failIfMajorPerformanceCaveat=s,this.preserveDrawingBuffer=n,this.stencil=a,this.container=o,this.pixelRatio=h,this._renderingScale=l,this.production=u,this.onError=d,this.onSuccess=c,this.onContextLost=p,this.onContextRestored=_,this.onDisposed=m,this.onSceneChange=f,this.initState(),this.canvas=document.createElement("canvas");const g={alpha:this.alpha,premultipliedAlpha:this.premultipliedAlpha,antialias:this.antialias,depth:this.depth,failIfMajorPerformanceCaveat:this.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.preserveDrawingBuffer,stencil:this.stencil};if(this.gl=this.canvas.getContext("webgl2",g),this._isWebGL2=!!this.gl,this.gl||(this.gl=this.canvas.getContext("webgl",g)||this.canvas.getContext("experimental-webgl",g)),!this.gl)return this.production||A(this.type+": WebGL context could not be created"),this.state.isActive=!1,void(this.onError&&this.onError());this.onSuccess&&this.onSuccess(),this.initRenderer()}initState(){this.state={isActive:!0,isContextLost:!0,drawingEnabled:!0,forceRender:!1,currentProgramID:null,currentGeometryID:null,forceBufferUpdate:!1,depthTest:null,blending:null,cullFace:null,frameBufferID:null,scenePassIndex:null,activeTexture:null,unpackAlignment:null,flipY:null,premultiplyAlpha:null}}initCallbackQueueManager(){this.nextRender=new L}initRenderer(){this.planes=[],this.renderTargets=[],this.shaderPasses=[],this.state.isContextLost=!1,this.state.maxTextureSize=this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE),this.initCallbackQueueManager(),this.setBlendFunc(),this.setDepthFunc(),this.setDepthTest(!0),this.cache=new z,this.scene=new F(this),this.getExtensions(),this._contextLostHandler=this.contextLost.bind(this),this.canvas.addEventListener("webglcontextlost",this._contextLostHandler,!1),this._contextRestoredHandler=this.contextRestored.bind(this),this.canvas.addEventListener("webglcontextrestored",this._contextRestoredHandler,!1)}getExtensions(){this.extensions=[],this._isWebGL2?(this.extensions.EXT_color_buffer_float=this.gl.getExtension("EXT_color_buffer_float"),this.extensions.OES_texture_float_linear=this.gl.getExtension("OES_texture_float_linear"),this.extensions.EXT_texture_filter_anisotropic=this.gl.getExtension("EXT_texture_filter_anisotropic"),this.extensions.WEBGL_lose_context=this.gl.getExtension("WEBGL_lose_context")):(this.extensions.OES_vertex_array_object=this.gl.getExtension("OES_vertex_array_object"),this.extensions.OES_texture_float=this.gl.getExtension("OES_texture_float"),this.extensions.OES_texture_float_linear=this.gl.getExtension("OES_texture_float_linear"),this.extensions.OES_texture_half_float=this.gl.getExtension("OES_texture_half_float"),this.extensions.OES_texture_half_float_linear=this.gl.getExtension("OES_texture_half_float_linear"),this.extensions.EXT_texture_filter_anisotropic=this.gl.getExtension("EXT_texture_filter_anisotropic"),this.extensions.OES_element_index_uint=this.gl.getExtension("OES_element_index_uint"),this.extensions.OES_standard_derivatives=this.gl.getExtension("OES_standard_derivatives"),this.extensions.EXT_sRGB=this.gl.getExtension("EXT_sRGB"),this.extensions.WEBGL_depth_texture=this.gl.getExtension("WEBGL_depth_texture"),this.extensions.WEBGL_draw_buffers=this.gl.getExtension("WEBGL_draw_buffers"),this.extensions.WEBGL_lose_context=this.gl.getExtension("WEBGL_lose_context"))}contextLost(t){this.state.isContextLost=!0,this.state.isActive&&(t.preventDefault(),this.nextRender.add(()=>this.onContextLost&&this.onContextLost()))}restoreContext(){this.state.isActive&&(this.initState(),this.gl&&this.extensions.WEBGL_lose_context?this.extensions.WEBGL_lose_context.restoreContext():(this.gl||this.production?this.extensions.WEBGL_lose_context||this.production||A(this.type+": Could not restore the context because the restore context extension is not defined"):A(this.type+": Could not restore the context because the context is not defined"),this.onError&&this.onError()))}isContextexFullyRestored(){let t=!0;for(let e=0;e<this.renderTargets.length;e++){this.renderTargets[e].textures[0]._canDraw||(t=!1);break}if(t)for(let e=0;e<this.planes.length;e++){if(!this.planes[e]._canDraw){t=!1;break}for(let i=0;i<this.planes[e].textures.length;i++)if(!this.planes[e].textures[i]._canDraw){t=!1;break}}if(t)for(let e=0;e<this.shaderPasses.length;e++){if(!this.shaderPasses[e]._canDraw){t=!1;break}for(let i=0;i<this.shaderPasses[e].textures.length;i++)if(!this.shaderPasses[e].textures[i]._canDraw){t=!1;break}}return t}contextRestored(){this.getExtensions(),this.setBlendFunc(),this.setDepthFunc(),this.setDepthTest(!0),this.cache.clear(),this.scene.initStacks();for(let t=0;t<this.renderTargets.length;t++)this.renderTargets[t]._restoreContext();for(let t=0;t<this.planes.length;t++)this.planes[t]._restoreContext();for(let t=0;t<this.shaderPasses.length;t++)this.shaderPasses[t]._restoreContext();const t=this.nextRender.add(()=>{this.isContextexFullyRestored()&&(t.keep=!1,this.state.isContextLost=!1,this.onContextRestored&&this.onContextRestored(),this.onSceneChange(),this.needRender())},!0)}setPixelRatio(t){this.pixelRatio=t}setSize(){if(!this.gl)return;const t=this.container.getBoundingClientRect();this._boundingRect={width:t.width*this.pixelRatio,height:t.height*this.pixelRatio,top:t.top*this.pixelRatio,left:t.left*this.pixelRatio};const e=!!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/),i=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;if(e&&i){function r(t){let e=0;for(;t&&!isNaN(t.offsetTop);)e+=t.offsetTop-t.scrollTop,t=t.offsetParent;return e}this._boundingRect.top=r(this.container)*this.pixelRatio}this.canvas.style.width=Math.floor(this._boundingRect.width/this.pixelRatio)+"px",this.canvas.style.height=Math.floor(this._boundingRect.height/this.pixelRatio)+"px",this.canvas.width=Math.floor(this._boundingRect.width*this._renderingScale),this.canvas.height=Math.floor(this._boundingRect.height*this._renderingScale),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}resize(){for(let t=0;t<this.planes.length;t++)this.planes[t]._canDraw&&this.planes[t].resize();for(let t=0;t<this.shaderPasses.length;t++)this.shaderPasses[t]._canDraw&&this.shaderPasses[t].resize();for(let t=0;t<this.renderTargets.length;t++)this.renderTargets[t].resize();this.needRender()}clear(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}clearDepth(){this.gl.clear(this.gl.DEPTH_BUFFER_BIT)}clearColor(){this.gl.clear(this.gl.COLOR_BUFFER_BIT)}bindFrameBuffer(t,e){let i=null;t?(i=t.index,i!==this.state.frameBufferID&&(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,t._frameBuffer),this.gl.viewport(0,0,t._size.width,t._size.height),t._shouldClear&&!e&&this.clear())):null!==this.state.frameBufferID&&(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)),this.state.frameBufferID=i}setDepthTest(t){t&&!this.state.depthTest?(this.state.depthTest=t,this.gl.enable(this.gl.DEPTH_TEST)):!t&&this.state.depthTest&&(this.state.depthTest=t,this.gl.disable(this.gl.DEPTH_TEST))}setDepthFunc(){this.gl.depthFunc(this.gl.LEQUAL)}setBlending(t=!1){t&&!this.state.blending?(this.state.blending=t,this.gl.enable(this.gl.BLEND)):!t&&this.state.blending&&(this.state.blending=t,this.gl.disable(this.gl.BLEND))}setBlendFunc(){this.gl.enable(this.gl.BLEND),this.gl.blendFuncSeparate(this.premultipliedAlpha?this.gl.ONE:this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)}setFaceCulling(t){if(this.state.cullFace!==t)if(this.state.cullFace=t,"none"===t)this.gl.disable(this.gl.CULL_FACE);else{const e="front"===t?this.gl.FRONT:this.gl.BACK;this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(e)}}useProgram(t){null!==this.state.currentProgramID&&this.state.currentProgramID===t.id||(this.gl.useProgram(t.program),this.state.currentProgramID=t.id)}removePlane(t){this.gl&&(this.planes=this.planes.filter(e=>e.uuid!==t.uuid),this.scene.removePlane(t),t=null,this.gl&&this.clear(),this.onSceneChange())}removeRenderTarget(t){if(!this.gl)return;let e=this.planes.find(e=>"PingPongPlane"!==e.type&&e.target&&e.target.uuid===t.uuid);for(let e=0;e<this.planes.length;e++)this.planes[e].target&&this.planes[e].target.uuid===t.uuid&&(this.planes[e].target=null);this.renderTargets=this.renderTargets.filter(e=>e.uuid!==t.uuid);for(let t=0;t<this.renderTargets.length;t++)this.renderTargets[t].index=t;t=null,this.gl&&this.clear(),e&&this.scene.resetPlaneStacks(),this.onSceneChange()}removeShaderPass(t){this.gl&&(this.shaderPasses=this.shaderPasses.filter(e=>e.uuid!==t.uuid),this.scene.removeShaderPass(t),t=null,this.gl&&this.clear(),this.onSceneChange())}enableDrawing(){this.state.drawingEnabled=!0}disableDrawing(){this.state.drawingEnabled=!1}needRender(){this.state.forceRender=!0}render(){this.gl&&(this.clear(),this.state.currentGeometryID=null,this.scene.draw())}deletePrograms(){for(let t=0;t<this.cache.programs.length;t++)this.gl.deleteProgram(this.cache.programs[t].program)}dispose(){if(!this.gl)return;for(this.state.isActive=!1;this.planes.length>0;)this.removePlane(this.planes[0]);for(;this.shaderPasses.length>0;)this.removeShaderPass(this.shaderPasses[0]);for(;this.renderTargets.length>0;)this.removeRenderTarget(this.renderTargets[0]);let t=this.nextRender.add(()=>{0===this.planes.length&&0===this.shaderPasses.length&&0===this.renderTargets.length&&(t.keep=!1,this.deletePrograms(),this.clear(),this.canvas.removeEventListener("webgllost",this._contextLostHandler,!1),this.canvas.removeEventListener("webglrestored",this._contextRestoredHandler,!1),this.gl&&this.extensions.WEBGL_lose_context&&this.extensions.WEBGL_lose_context.loseContext(),this.canvas.width=this.canvas.width,this.gl=null,this.container.removeChild(this.canvas),this.container=null,this.canvas=null,this.onDisposed&&this.onDisposed())},!0)}}class U{constructor({xOffset:t=0,yOffset:e=0,lastXDelta:i=0,lastYDelta:r=0,shouldWatch:s=!0,onScroll:n=()=>{}}={}){this.xOffset=t,this.yOffset=e,this.lastXDelta=i,this.lastYDelta=r,this.shouldWatch=s,this.onScroll=n,this.handler=this.scroll.bind(this,!0),this.shouldWatch&&window.addEventListener("scroll",this.handler,{passive:!0})}scroll(){this.updateScrollValues(window.pageXOffset,window.pageYOffset)}updateScrollValues(t,e){const i=this.xOffset;this.xOffset=t,this.lastXDelta=i-this.xOffset;const r=this.yOffset;this.yOffset=e,this.lastYDelta=r-this.yOffset,this.onScroll&&this.onScroll(this.lastXDelta,this.lastYDelta)}dispose(){this.shouldWatch&&window.removeEventListener("scroll",this.handler,{passive:!0})}}class V{constructor({container:t,alpha:e=!0,premultipliedAlpha:i=!1,antialias:r=!0,depth:s=!0,failIfMajorPerformanceCaveat:n=!0,preserveDrawingBuffer:a=!1,stencil:o=!1,autoResize:h=!0,autoRender:l=!0,watchScroll:u=!0,pixelRatio:d=window.devicePixelRatio||1,renderingScale:c=1,production:p=!1}={}){this.type="Curtains",this._autoResize=h,this._autoRender=l,this._watchScroll=u,this.pixelRatio=d,c=isNaN(c)?1:parseFloat(c),this._renderingScale=Math.max(.25,Math.min(1,c)),this.premultipliedAlpha=i,this.alpha=e,this.antialias=r,this.depth=s,this.failIfMajorPerformanceCaveat=n,this.preserveDrawingBuffer=a,this.stencil=o,this.production=p,this.errors=!1,t?this.setContainer(t):this.production||A(this.type+": no container provided in the initial parameters. Use setContainer() method to set one later and initialize the WebGL context")}setContainer(t){if(t)if("string"==typeof t)if(t=document.getElementById(t))this.container=t;else{let t=document.createElement("div");t.setAttribute("id","curtains-canvas"),document.body.appendChild(t),this.container=t,this.production||A('Curtains: no valid container HTML element or ID provided, created a div with "curtains-canvas" ID instead')}else t instanceof Element&&(this.container=t);else{let t=document.createElement("div");t.setAttribute("id","curtains-canvas"),document.body.appendChild(t),this.container=t,this.production||A('Curtains: no valid container HTML element or ID provided, created a div with "curtains-canvas" ID instead')}this._initCurtains()}_initCurtains(){this.planes=[],this.renderTargets=[],this.shaderPasses=[],this._initRenderer(),this.gl&&(this._initScroll(),this._setSize(),this._addListeners(),this.container.appendChild(this.canvas),console.log("curtains.js - v8.1.6"),this._animationFrameID=null,this._autoRender&&this._animate())}_initRenderer(){this.renderer=new I({alpha:this.alpha,antialias:this.antialias,premultipliedAlpha:this.premultipliedAlpha,depth:this.depth,failIfMajorPerformanceCaveat:this.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.preserveDrawingBuffer,stencil:this.stencil,container:this.container,pixelRatio:this.pixelRatio,renderingScale:this._renderingScale,production:this.production,onError:()=>this._onRendererError(),onSuccess:()=>this._onRendererSuccess(),onContextLost:()=>this._onRendererContextLost(),onContextRestored:()=>this._onRendererContextRestored(),onDisposed:()=>this._onRendererDisposed(),onSceneChange:()=>this._keepSync()}),this.gl=this.renderer.gl,this.canvas=this.renderer.canvas}restoreContext(){this.renderer.restoreContext()}_animate(){this.render(),this._animationFrameID=window.requestAnimationFrame(this._animate.bind(this))}enableDrawing(){this.renderer.enableDrawing()}disableDrawing(){this.renderer.disableDrawing()}needRender(){this.renderer.needRender()}nextRender(t,e=!1){return this.renderer.nextRender.add(t,e)}clear(){this.renderer&&this.renderer.clear()}clearDepth(){this.renderer&&this.renderer.clearDepth()}clearColor(){this.renderer&&this.renderer.clearColor()}isWebGL2(){return!!this.gl&&this.renderer._isWebGL2}render(){this.renderer.nextRender.execute(),(this.renderer.state.drawingEnabled||this.renderer.state.forceRender)&&(this.renderer.state.forceRender&&(this.renderer.state.forceRender=!1),this._onRenderCallback&&this._onRenderCallback(),this.renderer.render())}_addListeners(){this._resizeHandler=null,this._autoResize&&(this._resizeHandler=this.resize.bind(this,!0),window.addEventListener("resize",this._resizeHandler,!1))}setPixelRatio(t,e){this.pixelRatio=parseFloat(Math.max(t,1))||1,this.renderer.setPixelRatio(t),this.resize(e)}_setSize(){this.renderer.setSize(),this._scrollManager.shouldWatch&&(this._scrollManager.xOffset=window.pageXOffset,this._scrollManager.yOffset=window.pageYOffset)}getBoundingRect(){return this.renderer._boundingRect}resize(t){this.gl&&(this._setSize(),this.renderer.resize(),this.nextRender(()=>{this._onAfterResizeCallback&&t&&this._onAfterResizeCallback()}))}_initScroll(){this._scrollManager=new U({xOffset:window.pageXOffset,yOffset:window.pageYOffset,lastXDelta:0,lastYDelta:0,shouldWatch:this._watchScroll,onScroll:(t,e)=>this._updateScroll(t,e)})}_updateScroll(t,e){for(let i=0;i<this.planes.length;i++)this.planes[i].watchScroll&&this.planes[i].updateScrollPosition(t,e);this.renderer.needRender(),this._onScrollCallback&&this._onScrollCallback()}updateScrollValues(t,e){this._scrollManager.updateScrollValues(t,e)}getScrollDeltas(){return{x:this._scrollManager.lastXDelta,y:this._scrollManager.lastYDelta}}getScrollValues(){return{x:this._scrollManager.xOffset,y:this._scrollManager.yOffset}}_keepSync(){this.planes=this.renderer.planes,this.shaderPasses=this.renderer.shaderPasses,this.renderTargets=this.renderer.renderTargets}lerp(t,e,i){return function(t,e,i){return(1-i)*t+i*e}(t,e,i)}onAfterResize(t){return t&&(this._onAfterResizeCallback=t),this}onError(t){return t&&(this._onErrorCallback=t),this}_onRendererError(){setTimeout(()=>{this._onErrorCallback&&!this.errors&&this._onErrorCallback(),this.errors=!0},0)}onSuccess(t){return t&&(this._onSuccessCallback=t),this}_onRendererSuccess(){setTimeout(()=>{this._onSuccessCallback&&this._onSuccessCallback()},0)}onContextLost(t){return t&&(this._onContextLostCallback=t),this}_onRendererContextLost(){this._onContextLostCallback&&this._onContextLostCallback()}onContextRestored(t){return t&&(this._onContextRestoredCallback=t),this}_onRendererContextRestored(){this._onContextRestoredCallback&&this._onContextRestoredCallback()}onRender(t){return t&&(this._onRenderCallback=t),this}onScroll(t){return t&&(this._onScrollCallback=t),this}dispose(){this.renderer.dispose()}_onRendererDisposed(){this._animationFrameID&&window.cancelAnimationFrame(this._animationFrameID),this._resizeHandler&&window.removeEventListener("resize",this._resizeHandler,!1),this._scrollManager&&this._scrollManager.dispose()}}class N{constructor(t,e,i){if(this.type="Uniforms",t&&"Renderer"===t.type){if(!t.gl)return void k(this.type+": Renderer WebGL context is undefined",t)}else k(this.type+": Renderer not passed as first argument",t);if(this.renderer=t,this.gl=t.gl,this.program=e,this.uniforms={},i)for(const t in i){const e=i[t];this.uniforms[t]={name:e.name,type:e.type,value:e.value.clone&&"function"==typeof e.value.clone?e.value.clone():e.value,update:null}}}handleUniformSetting(t){switch(t.type){case"1i":t.update=this.setUniform1i.bind(this);break;case"1iv":t.update=this.setUniform1iv.bind(this);break;case"1f":t.update=this.setUniform1f.bind(this);break;case"1fv":t.update=this.setUniform1fv.bind(this);break;case"2i":t.update=this.setUniform2i.bind(this);break;case"2iv":t.update=this.setUniform2iv.bind(this);break;case"2f":t.update=this.setUniform2f.bind(this);break;case"2fv":t.update=this.setUniform2fv.bind(this);break;case"3i":t.update=this.setUniform3i.bind(this);break;case"3iv":t.update=this.setUniform3iv.bind(this);break;case"3f":t.update=this.setUniform3f.bind(this);break;case"3fv":t.update=this.setUniform3fv.bind(this);break;case"4i":t.update=this.setUniform4i.bind(this);break;case"4iv":t.update=this.setUniform4iv.bind(this);break;case"4f":t.update=this.setUniform4f.bind(this);break;case"4fv":t.update=this.setUniform4fv.bind(this);break;case"mat2":t.update=this.setUniformMatrix2fv.bind(this);break;case"mat3":t.update=this.setUniformMatrix3fv.bind(this);break;case"mat4":t.update=this.setUniformMatrix4fv.bind(this);break;default:this.renderer.production||A(this.type+": This uniform type is not handled : ",t.type)}}setInternalFormat(t){"Vec2"===t.value.type?(t._internalFormat="Vec2",t.lastValue=t.value.clone()):"Vec3"===t.value.type?(t._internalFormat="Vec3",t.lastValue=t.value.clone()):"Mat4"===t.value.type?(t._internalFormat="Mat4",t.lastValue=t.value.clone()):"Quat"===t.value.type?(t._internalFormat="Quat",t.lastValue=t.value.clone()):Array.isArray(t.value)?(t._internalFormat="array",t.lastValue=Array.from(t.value)):t.value.constructor===Float32Array?(t._internalFormat="mat",t.lastValue=t.value):(t._internalFormat="float",t.lastValue=t.value)}setUniforms(){if(this.uniforms)for(const t in this.uniforms){let e=this.uniforms[t];e.location=this.gl.getUniformLocation(this.program,e.name),e._internalFormat||this.setInternalFormat(e),e.type||("Vec2"===e._internalFormat?e.type="2f":"Vec3"===e._internalFormat?e.type="3f":"Mat4"===e._internalFormat?e.type="mat4":"array"===e._internalFormat?4===e.value.length?(e.type="4f",this.renderer.production||A(this.type+": No uniform type declared for "+e.name+", applied a 4f (array of 4 floats) uniform type")):3===e.value.length?(e.type="3f",this.renderer.production||A(this.type+": No uniform type declared for "+e.name+", applied a 3f (array of 3 floats) uniform type")):2===e.value.length&&(e.type="2f",this.renderer.production||A(this.type+": No uniform type declared for "+e.name+", applied a 2f (array of 2 floats) uniform type")):"mat"===e._internalFormat?16===e.value.length?(e.type="mat4",this.renderer.production||A(this.type+": No uniform type declared for "+e.name+", applied a mat4 (4x4 matrix array) uniform type")):9===e.value.length?(e.type="mat3",this.renderer.production||A(this.type+": No uniform type declared for "+e.name+", applied a mat3 (3x3 matrix array) uniform type")):4===e.value.length&&(e.type="mat2",this.renderer.production||A(this.type+": No uniform type declared for "+e.name+", applied a mat2 (2x2 matrix array) uniform type")):(e.type="1f",this.renderer.production||A(this.type+": No uniform type declared for "+e.name+", applied a 1f (float) uniform type"))),this.handleUniformSetting(e),e.update&&e.update(e)}}updateUniforms(){if(this.uniforms)for(const t in this.uniforms){const e=this.uniforms[t];let i=!1;"Vec2"===e._internalFormat||"Vec3"===e._internalFormat||"Quat"===e._internalFormat?e.value.equals(e.lastValue)||(i=!0,e.lastValue.copy(e.value)):e.value.length?JSON.stringify(e.value)!==JSON.stringify(e.lastValue)&&(i=!0,e.lastValue=Array.from(e.value)):e.value!==e.lastValue&&(i=!0,e.lastValue=e.value),i&&e.update&&e.update(e)}}setUniform1i(t){this.gl.uniform1i(t.location,t.value)}setUniform1iv(t){this.gl.uniform1iv(t.location,t.value)}setUniform1f(t){this.gl.uniform1f(t.location,t.value)}setUniform1fv(t){this.gl.uniform1fv(t.location,t.value)}setUniform2i(t){"Vec2"===t._internalFormat?this.gl.uniform2i(t.location,t.value.x,t.value.y):this.gl.uniform2i(t.location,t.value[0],t.value[1])}setUniform2iv(t){this.gl.uniform2iv(t.location,"Vec2"===t._internalFormat?[t.value.x,t.value.y]:t.value)}setUniform2f(t){"Vec2"===t._internalFormat?this.gl.uniform2f(t.location,t.value.x,t.value.y):this.gl.uniform2f(t.location,t.value[0],t.value[1])}setUniform2fv(t){this.gl.uniform2fv(t.location,"Vec2"===t._internalFormat?[t.value.x,t.value.y]:t.value)}setUniform3i(t){"Vec3"===t._internalFormat?this.gl.uniform3i(t.location,t.value.x,t.value.y,t.value.z):this.gl.uniform3i(t.location,t.value[0],t.value[1],t.value[2])}setUniform3iv(t){this.gl.uniform3iv(t.location,"Vec3"===t._internalFormat?[t.value.x,t.value.y,t.value.z]:t.value)}setUniform3f(t){"Vec3"===t._internalFormat?this.gl.uniform3f(t.location,t.value.x,t.value.y,t.value.z):this.gl.uniform3f(t.location,t.value[0],t.value[1],t.value[2])}setUniform3fv(t){this.gl.uniform3fv(t.location,"Vec3"===t._internalFormat?[t.value.x,t.value.y,t.value.z]:t.value)}setUniform4i(t){"Quat"===t._internalFormat?this.gl.uniform4i(t.location,t.value.elements[0],t.value.elements[1],t.value.elements[2],t.value[3]):this.gl.uniform4i(t.location,t.value[0],t.value[1],t.value[2],t.value[3])}setUniform4iv(t){this.gl.uniform4iv(t.location,"Quat"===t._internalFormat?[t.value.elements[0],t.value.elements[1],t.value.elements[2],t.value[3]]:t.value)}setUniform4f(t){"Quat"===t._internalFormat?this.gl.uniform4f(t.location,t.value.elements[0],t.value.elements[1],t.value.elements[2],t.value[3]):this.gl.uniform4f(t.location,t.value[0],t.value[1],t.value[2],t.value[3])}setUniform4fv(t){this.gl.uniform4fv(t.location,"Quat"===t._internalFormat?[t.value.elements[0],t.value.elements[1],t.value.elements[2],t.value[3]]:t.value)}setUniformMatrix2fv(t){this.gl.uniformMatrix2fv(t.location,!1,t.value)}setUniformMatrix3fv(t){this.gl.uniformMatrix3fv(t.location,!1,t.value)}setUniformMatrix4fv(t){this.gl.uniformMatrix4fv(t.location,!1,"Mat4"===t._internalFormat?t.value.elements:t.value)}}var B="\nprecision mediump float;\n".replace(/\n/g,""),W="\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\n".replace(/\n/g,""),G="\nvarying vec3 vVertexPosition;\nvarying vec2 vTextureCoord;\n".replace(/\n/g,""),X=(B+W+G+"\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\n\nvoid main() {\n    vTextureCoord = aTextureCoord;\n    vVertexPosition = aVertexPosition;\n    \n    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n}\n").replace(/\n/g,""),j=(B+G+"\nvoid main() {\n    gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n}\n").replace(/\n/g,""),Y=(B+W+G+"\nvoid main() {\n    vTextureCoord = aTextureCoord;\n    vVertexPosition = aVertexPosition;\n    \n    gl_Position = vec4(aVertexPosition, 1.0);\n}\n").replace(/\n/g,""),q=(B+G+"\nuniform sampler2D uRenderTexture;\n\nvoid main() {\n    gl_FragColor = texture2D(uRenderTexture, vTextureCoord);\n}\n").replace(/\n/g,"");let H=0;class Z{constructor(t,{parent:e,vertexShader:i,fragmentShader:r}={}){if(this.type="Program",t&&"Renderer"===t.type){if(!t.gl)return void k(this.type+": Renderer WebGL context is undefined",t)}else k(this.type+": Renderer not passed as first argument",t);this.renderer=t,this.gl=this.renderer.gl,this.parent=e,this.defaultVsCode="Plane"===this.parent.type?X:Y,this.defaultFsCode="Plane"===this.parent.type?j:q,i?this.vsCode=i:(this.renderer.production||"Plane"!==this.parent.type||A(this.parent.type+": No vertex shader provided, will use a default one"),this.vsCode=this.defaultVsCode),r?this.fsCode=r:(this.renderer.production||A(this.parent.type+": No fragment shader provided, will use a default one"),this.fsCode=this.defaultFsCode),this.compiled=!0,this.setupProgram()}createShader(t,e){const i=this.gl.createShader(e);if(this.gl.shaderSource(i,t),this.gl.compileShader(i),!this.renderer.production&&!this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS)){const t=e===this.gl.VERTEX_SHADER?"vertex shader":"fragment shader";let r=this.gl.getShaderSource(i).split("\n");for(let t=0;t<r.length;t++)r[t]=t+1+": "+r[t];return r=r.join("\n"),A(this.type+": Errors occurred while compiling the",t,":\n",this.gl.getShaderInfoLog(i)),k(r),A(this.type+": Will use a default",t),this.createShader(e===this.gl.VERTEX_SHADER?this.defaultVsCode:this.defaultFsCode,e)}return i}useNewShaders(){this.vertexShader=this.createShader(this.vsCode,this.gl.VERTEX_SHADER),this.fragmentShader=this.createShader(this.fsCode,this.gl.FRAGMENT_SHADER),this.vertexShader&&this.fragmentShader||this.renderer.production||A(this.type+": Unable to find or compile the vertex or fragment shader")}setupProgram(){let t=this.renderer.cache.getProgramFromShaders(this.vsCode,this.fsCode);t?(this.vertexShader=t.vertexShader,this.fragmentShader=t.fragmentShader,this.activeUniforms=t.activeUniforms,this.activeAttributes=t.activeAttributes,this.createProgram()):(this.useNewShaders(),this.compiled&&(this.createProgram(),this.renderer.cache.addProgram(this)))}createProgram(){if(H++,this.id=H,this.program=this.gl.createProgram(),this.gl.attachShader(this.program,this.vertexShader),this.gl.attachShader(this.program,this.fragmentShader),this.gl.linkProgram(this.program),!this.renderer.production&&!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))return A(this.type+": Unable to initialize the shader program: "+this.gl.getProgramInfoLog(this.program)),A(this.type+": Will use default vertex and fragment shaders"),this.vertexShader=this.createShader(this.defaultVsCode,this.gl.VERTEX_SHADER),this.fragmentShader=this.createShader(this.defaultFsCode,this.gl.FRAGMENT_SHADER),void this.createProgram();if(this.gl.deleteShader(this.vertexShader),this.gl.deleteShader(this.fragmentShader),!this.activeUniforms||!this.activeAttributes){this.activeUniforms={textures:[],textureMatrices:[]};const t=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_UNIFORMS);for(let e=0;e<t;e++){const t=this.gl.getActiveUniform(this.program,e);t.type===this.gl.SAMPLER_2D&&this.activeUniforms.textures.push(t.name),t.type===this.gl.FLOAT_MAT4&&"uMVMatrix"!==t.name&&"uPMatrix"!==t.name&&this.activeUniforms.textureMatrices.push(t.name)}this.activeAttributes=[];const e=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES);for(let t=0;t<e;t++){const e=this.gl.getActiveAttrib(this.program,t);this.activeAttributes.push(e.name)}}}createUniforms(t){this.uniformsManager=new N(this.renderer,this.program,t),this.setUniforms()}setUniforms(){this.renderer.useProgram(this),this.uniformsManager.setUniforms()}updateUniforms(){this.renderer.useProgram(this),this.uniformsManager.updateUniforms()}}class Q{constructor(t,{program:e=null,width:i=1,height:r=1}={}){if(this.type="Geometry",t&&"Renderer"===t.type){if(!t.gl)return void k(this.type+": Renderer WebGL context is undefined",t)}else k(this.type+": Renderer not passed as first argument",t);this.renderer=t,this.gl=this.renderer.gl,this.definition={id:i*r+i,width:i,height:r},this.setDefaultAttributes(),this.setVerticesUVs()}restoreContext(t){this.program=null,this.setDefaultAttributes(),this.setVerticesUVs(),this.setProgram(t)}setDefaultAttributes(){this.attributes={vertexPosition:{name:"aVertexPosition",size:3,isActive:!1},textureCoord:{name:"aTextureCoord",size:3,isActive:!1}}}setVerticesUVs(){const t=this.renderer.cache.getGeometryFromID(this.definition.id);t?(this.attributes.vertexPosition.array=t.vertices,this.attributes.textureCoord.array=t.uvs):(this.computeVerticesUVs(),this.renderer.cache.addGeometry(this.definition.id,this.attributes.vertexPosition.array,this.attributes.textureCoord.array))}setProgram(t){this.program=t,this.initAttributes(),this.renderer._isWebGL2?(this._vao=this.gl.createVertexArray(),this.gl.bindVertexArray(this._vao)):this.renderer.extensions.OES_vertex_array_object&&(this._vao=this.renderer.extensions.OES_vertex_array_object.createVertexArrayOES(),this.renderer.extensions.OES_vertex_array_object.bindVertexArrayOES(this._vao)),this.initializeBuffers()}initAttributes(){for(const t in this.attributes){if(this.attributes[t].isActive=this.program.activeAttributes.includes(this.attributes[t].name),!this.attributes[t].isActive)return;this.attributes[t].location=this.gl.getAttribLocation(this.program.program,this.attributes[t].name),this.attributes[t].buffer=this.gl.createBuffer(),this.attributes[t].numberOfItems=this.definition.width*this.definition.height*this.attributes[t].size*2}}computeVerticesUVs(){this.attributes.vertexPosition.array=[],this.attributes.textureCoord.array=[];const t=this.attributes.vertexPosition.array,e=this.attributes.textureCoord.array;for(let i=0;i<this.definition.height;i++){const r=i/this.definition.height;for(let i=0;i<this.definition.width;i++){const s=i/this.definition.width;e.push(s),e.push(r),e.push(0),t.push(2*(s-.5)),t.push(2*(r-.5)),t.push(0),e.push(s+1/this.definition.width),e.push(r),e.push(0),t.push(2*(s+1/this.definition.width-.5)),t.push(2*(r-.5)),t.push(0),e.push(s),e.push(r+1/this.definition.height),e.push(0),t.push(2*(s-.5)),t.push(2*(r+1/this.definition.height-.5)),t.push(0),e.push(s),e.push(r+1/this.definition.height),e.push(0),t.push(2*(s-.5)),t.push(2*(r+1/this.definition.height-.5)),t.push(0),e.push(s+1/this.definition.width),e.push(r),e.push(0),t.push(2*(s+1/this.definition.width-.5)),t.push(2*(r-.5)),t.push(0),e.push(s+1/this.definition.width),e.push(r+1/this.definition.height),e.push(0),t.push(2*(s+1/this.definition.width-.5)),t.push(2*(r+1/this.definition.height-.5)),t.push(0)}}}initializeBuffers(){if(this.attributes){for(const t in this.attributes){if(!this.attributes[t].isActive)return;this.gl.enableVertexAttribArray(this.attributes[t].location),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.attributes[t].buffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.attributes[t].array),this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.attributes[t].location,this.attributes[t].size,this.gl.FLOAT,!1,0,0)}this.renderer.state.currentGeometryID=this.definition.id}}bindBuffers(){if(this._vao)this.renderer._isWebGL2?this.gl.bindVertexArray(this._vao):this.renderer.extensions.OES_vertex_array_object.bindVertexArrayOES(this._vao);else for(const t in this.attributes){if(!this.attributes[t].isActive)return;this.gl.enableVertexAttribArray(this.attributes[t].location),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.attributes[t].buffer),this.gl.vertexAttribPointer(this.attributes[t].location,this.attributes[t].size,this.gl.FLOAT,!1,0,0)}this.renderer.state.currentGeometryID=this.definition.id}draw(){this.gl.drawArrays(this.gl.TRIANGLES,0,this.attributes.vertexPosition.numberOfItems)}dispose(){this._vao&&(this.renderer._isWebGL2?this.gl.deleteVertexArray(this._vao):this.renderer.extensions.OES_vertex_array_object.deleteVertexArrayOES(this._vao));for(const t in this.attributes){if(!this.attributes[t].isActive)return;this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.attributes[t].buffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,1,this.gl.STATIC_DRAW),this.gl.deleteBuffer(this.attributes[t].buffer)}this.attributes=null,this.renderer.state.currentGeometryID=null}}class ${constructor(t=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])){this.type="Mat4",this.elements=t}setFromArray(t){for(let e=0;e<this.elements.length;e++)this.elements[e]=t[e];return this}copy(t){const e=t.elements;return this.elements[0]=e[0],this.elements[1]=e[1],this.elements[2]=e[2],this.elements[3]=e[3],this.elements[4]=e[4],this.elements[5]=e[5],this.elements[6]=e[6],this.elements[7]=e[7],this.elements[8]=e[8],this.elements[9]=e[9],this.elements[10]=e[10],this.elements[11]=e[11],this.elements[12]=e[12],this.elements[13]=e[13],this.elements[14]=e[14],this.elements[15]=e[15],this}clone(){return(new $).copy(this)}multiply(t){const e=this.elements,i=t.elements;let r=new $;return r.elements[0]=i[0]*e[0]+i[1]*e[4]+i[2]*e[8]+i[3]*e[12],r.elements[1]=i[0]*e[1]+i[1]*e[5]+i[2]*e[9]+i[3]*e[13],r.elements[2]=i[0]*e[2]+i[1]*e[6]+i[2]*e[10]+i[3]*e[14],r.elements[3]=i[0]*e[3]+i[1]*e[7]+i[2]*e[11]+i[3]*e[15],r.elements[4]=i[4]*e[0]+i[5]*e[4]+i[6]*e[8]+i[7]*e[12],r.elements[5]=i[4]*e[1]+i[5]*e[5]+i[6]*e[9]+i[7]*e[13],r.elements[6]=i[4]*e[2]+i[5]*e[6]+i[6]*e[10]+i[7]*e[14],r.elements[7]=i[4]*e[3]+i[5]*e[7]+i[6]*e[11]+i[7]*e[15],r.elements[8]=i[8]*e[0]+i[9]*e[4]+i[10]*e[8]+i[11]*e[12],r.elements[9]=i[8]*e[1]+i[9]*e[5]+i[10]*e[9]+i[11]*e[13],r.elements[10]=i[8]*e[2]+i[9]*e[6]+i[10]*e[10]+i[11]*e[14],r.elements[11]=i[8]*e[3]+i[9]*e[7]+i[10]*e[11]+i[11]*e[15],r.elements[12]=i[12]*e[0]+i[13]*e[4]+i[14]*e[8]+i[15]*e[12],r.elements[13]=i[12]*e[1]+i[13]*e[5]+i[14]*e[9]+i[15]*e[13],r.elements[14]=i[12]*e[2]+i[13]*e[6]+i[14]*e[10]+i[15]*e[14],r.elements[15]=i[12]*e[3]+i[13]*e[7]+i[14]*e[11]+i[15]*e[15],r}getInverse(){const t=this.elements,e=new $,i=e.elements;let r=t[0],s=t[1],n=t[2],a=t[3],o=t[4],h=t[5],l=t[6],u=t[7],d=t[8],c=t[9],p=t[10],_=t[11],m=t[12],f=t[13],g=t[14],v=t[15],x=r*h-s*o,y=r*l-n*o,b=r*u-a*o,w=s*l-n*h,T=s*u-a*h,R=n*u-a*l,P=d*f-c*m,S=d*g-p*m,C=d*v-_*m,M=c*g-p*f,E=c*v-_*f,A=p*v-_*g,k=x*A-y*E+b*M+w*C-T*S+R*P;return k?(k=1/k,i[0]=(h*A-l*E+u*M)*k,i[1]=(n*E-s*A-a*M)*k,i[2]=(f*R-g*T+v*w)*k,i[3]=(p*T-c*R-_*w)*k,i[4]=(l*C-o*A-u*S)*k,i[5]=(r*A-n*C+a*S)*k,i[6]=(g*b-m*R-v*y)*k,i[7]=(d*R-p*b+_*y)*k,i[8]=(o*E-h*C+u*P)*k,i[9]=(s*C-r*E-a*P)*k,i[10]=(m*T-f*b+v*x)*k,i[11]=(c*b-d*T-_*x)*k,i[12]=(h*S-o*M-l*P)*k,i[13]=(r*M-s*S+n*P)*k,i[14]=(f*y-m*w-g*x)*k,i[15]=(d*w-c*y+p*x)*k,e):null}scale(t){let e=this.elements;return e[0]*=t.x,e[1]*=t.x,e[2]*=t.x,e[3]*=t.x,e[4]*=t.y,e[5]*=t.y,e[6]*=t.y,e[7]*=t.y,e[8]*=t.z,e[9]*=t.z,e[10]*=t.z,e[11]*=t.z,this}compose(t,e,i){let r=this.elements;const s=e.elements[0],n=e.elements[1],a=e.elements[2],o=e.elements[3],h=s+s,l=n+n,u=a+a,d=s*h,c=s*l,p=s*u,_=n*l,m=n*u,f=a*u,g=o*h,v=o*l,x=o*u,y=i.x,b=i.y,w=i.z;return r[0]=(1-(_+f))*y,r[1]=(c+x)*y,r[2]=(p-v)*y,r[3]=0,r[4]=(c-x)*b,r[5]=(1-(d+f))*b,r[6]=(m+g)*b,r[7]=0,r[8]=(p+v)*w,r[9]=(m-g)*w,r[10]=(1-(d+_))*w,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}composeFromOrigin(t,e,i,r){let s=this.elements;const n=e.elements[0],a=e.elements[1],o=e.elements[2],h=e.elements[3],l=n+n,u=a+a,d=o+o,c=n*l,p=n*u,_=n*d,m=a*u,f=a*d,g=o*d,v=h*l,x=h*u,y=h*d,b=i.x,w=i.y,T=i.z,R=r.x,P=r.y,S=r.z,C=(1-(m+g))*b,M=(p+y)*b,E=(_-x)*b,A=(p-y)*w,k=(1-(c+g))*w,O=(f+v)*w,D=(_+x)*T,F=(f-v)*T,z=(1-(c+m))*T;return s[0]=C,s[1]=M,s[2]=E,s[3]=0,s[4]=A,s[5]=k,s[6]=O,s[7]=0,s[8]=D,s[9]=F,s[10]=z,s[11]=0,s[12]=t.x+R-(C*R+A*P+D*S),s[13]=t.y+P-(M*R+k*P+F*S),s[14]=t.z+S-(E*R+O*P+z*S),s[15]=1,this}}class K{constructor(t=0,e=t){this.type="Vec2",this._x=t,this._y=e}get x(){return this._x}get y(){return this._y}set x(t){const e=t!==this._x;this._x=t,e&&this._onChangeCallback&&this._onChangeCallback()}set y(t){const e=t!==this._y;this._y=t,e&&this._onChangeCallback&&this._onChangeCallback()}onChange(t){return t&&(this._onChangeCallback=t),this}set(t,e){return this._x=t,this._y=e,this}add(t){return this._x+=t.x,this._y+=t.y,this}addScalar(t){return this._x+=t,this._y+=t,this}sub(t){return this._x-=t.x,this._y-=t.y,this}subScalar(t){return this._x-=t,this._y-=t,this}multiply(t){return this._x*=t.x,this._y*=t.y,this}multiplyScalar(t){return this._x*=t,this._y*=t,this}copy(t){return this._x=t.x,this._y=t.y,this}clone(){return new K(this._x,this._y)}sanitizeNaNValuesWith(t){return this._x=isNaN(this._x)?t.x:parseFloat(this._x),this._y=isNaN(this._y)?t.y:parseFloat(this._y),this}max(t){return this._x=Math.max(this._x,t.x),this._y=Math.max(this._y,t.y),this}min(t){return this._x=Math.min(this._x,t.x),this._y=Math.min(this._y,t.y),this}equals(t){return this._x===t.x&&this._y===t.y}normalize(){let t=this._x*this._x+this._y*this._y;return t>0&&(t=1/Math.sqrt(t)),this._x*=t,this._y*=t,this}dot(t){return this._x*t.x+this._y*t.y}}class J{constructor(t=0,e=t,i=t){this.type="Vec3",this._x=t,this._y=e,this._z=i}get x(){return this._x}get y(){return this._y}get z(){return this._z}set x(t){const e=t!==this._x;this._x=t,e&&this._onChangeCallback&&this._onChangeCallback()}set y(t){const e=t!==this._y;this._y=t,e&&this._onChangeCallback&&this._onChangeCallback()}set z(t){const e=t!==this._z;this._z=t,e&&this._onChangeCallback&&this._onChangeCallback()}onChange(t){return t&&(this._onChangeCallback=t),this}set(t,e,i){return this._x=t,this._y=e,this._z=i,this}add(t){return this._x+=t.x,this._y+=t.y,this._z+=t.z,this}addScalar(t){return this._x+=t,this._y+=t,this._z+=t,this}sub(t){return this._x-=t.x,this._y-=t.y,this._z-=t.z,this}subScalar(t){return this._x-=t,this._y-=t,this._z-=t,this}multiply(t){return this._x*=t.x,this._y*=t.y,this._z*=t.z,this}multiplyScalar(t){return this._x*=t,this._y*=t,this._z*=t,this}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this}clone(){return new J(this._x,this._y,this._z)}sanitizeNaNValuesWith(t){return this._x=isNaN(this._x)?t.x:parseFloat(this._x),this._y=isNaN(this._y)?t.y:parseFloat(this._y),this._z=isNaN(this._z)?t.z:parseFloat(this._z),this}max(t){return this._x=Math.max(this._x,t.x),this._y=Math.max(this._y,t.y),this._z=Math.max(this._z,t.z),this}min(t){return this._x=Math.min(this._x,t.x),this._y=Math.min(this._y,t.y),this._z=Math.min(this._z,t.z),this}equals(t){return this._x===t.x&&this._y===t.y&&this._z===t.z}normalize(){let t=this._x*this._x+this._y*this._y+this._z*this._z;return t>0&&(t=1/Math.sqrt(t)),this._x*=t,this._y*=t,this._z*=t,this}dot(t){return this._x*t.x+this._y*t.y+this._z*t.z}applyMat4(t){const e=this._x,i=this._y,r=this._z,s=t.elements;let n=s[3]*e+s[7]*i+s[11]*r+s[15];return n=n||1,this._x=(s[0]*e+s[4]*i+s[8]*r+s[12])/n,this._y=(s[1]*e+s[5]*i+s[9]*r+s[13])/n,this._z=(s[2]*e+s[6]*i+s[10]*r+s[14])/n,this}applyQuat(t){const e=this._x,i=this._y,r=this._z,s=t.elements[0],n=t.elements[1],a=t.elements[2],o=t.elements[3],h=o*e+n*r-a*i,l=o*i+a*e-s*r,u=o*r+s*i-n*e,d=-s*e-n*i-a*r;return this._x=h*o+d*-s+l*-a-u*-n,this._y=l*o+d*-n+u*-s-h*-a,this._z=u*o+d*-a+h*-n-l*-s,this}project(t){return this.applyMat4(t.viewMatrix).applyMat4(t.projectionMatrix),this}unproject(t){return this.applyMat4(t.projectionMatrix.getInverse()).applyMat4(t.worldMatrix),this}}const tt=new K,et=new J,it=new $;class rt{constructor(t,{isFBOTexture:e=!1,fromTexture:i=!1,loader:r,sampler:s,floatingPoint:n="none",premultiplyAlpha:a=!1,anisotropy:o=1,generateMipmap:h=null,wrapS:l,wrapT:u,minFilter:d,magFilter:c}={}){if(this.type="Texture",(t=t&&t.renderer||t)&&"Renderer"===t.type){if(!t.gl)return void(t.production||k(this.type+": Unable to create a "+this.type+" because the Renderer WebGL context is not defined"))}else k(this.type+": Renderer not passed as first argument",t);if(this.renderer=t,this.gl=this.renderer.gl,this.uuid=O(),this._globalParameters={unpackAlignment:4,flipY:!e,premultiplyAlpha:!1,shouldPremultiplyAlpha:a,floatingPoint:n,type:this.gl.UNSIGNED_BYTE,internalFormat:this.gl.RGBA,format:this.gl.RGBA},this.parameters={anisotropy:o,generateMipmap:h,wrapS:l||this.gl.CLAMP_TO_EDGE,wrapT:u||this.gl.CLAMP_TO_EDGE,minFilter:d||this.gl.LINEAR,magFilter:c||this.gl.LINEAR,_shouldUpdate:!0},this._initState(),this.sourceType=e?"fbo":"empty",this._useCache=!0,this._samplerName=s,this._sampler={isActive:!1,isTextureBound:!1,texture:this.gl.createTexture()},this._textureMatrix={matrix:new $,isActive:!1},this._size={width:1,height:1},this.scale=new K(1),this.scale.onChange(()=>this.resize()),this.offset=new K,this.offset.onChange(()=>this.resize()),this._loader=r,this._sourceLoaded=!1,this._uploaded=!1,this._willUpdate=!1,this.shouldUpdate=!1,this._forceUpdate=!1,this.userData={},this._canDraw=!1,i)return this._copyOnInit=!0,void(this._copiedFrom=i);this._copyOnInit=!1,this._initTexture()}_initState(){this._state={anisotropy:1,generateMipmap:!1,wrapS:null,wrapT:null,minFilter:null,magFilter:this.gl.LINEAR}}_initTexture(){this.gl.bindTexture(this.gl.TEXTURE_2D,this._sampler.texture),"empty"===this.sourceType&&(this._globalParameters.flipY=!1,this._updateGlobalTexParameters(),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array([0,0,0,255])),this._canDraw=!0)}_restoreFromTexture(){this._copyOnInit||this._initTexture(),this._parent&&(this._setTextureUniforms(),this._setSize()),this.copy(this._copiedFrom),this._canDraw=!0}_restoreContext(){if(this._canDraw=!1,this._sampler.texture=this.gl.createTexture(),this._sampler.isActive=!1,this._sampler.isTextureBound=!1,this._textureMatrix.isActive=!1,this._initState(),this._state.generateMipmap=!1,this.parameters._shouldUpdate=!0,this._copiedFrom){const t=this.renderer.nextRender.add(()=>{this._copiedFrom._canDraw&&(this._restoreFromTexture(),t.keep=!1)},!0)}else this._initTexture(),this._parent&&this._setParent(),this.source&&(this.setSource(this.source),"image"===this.sourceType?this.renderer.cache.addTexture(this):this.needUpdate()),this._canDraw=!0}addParent(t){!t||"Plane"!==t.type&&"PingPongPlane"!==t.type&&"ShaderPass"!==t.type&&"RenderTarget"!==t.type?this.renderer.production||A(this.type+": cannot add texture as a child of ",t," because it is not a valid parent"):(this._parent=t,this.index=this._parent.textures.length,this._parent.textures.push(this),this._setParent())}_setParent(){if(this._sampler.name=this._samplerName||"uSampler"+this.index,this._textureMatrix.name=this._samplerName?this._samplerName+"Matrix":"uTextureMatrix"+this.index,this._parent._program){if(!this._parent._program.compiled)return void(this.renderer.production||A(this.type+": Unable to create the texture because the program is not valid"));if(this._setTextureUniforms(),this._copyOnInit){const t=this.renderer.nextRender.add(()=>{this._copiedFrom._canDraw&&this._copiedFrom._uploaded&&(this.copy(this._copiedFrom),t.keep=!1)},!0);return}this.source?this._parent.loader&&this._parent.loader._addSourceToParent(this.source,this.sourceType):this._size={width:this._parent._boundingRect.document.width,height:this._parent._boundingRect.document.height},this._setSize()}else"RenderTarget"===this._parent.type&&(this._size={width:this._parent._size&&this._parent._size.width||this.renderer._boundingRect.width,height:this._parent._size&&this._parent._size.height||this.renderer._boundingRect.height},this._upload(),this._updateTexParameters(),this._canDraw=!0)}hasParent(){return!!this._parent}_setTextureUniforms(){const t=this._parent._program.activeUniforms;for(let e=0;e<t.textures.length;e++)t.textures[e]===this._sampler.name&&(this._sampler.isActive=!0,this.renderer.useProgram(this._parent._program),this._sampler.location=this.gl.getUniformLocation(this._parent._program.program,this._sampler.name),t.textureMatrices.find(t=>t===this._textureMatrix.name)&&(this._textureMatrix.isActive=!0,this._textureMatrix.location=this.gl.getUniformLocation(this._parent._program.program,this._textureMatrix.name)),this.gl.uniform1i(this._sampler.location,this.index))}copy(t){t&&"Texture"===t.type?(this._globalParameters=Object.assign({},t._globalParameters),this._state=Object.assign({},t._state),this.parameters.generateMipmap=t.parameters.generateMipmap,this._state.generateMipmap=null,this._size=t._size,!this._sourceLoaded&&t._sourceLoaded&&this._onSourceLoadedCallback&&this._onSourceLoadedCallback(),this._sourceLoaded=t._sourceLoaded,!this._uploaded&&t._uploaded&&this._onSourceUploadedCallback&&this._onSourceUploadedCallback(),this._uploaded=t._uploaded,this.sourceType=t.sourceType,this.source=t.source,this._videoFrameCallbackID=t._videoFrameCallbackID,this._sampler.texture=t._sampler.texture,this._copiedFrom=t,!this._parent||!this._parent._program||this._canDraw&&this._textureMatrix.matrix||(this._setSize(),this._canDraw=!0),this._updateTexParameters(),this.renderer.needRender()):this.renderer.production||A(this.type+": Unable to set the texture from texture:",t)}setSource(t){this._sourceLoaded||this.renderer.nextRender.add(()=>this._onSourceLoadedCallback&&this._onSourceLoadedCallback());const e="IMG"===t.tagName.toUpperCase()?"image":t.tagName.toLowerCase();if("video"!==e&&"canvas"!==e||(this._useCache=!1),this._useCache){const e=this.renderer.cache.getTextureFromSource(t);if(e&&e.uuid!==this.uuid)return this._uploaded||(this.renderer.nextRender.add(()=>this._onSourceUploadedCallback&&this._onSourceUploadedCallback()),this._uploaded=!0),this.copy(e),void this.resize()}if("empty"===this.sourceType||this.sourceType!==e)if("video"===e)this._willUpdate=!1,this.shouldUpdate=!0;else if("canvas"===e)this._willUpdate=!0,this.shouldUpdate=!0;else{if("image"!==e)return void(this.renderer.production||A(this.type+": this HTML tag could not be converted into a texture:",t.tagName));this._willUpdate=!1,this.shouldUpdate=!1}this.source=t,this.sourceType=e,this._size={width:this.source.naturalWidth||this.source.width||this.source.videoWidth,height:this.source.naturalHeight||this.source.height||this.source.videoHeight},this._sourceLoaded=!0,this.gl.bindTexture(this.gl.TEXTURE_2D,this._sampler.texture),this.resize(),this._globalParameters.flipY=!0,this._globalParameters.premultiplyAlpha=this._globalParameters.shouldPremultiplyAlpha,"image"===this.sourceType&&(this.parameters.generateMipmap=this.parameters.generateMipmap||null===this.parameters.generateMipmap,this.parameters._shouldUpdate=this.parameters.generateMipmap,this._state.generateMipmap=!1,this._upload()),this.renderer.needRender()}_updateGlobalTexParameters(){this.renderer.state.unpackAlignment!==this._globalParameters.unpackAlignment&&(this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,this._globalParameters.unpackAlignment),this.renderer.state.unpackAlignment=this._globalParameters.unpackAlignment),this.renderer.state.flipY!==this._globalParameters.flipY&&(this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,this._globalParameters.flipY),this.renderer.state.flipY=this._globalParameters.flipY),this.renderer.state.premultiplyAlpha!==this._globalParameters.premultiplyAlpha&&(this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._globalParameters.premultiplyAlpha),this.renderer.state.premultiplyAlpha=this._globalParameters.premultiplyAlpha),"half-float"===this._globalParameters.floatingPoint?this.renderer._isWebGL2&&this.renderer.extensions.EXT_color_buffer_float?(this._globalParameters.internalFormat=this.gl.RGBA16F,this._globalParameters.type=this.gl.HALF_FLOAT):this.renderer.extensions.OES_texture_half_float?this._globalParameters.type=this.renderer.extensions.OES_texture_half_float.HALF_FLOAT_OES:this.renderer.production||A(this.type+": could not use half-float textures because the extension is not available"):"float"===this._globalParameters.floatingPoint&&(this.renderer._isWebGL2&&this.renderer.extensions.EXT_color_buffer_float?(this._globalParameters.internalFormat=this.gl.RGBA16F,this._globalParameters.type=this.gl.FLOAT):this.renderer.extensions.OES_texture_float?this._globalParameters.type=this.renderer.extensions.OES_texture_half_float.FLOAT:this.renderer.production||A(this.type+": could not use float textures because the extension is not available"))}_updateTexParameters(){this.index&&this.renderer.state.activeTexture!==this.index&&this._bindTexture(),this.parameters.wrapS!==this._state.wrapS&&(this.renderer._isWebGL2||D(this._size.width)&&D(this._size.height)||(this.parameters.wrapS=this.gl.CLAMP_TO_EDGE),this.parameters.wrapS!==this.gl.REPEAT&&this.parameters.wrapS!==this.gl.CLAMP_TO_EDGE&&this.parameters.wrapS!==this.gl.MIRRORED_REPEAT&&(this.renderer.production||A(this.type+": Wrong wrapS value",this.parameters.wrapS,"for this texture:",this,"\ngl.CLAMP_TO_EDGE wrapping will be used instead"),this.parameters.wrapS=this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.parameters.wrapS),this._state.wrapS=this.parameters.wrapS),this.parameters.wrapT!==this._state.wrapT&&(this.renderer._isWebGL2||D(this._size.width)&&D(this._size.height)||(this.parameters.wrapT=this.gl.CLAMP_TO_EDGE),this.parameters.wrapT!==this.gl.REPEAT&&this.parameters.wrapT!==this.gl.CLAMP_TO_EDGE&&this.parameters.wrapT!==this.gl.MIRRORED_REPEAT&&(this.renderer.production||A(this.type+": Wrong wrapT value",this.parameters.wrapT,"for this texture:",this,"\ngl.CLAMP_TO_EDGE wrapping will be used instead"),this.parameters.wrapT=this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.parameters.wrapT),this._state.wrapT=this.parameters.wrapT),this.parameters.generateMipmap&&!this._state.generateMipmap&&this.source&&(this.renderer._isWebGL2||D(this._size.width)&&D(this._size.height)?this.gl.generateMipmap(this.gl.TEXTURE_2D):this.parameters.generateMipmap=!1,this._state.generateMipmap=this.parameters.generateMipmap),this.parameters.minFilter!==this._state.minFilter&&(this.renderer._isWebGL2||D(this._size.width)&&D(this._size.height)||(this.parameters.minFilter=this.gl.LINEAR),this.parameters.generateMipmap||null===this.parameters.generateMipmap||(this.parameters.minFilter=this.gl.LINEAR),this.parameters.minFilter!==this.gl.LINEAR&&this.parameters.minFilter!==this.gl.NEAREST&&this.parameters.minFilter!==this.gl.NEAREST_MIPMAP_NEAREST&&this.parameters.minFilter!==this.gl.LINEAR_MIPMAP_NEAREST&&this.parameters.minFilter!==this.gl.NEAREST_MIPMAP_LINEAR&&this.parameters.minFilter!==this.gl.LINEAR_MIPMAP_LINEAR&&(this.renderer.production||A(this.type+": Wrong minFilter value",this.parameters.minFilter,"for this texture:",this,"\ngl.LINEAR filtering will be used instead"),this.parameters.minFilter=this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.parameters.minFilter),this._state.minFilter=this.parameters.minFilter),this.parameters.magFilter!==this._state.magFilter&&(this.renderer._isWebGL2||D(this._size.width)&&D(this._size.height)||(this.parameters.magFilter=this.gl.LINEAR),this.parameters.magFilter!==this.gl.LINEAR&&this.parameters.magFilter!==this.gl.NEAREST&&(this.renderer.production||A(this.type+": Wrong magFilter value",this.parameters.magFilter,"for this texture:",this,"\ngl.LINEAR filtering will be used instead"),this.parameters.magFilter=this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.parameters.magFilter),this._state.magFilter=this.parameters.magFilter);const t=this.renderer.extensions.EXT_texture_filter_anisotropic;if(t&&this.parameters.anisotropy!==this._state.anisotropy){const e=this.gl.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.parameters.anisotropy=Math.max(1,Math.min(this.parameters.anisotropy,e)),this.gl.texParameterf(this.gl.TEXTURE_2D,t.TEXTURE_MAX_ANISOTROPY_EXT,this.parameters.anisotropy),this._state.anisotropy=this.parameters.anisotropy}}setWrapS(t){this.parameters.wrapS!==t&&(this.parameters.wrapS=t,this.parameters._shouldUpdate=!0)}setWrapT(t){this.parameters.wrapT!==t&&(this.parameters.wrapT=t,this.parameters._shouldUpdate=!0)}setMinFilter(t){this.parameters.minFilter!==t&&(this.parameters.minFilter=t,this.parameters._shouldUpdate=!0)}setMagFilter(t){this.parameters.magFilter!==t&&(this.parameters.magFilter=t,this.parameters._shouldUpdate=!0)}setAnisotropy(t){t=isNaN(t)?this.parameters.anisotropy:t,this.parameters.anisotropy!==t&&(this.parameters.anisotropy=t,this.parameters._shouldUpdate=!0)}needUpdate(){this._forceUpdate=!0}_videoFrameCallback(){if(this._willUpdate=!0,this.source)this.source.requestVideoFrameCallback(()=>this._videoFrameCallback());else{const t=this.renderer.nextRender.add(()=>{this.source&&(t.keep=!1,this.source.requestVideoFrameCallback(()=>this._videoFrameCallback()))},!0)}}_upload(){this._updateGlobalTexParameters(),this.source?this.gl.texImage2D(this.gl.TEXTURE_2D,0,this._globalParameters.internalFormat,this._globalParameters.format,this._globalParameters.type,this.source):"fbo"===this.sourceType&&this.gl.texImage2D(this.gl.TEXTURE_2D,0,this._globalParameters.internalFormat,this._size.width,this._size.height,0,this._globalParameters.format,this._globalParameters.type,this.source||null),this._uploaded||(this.renderer.nextRender.add(()=>this._onSourceUploadedCallback&&this._onSourceUploadedCallback()),this._uploaded=!0)}_getSizes(){if("fbo"===this.sourceType)return{parentWidth:this._parent._boundingRect.document.width,parentHeight:this._parent._boundingRect.document.height,sourceWidth:this._parent._boundingRect.document.width,sourceHeight:this._parent._boundingRect.document.height,xOffset:0,yOffset:0};const t=this._parent.scale?tt.set(this._parent.scale.x,this._parent.scale.y):tt.set(1,1),e=this._parent._boundingRect.document.width*t.x,i=this._parent._boundingRect.document.height*t.y,r=this._size.width,s=this._size.height,n=r/s,a=e/i;let o=0,h=0;return a>n?h=Math.min(0,i-e*(1/n)):a<n&&(o=Math.min(0,e-i*n)),{parentWidth:e,parentHeight:i,sourceWidth:r,sourceHeight:s,xOffset:o,yOffset:h}}setScale(t){t.type&&"Vec2"===t.type?(t.sanitizeNaNValuesWith(this.scale).max(tt.set(.001,.001)),t.equals(this.scale)||(this.scale.copy(t),this.resize())):this.renderer.production||A(this.type+": Cannot set scale because the parameter passed is not of Vec2 type:",t)}setOffset(t){t.type&&"Vec2"===t.type?(t.sanitizeNaNValuesWith(this.offset),t.equals(this.offset)||(this.offset.copy(t),this.resize())):this.renderer.production||A(this.type+": Cannot set offset because the parameter passed is not of Vec2 type:",scale)}_setSize(){if(this._parent&&this._parent._program){const t=this._getSizes();this._updateTextureMatrix(t)}}resize(){"fbo"===this.sourceType?(this._size={width:this._parent._size&&this._parent._size.width||this._parent._boundingRect.document.width,height:this._parent._size&&this._parent._size.height||this._parent._boundingRect.document.height},this._copiedFrom||(this.gl.bindTexture(this.gl.TEXTURE_2D,this._sampler.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this._globalParameters.internalFormat,this._size.width,this._size.height,0,this._globalParameters.format,this._globalParameters.type,null))):this.source&&(this._size={width:this.source.naturalWidth||this.source.width||this.source.videoWidth,height:this.source.naturalHeight||this.source.height||this.source.videoHeight}),this._setSize()}_updateTextureMatrix(t){const e=et.set(t.parentWidth/(t.parentWidth-t.xOffset),t.parentHeight/(t.parentHeight-t.yOffset),1);e.x/=this.scale.x,e.y/=this.scale.y,this._textureMatrix.matrix=it.setFromArray([e.x,0,0,0,0,e.y,0,0,0,0,1,0,(1-e.x)/2+this.offset.x,(1-e.y)/2+this.offset.y,0,1]),this._updateMatrixUniform()}_updateMatrixUniform(){this._textureMatrix.isActive&&(this.renderer.useProgram(this._parent._program),this.gl.uniformMatrix4fv(this._textureMatrix.location,!1,this._textureMatrix.matrix.elements))}_onSourceLoaded(t){this.setSource(t),"image"===this.sourceType&&this.renderer.cache.addTexture(this)}_bindTexture(){this._canDraw&&(this.renderer.state.activeTexture!==this.index&&(this.gl.activeTexture(this.gl.TEXTURE0+this.index),this.renderer.state.activeTexture=this.index),this.gl.bindTexture(this.gl.TEXTURE_2D,this._sampler.texture),this._sampler.isTextureBound||(this._sampler.isTextureBound=!!this.gl.getParameter(this.gl.TEXTURE_BINDING_2D),this._sampler.isTextureBound&&this.renderer.needRender()))}_draw(){this._sampler.isActive&&(this._bindTexture(),"video"===this.sourceType&&this.source&&!this._videoFrameCallbackID&&this.source.readyState>=this.source.HAVE_CURRENT_DATA&&!this.source.paused&&(this._willUpdate=!0),(this._forceUpdate||this._willUpdate&&this.shouldUpdate)&&(this._state.generateMipmap=!1,this._upload()),"video"===this.sourceType&&(this._willUpdate=!1),this._forceUpdate=!1),this.parameters._shouldUpdate&&(this._updateTexParameters(),this.parameters._shouldUpdate=!1)}onSourceLoaded(t){return t&&(this._onSourceLoadedCallback=t),this}onSourceUploaded(t){return t&&(this._onSourceUploadedCallback=t),this}_dispose(t=!1){"video"===this.sourceType||"image"===this.sourceType&&!this.renderer.state.isActive?(this._loader&&this._loader._removeSource(this),this.source=null):"canvas"===this.sourceType&&(this.source.width=this.source.width,this.source=null),this._parent=null,this.gl&&!this._copiedFrom&&(t||"image"!==this.sourceType||!this.renderer.state.isActive)&&(this._canDraw=!1,this.renderer.cache.removeTexture(this),this.gl.activeTexture(this.gl.TEXTURE0+this.index),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.deleteTexture(this._sampler.texture))}}class st{constructor(t,e="anonymous"){if(this.type="TextureLoader",(t=t&&t.renderer||t)&&"Renderer"===t.type){if(!t.gl)return void k(this.type+": Renderer WebGL context is undefined",t)}else k(this.type+": Renderer not passed as first argument",t);this.renderer=t,this.gl=this.renderer.gl,this.crossOrigin=e,this.elements=[]}_addElement(t,e,i,r){const s={source:t,texture:e,load:this._sourceLoaded.bind(this,t,e,i),error:this._sourceLoadError.bind(this,t,r)};return this.elements.push(s),s}_sourceLoadError(t,e,i){e&&e(t,i)}_sourceLoaded(t,e,i){e._sourceLoaded||(e._onSourceLoaded(t),this._parent&&(this._increment&&this._increment(),this.renderer.nextRender.add(()=>this._parent._onLoadingCallback&&this._parent._onLoadingCallback(e))),i&&i(e))}_getSourceType(t){let e;return"string"==typeof t?null!==t.match(/\.(jpeg|jpg|jfif|pjpeg|pjp|gif|bmp|png|webp|svg|avif|apng)$/)?e="image":null!==t.match(/\.(webm|mp4|mpg|mpeg|avi|ogg|ogm|ogv|mov|av1)$/)&&(e="video"):"IMG"===t.tagName.toUpperCase()?e="image":"VIDEO"===t.tagName.toUpperCase()?e="video":"CANVAS"===t.tagName.toUpperCase()&&(e="canvas"),e}_createImage(t){if("string"!=typeof t&&t.hasAttribute("crossOrigin"))return t;{const e=new Image;return e.crossOrigin=this.crossOrigin,"string"==typeof t?e.src=t:(e.src=t.src,t.hasAttribute("data-sampler")&&e.setAttribute("data-sampler",t.getAttribute("data-sampler"))),e}}_createVideo(t){if("string"==typeof t||null===t.getAttribute("crossOrigin")){const e=document.createElement("video");return e.crossOrigin=this.crossOrigin,"string"==typeof t?e.src=t:(e.src=t.src,t.hasAttribute("data-sampler")&&e.setAttribute("data-sampler",t.getAttribute("data-sampler"))),e}return t}loadSource(t,e,i,r){switch(this._getSourceType(t)){case"image":this.loadImage(t,e,i,r);break;case"video":this.loadVideo(t,e,i,r);break;case"canvas":this.loadCanvas(t,e,i);break;default:this._sourceLoadError(t,r,"this source could not be converted into a texture: "+t)}}loadSources(t,e,i,r){for(let s=0;s<t.length;s++)this.loadSource(t[s],e,i,r)}loadImage(t,e={},i,r){const s=this.renderer.cache.getTextureFromSource(t);let n=Object.assign({},e);if(this._parent&&(n=Object.assign(n,this._parent._texturesOptions)),n.loader=this,s){n.sampler="string"!=typeof t&&t.hasAttribute("data-sampler")?t.getAttribute("data-sampler"):n.sampler,n.fromTexture=s;const e=new rt(this.renderer,n);return this._sourceLoaded(s.source,e,i),void(this._parent&&this._addToParent(e,s.source,"image"))}const a=this._createImage(t);n.sampler=a.hasAttribute("data-sampler")?a.getAttribute("data-sampler"):n.sampler;const o=new rt(this.renderer,n),h=this._addElement(a,o,i,r);a.complete?this._sourceLoaded(a,o,i):a.decode?a.decode().then(this._sourceLoaded.bind(this,a,o,i)).catch(()=>{a.addEventListener("load",h.load,!1),a.addEventListener("error",h.error,!1)}):(a.addEventListener("load",h.load,!1),a.addEventListener("error",h.error,!1)),this._parent&&this._addToParent(o,a,"image")}loadImages(t,e,i,r){for(let s=0;s<t.length;s++)this.loadImage(t[s],e,i,r)}loadVideo(t,e={},i,r){const s=this._createVideo(t);s.preload=!0,s.muted=!0,s.loop=!0,s.setAttribute("playsinline",""),s.crossOrigin=this.crossOrigin;let n=Object.assign({},e);this._parent&&(n=Object.assign(e,this._parent._texturesOptions)),n.loader=this,n.sampler=s.hasAttribute("data-sampler")?s.getAttribute("data-sampler"):n.sampler;const a=new rt(this.renderer,n),o=this._addElement(s,a,i,r);s.addEventListener("canplaythrough",o.load,!1),s.addEventListener("error",o.error,!1),s.readyState>=s.HAVE_FUTURE_DATA&&i&&this._sourceLoaded(s,a,i),s.load(),this._addToParent&&this._addToParent(a,s,"video"),"requestVideoFrameCallback"in HTMLVideoElement.prototype&&(o.videoFrameCallback=a._videoFrameCallback.bind(a),a._videoFrameCallbackID=s.requestVideoFrameCallback(o.videoFrameCallback))}loadVideos(t,e,i,r){for(let s=0;s<t.length;s++)this.loadVideo(t[s],e,i,r)}loadCanvas(t,e={},i){let r=Object.assign({},e);this._parent&&(r=Object.assign(e,this._parent._texturesOptions)),r.loader=this,r.sampler=t.hasAttribute("data-sampler")?t.getAttribute("data-sampler"):r.sampler;const s=new rt(this.renderer,r);this._addElement(t,s,i,null),this._sourceLoaded(t,s,i),this._parent&&this._addToParent(s,t,"canvas")}loadCanvases(t,e,i){for(let r=0;r<t.length;r++)this.loadCanvas(t[r],e,i)}_removeSource(t){const e=this.elements.find(e=>e.texture.uuid===t.uuid);e&&("image"===t.sourceType?e.source.removeEventListener("load",e.load,!1):"video"===t.sourceType&&(e.videoFrameCallback&&t._videoFrameCallbackID&&e.source.cancelVideoFrameCallback(t._videoFrameCallbackID),e.source.removeEventListener("canplaythrough",e.load,!1),e.source.pause(),e.source.removeAttribute("src"),e.source.load()),e.source.removeEventListener("error",e.error,!1))}}class nt extends st{constructor(t,e,{sourcesLoaded:i=0,sourcesToLoad:r=0,complete:s=!1,onComplete:n=()=>{}}={}){super(t,e.crossOrigin),this.type="PlaneTextureLoader",this._parent=e,"Plane"!==this._parent.type&&"PingPongPlane"!==this._parent.type&&"ShaderPass"!==this._parent.type&&(A(this.type+": Wrong parent type assigned to this loader"),this._parent=null),this.sourcesLoaded=i,this.sourcesToLoad=r,this.complete=s,this.onComplete=n}_setLoaderSize(t){this.sourcesToLoad=t,0===this.sourcesToLoad&&(this.complete=!0,this.renderer.nextRender.add(()=>this.onComplete&&this.onComplete()))}_increment(){this.sourcesLoaded++,this.sourcesLoaded>=this.sourcesToLoad&&!this.complete&&(this.complete=!0,this.renderer.nextRender.add(()=>this.onComplete&&this.onComplete()))}_addSourceToParent(t,e){if("image"===e){const e=this._parent.images;!e.find(e=>e.src===t.src)&&e.push(t)}else if("video"===e){const e=this._parent.videos;!e.find(e=>e.src===t.src)&&e.push(t)}else if("canvas"===e){const e=this._parent.canvases;!e.find(e=>e.isSameNode(t))&&e.push(t)}}_addToParent(t,e,i){this._addSourceToParent(e,i),this._parent&&t.addParent(this._parent)}}class at{constructor(t,e="Mesh",{vertexShaderID:i,fragmentShaderID:r,vertexShader:s,fragmentShader:n,uniforms:a={},widthSegments:o=1,heightSegments:h=1,renderOrder:l=0,depthTest:u=!0,cullFace:d="back",texturesOptions:c={},crossOrigin:p="anonymous"}={}){if(this.type=e,(t=t&&t.renderer||t)&&"Renderer"===t.type||(k(this.type+": Curtains not passed as first argument or Curtains Renderer is missing",t),setTimeout(()=>{this._onErrorCallback&&this._onErrorCallback()},0)),this.renderer=t,this.gl=this.renderer.gl,!this.gl)return this.renderer.production||k(this.type+": Unable to create a "+this.type+" because the Renderer WebGL context is not defined"),void setTimeout(()=>{this._onErrorCallback&&this._onErrorCallback()},0);this._canDraw=!1,this.renderOrder=l,this._depthTest=u,this.cullFace=d,"back"!==this.cullFace&&"front"!==this.cullFace&&"none"!==this.cullFace&&(this.cullFace="back"),this.textures=[],this._texturesOptions=Object.assign({premultiplyAlpha:!1,anisotropy:1,floatingPoint:"none",wrapS:this.gl.CLAMP_TO_EDGE,wrapT:this.gl.CLAMP_TO_EDGE,minFilter:this.gl.LINEAR,magFilter:this.gl.LINEAR},c),this.crossOrigin=p,!s&&i&&document.getElementById(i)&&(s=document.getElementById(i).innerHTML),!n&&r&&document.getElementById(r)&&(n=document.getElementById(r).innerHTML),this._initMesh(),o=parseInt(o),h=parseInt(h),this._geometry=new Q(this.renderer,{width:o,height:h}),this._program=new Z(this.renderer,{parent:this,vertexShader:s,fragmentShader:n}),this._program.compiled?(this._program.createUniforms(a),this.uniforms=this._program.uniformsManager.uniforms,this._geometry.setProgram(this._program),this.renderer.onSceneChange()):this.renderer.nextRender.add(()=>this._onErrorCallback&&this._onErrorCallback())}_initMesh(){this.uuid=O(),this.loader=new nt(this.renderer,this,{sourcesLoaded:0,initSourcesToLoad:0,complete:!1,onComplete:()=>{this._onReadyCallback&&this._onReadyCallback(),this.renderer.needRender()}}),this.images=[],this.videos=[],this.canvases=[],this.userData={},this._canDraw=!0}_restoreContext(){this._canDraw=!1,this._matrices&&(this._matrices=null),this._program=new Z(this.renderer,{parent:this,vertexShader:this._program.vsCode,fragmentShader:this._program.fsCode}),this._program.compiled&&(this._geometry.restoreContext(this._program),this._program.createUniforms(this.uniforms),this.uniforms=this._program.uniformsManager.uniforms,this._programRestored())}setRenderTarget(t){t&&"RenderTarget"===t.type?("Plane"===this.type&&this.renderer.scene.removePlane(this),this.target=t,"Plane"===this.type&&this.renderer.scene.addPlane(this)):this.renderer.production||A(this.type+": Could not set the render target because the argument passed is not a RenderTarget class object",t)}setRenderOrder(t=0){(t=isNaN(t)?this.renderOrder:parseInt(t))!==this.renderOrder&&(this.renderOrder=t,this.renderer.scene.setPlaneRenderOrder(this))}createTexture(t={}){const e=new rt(this.renderer,Object.assign(t,this._texturesOptions));return e.addParent(this),e}addTexture(t){t&&"Texture"===t.type?t.addParent(this):this.renderer.production||A(this.type+": cannot add ",t," to this "+this.type+" because it is not a valid texture")}loadSources(t,e={},i,r){for(let s=0;s<t.length;s++)this.loadSource(t[s],e,i,r)}loadSource(t,e={},i,r){this.loader.loadSource(t,Object.assign(e,this._texturesOptions),t=>{i&&i(t)},(t,e)=>{this.renderer.production||A(this.type+": this HTML tag could not be converted into a texture:",t.tagName),r&&r(t,e)})}loadImage(t,e={},i,r){this.loader.loadImage(t,Object.assign(e,this._texturesOptions),t=>{i&&i(t)},(t,e)=>{this.renderer.production||A(this.type+": There has been an error:\n",e,"\nwhile loading this image:\n",t),r&&r(t,e)})}loadVideo(t,e={},i,r){this.loader.loadVideo(t,Object.assign(e,this._texturesOptions),t=>{i&&i(t)},(t,e)=>{this.renderer.production||A(this.type+": There has been an error:\n",e,"\nwhile loading this video:\n",t),r&&r(t,e)})}loadCanvas(t,e={},i){this.loader.loadCanvas(t,Object.assign(e,this._texturesOptions),t=>{i&&i(t)})}loadImages(t,e={},i,r){for(let s=0;s<t.length;s++)this.loadImage(t[s],e,i,r)}loadVideos(t,e={},i,r){for(let s=0;s<t.length;s++)this.loadVideo(t[s],e,i,r)}loadCanvases(t,e={},i){for(let r=0;r<t.length;r++)this.loadCanvas(t[r],e,i)}playVideos(){for(let t=0;t<this.textures.length;t++){const e=this.textures[t];if("video"===e.sourceType){const t=e.source.play();void 0!==t&&t.catch(t=>{this.renderer.production||A(this.type+": Could not play the video : ",t)})}}}_draw(){this.renderer.setDepthTest(this._depthTest),this.renderer.setFaceCulling(this.cullFace),this._program.updateUniforms(),this._geometry.bindBuffers(),this.renderer.state.forceBufferUpdate=!1;for(let t=0;t<this.textures.length;t++)if(this.textures[t]._draw(),this.textures[t]._sampler.isActive&&!this.textures[t]._sampler.isTextureBound)return;this._geometry.draw(),this.renderer.state.activeTexture=null,this._onAfterRenderCallback&&this._onAfterRenderCallback()}onError(t){return t&&(this._onErrorCallback=t),this}onLoading(t){return t&&(this._onLoadingCallback=t),this}onReady(t){return t&&(this._onReadyCallback=t),this}onRender(t){return t&&(this._onRenderCallback=t),this}onAfterRender(t){return t&&(this._onAfterRenderCallback=t),this}remove(){this._canDraw=!1,this.target&&this.renderer.bindFrameBuffer(null),this._dispose(),"Plane"===this.type?this.renderer.removePlane(this):"ShaderPass"===this.type&&(this.target&&(this.target._shaderPass=null,this.target.remove(),this.target=null),this.renderer.removeShaderPass(this))}_dispose(){if(this.gl){this._geometry&&this._geometry.dispose(),this.target&&"ShaderPass"===this.type&&(this.renderer.removeRenderTarget(this.target),this.textures.shift());for(let t=0;t<this.textures.length;t++)this.textures[t]._dispose();this.textures=[]}}}const ot=new K,ht=new K;class lt extends at{constructor(t,e,i="DOMMesh",{widthSegments:r,heightSegments:s,renderOrder:n,depthTest:a,cullFace:o,uniforms:h,vertexShaderID:l,fragmentShaderID:u,vertexShader:d,fragmentShader:c,texturesOptions:p,crossOrigin:_}={}){super(t,i,{widthSegments:r,heightSegments:s,renderOrder:n,depthTest:a,cullFace:o,uniforms:h,vertexShaderID:l=l||e&&e.getAttribute("data-vs-id"),fragmentShaderID:u=u||e&&e.getAttribute("data-fs-id"),vertexShader:d,fragmentShader:c,texturesOptions:p,crossOrigin:_}),this.gl&&(this.htmlElement=e,this.htmlElement&&0!==this.htmlElement.length||this.renderer.production||A(this.type+": The HTML element you specified does not currently exists in the DOM"),this._setDocumentSizes())}_setDocumentSizes(){let t=this.htmlElement.getBoundingClientRect();this._boundingRect||(this._boundingRect={}),this._boundingRect.document={width:t.width*this.renderer.pixelRatio,height:t.height*this.renderer.pixelRatio,top:t.top*this.renderer.pixelRatio,left:t.left*this.renderer.pixelRatio}}getBoundingRect(){return{width:this._boundingRect.document.width,height:this._boundingRect.document.height,top:this._boundingRect.document.top,left:this._boundingRect.document.left,right:this._boundingRect.document.left+this._boundingRect.document.width,bottom:this._boundingRect.document.top+this._boundingRect.document.height}}resize(){this._setDocumentSizes(),"Plane"===this.type&&(this.setPerspective(this.camera.fov,this.camera.near,this.camera.far),this._setWorldSizes(),this._applyWorldPositions());for(let t=0;t<this.textures.length;t++)this.textures[t].resize();this.renderer.nextRender.add(()=>this._onAfterResizeCallback&&this._onAfterResizeCallback())}mouseToPlaneCoords(t){const e=this.scale?this.scale:ht.set(1,1),i=ot.set((this._boundingRect.document.width-this._boundingRect.document.width*e.x)/2,(this._boundingRect.document.height-this._boundingRect.document.height*e.y)/2);return ot.set((t.x-(this._boundingRect.document.left+i.x)/this.renderer.pixelRatio)/(this._boundingRect.document.width*e.x/this.renderer.pixelRatio)*2-1,1-(t.y-(this._boundingRect.document.top+i.y)/this.renderer.pixelRatio)/(this._boundingRect.document.height*e.y/this.renderer.pixelRatio)*2)}onAfterResize(t){return t&&(this._onAfterResizeCallback=t),this}}class ut{constructor({fov:t=50,near:e=.1,far:i=150,width:r,height:s,pixelRatio:n=1}={}){this.position=new J,this.projectionMatrix=new $,this.worldMatrix=new $,this.viewMatrix=new $,this._shouldUpdate=!1,this.setSize(),this.setPerspective(t,e,i,r,s,n)}setFov(t){t=isNaN(t)?this.fov:parseFloat(t),(t=Math.max(1,Math.min(t,179)))!==this.fov&&(this.fov=t,this.setPosition(),this._shouldUpdate=!0),this.setCSSPerspective()}setNear(t){t=isNaN(t)?this.near:parseFloat(t),(t=Math.max(t,.01))!==this.near&&(this.near=t,this._shouldUpdate=!0)}setFar(t){t=isNaN(t)?this.far:parseFloat(t),(t=Math.max(t,50))!==this.far&&(this.far=t,this._shouldUpdate=!0)}setPixelRatio(t){t!==this.pixelRatio&&(this._shouldUpdate=!0),this.pixelRatio=t}setSize(t,e){t===this.width&&e===this.height||(this._shouldUpdate=!0),this.width=t,this.height=e}setPerspective(t,e,i,r,s,n){this.setPixelRatio(n),this.setSize(r,s),this.setFov(t),this.setNear(e),this.setFar(i),this._shouldUpdate&&this.updateProjectionMatrix()}setPosition(){this.position.set(0,0,1),this.worldMatrix.setFromArray([1,0,0,0,0,1,0,0,0,0,1,0,this.position.x,this.position.y,this.position.z,1]),this.viewMatrix=this.viewMatrix.copy(this.worldMatrix).getInverse()}setCSSPerspective(){this.CSSPerspective=Math.pow(Math.pow(this.width/(2*this.pixelRatio),2)+Math.pow(this.height/(2*this.pixelRatio),2),.5)/Math.tan(.5*this.fov*Math.PI/180)}getScreenRatiosFromFov(t=0){const e=this.position.z;t<e?t-=e:t+=e;const i=this.fov*Math.PI/180,r=2*Math.tan(i/2)*Math.abs(t);return{width:r*this.width/this.height,height:r}}updateProjectionMatrix(){const t=this.width/this.height,e=this.near*Math.tan(Math.PI/180*.5*this.fov),i=2*e,r=t*i,s=-.5*r,n=s+r,a=e-i;this.projectionMatrix.setFromArray([2*this.near/(n-s),0,0,0,0,2*this.near/(e-a),0,0,(n+s)/(n-s),(e+a)/(e-a),-(this.far+this.near)/(this.far-this.near),-1,0,0,-2*this.far*this.near/(this.far-this.near),0])}forceUpdate(){this._shouldUpdate=!0}cancelUpdate(){this._shouldUpdate=!1}}class dt{constructor(t=new Float32Array([0,0,0,1]),e="XYZ"){this.type="Quat",this.elements=t,this.axisOrder=e}setFromArray(t){return this.elements[0]=t[0],this.elements[1]=t[1],this.elements[2]=t[2],this.elements[3]=t[3],this}setAxisOrder(t){switch(t=t.toUpperCase()){case"XYZ":case"YXZ":case"ZXY":case"ZYX":case"YZX":case"XZY":this.axisOrder=t;break;default:this.axisOrder="XYZ"}return this}copy(t){return this.elements=t.elements,this.axisOrder=t.axisOrder,this}clone(){return(new dt).copy(this)}equals(t){return this.elements[0]===t.elements[0]&&this.elements[1]===t.elements[1]&&this.elements[2]===t.elements[2]&&this.elements[3]===t.elements[3]&&this.axisOrder===t.axisOrder}setFromVec3(t){const e=.5*t.x,i=.5*t.y,r=.5*t.z,s=Math.cos(e),n=Math.cos(i),a=Math.cos(r),o=Math.sin(e),h=Math.sin(i),l=Math.sin(r);return"XYZ"===this.axisOrder?(this.elements[0]=o*n*a+s*h*l,this.elements[1]=s*h*a-o*n*l,this.elements[2]=s*n*l+o*h*a,this.elements[3]=s*n*a-o*h*l):"YXZ"===this.axisOrder?(this.elements[0]=o*n*a+s*h*l,this.elements[1]=s*h*a-o*n*l,this.elements[2]=s*n*l-o*h*a,this.elements[3]=s*n*a+o*h*l):"ZXY"===this.axisOrder?(this.elements[0]=o*n*a-s*h*l,this.elements[1]=s*h*a+o*n*l,this.elements[2]=s*n*l+o*h*a,this.elements[3]=s*n*a-o*h*l):"ZYX"===this.axisOrder?(this.elements[0]=o*n*a-s*h*l,this.elements[1]=s*h*a+o*n*l,this.elements[2]=s*n*l-o*h*a,this.elements[3]=s*n*a+o*h*l):"YZX"===this.axisOrder?(this.elements[0]=o*n*a+s*h*l,this.elements[1]=s*h*a+o*n*l,this.elements[2]=s*n*l-o*h*a,this.elements[3]=s*n*a-o*h*l):"XZY"===this.axisOrder&&(this.elements[0]=o*n*a-s*h*l,this.elements[1]=s*h*a-o*n*l,this.elements[2]=s*n*l+o*h*a,this.elements[3]=s*n*a+o*h*l),this}}const ct=new K,pt=new J,_t=new J,mt=new J,ft=new J,gt=new J,vt=new J,xt=new J,yt=new J,bt=new dt,wt=new J(.5,.5,0),Tt=new J,Rt=new J,Pt=new J,St=new J,Ct=new K;class Mt extends lt{constructor(t,e,{widthSegments:i,heightSegments:r,renderOrder:s,depthTest:n,cullFace:a,uniforms:o,vertexShaderID:h,fragmentShaderID:l,vertexShader:u,fragmentShader:d,texturesOptions:c,crossOrigin:p,alwaysDraw:_=!1,visible:m=!0,transparent:f=!1,drawCheckMargins:g={top:0,right:0,bottom:0,left:0},autoloadSources:v=!0,watchScroll:x=!0,fov:y=50}={}){super(t,e,"Plane",{widthSegments:i,heightSegments:r,renderOrder:s,depthTest:n,cullFace:a,uniforms:o,vertexShaderID:h,fragmentShaderID:l,vertexShader:u,fragmentShader:d,texturesOptions:c,crossOrigin:p}),this.gl&&(this.index=this.renderer.planes.length,this.target=null,this.alwaysDraw=_,this._shouldDraw=!0,this.visible=m,this._transparent=f,this.drawCheckMargins=g,this.autoloadSources=v,this.watchScroll=x,this._updateMVMatrix=!1,this.camera=new ut({fov:y,width:this.renderer._boundingRect.width,height:this.renderer._boundingRect.height,pixelRatio:this.renderer.pixelRatio}),this._program.compiled&&(this._initPlane(),this.renderer.scene.addPlane(this),this.renderer.planes.push(this)))}_programRestored(){this.target&&this.setRenderTarget(this.renderer.renderTargets[this.target.index]),this._initMatrices(),this.setPerspective(this.camera.fov,this.camera.near,this.camera.far),this._setWorldSizes(),this._applyWorldPositions(),this.renderer.scene.addPlane(this);for(let t=0;t<this.textures.length;t++)this.textures[t]._parent=this,this.textures[t]._restoreContext();this._canDraw=!0}_initPlane(){this._initTransformValues(),this._initPositions(),this.setPerspective(this.camera.fov,this.camera.near,this.camera.far),this._initSources()}_initTransformValues(){this.rotation=new J,this.rotation.onChange(()=>this._applyRotation()),this.quaternion=new dt,this.relativeTranslation=new J,this.relativeTranslation.onChange(()=>this._setTranslation()),this._translation=new J,this.scale=new J(1),this.scale.onChange(()=>{this.scale.z=1,this._applyScale()}),this.transformOrigin=new J(.5,.5,0),this.transformOrigin.onChange(()=>{this._setWorldTransformOrigin(),this._updateMVMatrix=!0})}resetPlane(t){this._initTransformValues(),this._setWorldTransformOrigin(),null!==t&&t?(this.htmlElement=t,this.resize()):t||this.renderer.production||A(this.type+": You are trying to reset a plane with a HTML element that does not exist. The old HTML element will be kept instead.")}removeRenderTarget(){this.target&&(this.renderer.scene.removePlane(this),this.target=null,this.renderer.scene.addPlane(this))}_initPositions(){this._initMatrices(),this._setWorldSizes(),this._applyWorldPositions()}_initMatrices(){const t=new $;this._matrices={world:{matrix:t},modelView:{name:"uMVMatrix",matrix:t,location:this.gl.getUniformLocation(this._program.program,"uMVMatrix")},projection:{name:"uPMatrix",matrix:t,location:this.gl.getUniformLocation(this._program.program,"uPMatrix")},modelViewProjection:{matrix:t}}}_setPerspectiveMatrix(){this.camera._shouldUpdate&&(this.renderer.useProgram(this._program),this.gl.uniformMatrix4fv(this._matrices.projection.location,!1,this._matrices.projection.matrix.elements)),this.camera.cancelUpdate()}setPerspective(t,e,i){this.camera.setPerspective(t,e,i,this.renderer._boundingRect.width,this.renderer._boundingRect.height,this.renderer.pixelRatio),this.renderer.state.isContextLost&&this.camera.forceUpdate(),this._matrices.projection.matrix=this.camera.projectionMatrix,this.camera._shouldUpdate&&(this._setWorldSizes(),this._applyWorldPositions(),this._translation.z=this.relativeTranslation.z/this.camera.CSSPerspective),this._updateMVMatrix=this.camera._shouldUpdate}_setMVMatrix(){this._updateMVMatrix&&(this._matrices.world.matrix=this._matrices.world.matrix.composeFromOrigin(this._translation,this.quaternion,this.scale,this._boundingRect.world.transformOrigin),this._matrices.world.matrix.scale({x:this._boundingRect.world.width,y:this._boundingRect.world.height,z:1}),this._matrices.modelView.matrix.copy(this._matrices.world.matrix),this._matrices.modelView.matrix.elements[14]-=this.camera.position.z,this._matrices.modelViewProjection.matrix=this._matrices.projection.matrix.multiply(this._matrices.modelView.matrix),this.alwaysDraw||this._shouldDrawCheck(),this.renderer.useProgram(this._program),this.gl.uniformMatrix4fv(this._matrices.modelView.location,!1,this._matrices.modelView.matrix.elements)),this._updateMVMatrix=!1}_setWorldTransformOrigin(){this._boundingRect.world.transformOrigin=new J((2*this.transformOrigin.x-1)*this._boundingRect.world.width,-(2*this.transformOrigin.y-1)*this._boundingRect.world.height,this.transformOrigin.z)}_documentToWorldSpace(t){return _t.set(t.x*this.renderer.pixelRatio/this.renderer._boundingRect.width*this._boundingRect.world.ratios.width,-t.y*this.renderer.pixelRatio/this.renderer._boundingRect.height*this._boundingRect.world.ratios.height,t.z)}_setWorldSizes(){const t=this.camera.getScreenRatiosFromFov();this._boundingRect.world={width:this._boundingRect.document.width/this.renderer._boundingRect.width*t.width/2,height:this._boundingRect.document.height/this.renderer._boundingRect.height*t.height/2,ratios:t},this._setWorldTransformOrigin()}_setWorldPosition(){const t=this._boundingRect.document.width/2+this._boundingRect.document.left,e=this.renderer._boundingRect.width/2+this.renderer._boundingRect.left;this._boundingRect.world.top=(this.renderer._boundingRect.height/2+this.renderer._boundingRect.top-(this._boundingRect.document.height/2+this._boundingRect.document.top))/this.renderer._boundingRect.height*this._boundingRect.world.ratios.height,this._boundingRect.world.left=(t-e)/this.renderer._boundingRect.width*this._boundingRect.world.ratios.width}setScale(t){t.type&&"Vec2"===t.type?(t.sanitizeNaNValuesWith(this.scale).max(ct.set(.001,.001)),t.x===this.scale.x&&t.y===this.scale.y||(this.scale.set(t.x,t.y,1),this._applyScale())):this.renderer.production||A(this.type+": Cannot set scale because the parameter passed is not of Vec2 type:",t)}_applyScale(){for(let t=0;t<this.textures.length;t++)this.textures[t].resize();this._updateMVMatrix=!0}setRotation(t){t.type&&"Vec3"===t.type?(t.sanitizeNaNValuesWith(this.rotation),t.equals(this.rotation)||(this.rotation.copy(t),this._applyRotation())):this.renderer.production||A(this.type+": Cannot set rotation because the parameter passed is not of Vec3 type:",t)}_applyRotation(){this.quaternion.setFromVec3(this.rotation),this._updateMVMatrix=!0}setTransformOrigin(t){t.type&&"Vec3"===t.type?(t.sanitizeNaNValuesWith(this.transformOrigin),t.equals(this.transformOrigin)||(this.transformOrigin.copy(t),this._setWorldTransformOrigin(),this._updateMVMatrix=!0)):this.renderer.production||A(this.type+": Cannot set transform origin because the parameter passed is not of Vec3 type:",t)}_setTranslation(){let t=pt.set(0,0,0);this.relativeTranslation.equals(t)||(t=this._documentToWorldSpace(this.relativeTranslation)),this._translation.set(this._boundingRect.world.left+t.x,this._boundingRect.world.top+t.y,this.relativeTranslation.z/this.camera.CSSPerspective),this._updateMVMatrix=!0}setRelativeTranslation(t){t.type&&"Vec3"===t.type?(t.sanitizeNaNValuesWith(this.relativeTranslation),t.equals(this.relativeTranslation)||(this.relativeTranslation.copy(t),this._setTranslation())):this.renderer.production||A(this.type+": Cannot set translation because the parameter passed is not of Vec3 type:",t)}_applyWorldPositions(){this._setWorldPosition(),this._setTranslation()}updatePosition(){this._setDocumentSizes(),this._applyWorldPositions()}updateScrollPosition(t,e){(t||e)&&(this._boundingRect.document.top+=e*this.renderer.pixelRatio,this._boundingRect.document.left+=t*this.renderer.pixelRatio,this._applyWorldPositions())}_getIntersection(t,e){let i=e.clone().sub(t),r=t.clone();for(;r.z>-1;)r.add(i);return r}_getNearPlaneIntersections(t,e,i){const r=this._matrices.modelViewProjection.matrix;if(1===i.length)0===i[0]?(e[0]=this._getIntersection(e[1],xt.set(.95,1,0).applyMat4(r)),e.push(this._getIntersection(e[3],yt.set(-1,-.95,0).applyMat4(r)))):1===i[0]?(e[1]=this._getIntersection(e[0],xt.set(-.95,1,0).applyMat4(r)),e.push(this._getIntersection(e[2],yt.set(1,-.95,0).applyMat4(r)))):2===i[0]?(e[2]=this._getIntersection(e[3],xt.set(-.95,-1,0).applyMat4(r)),e.push(this._getIntersection(e[1],yt.set(1,.95,0).applyMat4(r)))):3===i[0]&&(e[3]=this._getIntersection(e[2],xt.set(.95,-1,0).applyMat4(r)),e.push(this._getIntersection(e[0],yt.set(-1,.95,0).applyMat4(r))));else if(2===i.length)0===i[0]&&1===i[1]?(e[0]=this._getIntersection(e[3],xt.set(-1,-.95,0).applyMat4(r)),e[1]=this._getIntersection(e[2],yt.set(1,-.95,0).applyMat4(r))):1===i[0]&&2===i[1]?(e[1]=this._getIntersection(e[0],xt.set(-.95,1,0).applyMat4(r)),e[2]=this._getIntersection(e[3],yt.set(-.95,-1,0).applyMat4(r))):2===i[0]&&3===i[1]?(e[2]=this._getIntersection(e[1],xt.set(1,.95,0).applyMat4(r)),e[3]=this._getIntersection(e[0],yt.set(-1,.95,0).applyMat4(r))):0===i[0]&&3===i[1]&&(e[0]=this._getIntersection(e[1],xt.set(.95,1,0).applyMat4(r)),e[3]=this._getIntersection(e[2],yt.set(.95,-1,0).applyMat4(r)));else if(3===i.length){let s=0;for(let e=0;e<t.length;e++)i.includes(e)||(s=e);e=[e[s]],0===s?(e.push(this._getIntersection(e[0],xt.set(-.95,1,0).applyMat4(r))),e.push(this._getIntersection(e[0],yt.set(-1,.95,0).applyMat4(r)))):1===s?(e.push(this._getIntersection(e[0],xt.set(.95,1,0).applyMat4(r))),e.push(this._getIntersection(e[0],yt.set(1,.95,0).applyMat4(r)))):2===s?(e.push(this._getIntersection(e[0],xt.set(.95,-1,0).applyMat4(r))),e.push(this._getIntersection(e[0],yt.set(1,-.95,0).applyMat4(r)))):3===s&&(e.push(this._getIntersection(e[0],xt.set(-.95,-1,0).applyMat4(r))),e.push(this._getIntersection(e[0],yt.set(-1.95,0).applyMat4(r))))}else for(let i=0;i<t.length;i++)e[i][0]=1e4,e[i][1]=1e4;return e}_getWorldCoords(){const t=[mt.set(-1,1,0),ft.set(1,1,0),gt.set(1,-1,0),vt.set(-1,-1,0)];let e=[],i=[];for(let r=0;r<t.length;r++){const s=t[r].applyMat4(this._matrices.modelViewProjection.matrix);e.push(s),Math.abs(s.z)>1&&i.push(r)}i.length&&(e=this._getNearPlaneIntersections(t,e,i));let r=Infinity,s=-Infinity,n=Infinity,a=-Infinity;for(let t=0;t<e.length;t++){const i=e[t];i.x<r&&(r=i.x),i.x>s&&(s=i.x),i.y<n&&(n=i.y),i.y>a&&(a=i.y)}return{top:a,right:s,bottom:n,left:r}}_computeWebGLBoundingRect(){const t=this._getWorldCoords();let e={top:1-(t.top+1)/2,right:(t.right+1)/2,bottom:1-(t.bottom+1)/2,left:(t.left+1)/2};e.width=e.right-e.left,e.height=e.bottom-e.top,this._boundingRect.worldToDocument={width:e.width*this.renderer._boundingRect.width,height:e.height*this.renderer._boundingRect.height,top:e.top*this.renderer._boundingRect.height+this.renderer._boundingRect.top,left:e.left*this.renderer._boundingRect.width+this.renderer._boundingRect.left,right:e.left*this.renderer._boundingRect.width+this.renderer._boundingRect.left+e.width*this.renderer._boundingRect.width,bottom:e.top*this.renderer._boundingRect.height+this.renderer._boundingRect.top+e.height*this.renderer._boundingRect.height}}getWebGLBoundingRect(){return this._matrices.modelViewProjection?(this._boundingRect.worldToDocument&&!this.alwaysDraw||this._computeWebGLBoundingRect(),this._boundingRect.worldToDocument):this._boundingRect.document}_getWebGLDrawRect(){return this._computeWebGLBoundingRect(),{top:this._boundingRect.worldToDocument.top-this.drawCheckMargins.top,right:this._boundingRect.worldToDocument.right+this.drawCheckMargins.right,bottom:this._boundingRect.worldToDocument.bottom+this.drawCheckMargins.bottom,left:this._boundingRect.worldToDocument.left-this.drawCheckMargins.left}}_shouldDrawCheck(){const t=this._getWebGLDrawRect();Math.round(t.right)<=this.renderer._boundingRect.left||Math.round(t.left)>=this.renderer._boundingRect.left+this.renderer._boundingRect.width||Math.round(t.bottom)<=this.renderer._boundingRect.top||Math.round(t.top)>=this.renderer._boundingRect.top+this.renderer._boundingRect.height?this._shouldDraw&&(this._shouldDraw=!1,this.renderer.nextRender.add(()=>this._onLeaveViewCallback&&this._onLeaveViewCallback())):(this._shouldDraw||this.renderer.nextRender.add(()=>this._onReEnterViewCallback&&this._onReEnterViewCallback()),this._shouldDraw=!0)}isDrawn(){return this._canDraw&&this.visible&&(this._shouldDraw||this.alwaysDraw)}enableDepthTest(t){this._depthTest=t}_initSources(){let t=0;if(this.autoloadSources){const e=this.htmlElement.getElementsByTagName("img"),i=this.htmlElement.getElementsByTagName("video"),r=this.htmlElement.getElementsByTagName("canvas");e.length&&this.loadImages(e),i.length&&this.loadVideos(i),r.length&&this.loadCanvases(r),t=e.length+i.length+r.length}this.loader._setLoaderSize(t),this._canDraw=!0}_startDrawing(){this._canDraw&&(this._onRenderCallback&&this._onRenderCallback(),this.target?this.renderer.bindFrameBuffer(this.target):null===this.renderer.state.scenePassIndex&&this.renderer.bindFrameBuffer(null),this._setPerspectiveMatrix(),this._setMVMatrix(),(this.alwaysDraw||this._shouldDraw)&&this.visible&&this._draw())}mouseToPlaneCoords(t){if(bt.setAxisOrder(this.quaternion.axisOrder),bt.equals(this.quaternion)&&wt.equals(this.transformOrigin))return super.mouseToPlaneCoords(t);{const e={x:t.x/(this.renderer._boundingRect.width/this.renderer.pixelRatio)*2-1,y:2*(1-t.y/(this.renderer._boundingRect.height/this.renderer.pixelRatio))-1},i=this.camera.position.clone(),r=Tt.set(e.x,e.y,-.5);r.unproject(this.camera),r.sub(i).normalize();const s=Rt.set(0,0,-1);s.applyQuat(this.quaternion).normalize();const n=St.set(0,0,0),a=s.dot(r);if(Math.abs(a)>=1e-4){const t=this._matrices.world.matrix.getInverse().multiply(this.camera.viewMatrix),e=this._boundingRect.world.transformOrigin.clone().add(this._translation),o=Pt.set(this._translation.x-e.x,this._translation.y-e.y,this._translation.z-e.z);o.applyQuat(this.quaternion),e.add(o);const h=s.dot(e.clone().sub(i))/a;n.copy(i.add(r.multiplyScalar(h))),n.applyMat4(t)}else n.set(Infinity,Infinity,Infinity);return Ct.set(n.x,n.y)}}onReEnterView(t){return t&&(this._onReEnterViewCallback=t),this}onLeaveView(t){return t&&(this._onLeaveViewCallback=t),this}}function Et(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function At(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var kt,Ot,Dt,Ft,zt,Lt,It,Ut,Vt,Nt,Bt,Wt,Gt,Xt,jt,Yt,qt,Ht={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Zt={duration:.5,overwrite:!1,delay:0},Qt=1e8,$t=1e-8,Kt=2*Math.PI,Jt=Kt/4,te=0,ee=Math.sqrt,ie=Math.cos,re=Math.sin,se=function(t){return"string"==typeof t},ne=function(t){return"function"==typeof t},ae=function(t){return"number"==typeof t},oe=function(t){return void 0===t},he=function(t){return"object"==typeof t},le=function(t){return!1!==t},ue=function(){return"undefined"!=typeof window},de=function(t){return ne(t)||se(t)},ce="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},pe=Array.isArray,_e=/(?:-?\.?\d|\.)+/gi,me=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,fe=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,ge=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,ve=/[+-]=-?[.\d]+/,xe=/[^,'"\[\]\s]+/gi,ye=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,be={},we={},Te=function(t){return(we=Ke(t,be))&&Kr},Re=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},Pe=function(t,e){return!e&&console.warn(t)},Se=function(t,e){return t&&(be[t]=e)&&we&&(we[t]=e)||be},Ce=function(){return 0},Me={suppressEvents:!0,isStart:!0,kill:!1},Ee={suppressEvents:!0,kill:!1},Ae={suppressEvents:!0},ke={},Oe=[],De={},Fe={},ze={},Le=30,Ie=[],Ue="",Ve=function(t){var e,i,r=t[0];if(he(r)||ne(r)||(t=[t]),!(e=(r._gsap||{}).harness)){for(i=Ie.length;i--&&!Ie[i].targetTest(r););e=Ie[i]}for(i=t.length;i--;)t[i]&&(t[i]._gsap||(t[i]._gsap=new cr(t[i],e)))||t.splice(i,1);return t},Ne=function(t){return t._gsap||Ve(Ei(t))[0]._gsap},Be=function(t,e,i){return(i=t[e])&&ne(i)?t[e]():oe(i)&&t.getAttribute&&t.getAttribute(e)||i},We=function(t,e){return(t=t.split(",")).forEach(e)||t},Ge=function(t){return Math.round(1e5*t)/1e5||0},Xe=function(t){return Math.round(1e7*t)/1e7||0},je=function(t,e){var i=e.charAt(0),r=parseFloat(e.substr(2));return t=parseFloat(t),"+"===i?t+r:"-"===i?t-r:"*"===i?t*r:t/r},Ye=function(t,e){for(var i=e.length,r=0;t.indexOf(e[r])<0&&++r<i;);return r<i},qe=function(){var t,e,i=Oe.length,r=Oe.slice(0);for(De={},Oe.length=0,t=0;t<i;t++)(e=r[t])&&e._lazy&&(e.render(e._lazy[0],e._lazy[1],!0)._lazy=0)},He=function(t,e,i,r){Oe.length&&!Ot&&qe(),t.render(e,i,r||Ot&&e<0&&(t._initted||t._startAt)),Oe.length&&!Ot&&qe()},Ze=function(t){var e=parseFloat(t);return(e||0===e)&&(t+"").match(xe).length<2?e:se(t)?t.trim():t},Qe=function(t){return t},$e=function(t,e){for(var i in e)i in t||(t[i]=e[i]);return t},Ke=function(t,e){for(var i in e)t[i]=e[i];return t},Je=function t(e,i){for(var r in i)"__proto__"!==r&&"constructor"!==r&&"prototype"!==r&&(e[r]=he(i[r])?t(e[r]||(e[r]={}),i[r]):i[r]);return e},ti=function(t,e){var i,r={};for(i in t)i in e||(r[i]=t[i]);return r},ei=function(t){var e,i=t.parent||Ft,r=t.keyframes?(e=pe(t.keyframes),function(t,i){for(var r in i)r in t||"duration"===r&&e||"ease"===r||(t[r]=i[r])}):$e;if(le(t.inherit))for(;i;)r(t,i.vars.defaults),i=i.parent||i._dp;return t},ii=function(t,e,i,r,s){void 0===i&&(i="_first"),void 0===r&&(r="_last");var n,a=t[r];if(s)for(n=e[s];a&&a[s]>n;)a=a._prev;return a?(e._next=a._next,a._next=e):(e._next=t[i],t[i]=e),e._next?e._next._prev=e:t[r]=e,e._prev=a,e.parent=e._dp=t,e},ri=function(t,e,i,r){void 0===i&&(i="_first"),void 0===r&&(r="_last");var s=e._prev,n=e._next;s?s._next=n:t[i]===e&&(t[i]=n),n?n._prev=s:t[r]===e&&(t[r]=s),e._next=e._prev=e.parent=null},si=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove&&t.parent.remove(t),t._act=0},ni=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var i=t;i;)i._dirty=1,i=i.parent;return t},ai=function(t,e,i,r){return t._startAt&&(Ot?t._startAt.revert(Ee):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(e,!0,r))},oi=function t(e){return!e||e._ts&&t(e.parent)},hi=function(t){return t._repeat?li(t._tTime,t=t.duration()+t._rDelay)*t:0},li=function(t,e){var i=Math.floor(t=Xe(t/e));return t&&i===t?i-1:i},ui=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},di=function(t){return t._end=Xe(t._start+(t._tDur/Math.abs(t._ts||t._rts||$t)||0))},ci=function(t,e){var i=t._dp;return i&&i.smoothChildTiming&&t._ts&&(t._start=Xe(i._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),di(t),i._dirty||ni(i,t)),t},pi=function(t,e){var i;if((e._time||!e._dur&&e._initted||e._start<t._time&&(e._dur||!e.add))&&(i=ui(t.rawTime(),e),(!e._dur||Pi(0,e.totalDuration(),i)-e._tTime>$t)&&e.render(i,!0)),ni(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(i=t;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;t._zTime=-1e-8}},_i=function(t,e,i,r){return e.parent&&si(e),e._start=Xe((ae(i)?i:i||t!==Ft?wi(t,i,e):t._time)+e._delay),e._end=Xe(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),ii(t,e,"_first","_last",t._sort?"_start":0),vi(e)||(t._recent=e),r||pi(t,e),t._ts<0&&ci(t,t._tTime),t},mi=function(t,e){return(be.ScrollTrigger||Re("scrollTrigger",e))&&be.ScrollTrigger.create(e,t)},fi=function(t,e,i,r,s){return yr(t,e,s),t._initted?!i&&t._pt&&!Ot&&(t._dur&&!1!==t.vars.lazy||!t._dur&&t.vars.lazy)&&Vt!==Ji.frame?(Oe.push(t),t._lazy=[s,r],1):void 0:1},gi=function t(e){var i=e.parent;return i&&i._ts&&i._initted&&!i._lock&&(i.rawTime()<0||t(i))},vi=function(t){var e=t.data;return"isFromStart"===e||"isStart"===e},xi=function(t,e,i,r){var s=t._repeat,n=Xe(e)||0,a=t._tTime/t._tDur;return a&&!r&&(t._time*=n/t._dur),t._dur=n,t._tDur=s?s<0?1e10:Xe(n*(s+1)+t._rDelay*s):n,a>0&&!r&&ci(t,t._tTime=t._tDur*a),t.parent&&di(t),i||ni(t.parent,t),t},yi=function(t){return t instanceof _r?ni(t):xi(t,t._dur)},bi={_start:0,endTime:Ce,totalDuration:Ce},wi=function t(e,i,r){var s,n,a,o=e.labels,h=e._recent||bi,l=e.duration()>=Qt?h.endTime(!1):e._dur;return se(i)&&(isNaN(i)||i in o)?(n=i.charAt(0),a="%"===i.substr(-1),s=i.indexOf("="),"<"===n||">"===n?(s>=0&&(i=i.replace(/=/,"")),("<"===n?h._start:h.endTime(h._repeat>=0))+(parseFloat(i.substr(1))||0)*(a?(s<0?h:r).totalDuration()/100:1)):s<0?(i in o||(o[i]=l),o[i]):(n=parseFloat(i.charAt(s-1)+i.substr(s+1)),a&&r&&(n=n/100*(pe(r)?r[0]:r).totalDuration()),s>1?t(e,i.substr(0,s-1),r)+n:l+n)):null==i?l:+i},Ti=function(t,e,i){var r,s,n=ae(e[1]),a=(n?2:1)+(t<2?0:1),o=e[a];if(n&&(o.duration=e[1]),o.parent=i,t){for(r=o,s=i;s&&!("immediateRender"in r);)r=s.vars.defaults||{},s=le(s.vars.inherit)&&s.parent;o.immediateRender=le(r.immediateRender),t<2?o.runBackwards=1:o.startAt=e[a-1]}return new Pr(e[0],o,e[a+1])},Ri=function(t,e){return t||0===t?e(t):e},Pi=function(t,e,i){return i<t?t:i>e?e:i},Si=function(t,e){return se(t)&&(e=ye.exec(t))?e[1]:""},Ci=[].slice,Mi=function(t,e){return t&&he(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&he(t[0]))&&!t.nodeType&&t!==zt},Ei=function(t,e,i){return Dt&&!e&&Dt.selector?Dt.selector(t):!se(t)||i||!Lt&&tr()?pe(t)?function(t,e,i){return void 0===i&&(i=[]),t.forEach(function(t){var r;return se(t)&&!e||Mi(t,1)?(r=i).push.apply(r,Ei(t)):i.push(t)})||i}(t,i):Mi(t)?Ci.call(t,0):t?[t]:[]:Ci.call((e||It).querySelectorAll(t),0)},Ai=function(t){return t=Ei(t)[0]||Pe("Invalid scope")||{},function(e){var i=t.current||t.nativeElement||t;return Ei(e,i.querySelectorAll?i:i===t?Pe("Invalid scope")||It.createElement("div"):t)}},ki=function(t){return t.sort(function(){return.5-Math.random()})},Oi=function(t){if(ne(t))return t;var e=he(t)?t:{each:t},i=or(e.ease),r=e.from||0,s=parseFloat(e.base)||0,n={},a=r>0&&r<1,o=isNaN(r)||a,h=e.axis,l=r,u=r;return se(r)?l=u={center:.5,edges:.5,end:1}[r]||0:!a&&o&&(l=r[0],u=r[1]),function(t,a,d){var c,p,_,m,f,g,v,x,y,b=(d||e).length,w=n[b];if(!w){if(!(y="auto"===e.grid?0:(e.grid||[1,Qt])[1])){for(v=-1e8;v<(v=d[y++].getBoundingClientRect().left)&&y<b;);y<b&&y--}for(w=n[b]=[],c=o?Math.min(y,b)*l-.5:r%y,p=y===Qt?0:o?b*u/y-.5:r/y|0,v=0,x=Qt,g=0;g<b;g++)_=g%y-c,m=p-(g/y|0),w[g]=f=h?Math.abs("y"===h?m:_):ee(_*_+m*m),f>v&&(v=f),f<x&&(x=f);"random"===r&&ki(w),w.max=v-x,w.min=x,w.v=b=(parseFloat(e.amount)||parseFloat(e.each)*(y>b?b-1:h?"y"===h?b/y:y:Math.max(y,b/y))||0)*("edges"===r?-1:1),w.b=b<0?s-b:s,w.u=Si(e.amount||e.each)||0,i=i&&b<0?nr(i):i}return b=(w[t]-w.min)/w.max||0,Xe(w.b+(i?i(b):b)*w.v)+w.u}},Di=function(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(i){var r=Xe(Math.round(parseFloat(i)/t)*t*e);return(r-r%1)/e+(ae(i)?0:Si(i))}},Fi=function(t,e){var i,r,s=pe(t);return!s&&he(t)&&(i=s=t.radius||Qt,t.values?(t=Ei(t.values),(r=!ae(t[0]))&&(i*=i)):t=Di(t.increment)),Ri(e,s?ne(t)?function(e){return r=t(e),Math.abs(r-e)<=i?r:e}:function(e){for(var s,n,a=parseFloat(r?e.x:e),o=parseFloat(r?e.y:0),h=Qt,l=0,u=t.length;u--;)(s=r?(s=t[u].x-a)*s+(n=t[u].y-o)*n:Math.abs(t[u]-a))<h&&(h=s,l=u);return l=!i||h<=i?t[l]:e,r||l===e||ae(e)?l:l+Si(e)}:Di(t))},zi=function(t,e,i,r){return Ri(pe(t)?!e:!0===i?!!(i=0):!r,function(){return pe(t)?t[~~(Math.random()*t.length)]:(i=i||1e-5)&&(r=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((t-i/2+Math.random()*(e-t+.99*i))/i)*i*r)/r})},Li=function(t,e,i){return Ri(i,function(i){return t[~~e(i)]})},Ii=function(t){for(var e,i,r,s,n=0,a="";~(e=t.indexOf("random(",n));)r=t.indexOf(")",e),s="["===t.charAt(e+7),i=t.substr(e+7,r-e-7).match(s?xe:_e),a+=t.substr(n,e-n)+zi(s?i:+i[0],s?0:+i[1],+i[2]||1e-5),n=r+1;return a+t.substr(n,t.length-n)},Ui=function(t,e,i,r,s){var n=e-t,a=r-i;return Ri(s,function(e){return i+((e-t)/n*a||0)})},Vi=function(t,e,i){var r,s,n,a=t.labels,o=Qt;for(r in a)(s=a[r]-e)<0==!!i&&s&&o>(s=Math.abs(s))&&(n=r,o=s);return n},Ni=function(t,e,i){var r,s,n,a=t.vars,o=a[e],h=Dt,l=t._ctx;if(o)return r=a[e+"Params"],s=a.callbackScope||t,i&&Oe.length&&qe(),l&&(Dt=l),n=r?o.apply(s,r):o.call(s),Dt=h,n},Bi=function(t){return si(t),t.scrollTrigger&&t.scrollTrigger.kill(!!Ot),t.progress()<1&&Ni(t,"onInterrupt"),t},Wi=[],Gi=function(t){if(t)if(t=!t.name&&t.default||t,ue()||t.headless){var e=t.name,i=ne(t),r=e&&!i&&t.init?function(){this._props=[]}:t,s={init:Ce,render:Fr,add:vr,kill:Lr,modifier:zr,rawVars:0},n={targetTest:0,get:0,getSetter:Ar,aliases:{},register:0};if(tr(),t!==r){if(Fe[e])return;$e(r,$e(ti(t,s),n)),Ke(r.prototype,Ke(s,ti(t,n))),Fe[r.prop=e]=r,t.targetTest&&(Ie.push(r),ke[e]=1),e=("css"===e?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}Se(e,r),t.register&&t.register(Kr,r,Vr)}else Wi.push(t)},Xi=255,ji={aqua:[0,Xi,Xi],lime:[0,Xi,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Xi],navy:[0,0,128],white:[Xi,Xi,Xi],olive:[128,128,0],yellow:[Xi,Xi,0],orange:[Xi,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Xi,0,0],pink:[Xi,192,203],cyan:[0,Xi,Xi],transparent:[Xi,Xi,Xi,0]},Yi=function(t,e,i){return(6*(t+=t<0?1:t>1?-1:0)<1?e+(i-e)*t*6:t<.5?i:3*t<2?e+(i-e)*(2/3-t)*6:e)*Xi+.5|0},qi=function(t,e,i){var r,s,n,a,o,h,l,u,d,c,p=t?ae(t)?[t>>16,t>>8&Xi,t&Xi]:0:ji.black;if(!p){if(","===t.substr(-1)&&(t=t.substr(0,t.length-1)),ji[t])p=ji[t];else if("#"===t.charAt(0)){if(t.length<6&&(r=t.charAt(1),s=t.charAt(2),n=t.charAt(3),t="#"+r+r+s+s+n+n+(5===t.length?t.charAt(4)+t.charAt(4):"")),9===t.length)return[(p=parseInt(t.substr(1,6),16))>>16,p>>8&Xi,p&Xi,parseInt(t.substr(7),16)/255];p=[(t=parseInt(t.substr(1),16))>>16,t>>8&Xi,t&Xi]}else if("hsl"===t.substr(0,3))if(p=c=t.match(_e),e){if(~t.indexOf("="))return p=t.match(me),i&&p.length<4&&(p[3]=1),p}else a=+p[0]%360/360,o=+p[1]/100,r=2*(h=+p[2]/100)-(s=h<=.5?h*(o+1):h+o-h*o),p.length>3&&(p[3]*=1),p[0]=Yi(a+1/3,r,s),p[1]=Yi(a,r,s),p[2]=Yi(a-1/3,r,s);else p=t.match(_e)||ji.transparent;p=p.map(Number)}return e&&!c&&(r=p[0]/Xi,s=p[1]/Xi,n=p[2]/Xi,h=((l=Math.max(r,s,n))+(u=Math.min(r,s,n)))/2,l===u?a=o=0:(d=l-u,o=h>.5?d/(2-l-u):d/(l+u),a=l===r?(s-n)/d+(s<n?6:0):l===s?(n-r)/d+2:(r-s)/d+4,a*=60),p[0]=~~(a+.5),p[1]=~~(100*o+.5),p[2]=~~(100*h+.5)),i&&p.length<4&&(p[3]=1),p},Hi=function(t){var e=[],i=[],r=-1;return t.split(Qi).forEach(function(t){var s=t.match(fe)||[];e.push.apply(e,s),i.push(r+=s.length+1)}),e.c=i,e},Zi=function(t,e,i){var r,s,n,a,o="",h=(t+o).match(Qi),l=e?"hsla(":"rgba(",u=0;if(!h)return t;if(h=h.map(function(t){return(t=qi(t,e,1))&&l+(e?t[0]+","+t[1]+"%,"+t[2]+"%,"+t[3]:t.join(","))+")"}),i&&(n=Hi(t),(r=i.c).join(o)!==n.c.join(o)))for(a=(s=t.replace(Qi,"1").split(fe)).length-1;u<a;u++)o+=s[u]+(~r.indexOf(u)?h.shift()||l+"0,0,0,0)":(n.length?n:h.length?h:i).shift());if(!s)for(a=(s=t.split(Qi)).length-1;u<a;u++)o+=s[u]+h[u];return o+s[a]},Qi=function(){var t,e="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(t in ji)e+="|"+t+"\\b";return new RegExp(e+")","gi")}(),$i=/hsl[a]?\(/,Ki=function(t){var e,i=t.join(" ");if(Qi.lastIndex=0,Qi.test(i))return e=$i.test(i),t[1]=Zi(t[1],e),t[0]=Zi(t[0],e,Hi(t[1])),!0},Ji=function(){var t,e,i,r,s,n,a=Date.now,o=500,h=33,l=a(),u=l,d=1e3/240,c=d,p=[],_=function i(_){var m,f,g,v,x=a()-u,y=!0===_;if((x>o||x<0)&&(l+=x-h),((m=(g=(u+=x)-l)-c)>0||y)&&(v=++r.frame,s=g-1e3*r.time,r.time=g/=1e3,c+=m+(m>=d?4:d-m),f=1),y||(t=e(i)),f)for(n=0;n<p.length;n++)p[n](g,s,v,_)};return r={time:0,frame:0,tick:function(){_(!0)},deltaRatio:function(t){return s/(1e3/(t||60))},wake:function(){Ut&&(!Lt&&ue()&&(zt=Lt=window,It=zt.document||{},be.gsap=Kr,(zt.gsapVersions||(zt.gsapVersions=[])).push(Kr.version),Te(we||zt.GreenSockGlobals||!zt.gsap&&zt||{}),Wi.forEach(Gi)),i="undefined"!=typeof requestAnimationFrame&&requestAnimationFrame,t&&r.sleep(),e=i||function(t){return setTimeout(t,c-1e3*r.time+1|0)},Bt=1,_(2))},sleep:function(){(i?cancelAnimationFrame:clearTimeout)(t),Bt=0,e=Ce},lagSmoothing:function(t,e){o=t||Infinity,h=Math.min(e||33,o)},fps:function(t){c=1e3*r.time+(d=1e3/(t||240))},add:function(t,e,i){var s=e?function(e,i,n,a){t(e,i,n,a),r.remove(s)}:t;return r.remove(t),p[i?"unshift":"push"](s),tr(),s},remove:function(t,e){~(e=p.indexOf(t))&&p.splice(e,1)&&n>=e&&n--},_listeners:p}}(),tr=function(){return!Bt&&Ji.wake()},er={},ir=/^[\d.\-M][\d.\-,\s]/,rr=/["']/g,sr=function(t){for(var e,i,r,s={},n=t.substr(1,t.length-3).split(":"),a=n[0],o=1,h=n.length;o<h;o++)i=n[o],e=o!==h-1?i.lastIndexOf(","):i.length,r=i.substr(0,e),s[a]=isNaN(r)?r.replace(rr,"").trim():+r,a=i.substr(e+1).trim();return s},nr=function(t){return function(e){return 1-t(1-e)}},ar=function t(e,i){for(var r,s=e._first;s;)s instanceof _r?t(s,i):!s.vars.yoyoEase||s._yoyo&&s._repeat||s._yoyo===i||(s.timeline?t(s.timeline,i):(r=s._ease,s._ease=s._yEase,s._yEase=r,s._yoyo=i)),s=s._next},or=function(t,e){return t&&(ne(t)?t:er[t]||function(t){var e,i,r,s,n=(t+"").split("("),a=er[n[0]];return a&&n.length>1&&a.config?a.config.apply(null,~t.indexOf("{")?[sr(n[1])]:(e=t,i=e.indexOf("(")+1,r=e.indexOf(")"),s=e.indexOf("(",i),e.substring(i,~s&&s<r?e.indexOf(")",r+1):r)).split(",").map(Ze)):er._CE&&ir.test(t)?er._CE("",t):a}(t))||e},hr=function(t,e,i,r){void 0===i&&(i=function(t){return 1-e(1-t)}),void 0===r&&(r=function(t){return t<.5?e(2*t)/2:1-e(2*(1-t))/2});var s,n={easeIn:e,easeOut:i,easeInOut:r};return We(t,function(t){for(var e in er[t]=be[t]=n,er[s=t.toLowerCase()]=i,n)er[s+("easeIn"===e?".in":"easeOut"===e?".out":".inOut")]=er[t+"."+e]=n[e]}),n},lr=function(t){return function(e){return e<.5?(1-t(1-2*e))/2:.5+t(2*(e-.5))/2}},ur=function t(e,i,r){var s=i>=1?i:1,n=(r||(e?.3:.45))/(i<1?i:1),a=n/Kt*(Math.asin(1/s)||0),o=function(t){return 1===t?1:s*Math.pow(2,-10*t)*re((t-a)*n)+1},h="out"===e?o:"in"===e?function(t){return 1-o(1-t)}:lr(o);return n=Kt/n,h.config=function(i,r){return t(e,i,r)},h},dr=function t(e,i){void 0===i&&(i=1.70158);var r=function(t){return t?--t*t*((i+1)*t+i)+1:0},s="out"===e?r:"in"===e?function(t){return 1-r(1-t)}:lr(r);return s.config=function(i){return t(e,i)},s};We("Linear,Quad,Cubic,Quart,Quint,Strong",function(t,e){var i=e<5?e+1:e;hr(t+",Power"+(i-1),e?function(t){return Math.pow(t,i)}:function(t){return t},function(t){return 1-Math.pow(1-t,i)},function(t){return t<.5?Math.pow(2*t,i)/2:1-Math.pow(2*(1-t),i)/2})}),er.Linear.easeNone=er.none=er.Linear.easeIn,hr("Elastic",ur("in"),ur("out"),ur()),Wt=7.5625,jt=2*(Xt=1/(Gt=2.75)),Yt=2.5*Xt,hr("Bounce",function(t){return 1-qt(1-t)},qt=function(t){return t<Xt?Wt*t*t:t<jt?Wt*Math.pow(t-1.5/Gt,2)+.75:t<Yt?Wt*(t-=2.25/Gt)*t+.9375:Wt*Math.pow(t-2.625/Gt,2)+.984375}),hr("Expo",function(t){return Math.pow(2,10*(t-1))*t+t*t*t*t*t*t*(1-t)}),hr("Circ",function(t){return-(ee(1-t*t)-1)}),hr("Sine",function(t){return 1===t?1:1-ie(t*Jt)}),hr("Back",dr("in"),dr("out"),dr()),er.SteppedEase=er.steps=be.SteppedEase={config:function(t,e){void 0===t&&(t=1);var i=1/t,r=t+(e?0:1),s=e?1:0;return function(t){return((r*Pi(0,.99999999,t)|0)+s)*i}}},Zt.ease=er["quad.out"],We("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(t){return Ue+=t+","+t+"Params,"});var cr=function(t,e){this.id=te++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:Be,this.set=e?e.getSetter:Ar},pr=/*#__PURE__*/function(){function t(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=Infinity===t.repeat?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,xi(this,+t.duration,1,1),this.data=t.data,Dt&&(this._ctx=Dt,Dt.data.push(this)),Bt||Ji.wake()}var e=t.prototype;return e.delay=function(t){return t||0===t?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+t-this._delay),this._delay=t,this):this._delay},e.duration=function(t){return arguments.length?this.totalDuration(this._repeat>0?t+(t+this._rDelay)*this._repeat:t):this.totalDuration()&&this._dur},e.totalDuration=function(t){return arguments.length?(this._dirty=0,xi(this,this._repeat<0?t:(t-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(t,e){if(tr(),!arguments.length)return this._tTime;var i=this._dp;if(i&&i.smoothChildTiming&&this._ts){for(ci(this,t),!i._dp||i.parent||pi(i,this);i&&i.parent;)i.parent._time!==i._start+(i._ts>=0?i._tTime/i._ts:(i.totalDuration()-i._tTime)/-i._ts)&&i.totalTime(i._tTime,!0),i=i.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&t<this._tDur||this._ts<0&&t>0||!this._tDur&&!t)&&_i(this._dp,this,this._start-this._delay)}return(this._tTime!==t||!this._dur&&!e||this._initted&&Math.abs(this._zTime)===$t||!t&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=t),He(this,t,e)),this},e.time=function(t,e){return arguments.length?this.totalTime(Math.min(this.totalDuration(),t+hi(this))%(this._dur+this._rDelay)||(t?this._dur:0),e):this._time},e.totalProgress=function(t,e){return arguments.length?this.totalTime(this.totalDuration()*t,e):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},e.progress=function(t,e){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?t:1-t)+hi(this),e):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(t,e){var i=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(t-1)*i,e):this._repeat?li(this._tTime,i)+1:1},e.timeScale=function(t,e){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===t)return this;var i=this.parent&&this._ts?ui(this.parent._time,this):this._tTime;return this._rts=+t||0,this._ts=this._ps||-1e-8===t?0:this._rts,this.totalTime(Pi(-Math.abs(this._delay),this._tDur,i),!1!==e),di(this),function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t}(this)},e.paused=function(t){return arguments.length?(this._ps!==t&&(this._ps=t,t?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(tr(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==$t&&(this._tTime-=$t)))),this):this._ps},e.startTime=function(t){if(arguments.length){this._start=t;var e=this.parent||this._dp;return e&&(e._sort||!this.parent)&&_i(e,this,t-this._delay),this}return this._start},e.endTime=function(t){return this._start+(le(t)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(t){var e=this.parent||this._dp;return e?t&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?ui(e.rawTime(t),this):this._tTime:this._tTime},e.revert=function(t){void 0===t&&(t=Ae);var e=Ot;return Ot=t,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(t),this.totalTime(-.01,t.suppressEvents)),"nested"!==this.data&&!1!==t.kill&&this.kill(),Ot=e,this},e.globalTime=function(t){for(var e=this,i=arguments.length?t:e.rawTime();e;)i=e._start+i/(Math.abs(e._ts)||1),e=e._dp;return!this.parent&&this._sat?this._sat.globalTime(t):i},e.repeat=function(t){return arguments.length?(this._repeat=Infinity===t?-2:t,yi(this)):-2===this._repeat?Infinity:this._repeat},e.repeatDelay=function(t){if(arguments.length){var e=this._time;return this._rDelay=t,yi(this),e?this.time(e):this}return this._rDelay},e.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},e.seek=function(t,e){return this.totalTime(wi(this,t),le(e))},e.restart=function(t,e){return this.play().totalTime(t?-this._delay:0,le(e)),this._dur||(this._zTime=-1e-8),this},e.play=function(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},e.reverse=function(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},e.pause=function(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(t){return arguments.length?(!!t!==this.reversed()&&this.timeScale(-this._rts||(t?-1e-8:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},e.isActive=function(){var t,e=this.parent||this._dp,i=this._start;return!(e&&!(this._ts&&this._initted&&e.isActive()&&(t=e.rawTime(!0))>=i&&t<this.endTime(!0)-$t))},e.eventCallback=function(t,e,i){var r=this.vars;return arguments.length>1?(e?(r[t]=e,i&&(r[t+"Params"]=i),"onUpdate"===t&&(this._onUpdate=e)):delete r[t],this):r[t]},e.then=function(t){var e=this;return new Promise(function(i){var r=ne(t)?t:Qe,s=function(){var t=e.then;e.then=null,ne(r)&&(r=r(e))&&(r.then||r===e)&&(e.then=t),i(r),e.then=t};e._initted&&1===e.totalProgress()&&e._ts>=0||!e._tTime&&e._ts<0?s():e._prom=s})},e.kill=function(){Bi(this)},t}();$e(pr.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var _r=/*#__PURE__*/function(t){function e(e,i){var r;return void 0===e&&(e={}),(r=t.call(this,e)||this).labels={},r.smoothChildTiming=!!e.smoothChildTiming,r.autoRemoveChildren=!!e.autoRemoveChildren,r._sort=le(e.sortChildren),Ft&&_i(e.parent||Ft,Et(r),i),e.reversed&&r.reverse(),e.paused&&r.paused(!0),e.scrollTrigger&&mi(Et(r),e.scrollTrigger),r}At(e,t);var i=e.prototype;return i.to=function(t,e,i){return Ti(0,arguments,this),this},i.from=function(t,e,i){return Ti(1,arguments,this),this},i.fromTo=function(t,e,i,r){return Ti(2,arguments,this),this},i.set=function(t,e,i){return e.duration=0,e.parent=this,ei(e).repeatDelay||(e.repeat=0),e.immediateRender=!!e.immediateRender,new Pr(t,e,wi(this,i),1),this},i.call=function(t,e,i){return _i(this,Pr.delayedCall(0,t,e),i)},i.staggerTo=function(t,e,i,r,s,n,a){return i.duration=e,i.stagger=i.stagger||r,i.onComplete=n,i.onCompleteParams=a,i.parent=this,new Pr(t,i,wi(this,s)),this},i.staggerFrom=function(t,e,i,r,s,n,a){return i.runBackwards=1,ei(i).immediateRender=le(i.immediateRender),this.staggerTo(t,e,i,r,s,n,a)},i.staggerFromTo=function(t,e,i,r,s,n,a,o){return r.startAt=i,ei(r).immediateRender=le(r.immediateRender),this.staggerTo(t,e,r,s,n,a,o)},i.render=function(t,e,i){var r,s,n,a,o,h,l,u,d,c,p,_,m=this._time,f=this._dirty?this.totalDuration():this._tDur,g=this._dur,v=t<=0?0:Xe(t),x=this._zTime<0!=t<0&&(this._initted||!g);if(this!==Ft&&v>f&&t>=0&&(v=f),v!==this._tTime||i||x){if(m!==this._time&&g&&(v+=this._time-m,t+=this._time-m),r=v,d=this._start,h=!(u=this._ts),x&&(g||(m=this._zTime),(t||!e)&&(this._zTime=t)),this._repeat){if(p=this._yoyo,o=g+this._rDelay,this._repeat<-1&&t<0)return this.totalTime(100*o+t,e,i);if(r=Xe(v%o),v===f?(a=this._repeat,r=g):((a=~~(c=Xe(v/o)))&&a===c&&(r=g,a--),r>g&&(r=g)),c=li(this._tTime,o),!m&&this._tTime&&c!==a&&this._tTime-c*o-this._dur<=0&&(c=a),p&&1&a&&(r=g-r,_=1),a!==c&&!this._lock){var y=p&&1&c,b=y===(p&&1&a);if(a<c&&(y=!y),m=y?0:v%g?g:v,this._lock=1,this.render(m||(_?0:Xe(a*o)),e,!g)._lock=0,this._tTime=v,!e&&this.parent&&Ni(this,"onRepeat"),this.vars.repeatRefresh&&!_&&(this.invalidate()._lock=1),m&&m!==this._time||h!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(g=this._dur,f=this._tDur,b&&(this._lock=2,this.render(m=y?g:-1e-4,!0),this.vars.repeatRefresh&&!_&&this.invalidate()),this._lock=0,!this._ts&&!h)return this;ar(this,_)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(l=function(t,e,i){var r;if(i>e)for(r=t._first;r&&r._start<=i;){if("isPause"===r.data&&r._start>e)return r;r=r._next}else for(r=t._last;r&&r._start>=i;){if("isPause"===r.data&&r._start<e)return r;r=r._prev}}(this,Xe(m),Xe(r)),l&&(v-=r-(r=l._start))),this._tTime=v,this._time=r,this._act=!u,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=t,m=0),!m&&r&&!e&&!a&&(Ni(this,"onStart"),this._tTime!==v))return this;if(r>=m&&t>=0)for(s=this._first;s;){if(n=s._next,(s._act||r>=s._start)&&s._ts&&l!==s){if(s.parent!==this)return this.render(t,e,i);if(s.render(s._ts>0?(r-s._start)*s._ts:(s._dirty?s.totalDuration():s._tDur)+(r-s._start)*s._ts,e,i),r!==this._time||!this._ts&&!h){l=0,n&&(v+=this._zTime=-1e-8);break}}s=n}else{s=this._last;for(var w=t<0?t:r;s;){if(n=s._prev,(s._act||w<=s._end)&&s._ts&&l!==s){if(s.parent!==this)return this.render(t,e,i);if(s.render(s._ts>0?(w-s._start)*s._ts:(s._dirty?s.totalDuration():s._tDur)+(w-s._start)*s._ts,e,i||Ot&&(s._initted||s._startAt)),r!==this._time||!this._ts&&!h){l=0,n&&(v+=this._zTime=w?-1e-8:$t);break}}s=n}}if(l&&!e&&(this.pause(),l.render(r>=m?0:-1e-8)._zTime=r>=m?1:-1,this._ts))return this._start=d,di(this),this.render(t,e,i);this._onUpdate&&!e&&Ni(this,"onUpdate",!0),(v===f&&this._tTime>=this.totalDuration()||!v&&m)&&(d!==this._start&&Math.abs(u)===Math.abs(this._ts)||this._lock||((t||!g)&&(v===f&&this._ts>0||!v&&this._ts<0)&&si(this,1),e||t<0&&!m||!v&&!m&&f||(Ni(this,v===f&&t>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(v<f&&this.timeScale()>0)&&this._prom())))}return this},i.add=function(t,e){var i=this;if(ae(e)||(e=wi(this,e,t)),!(t instanceof pr)){if(pe(t))return t.forEach(function(t){return i.add(t,e)}),this;if(se(t))return this.addLabel(t,e);if(!ne(t))return this;t=Pr.delayedCall(0,t)}return this!==t?_i(this,t,e):this},i.getChildren=function(t,e,i,r){void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===r&&(r=-1e8);for(var s=[],n=this._first;n;)n._start>=r&&(n instanceof Pr?e&&s.push(n):(i&&s.push(n),t&&s.push.apply(s,n.getChildren(!0,e,i)))),n=n._next;return s},i.getById=function(t){for(var e=this.getChildren(1,1,1),i=e.length;i--;)if(e[i].vars.id===t)return e[i]},i.remove=function(t){return se(t)?this.removeLabel(t):ne(t)?this.killTweensOf(t):(t.parent===this&&ri(this,t),t===this._recent&&(this._recent=this._last),ni(this))},i.totalTime=function(e,i){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Xe(Ji.time-(this._ts>0?e/this._ts:(this.totalDuration()-e)/-this._ts))),t.prototype.totalTime.call(this,e,i),this._forcing=0,this):this._tTime},i.addLabel=function(t,e){return this.labels[t]=wi(this,e),this},i.removeLabel=function(t){return delete this.labels[t],this},i.addPause=function(t,e,i){var r=Pr.delayedCall(0,e||Ce,i);return r.data="isPause",this._hasPause=1,_i(this,r,wi(this,t))},i.removePause=function(t){var e=this._first;for(t=wi(this,t);e;)e._start===t&&"isPause"===e.data&&si(e),e=e._next},i.killTweensOf=function(t,e,i){for(var r=this.getTweensOf(t,i),s=r.length;s--;)mr!==r[s]&&r[s].kill(t,e);return this},i.getTweensOf=function(t,e){for(var i,r=[],s=Ei(t),n=this._first,a=ae(e);n;)n instanceof Pr?Ye(n._targets,s)&&(a?(!mr||n._initted&&n._ts)&&n.globalTime(0)<=e&&n.globalTime(n.totalDuration())>e:!e||n.isActive())&&r.push(n):(i=n.getTweensOf(s,e)).length&&r.push.apply(r,i),n=n._next;return r},i.tweenTo=function(t,e){e=e||{};var i,r=this,s=wi(r,t),n=e.startAt,a=e.onStart,o=e.onStartParams,h=e.immediateRender,l=Pr.to(r,$e({ease:e.ease||"none",lazy:!1,immediateRender:!1,time:s,overwrite:"auto",duration:e.duration||Math.abs((s-(n&&"time"in n?n.time:r._time))/r.timeScale())||$t,onStart:function(){if(r.pause(),!i){var t=e.duration||Math.abs((s-(n&&"time"in n?n.time:r._time))/r.timeScale());l._dur!==t&&xi(l,t,0,1).render(l._time,!0,!0),i=1}a&&a.apply(l,o||[])}},e));return h?l.render(0):l},i.tweenFromTo=function(t,e,i){return this.tweenTo(e,$e({startAt:{time:wi(this,t)}},i))},i.recent=function(){return this._recent},i.nextLabel=function(t){return void 0===t&&(t=this._time),Vi(this,wi(this,t))},i.previousLabel=function(t){return void 0===t&&(t=this._time),Vi(this,wi(this,t),1)},i.currentLabel=function(t){return arguments.length?this.seek(t,!0):this.previousLabel(this._time+$t)},i.shiftChildren=function(t,e,i){void 0===i&&(i=0);for(var r,s=this._first,n=this.labels;s;)s._start>=i&&(s._start+=t,s._end+=t),s=s._next;if(e)for(r in n)n[r]>=i&&(n[r]+=t);return ni(this)},i.invalidate=function(e){var i=this._first;for(this._lock=0;i;)i.invalidate(e),i=i._next;return t.prototype.invalidate.call(this,e)},i.clear=function(t){void 0===t&&(t=!0);for(var e,i=this._first;i;)e=i._next,this.remove(i),i=e;return this._dp&&(this._time=this._tTime=this._pTime=0),t&&(this.labels={}),ni(this)},i.totalDuration=function(t){var e,i,r,s=0,n=this,a=n._last,o=Qt;if(arguments.length)return n.timeScale((n._repeat<0?n.duration():n.totalDuration())/(n.reversed()?-t:t));if(n._dirty){for(r=n.parent;a;)e=a._prev,a._dirty&&a.totalDuration(),(i=a._start)>o&&n._sort&&a._ts&&!n._lock?(n._lock=1,_i(n,a,i-a._delay,1)._lock=0):o=i,i<0&&a._ts&&(s-=i,(!r&&!n._dp||r&&r.smoothChildTiming)&&(n._start+=i/n._ts,n._time-=i,n._tTime-=i),n.shiftChildren(-i,!1,-Infinity),o=0),a._end>s&&a._ts&&(s=a._end),a=e;xi(n,n===Ft&&n._time>s?n._time:s,1,1),n._dirty=0}return n._tDur},e.updateRoot=function(t){if(Ft._ts&&(He(Ft,ui(t,Ft)),Vt=Ji.frame),Ji.frame>=Le){Le+=Ht.autoSleep||120;var e=Ft._first;if((!e||!e._ts)&&Ht.autoSleep&&Ji._listeners.length<2){for(;e&&!e._ts;)e=e._next;e||Ji.sleep()}}},e}(pr);$e(_r.prototype,{_lock:0,_hasPause:0,_forcing:0});var mr,fr,gr=function(t,e,i,r,s,n,a){var o,h,l,u,d,c,p,_,m=new Vr(this._pt,t,e,0,1,Dr,null,s),f=0,g=0;for(m.b=i,m.e=r,i+="",(p=~(r+="").indexOf("random("))&&(r=Ii(r)),n&&(n(_=[i,r],t,e),i=_[0],r=_[1]),h=i.match(ge)||[];o=ge.exec(r);)u=o[0],d=r.substring(f,o.index),l?l=(l+1)%5:"rgba("===d.substr(-5)&&(l=1),u!==h[g++]&&(c=parseFloat(h[g-1])||0,m._pt={_next:m._pt,p:d||1===g?d:",",s:c,c:"="===u.charAt(1)?je(c,u)-c:parseFloat(u)-c,m:l&&l<4?Math.round:0},f=ge.lastIndex);return m.c=f<r.length?r.substring(f,r.length):"",m.fp=a,(ve.test(r)||p)&&(m.e=0),this._pt=m,m},vr=function(t,e,i,r,s,n,a,o,h,l){ne(r)&&(r=r(s||0,t,n));var u,d=t[e],c="get"!==i?i:ne(d)?h?t[e.indexOf("set")||!ne(t["get"+e.substr(3)])?e:"get"+e.substr(3)](h):t[e]():d,p=ne(d)?h?Mr:Cr:Sr;if(se(r)&&(~r.indexOf("random(")&&(r=Ii(r)),"="===r.charAt(1)&&((u=je(c,r)+(Si(c)||0))||0===u)&&(r=u)),!l||c!==r||fr)return isNaN(c*r)||""===r?(!d&&!(e in t)&&Re(e,r),gr.call(this,t,e,c,r,p,o||Ht.stringFilter,h)):(u=new Vr(this._pt,t,e,+c||0,r-(c||0),"boolean"==typeof d?Or:kr,0,p),h&&(u.fp=h),a&&u.modifier(a,this,t),this._pt=u)},xr=function(t,e,i,r,s,n){var a,o,h,l;if(Fe[t]&&!1!==(a=new Fe[t]).init(s,a.rawVars?e[t]:function(t,e,i,r,s){if(ne(t)&&(t=wr(t,s,e,i,r)),!he(t)||t.style&&t.nodeType||pe(t)||ce(t))return se(t)?wr(t,s,e,i,r):t;var n,a={};for(n in t)a[n]=wr(t[n],s,e,i,r);return a}(e[t],r,s,n,i),i,r,n)&&(i._pt=o=new Vr(i._pt,s,t,0,1,a.render,a,0,a.priority),i!==Nt))for(h=i._ptLookup[i._targets.indexOf(s)],l=a._props.length;l--;)h[a._props[l]]=o;return a},yr=function t(e,i,r){var s,n,a,o,h,l,u,d,c,p,_,m,f,g=e.vars,v=g.ease,x=g.startAt,y=g.immediateRender,b=g.lazy,w=g.onUpdate,T=g.runBackwards,R=g.yoyoEase,P=g.keyframes,S=g.autoRevert,C=e._dur,M=e._startAt,E=e._targets,A=e.parent,k=A&&"nested"===A.data?A.vars.targets:E,O="auto"===e._overwrite&&!kt,D=e.timeline;if(D&&(!P||!v)&&(v="none"),e._ease=or(v,Zt.ease),e._yEase=R?nr(or(!0===R?v:R,Zt.ease)):0,R&&e._yoyo&&!e._repeat&&(R=e._yEase,e._yEase=e._ease,e._ease=R),e._from=!D&&!!g.runBackwards,!D||P&&!g.stagger){if(m=(d=E[0]?Ne(E[0]).harness:0)&&g[d.prop],s=ti(g,ke),M&&(M._zTime<0&&M.progress(1),i<0&&T&&y&&!S?M.render(-1,!0):M.revert(T&&C?Ee:Me),M._lazy=0),x){if(si(e._startAt=Pr.set(E,$e({data:"isStart",overwrite:!1,parent:A,immediateRender:!0,lazy:!M&&le(b),startAt:null,delay:0,onUpdate:w&&function(){return Ni(e,"onUpdate")},stagger:0},x))),e._startAt._dp=0,e._startAt._sat=e,i<0&&(Ot||!y&&!S)&&e._startAt.revert(Ee),y&&C&&i<=0&&r<=0)return void(i&&(e._zTime=i))}else if(T&&C&&!M)if(i&&(y=!1),a=$e({overwrite:!1,data:"isFromStart",lazy:y&&!M&&le(b),immediateRender:y,stagger:0,parent:A},s),m&&(a[d.prop]=m),si(e._startAt=Pr.set(E,a)),e._startAt._dp=0,e._startAt._sat=e,i<0&&(Ot?e._startAt.revert(Ee):e._startAt.render(-1,!0)),e._zTime=i,y){if(!i)return}else t(e._startAt,$t,$t);for(e._pt=e._ptCache=0,b=C&&le(b)||b&&!C,n=0;n<E.length;n++){if(u=(h=E[n])._gsap||Ve(E)[n]._gsap,e._ptLookup[n]=p={},De[u.id]&&Oe.length&&qe(),_=k===E?n:k.indexOf(h),d&&!1!==(c=new d).init(h,m||s,e,_,k)&&(e._pt=o=new Vr(e._pt,h,c.name,0,1,c.render,c,0,c.priority),c._props.forEach(function(t){p[t]=o}),c.priority&&(l=1)),!d||m)for(a in s)Fe[a]&&(c=xr(a,s,e,_,h,k))?c.priority&&(l=1):p[a]=o=vr.call(e,h,a,"get",s[a],_,k,0,g.stringFilter);e._op&&e._op[n]&&e.kill(h,e._op[n]),O&&e._pt&&(mr=e,Ft.killTweensOf(h,p,e.globalTime(i)),f=!e.parent,mr=0),e._pt&&b&&(De[u.id]=1)}l&&Ur(e),e._onInit&&e._onInit(e)}e._onUpdate=w,e._initted=(!e._op||e._pt)&&!f,P&&i<=0&&D.render(Qt,!0,!0)},br=function(t,e,i,r){var s,n,a=e.ease||r||"power1.inOut";if(pe(e))n=i[t]||(i[t]=[]),e.forEach(function(t,i){return n.push({t:i/(e.length-1)*100,v:t,e:a})});else for(s in e)n=i[s]||(i[s]=[]),"ease"===s||n.push({t:parseFloat(t),v:e[s],e:a})},wr=function(t,e,i,r,s){return ne(t)?t.call(e,i,r,s):se(t)&&~t.indexOf("random(")?Ii(t):t},Tr=Ue+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",Rr={};We(Tr+",id,stagger,delay,duration,paused,scrollTrigger",function(t){return Rr[t]=1});var Pr=/*#__PURE__*/function(t){function e(e,i,r,s){var n;"number"==typeof i&&(r.duration=i,i=r,r=null);var a,o,h,l,u,d,c,p,_=(n=t.call(this,s?i:ei(i))||this).vars,m=_.duration,f=_.delay,g=_.immediateRender,v=_.stagger,x=_.overwrite,y=_.keyframes,b=_.defaults,w=_.scrollTrigger,T=_.yoyoEase,R=i.parent||Ft,P=(pe(e)||ce(e)?ae(e[0]):"length"in i)?[e]:Ei(e);if(n._targets=P.length?Ve(P):Pe("GSAP target "+e+" not found. https://gsap.com",!Ht.nullTargetWarn)||[],n._ptLookup=[],n._overwrite=x,y||v||de(m)||de(f)){if(i=n.vars,(a=n.timeline=new _r({data:"nested",defaults:b||{},targets:R&&"nested"===R.data?R.vars.targets:P})).kill(),a.parent=a._dp=Et(n),a._start=0,v||de(m)||de(f)){if(l=P.length,c=v&&Oi(v),he(v))for(u in v)~Tr.indexOf(u)&&(p||(p={}),p[u]=v[u]);for(o=0;o<l;o++)(h=ti(i,Rr)).stagger=0,T&&(h.yoyoEase=T),p&&Ke(h,p),d=P[o],h.duration=+wr(m,Et(n),o,d,P),h.delay=(+wr(f,Et(n),o,d,P)||0)-n._delay,!v&&1===l&&h.delay&&(n._delay=f=h.delay,n._start+=f,h.delay=0),a.to(d,h,c?c(o,d,P):0),a._ease=er.none;a.duration()?m=f=0:n.timeline=0}else if(y){ei($e(a.vars.defaults,{ease:"none"})),a._ease=or(y.ease||i.ease||"none");var S,C,M,E=0;if(pe(y))y.forEach(function(t){return a.to(P,t,">")}),a.duration();else{for(u in h={},y)"ease"===u||"easeEach"===u||br(u,y[u],h,y.easeEach);for(u in h)for(S=h[u].sort(function(t,e){return t.t-e.t}),E=0,o=0;o<S.length;o++)(M={ease:(C=S[o]).e,duration:(C.t-(o?S[o-1].t:0))/100*m})[u]=C.v,a.to(P,M,E),E+=M.duration;a.duration()<m&&a.to({},{duration:m-a.duration()})}}m||n.duration(m=a.duration())}else n.timeline=0;return!0!==x||kt||(mr=Et(n),Ft.killTweensOf(P),mr=0),_i(R,Et(n),r),i.reversed&&n.reverse(),i.paused&&n.paused(!0),(g||!m&&!y&&n._start===Xe(R._time)&&le(g)&&oi(Et(n))&&"nested"!==R.data)&&(n._tTime=-1e-8,n.render(Math.max(0,-f)||0)),w&&mi(Et(n),w),n}At(e,t);var i=e.prototype;return i.render=function(t,e,i){var r,s,n,a,o,h,l,u,d,c=this._time,p=this._tDur,_=this._dur,m=t<0,f=t>p-$t&&!m?p:t<$t?0:t;if(_){if(f!==this._tTime||!t||i||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==m||this._lazy){if(r=f,u=this.timeline,this._repeat){if(a=_+this._rDelay,this._repeat<-1&&m)return this.totalTime(100*a+t,e,i);if(r=Xe(f%a),f===p?(n=this._repeat,r=_):(n=~~(o=Xe(f/a)))&&n===o?(r=_,n--):r>_&&(r=_),(h=this._yoyo&&1&n)&&(d=this._yEase,r=_-r),o=li(this._tTime,a),r===c&&!i&&this._initted&&n===o)return this._tTime=f,this;n!==o&&(u&&this._yEase&&ar(u,h),this.vars.repeatRefresh&&!h&&!this._lock&&r!==a&&this._initted&&(this._lock=i=1,this.render(Xe(a*n),!0).invalidate()._lock=0))}if(!this._initted){if(fi(this,m?t:r,i,e,f))return this._tTime=0,this;if(!(c===this._time||i&&this.vars.repeatRefresh&&n!==o))return this;if(_!==this._dur)return this.render(t,e,i)}if(this._tTime=f,this._time=r,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=l=(d||this._ease)(r/_),this._from&&(this.ratio=l=1-l),r&&!c&&!e&&!n&&(Ni(this,"onStart"),this._tTime!==f))return this;for(s=this._pt;s;)s.r(l,s.d),s=s._next;u&&u.render(t<0?t:u._dur*u._ease(r/this._dur),e,i)||this._startAt&&(this._zTime=t),this._onUpdate&&!e&&(m&&ai(this,t,0,i),Ni(this,"onUpdate")),this._repeat&&n!==o&&this.vars.onRepeat&&!e&&this.parent&&Ni(this,"onRepeat"),f!==this._tDur&&f||this._tTime!==f||(m&&!this._onUpdate&&ai(this,t,0,!0),(t||!_)&&(f===this._tDur&&this._ts>0||!f&&this._ts<0)&&si(this,1),e||m&&!c||!(f||c||h)||(Ni(this,f===p?"onComplete":"onReverseComplete",!0),this._prom&&!(f<p&&this.timeScale()>0)&&this._prom()))}}else!function(t,e,i,r){var s,n,a,o=t.ratio,h=e<0||!e&&(!t._start&&gi(t)&&(t._initted||!vi(t))||(t._ts<0||t._dp._ts<0)&&!vi(t))?0:1,l=t._rDelay,u=0;if(l&&t._repeat&&(u=Pi(0,t._tDur,e),n=li(u,l),t._yoyo&&1&n&&(h=1-h),n!==li(t._tTime,l)&&(o=1-h,t.vars.repeatRefresh&&t._initted&&t.invalidate())),h!==o||Ot||r||t._zTime===$t||!e&&t._zTime){if(!t._initted&&fi(t,e,r,i,u))return;for(a=t._zTime,t._zTime=e||(i?$t:0),i||(i=e&&!a),t.ratio=h,t._from&&(h=1-h),t._time=0,t._tTime=u,s=t._pt;s;)s.r(h,s.d),s=s._next;e<0&&ai(t,e,0,!0),t._onUpdate&&!i&&Ni(t,"onUpdate"),u&&t._repeat&&!i&&t.parent&&Ni(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===h&&(h&&si(t,1),i||Ot||(Ni(t,h?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)}(this,t,e,i);return this},i.targets=function(){return this._targets},i.invalidate=function(e){return(!e||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(e),t.prototype.invalidate.call(this,e)},i.resetTo=function(t,e,i,r,s){Bt||Ji.wake(),this._ts||this.play();var n=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||yr(this,n),function(t,e,i,r,s,n,a,o){var h,l,u,d,c=(t._pt&&t._ptCache||(t._ptCache={}))[e];if(!c)for(c=t._ptCache[e]=[],u=t._ptLookup,d=t._targets.length;d--;){if((h=u[d][e])&&h.d&&h.d._pt)for(h=h.d._pt;h&&h.p!==e&&h.fp!==e;)h=h._next;if(!h)return fr=1,t.vars[e]="+=0",yr(t,a),fr=0,o?Pe(e+" not eligible for reset"):1;c.push(h)}for(d=c.length;d--;)(h=(l=c[d])._pt||l).s=!r&&0!==r||s?h.s+(r||0)+n*h.c:r,h.c=i-h.s,l.e&&(l.e=Ge(i)+Si(l.e)),l.b&&(l.b=h.s+Si(l.b))}(this,t,e,i,r,this._ease(n/this._dur),n,s)?this.resetTo(t,e,i,r,1):(ci(this,0),this.parent||ii(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},i.kill=function(t,e){if(void 0===e&&(e="all"),!(t||e&&"all"!==e))return this._lazy=this._pt=0,this.parent?Bi(this):this.scrollTrigger&&this.scrollTrigger.kill(!!Ot),this;if(this.timeline){var i=this.timeline.totalDuration();return this.timeline.killTweensOf(t,e,mr&&!0!==mr.vars.overwrite)._first||Bi(this),this.parent&&i!==this.timeline.totalDuration()&&xi(this,this._dur*this.timeline._tDur/i,0,1),this}var r,s,n,a,o,h,l,u=this._targets,d=t?Ei(t):u,c=this._ptLookup,p=this._pt;if((!e||"all"===e)&&function(t,e){for(var i=t.length,r=i===e.length;r&&i--&&t[i]===e[i];);return i<0}(u,d))return"all"===e&&(this._pt=0),Bi(this);for(r=this._op=this._op||[],"all"!==e&&(se(e)&&(o={},We(e,function(t){return o[t]=1}),e=o),e=function(t,e){var i,r,s,n,a=t[0]?Ne(t[0]).harness:0,o=a&&a.aliases;if(!o)return e;for(r in i=Ke({},e),o)if(r in i)for(s=(n=o[r].split(",")).length;s--;)i[n[s]]=i[r];return i}(u,e)),l=u.length;l--;)if(~d.indexOf(u[l]))for(o in s=c[l],"all"===e?(r[l]=e,a=s,n={}):(n=r[l]=r[l]||{},a=e),a)(h=s&&s[o])&&("kill"in h.d&&!0!==h.d.kill(o)||ri(this,h,"_pt"),delete s[o]),"all"!==n&&(n[o]=1);return this._initted&&!this._pt&&p&&Bi(this),this},e.to=function(t,i){return new e(t,i,arguments[2])},e.from=function(t,e){return Ti(1,arguments)},e.delayedCall=function(t,i,r,s){return new e(i,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:t,onComplete:i,onReverseComplete:i,onCompleteParams:r,onReverseCompleteParams:r,callbackScope:s})},e.fromTo=function(t,e,i){return Ti(2,arguments)},e.set=function(t,i){return i.duration=0,i.repeatDelay||(i.repeat=0),new e(t,i)},e.killTweensOf=function(t,e,i){return Ft.killTweensOf(t,e,i)},e}(pr);$e(Pr.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),We("staggerTo,staggerFrom,staggerFromTo",function(t){Pr[t]=function(){var e=new _r,i=Ci.call(arguments,0);return i.splice("staggerFromTo"===t?5:4,0,0),e[t].apply(e,i)}});var Sr=function(t,e,i){return t[e]=i},Cr=function(t,e,i){return t[e](i)},Mr=function(t,e,i,r){return t[e](r.fp,i)},Er=function(t,e,i){return t.setAttribute(e,i)},Ar=function(t,e){return ne(t[e])?Cr:oe(t[e])&&t.setAttribute?Er:Sr},kr=function(t,e){return e.set(e.t,e.p,Math.round(1e6*(e.s+e.c*t))/1e6,e)},Or=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},Dr=function(t,e){var i=e._pt,r="";if(!t&&e.b)r=e.b;else if(1===t&&e.e)r=e.e;else{for(;i;)r=i.p+(i.m?i.m(i.s+i.c*t):Math.round(1e4*(i.s+i.c*t))/1e4)+r,i=i._next;r+=e.c}e.set(e.t,e.p,r,e)},Fr=function(t,e){for(var i=e._pt;i;)i.r(t,i.d),i=i._next},zr=function(t,e,i,r){for(var s,n=this._pt;n;)s=n._next,n.p===r&&n.modifier(t,e,i),n=s},Lr=function(t){for(var e,i,r=this._pt;r;)i=r._next,r.p===t&&!r.op||r.op===t?ri(this,r,"_pt"):r.dep||(e=1),r=i;return!e},Ir=function(t,e,i,r){r.mSet(t,e,r.m.call(r.tween,i,r.mt),r)},Ur=function(t){for(var e,i,r,s,n=t._pt;n;){for(e=n._next,i=r;i&&i.pr>n.pr;)i=i._next;(n._prev=i?i._prev:s)?n._prev._next=n:r=n,(n._next=i)?i._prev=n:s=n,n=e}t._pt=r},Vr=/*#__PURE__*/function(){function t(t,e,i,r,s,n,a,o,h){this.t=e,this.s=r,this.c=s,this.p=i,this.r=n||kr,this.d=a||this,this.set=o||Sr,this.pr=h||0,this._next=t,t&&(t._prev=this)}return t.prototype.modifier=function(t,e,i){this.mSet=this.mSet||this.set,this.set=Ir,this.m=t,this.mt=i,this.tween=e},t}();We(Ue+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(t){return ke[t]=1}),be.TweenMax=be.TweenLite=Pr,be.TimelineLite=be.TimelineMax=_r,Ft=new _r({sortChildren:!1,defaults:Zt,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),Ht.stringFilter=Ki;var Nr=[],Br={},Wr=[],Gr=0,Xr=0,jr=function(t){return(Br[t]||Wr).map(function(t){return t()})},Yr=function(){var t=Date.now(),e=[];t-Gr>2&&(jr("matchMediaInit"),Nr.forEach(function(t){var i,r,s,n,a=t.queries,o=t.conditions;for(r in a)(i=zt.matchMedia(a[r]).matches)&&(s=1),i!==o[r]&&(o[r]=i,n=1);n&&(t.revert(),s&&e.push(t))}),jr("matchMediaRevert"),e.forEach(function(t){return t.onMatch(t,function(e){return t.add(null,e)})}),Gr=t,jr("matchMedia"))},qr=/*#__PURE__*/function(){function t(t,e){this.selector=e&&Ai(e),this.data=[],this._r=[],this.isReverted=!1,this.id=Xr++,t&&this.add(t)}var e=t.prototype;return e.add=function(t,e,i){ne(t)&&(i=e,e=t,t=ne);var r=this,s=function(){var t,s=Dt,n=r.selector;return s&&s!==r&&s.data.push(r),i&&(r.selector=Ai(i)),Dt=r,t=e.apply(r,arguments),ne(t)&&r._r.push(t),Dt=s,r.selector=n,r.isReverted=!1,t};return r.last=s,t===ne?s(r,function(t){return r.add(null,t)}):t?r[t]=s:s},e.ignore=function(t){var e=Dt;Dt=null,t(this),Dt=e},e.getTweens=function(){var e=[];return this.data.forEach(function(i){return i instanceof t?e.push.apply(e,i.getTweens()):i instanceof Pr&&!(i.parent&&"nested"===i.parent.data)&&e.push(i)}),e},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(t,e){var i=this;if(t?function(){for(var e,r=i.getTweens(),s=i.data.length;s--;)"isFlip"===(e=i.data[s]).data&&(e.revert(),e.getChildren(!0,!0,!1).forEach(function(t){return r.splice(r.indexOf(t),1)}));for(r.map(function(t){return{g:t._dur||t._delay||t._sat&&!t._sat.vars.immediateRender?t.globalTime(0):-Infinity,t}}).sort(function(t,e){return e.g-t.g||-Infinity}).forEach(function(e){return e.t.revert(t)}),s=i.data.length;s--;)(e=i.data[s])instanceof _r?"nested"!==e.data&&(e.scrollTrigger&&e.scrollTrigger.revert(),e.kill()):!(e instanceof Pr)&&e.revert&&e.revert(t);i._r.forEach(function(e){return e(t,i)}),i.isReverted=!0}():this.data.forEach(function(t){return t.kill&&t.kill()}),this.clear(),e)for(var r=Nr.length;r--;)Nr[r].id===this.id&&Nr.splice(r,1)},e.revert=function(t){this.kill(t||{})},t}(),Hr=/*#__PURE__*/function(){function t(t){this.contexts=[],this.scope=t,Dt&&Dt.data.push(this)}var e=t.prototype;return e.add=function(t,e,i){he(t)||(t={matches:t});var r,s,n,a=new qr(0,i||this.scope),o=a.conditions={};for(s in Dt&&!a.selector&&(a.selector=Dt.selector),this.contexts.push(a),e=a.add("onMatch",e),a.queries=t,t)"all"===s?n=1:(r=zt.matchMedia(t[s]))&&(Nr.indexOf(a)<0&&Nr.push(a),(o[s]=r.matches)&&(n=1),r.addListener?r.addListener(Yr):r.addEventListener("change",Yr));return n&&e(a,function(t){return a.add(null,t)}),this},e.revert=function(t){this.kill(t||{})},e.kill=function(t){this.contexts.forEach(function(e){return e.kill(t,!0)})},t}(),Zr={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];e.forEach(function(t){return Gi(t)})},timeline:function(t){return new _r(t)},getTweensOf:function(t,e){return Ft.getTweensOf(t,e)},getProperty:function(t,e,i,r){se(t)&&(t=Ei(t)[0]);var s=Ne(t||{}).get,n=i?Qe:Ze;return"native"===i&&(i=""),t?e?n((Fe[e]&&Fe[e].get||s)(t,e,i,r)):function(e,i,r){return n((Fe[e]&&Fe[e].get||s)(t,e,i,r))}:t},quickSetter:function(t,e,i){if((t=Ei(t)).length>1){var r=t.map(function(t){return Kr.quickSetter(t,e,i)}),s=r.length;return function(t){for(var e=s;e--;)r[e](t)}}var n=Fe[e],a=Ne(t=t[0]||{}),o=a.harness&&(a.harness.aliases||{})[e]||e,h=n?function(e){var r=new n;Nt._pt=0,r.init(t,i?e+i:e,Nt,0,[t]),r.render(1,r),Nt._pt&&Fr(1,Nt)}:a.set(t,o);return n?h:function(e){return h(t,o,i?e+i:e,a,1)}},quickTo:function(t,e,i){var r,s=Kr.to(t,$e(((r={})[e]="+=0.1",r.paused=!0,r.stagger=0,r),i||{})),n=function(t,i,r){return s.resetTo(e,t,i,r)};return n.tween=s,n},isTweening:function(t){return Ft.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=or(t.ease,Zt.ease)),Je(Zt,t||{})},config:function(t){return Je(Ht,t||{})},registerEffect:function(t){var e=t.name,i=t.effect,r=t.defaults,s=t.extendTimeline;(t.plugins||"").split(",").forEach(function(t){return t&&!Fe[t]&&!be[t]&&Pe(e+" effect requires "+t+" plugin.")}),ze[e]=function(t,e,s){return i(Ei(t),$e(e||{},r),s)},s&&(_r.prototype[e]=function(t,i,r){return this.add(ze[e](t,he(i)?i:(r=i)&&{},this),r)})},registerEase:function(t,e){er[t]=or(e)},parseEase:function(t,e){return arguments.length?or(t,e):er},getById:function(t){return Ft.getById(t)},exportRoot:function(t,e){void 0===t&&(t={});var i,r,s=new _r(t);for(s.smoothChildTiming=le(t.smoothChildTiming),Ft.remove(s),s._dp=0,s._time=s._tTime=Ft._time,i=Ft._first;i;)r=i._next,!e&&!i._dur&&i instanceof Pr&&i.vars.onComplete===i._targets[0]||_i(s,i,i._start-i._delay),i=r;return _i(Ft,s,0),s},context:function(t,e){return t?new qr(t,e):Dt},matchMedia:function(t){return new Hr(t)},matchMediaRefresh:function(){return Nr.forEach(function(t){var e,i,r=t.conditions;for(i in r)r[i]&&(r[i]=!1,e=1);e&&t.revert()})||Yr()},addEventListener:function(t,e){var i=Br[t]||(Br[t]=[]);~i.indexOf(e)||i.push(e)},removeEventListener:function(t,e){var i=Br[t],r=i&&i.indexOf(e);r>=0&&i.splice(r,1)},utils:{wrap:function t(e,i,r){var s=i-e;return pe(e)?Li(e,t(0,e.length),i):Ri(r,function(t){return(s+(t-e)%s)%s+e})},wrapYoyo:function t(e,i,r){var s=i-e,n=2*s;return pe(e)?Li(e,t(0,e.length-1),i):Ri(r,function(t){return e+((t=(n+(t-e)%n)%n||0)>s?n-t:t)})},distribute:Oi,random:zi,snap:Fi,normalize:function(t,e,i){return Ui(t,e,0,1,i)},getUnit:Si,clamp:function(t,e,i){return Ri(i,function(i){return Pi(t,e,i)})},splitColor:qi,toArray:Ei,selector:Ai,mapRange:Ui,pipe:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return function(t){return e.reduce(function(t,e){return e(t)},t)}},unitize:function(t,e){return function(i){return t(parseFloat(i))+(e||Si(i))}},interpolate:function t(e,i,r,s){var n=isNaN(e+i)?0:function(t){return(1-t)*e+t*i};if(!n){var a,o,h,l,u,d=se(e),c={};if(!0===r&&(s=1)&&(r=null),d)e={p:e},i={p:i};else if(pe(e)&&!pe(i)){for(h=[],u=(l=e.length)-2,o=1;o<l;o++)h.push(t(e[o-1],e[o]));l--,n=function(t){t*=l;var e=Math.min(u,~~t);return h[e](t-e)},r=i}else s||(e=Ke(pe(e)?[]:{},e));if(!h){for(a in i)vr.call(c,e,a,"get",i[a]);n=function(t){return Fr(t,c)||(d?e.p:e)}}}return Ri(r,n)},shuffle:ki},install:Te,effects:ze,ticker:Ji,updateRoot:_r.updateRoot,plugins:Fe,globalTimeline:Ft,core:{PropTween:Vr,globals:Se,Tween:Pr,Timeline:_r,Animation:pr,getCache:Ne,_removeLinkedListItem:ri,reverting:function(){return Ot},context:function(t){return t&&Dt&&(Dt.data.push(t),t._ctx=Dt),Dt},suppressOverwrites:function(t){return kt=t}}};We("to,from,fromTo,delayedCall,set,killTweensOf",function(t){return Zr[t]=Pr[t]}),Ji.add(_r.updateRoot),Nt=Zr.to({},{duration:0});var Qr=function(t,e){for(var i=t._pt;i&&i.p!==e&&i.op!==e&&i.fp!==e;)i=i._next;return i},$r=function(t,e){return{name:t,rawVars:1,init:function(t,i,r){r._onInit=function(t){var r,s;if(se(i)&&(r={},We(i,function(t){return r[t]=1}),i=r),e){for(s in r={},i)r[s]=e(i[s]);i=r}!function(t,e){var i,r,s,n=t._targets;for(i in e)for(r=n.length;r--;)(s=t._ptLookup[r][i])&&(s=s.d)&&(s._pt&&(s=Qr(s,i)),s&&s.modifier&&s.modifier(e[i],t,n[r],i))}(t,i)}}}},Kr=Zr.registerPlugin({name:"attr",init:function(t,e,i,r,s){var n,a,o;for(n in this.tween=i,e)o=t.getAttribute(n)||"",(a=this.add(t,"setAttribute",(o||0)+"",e[n],r,s,0,0,n)).op=n,a.b=o,this._props.push(n)},render:function(t,e){for(var i=e._pt;i;)Ot?i.set(i.t,i.p,i.b,i):i.r(t,i.d),i=i._next}},{name:"endArray",init:function(t,e){for(var i=e.length;i--;)this.add(t,i,t[i]||0,e[i],0,0,0,0,0,1)}},$r("roundProps",Di),$r("modifiers"),$r("snap",Fi))||Zr;Pr.version=_r.version=Kr.version="3.12.7",Ut=1,ue()&&tr();var Jr,ts,es,is,rs,ss,ns,as,os={},hs=180/Math.PI,ls=Math.PI/180,us=Math.atan2,ds=/([A-Z])/g,cs=/(left|right|width|margin|padding|x)/i,ps=/[\s,\(]\S/,_s={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},ms=function(t,e){return e.set(e.t,e.p,Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},fs=function(t,e){return e.set(e.t,e.p,1===t?e.e:Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},gs=function(t,e){return e.set(e.t,e.p,t?Math.round(1e4*(e.s+e.c*t))/1e4+e.u:e.b,e)},vs=function(t,e){var i=e.s+e.c*t;e.set(e.t,e.p,~~(i+(i<0?-.5:.5))+e.u,e)},xs=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},ys=function(t,e){return e.set(e.t,e.p,1!==t?e.b:e.e,e)},bs=function(t,e,i){return t.style[e]=i},ws=function(t,e,i){return t.style.setProperty(e,i)},Ts=function(t,e,i){return t._gsap[e]=i},Rs=function(t,e,i){return t._gsap.scaleX=t._gsap.scaleY=i},Ps=function(t,e,i,r,s){var n=t._gsap;n.scaleX=n.scaleY=i,n.renderTransform(s,n)},Ss=function(t,e,i,r,s){var n=t._gsap;n[e]=i,n.renderTransform(s,n)},Cs="transform",Ms=Cs+"Origin",Es=function t(e,i){var r=this,s=this.target,n=s.style,a=s._gsap;if(e in os&&n){if(this.tfm=this.tfm||{},"transform"===e)return _s.transform.split(",").forEach(function(e){return t.call(r,e,i)});if(~(e=_s[e]||e).indexOf(",")?e.split(",").forEach(function(t){return r.tfm[t]=qs(s,t)}):this.tfm[e]=a.x?a[e]:qs(s,e),e===Ms&&(this.tfm.zOrigin=a.zOrigin),this.props.indexOf(Cs)>=0)return;a.svg&&(this.svgo=s.getAttribute("data-svg-origin"),this.props.push(Ms,i,"")),e=Cs}(n||i)&&this.props.push(e,i,n[e])},As=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},ks=function(){var t,e,i=this.props,r=this.target,s=r.style,n=r._gsap;for(t=0;t<i.length;t+=3)i[t+1]?2===i[t+1]?r[i[t]](i[t+2]):r[i[t]]=i[t+2]:i[t+2]?s[i[t]]=i[t+2]:s.removeProperty("--"===i[t].substr(0,2)?i[t]:i[t].replace(ds,"-$1").toLowerCase());if(this.tfm){for(e in this.tfm)n[e]=this.tfm[e];n.svg&&(n.renderTransform(),r.setAttribute("data-svg-origin",this.svgo||"")),(t=ns())&&t.isStart||s[Cs]||(As(s),n.zOrigin&&s[Ms]&&(s[Ms]+=" "+n.zOrigin+"px",n.zOrigin=0,n.renderTransform()),n.uncache=1)}},Os=function(t,e){var i={target:t,props:[],revert:ks,save:Es};return t._gsap||Kr.core.getCache(t),e&&t.style&&t.nodeType&&e.split(",").forEach(function(t){return i.save(t)}),i},Ds=function(t,e){var i=ts.createElementNS?ts.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):ts.createElement(t);return i&&i.style?i:ts.createElement(t)},Fs=function t(e,i,r){var s=getComputedStyle(e);return s[i]||s.getPropertyValue(i.replace(ds,"-$1").toLowerCase())||s.getPropertyValue(i)||!r&&t(e,Ls(i)||i,1)||""},zs="O,Moz,ms,Ms,Webkit".split(","),Ls=function(t,e,i){var r=(e||rs).style,s=5;if(t in r&&!i)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);s--&&!(zs[s]+t in r););return s<0?null:(3===s?"ms":s>=0?zs[s]:"")+t},Is=function(){"undefined"!=typeof window&&window.document&&(Jr=window,es=(ts=Jr.document).documentElement,rs=Ds("div")||{style:{}},Ds("div"),Cs=Ls(Cs),Ms=Cs+"Origin",rs.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",as=!!Ls("perspective"),ns=Kr.core.reverting,is=1)},Us=function(t){var e,i=t.ownerSVGElement,r=Ds("svg",i&&i.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),s=t.cloneNode(!0);s.style.display="block",r.appendChild(s),es.appendChild(r);try{e=s.getBBox()}catch(t){}return r.removeChild(s),es.removeChild(r),e},Vs=function(t,e){for(var i=e.length;i--;)if(t.hasAttribute(e[i]))return t.getAttribute(e[i])},Ns=function(t){var e,i;try{e=t.getBBox()}catch(r){e=Us(t),i=1}return e&&(e.width||e.height)||i||(e=Us(t)),!e||e.width||e.x||e.y?e:{x:+Vs(t,["x","cx","x1"])||0,y:+Vs(t,["y","cy","y1"])||0,width:0,height:0}},Bs=function(t){return!(!t.getCTM||t.parentNode&&!t.ownerSVGElement||!Ns(t))},Ws=function(t,e){if(e){var i,r=t.style;e in os&&e!==Ms&&(e=Cs),r.removeProperty?("ms"!==(i=e.substr(0,2))&&"webkit"!==e.substr(0,6)||(e="-"+e),r.removeProperty("--"===i?e:e.replace(ds,"-$1").toLowerCase())):r.removeAttribute(e)}},Gs=function(t,e,i,r,s,n){var a=new Vr(t._pt,e,i,0,1,n?ys:xs);return t._pt=a,a.b=r,a.e=s,t._props.push(i),a},Xs={deg:1,rad:1,turn:1},js={grid:1,flex:1},Ys=function t(e,i,r,s){var n,a,o,h,l=parseFloat(r)||0,u=(r+"").trim().substr((l+"").length)||"px",d=rs.style,c=cs.test(i),p="svg"===e.tagName.toLowerCase(),_=(p?"client":"offset")+(c?"Width":"Height"),m=100,f="px"===s,g="%"===s;if(s===u||!l||Xs[s]||Xs[u])return l;if("px"!==u&&!f&&(l=t(e,i,r,"px")),h=e.getCTM&&Bs(e),(g||"%"===u)&&(os[i]||~i.indexOf("adius")))return n=h?e.getBBox()[c?"width":"height"]:e[_],Ge(g?l/n*m:l/100*n);if(d[c?"width":"height"]=m+(f?u:s),a="rem"!==s&&~i.indexOf("adius")||"em"===s&&e.appendChild&&!p?e:e.parentNode,h&&(a=(e.ownerSVGElement||{}).parentNode),a&&a!==ts&&a.appendChild||(a=ts.body),(o=a._gsap)&&g&&o.width&&c&&o.time===Ji.time&&!o.uncache)return Ge(l/o.width*m);if(!g||"height"!==i&&"width"!==i)(g||"%"===u)&&!js[Fs(a,"display")]&&(d.position=Fs(e,"position")),a===e&&(d.position="static"),a.appendChild(rs),n=rs[_],a.removeChild(rs),d.position="absolute";else{var v=e.style[i];e.style[i]=m+s,n=e[_],v?e.style[i]=v:Ws(e,i)}return c&&g&&((o=Ne(a)).time=Ji.time,o.width=a[_]),Ge(f?n*l/m:n&&l?m/n*l:0)},qs=function(t,e,i,r){var s;return is||Is(),e in _s&&"transform"!==e&&~(e=_s[e]).indexOf(",")&&(e=e.split(",")[0]),os[e]&&"transform"!==e?(s=nn(t,r),s="transformOrigin"!==e?s[e]:s.svg?s.origin:an(Fs(t,Ms))+" "+s.zOrigin+"px"):(!(s=t.style[e])||"auto"===s||r||~(s+"").indexOf("calc("))&&(s=$s[e]&&$s[e](t,e,i)||Fs(t,e)||Be(t,e)||("opacity"===e?1:0)),i&&!~(s+"").trim().indexOf(" ")?Ys(t,e,s,i)+i:s},Hs=function(t,e,i,r){if(!i||"none"===i){var s=Ls(e,t,1),n=s&&Fs(t,s,1);n&&n!==i?(e=s,i=n):"borderColor"===e&&(i=Fs(t,"borderTopColor"))}var a,o,h,l,u,d,c,p,_,m,f,g=new Vr(this._pt,t.style,e,0,1,Dr),v=0,x=0;if(g.b=i,g.e=r,i+="","auto"==(r+="")&&(d=t.style[e],t.style[e]=r,r=Fs(t,e)||r,d?t.style[e]=d:Ws(t,e)),Ki(a=[i,r]),r=a[1],h=(i=a[0]).match(fe)||[],(r.match(fe)||[]).length){for(;o=fe.exec(r);)c=o[0],_=r.substring(v,o.index),u?u=(u+1)%5:"rgba("!==_.substr(-5)&&"hsla("!==_.substr(-5)||(u=1),c!==(d=h[x++]||"")&&(l=parseFloat(d)||0,f=d.substr((l+"").length),"="===c.charAt(1)&&(c=je(l,c)+f),p=parseFloat(c),m=c.substr((p+"").length),v=fe.lastIndex-m.length,m||(m=m||Ht.units[e]||f,v===r.length&&(r+=m,g.e+=m)),f!==m&&(l=Ys(t,e,d,m)||0),g._pt={_next:g._pt,p:_||1===x?_:",",s:l,c:p-l,m:u&&u<4||"zIndex"===e?Math.round:0});g.c=v<r.length?r.substring(v,r.length):""}else g.r="display"===e&&"none"===r?ys:xs;return ve.test(r)&&(g.e=0),this._pt=g,g},Zs={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Qs=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var i,r,s,n=e.t,a=n.style,o=e.u,h=n._gsap;if("all"===o||!0===o)a.cssText="",r=1;else for(s=(o=o.split(",")).length;--s>-1;)os[i=o[s]]&&(r=1,i="transformOrigin"===i?Ms:Cs),Ws(n,i);r&&(Ws(n,Cs),h&&(h.svg&&n.removeAttribute("transform"),a.scale=a.rotate=a.translate="none",nn(n,1),h.uncache=1,As(a)))}},$s={clearProps:function(t,e,i,r,s){if("isFromStart"!==s.data){var n=t._pt=new Vr(t._pt,e,i,0,0,Qs);return n.u=r,n.pr=-10,n.tween=s,t._props.push(i),1}}},Ks=[1,0,0,1,0,0],Js={},tn=function(t){return"matrix(1, 0, 0, 1, 0, 0)"===t||"none"===t||!t},en=function(t){var e=Fs(t,Cs);return tn(e)?Ks:e.substr(7).match(me).map(Ge)},rn=function(t,e){var i,r,s,n,a=t._gsap||Ne(t),o=t.style,h=en(t);return a.svg&&t.getAttribute("transform")?"1,0,0,1,0,0"===(h=[(s=t.transform.baseVal.consolidate().matrix).a,s.b,s.c,s.d,s.e,s.f]).join(",")?Ks:h:(h!==Ks||t.offsetParent||t===es||a.svg||(s=o.display,o.display="block",(i=t.parentNode)&&(t.offsetParent||t.getBoundingClientRect().width)||(n=1,r=t.nextElementSibling,es.appendChild(t)),h=en(t),s?o.display=s:Ws(t,"display"),n&&(r?i.insertBefore(t,r):i?i.appendChild(t):es.removeChild(t))),e&&h.length>6?[h[0],h[1],h[4],h[5],h[12],h[13]]:h)},sn=function(t,e,i,r,s,n){var a,o,h,l=t._gsap,u=s||rn(t,!0),d=l.xOrigin||0,c=l.yOrigin||0,p=l.xOffset||0,_=l.yOffset||0,m=u[0],f=u[1],g=u[2],v=u[3],x=u[4],y=u[5],b=e.split(" "),w=parseFloat(b[0])||0,T=parseFloat(b[1])||0;i?u!==Ks&&(o=m*v-f*g)&&(h=w*(-f/o)+T*(m/o)-(m*y-f*x)/o,w=w*(v/o)+T*(-g/o)+(g*y-v*x)/o,T=h):(w=(a=Ns(t)).x+(~b[0].indexOf("%")?w/100*a.width:w),T=a.y+(~(b[1]||b[0]).indexOf("%")?T/100*a.height:T)),r||!1!==r&&l.smooth?(l.xOffset=p+((x=w-d)*m+(y=T-c)*g)-x,l.yOffset=_+(x*f+y*v)-y):l.xOffset=l.yOffset=0,l.xOrigin=w,l.yOrigin=T,l.smooth=!!r,l.origin=e,l.originIsAbsolute=!!i,t.style[Ms]="0px 0px",n&&(Gs(n,l,"xOrigin",d,w),Gs(n,l,"yOrigin",c,T),Gs(n,l,"xOffset",p,l.xOffset),Gs(n,l,"yOffset",_,l.yOffset)),t.setAttribute("data-svg-origin",w+" "+T)},nn=function(t,e){var i=t._gsap||new cr(t);if("x"in i&&!e&&!i.uncache)return i;var r,s,n,a,o,h,l,u,d,c,p,_,m,f,g,v,x,y,b,w,T,R,P,S,C,M,E,A,k,O,D,F,z=t.style,L=i.scaleX<0,I="px",U="deg",V=getComputedStyle(t),N=Fs(t,Ms)||"0";return r=s=n=h=l=u=d=c=p=0,a=o=1,i.svg=!(!t.getCTM||!Bs(t)),V.translate&&("none"===V.translate&&"none"===V.scale&&"none"===V.rotate||(z[Cs]=("none"!==V.translate?"translate3d("+(V.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==V.rotate?"rotate("+V.rotate+") ":"")+("none"!==V.scale?"scale("+V.scale.split(" ").join(",")+") ":"")+("none"!==V[Cs]?V[Cs]:"")),z.scale=z.rotate=z.translate="none"),f=rn(t,i.svg),i.svg&&(i.uncache?(C=t.getBBox(),N=i.xOrigin-C.x+"px "+(i.yOrigin-C.y)+"px",S=""):S=!e&&t.getAttribute("data-svg-origin"),sn(t,S||N,!!S||i.originIsAbsolute,!1!==i.smooth,f)),_=i.xOrigin||0,m=i.yOrigin||0,f!==Ks&&(y=f[0],b=f[1],w=f[2],T=f[3],r=R=f[4],s=P=f[5],6===f.length?(a=Math.sqrt(y*y+b*b),o=Math.sqrt(T*T+w*w),h=y||b?us(b,y)*hs:0,(d=w||T?us(w,T)*hs+h:0)&&(o*=Math.abs(Math.cos(d*ls))),i.svg&&(r-=_-(_*y+m*w),s-=m-(_*b+m*T))):(O=f[7],E=f[8],A=f[9],D=f[11],r=f[12],s=f[13],n=f[14],l=(g=us(F=f[6],k=f[10]))*hs,g&&(S=R*(v=Math.cos(-g))+E*(x=Math.sin(-g)),C=P*v+A*x,M=F*v+k*x,E=R*-x+E*v,A=P*-x+A*v,k=F*-x+k*v,D=O*-x+D*v,R=S,P=C,F=M),u=(g=us(-w,k))*hs,g&&(v=Math.cos(-g),D=T*(x=Math.sin(-g))+D*v,y=S=y*v-E*x,b=C=b*v-A*x,w=M=w*v-k*x),h=(g=us(b,y))*hs,g&&(S=y*(v=Math.cos(g))+b*(x=Math.sin(g)),C=R*v+P*x,b=b*v-y*x,P=P*v-R*x,y=S,R=C),l&&Math.abs(l)+Math.abs(h)>359.9&&(l=h=0,u=180-u),a=Ge(Math.sqrt(y*y+b*b+w*w)),o=Ge(Math.sqrt(P*P+F*F)),g=us(R,P),d=Math.abs(g)>2e-4?g*hs:0,p=D?1/(D<0?-D:D):0),i.svg&&(S=t.getAttribute("transform"),i.forceCSS=t.setAttribute("transform","")||!tn(Fs(t,Cs)),S&&t.setAttribute("transform",S))),Math.abs(d)>90&&Math.abs(d)<270&&(L?(a*=-1,d+=h<=0?180:-180,h+=h<=0?180:-180):(o*=-1,d+=d<=0?180:-180)),e=e||i.uncache,i.x=r-((i.xPercent=r&&(!e&&i.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-r)?-50:0)))?t.offsetWidth*i.xPercent/100:0)+I,i.y=s-((i.yPercent=s&&(!e&&i.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-s)?-50:0)))?t.offsetHeight*i.yPercent/100:0)+I,i.z=n+I,i.scaleX=Ge(a),i.scaleY=Ge(o),i.rotation=Ge(h)+U,i.rotationX=Ge(l)+U,i.rotationY=Ge(u)+U,i.skewX=d+U,i.skewY=c+U,i.transformPerspective=p+I,(i.zOrigin=parseFloat(N.split(" ")[2])||!e&&i.zOrigin||0)&&(z[Ms]=an(N)),i.xOffset=i.yOffset=0,i.force3D=Ht.force3D,i.renderTransform=i.svg?pn:as?cn:hn,i.uncache=0,i},an=function(t){return(t=t.split(" "))[0]+" "+t[1]},on=function(t,e,i){var r=Si(e);return Ge(parseFloat(e)+parseFloat(Ys(t,"x",i+"px",r)))+r},hn=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,cn(t,e)},ln="0deg",un="0px",dn=") ",cn=function(t,e){var i=e||this,r=i.xPercent,s=i.yPercent,n=i.x,a=i.y,o=i.z,h=i.rotation,l=i.rotationY,u=i.rotationX,d=i.skewX,c=i.skewY,p=i.scaleX,_=i.scaleY,m=i.transformPerspective,f=i.force3D,g=i.target,v=i.zOrigin,x="",y="auto"===f&&t&&1!==t||!0===f;if(v&&(u!==ln||l!==ln)){var b,w=parseFloat(l)*ls,T=Math.sin(w),R=Math.cos(w);w=parseFloat(u)*ls,b=Math.cos(w),n=on(g,n,T*b*-v),a=on(g,a,-Math.sin(w)*-v),o=on(g,o,R*b*-v+v)}m!==un&&(x+="perspective("+m+dn),(r||s)&&(x+="translate("+r+"%, "+s+"%) "),(y||n!==un||a!==un||o!==un)&&(x+=o!==un||y?"translate3d("+n+", "+a+", "+o+") ":"translate("+n+", "+a+dn),h!==ln&&(x+="rotate("+h+dn),l!==ln&&(x+="rotateY("+l+dn),u!==ln&&(x+="rotateX("+u+dn),d===ln&&c===ln||(x+="skew("+d+", "+c+dn),1===p&&1===_||(x+="scale("+p+", "+_+dn),g.style[Cs]=x||"translate(0, 0)"},pn=function(t,e){var i,r,s,n,a,o=e||this,h=o.xPercent,l=o.yPercent,u=o.x,d=o.y,c=o.rotation,p=o.skewX,_=o.skewY,m=o.scaleX,f=o.scaleY,g=o.target,v=o.xOrigin,x=o.yOrigin,y=o.xOffset,b=o.yOffset,w=o.forceCSS,T=parseFloat(u),R=parseFloat(d);c=parseFloat(c),p=parseFloat(p),(_=parseFloat(_))&&(p+=_=parseFloat(_),c+=_),c||p?(c*=ls,p*=ls,i=Math.cos(c)*m,r=Math.sin(c)*m,s=Math.sin(c-p)*-f,n=Math.cos(c-p)*f,p&&(_*=ls,a=Math.tan(p-_),s*=a=Math.sqrt(1+a*a),n*=a,_&&(a=Math.tan(_),i*=a=Math.sqrt(1+a*a),r*=a)),i=Ge(i),r=Ge(r),s=Ge(s),n=Ge(n)):(i=m,n=f,r=s=0),(T&&!~(u+"").indexOf("px")||R&&!~(d+"").indexOf("px"))&&(T=Ys(g,"x",u,"px"),R=Ys(g,"y",d,"px")),(v||x||y||b)&&(T=Ge(T+v-(v*i+x*s)+y),R=Ge(R+x-(v*r+x*n)+b)),(h||l)&&(a=g.getBBox(),T=Ge(T+h/100*a.width),R=Ge(R+l/100*a.height)),g.setAttribute("transform",a="matrix("+i+","+r+","+s+","+n+","+T+","+R+")"),w&&(g.style[Cs]=a)},_n=function(t,e,i,r,s){var n,a,o=360,h=se(s),l=parseFloat(s)*(h&&~s.indexOf("rad")?hs:1)-r,u=r+l+"deg";return h&&("short"===(n=s.split("_")[1])&&(l%=o)!=l%180&&(l+=l<0?o:-360),"cw"===n&&l<0?l=(l+36e9)%o-~~(l/o)*o:"ccw"===n&&l>0&&(l=(l-36e9)%o-~~(l/o)*o)),t._pt=a=new Vr(t._pt,e,i,r,l,fs),a.e=u,a.u="deg",t._props.push(i),a},mn=function(t,e){for(var i in e)t[i]=e[i];return t},fn=function(t,e,i){var r,s,n,a,o,h,l,u=mn({},i._gsap),d=i.style;for(s in u.svg?(n=i.getAttribute("transform"),i.setAttribute("transform",""),d[Cs]=e,r=nn(i,1),Ws(i,Cs),i.setAttribute("transform",n)):(n=getComputedStyle(i)[Cs],d[Cs]=e,r=nn(i,1),d[Cs]=n),os)(n=u[s])!==(a=r[s])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(s)<0&&(o=Si(n)!==(l=Si(a))?Ys(i,s,n,l):parseFloat(n),h=parseFloat(a),t._pt=new Vr(t._pt,r,s,o,h-o,ms),t._pt.u=l||0,t._props.push(s));mn(r,u)};We("padding,margin,Width,Radius",function(t,e){var i="Top",r="Right",s="Bottom",n="Left",a=(e<3?[i,r,s,n]:[i+n,i+r,s+r,s+n]).map(function(i){return e<2?t+i:"border"+i+t});$s[e>1?"border"+t:t]=function(t,e,i,r,s){var n,o;if(arguments.length<4)return n=a.map(function(e){return qs(t,e,i)}),5===(o=n.join(" ")).split(n[0]).length?n[0]:o;n=(r+"").split(" "),o={},a.forEach(function(t,e){return o[t]=n[e]=n[e]||n[(e-1)/2|0]}),t.init(e,o,s)}});var gn,vn,xn={name:"css",register:Is,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,i,r,s){var n,a,o,h,l,u,d,c,p,_,m,f,g,v,x,y,b,w,T,R,P=this._props,S=t.style,C=i.vars.startAt;for(d in is||Is(),this.styles=this.styles||Os(t),y=this.styles.props,this.tween=i,e)if("autoRound"!==d&&(a=e[d],!Fe[d]||!xr(d,e,i,r,t,s)))if(u=$s[d],"function"==(l=typeof a)&&(l=typeof(a=a.call(i,r,t,s))),"string"===l&&~a.indexOf("random(")&&(a=Ii(a)),u)u(this,t,d,a,i)&&(x=1);else if("--"===d.substr(0,2))n=(getComputedStyle(t).getPropertyValue(d)+"").trim(),a+="",Qi.lastIndex=0,Qi.test(n)||(c=Si(n),p=Si(a)),p?c!==p&&(n=Ys(t,d,n,p)+p):c&&(a+=c),this.add(S,"setProperty",n,a,r,s,0,0,d),P.push(d),y.push(d,0,S[d]);else if("undefined"!==l){if(C&&d in C?(n="function"==typeof C[d]?C[d].call(i,r,t,s):C[d],se(n)&&~n.indexOf("random(")&&(n=Ii(n)),Si(n+"")||"auto"===n||(n+=Ht.units[d]||Si(qs(t,d))||""),"="===(n+"").charAt(1)&&(n=qs(t,d))):n=qs(t,d),h=parseFloat(n),(_="string"===l&&"="===a.charAt(1)&&a.substr(0,2))&&(a=a.substr(2)),o=parseFloat(a),d in _s&&("autoAlpha"===d&&(1===h&&"hidden"===qs(t,"visibility")&&o&&(h=0),y.push("visibility",0,S.visibility),Gs(this,S,"visibility",h?"inherit":"hidden",o?"inherit":"hidden",!o)),"scale"!==d&&"transform"!==d&&~(d=_s[d]).indexOf(",")&&(d=d.split(",")[0])),m=d in os)if(this.styles.save(d),f||((g=t._gsap).renderTransform&&!e.parseTransform||nn(t,e.parseTransform),v=!1!==e.smoothOrigin&&g.smooth,(f=this._pt=new Vr(this._pt,S,Cs,0,1,g.renderTransform,g,0,-1)).dep=1),"scale"===d)this._pt=new Vr(this._pt,g,"scaleY",g.scaleY,(_?je(g.scaleY,_+o):o)-g.scaleY||0,ms),this._pt.u=0,P.push("scaleY",d),d+="X";else{if("transformOrigin"===d){y.push(Ms,0,S[Ms]),w=void 0,T=void 0,R=void 0,R=(w=(b=a).split(" "))[1]||"50%","top"!==(T=w[0])&&"bottom"!==T&&"left"!==R&&"right"!==R||(b=T,T=R,R=b),w[0]=Zs[T]||T,w[1]=Zs[R]||R,a=w.join(" "),g.svg?sn(t,a,0,v,0,this):((p=parseFloat(a.split(" ")[2])||0)!==g.zOrigin&&Gs(this,g,"zOrigin",g.zOrigin,p),Gs(this,S,d,an(n),an(a)));continue}if("svgOrigin"===d){sn(t,a,1,v,0,this);continue}if(d in Js){_n(this,g,d,h,_?je(h,_+a):a);continue}if("smoothOrigin"===d){Gs(this,g,"smooth",g.smooth,a);continue}if("force3D"===d){g[d]=a;continue}if("transform"===d){fn(this,a,t);continue}}else d in S||(d=Ls(d)||d);if(m||(o||0===o)&&(h||0===h)&&!ps.test(a)&&d in S)o||(o=0),(c=(n+"").substr((h+"").length))!==(p=Si(a)||(d in Ht.units?Ht.units[d]:c))&&(h=Ys(t,d,n,p)),this._pt=new Vr(this._pt,m?g:S,d,h,(_?je(h,_+o):o)-h,m||"px"!==p&&"zIndex"!==d||!1===e.autoRound?ms:vs),this._pt.u=p||0,c!==p&&"%"!==p&&(this._pt.b=n,this._pt.r=gs);else if(d in S)Hs.call(this,t,d,n,_?_+a:a);else if(d in t)this.add(t,d,n||t[d],_?_+a:a,r,s);else if("parseTransform"!==d){Re(d,a);continue}m||(d in S?y.push(d,0,S[d]):"function"==typeof t[d]?y.push(d,2,t[d]()):y.push(d,1,n||t[d])),P.push(d)}x&&Ur(this)},render:function(t,e){if(e.tween._time||!ns())for(var i=e._pt;i;)i.r(t,i.d),i=i._next;else e.styles.revert()},get:qs,aliases:_s,getSetter:function(t,e,i){var r=_s[e];return r&&r.indexOf(",")<0&&(e=r),e in os&&e!==Ms&&(t._gsap.x||qs(t,"x"))?i&&ss===i?"scale"===e?Rs:Ts:(ss=i||{})&&("scale"===e?Ps:Ss):t.style&&!oe(t.style[e])?bs:~e.indexOf("-")?ws:Ar(t,e)},core:{_removeProperty:Ws,_getMatrix:rn}};Kr.utils.checkPrefix=Ls,Kr.core.getStyleSaver=Os,vn=We("x,y,z,scale,scaleX,scaleY,xPercent,yPercent,"+(gn="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",function(t){os[t]=1}),We(gn,function(t){Ht.units[t]="deg",Js[t]=1}),_s[vn[13]]="x,y,z,scale,scaleX,scaleY,xPercent,yPercent,"+gn,We("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",function(t){var e=t.split(":");_s[e[1]]=vn[e[0]]}),We("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(t){Ht.units[t]="px"}),Kr.registerPlugin(xn);var yn=Kr.registerPlugin(xn)||Kr;const bn=(t,e=0)=>{const i=new class{constructor(t){this.canvas=t.canvas,this.imagesSrc=t.imagesSrc,this.webGLCurtain=new V({container:this.canvas}),this.plane=null,this.textures={texture0:null,texture1:null,map:null},this.currentIndex=t.initialIndex||0,this.isTransitioning=!1,this.params={vertexShader:Tn,fragmentShader:wn,widthSegments:40,heightSegments:40,uniforms:{time:{name:"uTime",type:"1f",value:0},mousepos:{name:"uMouse",type:"2f",value:[0,0]},resolution:{name:"uReso",type:"2f",value:[innerWidth,innerHeight]},progress:{name:"uProgress",type:"1f",value:0}}}}async loadTexture(t,e){const i=document.createElement("img");return i.crossOrigin="anonymous",i.src=t,await i.decode(),new rt(this.webGLCurtain,{sampler:e,fromTexture:i})}async initPlane(){const t=document.createElement("div");t.className="plane",document.getElementById("wrap-texture").appendChild(t);const e=document.createElement("img");e.setAttribute("data-sampler","texture0"),e.src=this.imagesSrc[this.currentIndex];const i=document.createElement("img");i.setAttribute("data-sampler","texture1"),i.src=this.imagesSrc[this.currentIndex];const r=document.createElement("img");r.setAttribute("data-sampler","map"),r.src="https://i.ibb.co/n8MjCrk/seed129873123-scale10-fbm-worley-quintic-octaves2.jpg",t.appendChild(e),t.appendChild(i),t.appendChild(r),this.plane=new Mt(this.webGLCurtain,t,this.params),this.plane.onReady(()=>{this.textures.texture0=this.plane.textures[0],this.textures.texture1=this.plane.textures[1],this.textures.map=this.plane.textures[2],this.update()})}update(){this.plane.onRender(()=>{this.plane.uniforms.time.value+=.01,this.plane.uniforms.resolution.value=[innerWidth,innerHeight]})}async goToIndex(t){if(t<0||t>=this.imagesSrc.length||t===this.currentIndex||this.isTransitioning)return;this.isTransitioning=!0;const e=this.imagesSrc[t],i=new Image;i.crossOrigin="anonymous",i.src=e,await i.decode(),this.textures.texture1.setSource(i),this.plane.uniforms.progress.value=0,await yn.to(this.plane.uniforms.progress,{value:1,duration:.7,onComplete:()=>{this.textures.texture0.setSource(i),this.plane.uniforms.progress.value=0,this.currentIndex=t,this.isTransitioning=!1}})}}({canvas:document.getElementById("canvas"),imagesSrc:t,initialIndex:e});return i.initPlane(),i},wn="\n   #ifdef GL_ES\n    precision mediump float;\n    #endif\n\n    #define PI2 6.28318530718\n    #define PI 3.14159265359\n    #define S(a,b,n) smoothstep(a,b,n)\n\n    uniform float uTime;\n    uniform float uProgress;\n    uniform vec2 uReso;\n    uniform vec2 uMouse;\n\n    varying vec3 vVertexPosition;\n    varying vec2 vTextureCoord0;\n    varying vec2 vTextureCoord1;\n    varying vec2 vTextureCoordMap;\n\n    uniform sampler2D texture0;\n    uniform sampler2D texture1;\n    uniform sampler2D map;\n\n    float exponentialEasing (float x, float a){\n      float epsilon = 0.00001;\n      float min_param_a = 0.0 + epsilon;\n      float max_param_a = 1.0 - epsilon;\n      a = max(min_param_a, min(max_param_a, a));\n      if (a < 0.5){\n        a = 2.0 * a;\n        return pow(x, a);\n      } else {\n        a = 2.0 * (a - 0.5);\n        return pow(x, 1.0 / (1.0 - a));\n      }\n    }\n\n    vec4 blur13(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n      vec4 color = vec4(0.0);\n      vec2 off1 = vec2(1.41176) * direction;\n      vec2 off2 = vec2(3.29411) * direction;\n      vec2 off3 = vec2(5.17647) * direction;\n      color += texture2D(image, uv) * 0.19648;\n      color += texture2D(image, uv + (off1 / resolution)) * 0.29691;\n      color += texture2D(image, uv - (off1 / resolution)) * 0.29691;\n      color += texture2D(image, uv + (off2 / resolution)) * 0.09447;\n      color += texture2D(image, uv - (off2 / resolution)) * 0.09447;\n      color += texture2D(image, uv + (off3 / resolution)) * 0.01038;\n      color += texture2D(image, uv - (off3 / resolution)) * 0.01038;\n      return color;\n    }\n\n    void main() {\n        vec2 uv0 = vTextureCoord0;\n        vec2 uv1 = vTextureCoord1;\n\n        float progress0 = uProgress;\n        float progress1 = 1.0 - uProgress;\n\n        vec4 mapTex = blur13(map, vTextureCoordMap, uReso, vec2(2.0)) + 0.5;\n\n        uv0.x += progress0 * mapTex.r;\n        uv1.x -= progress1 * mapTex.r;\n\n        vec4 color = texture2D(texture0, uv0);\n        vec4 color1 = texture2D(texture1, uv1);\n\n        gl_FragColor = mix(color, color1, progress0);\n    }\n",Tn="\n   #ifdef GL_ES\n    precision mediump float;\n    #endif\n\n    attribute vec3 aVertexPosition;\n    attribute vec2 aTextureCoord;\n\n    uniform mat4 uMVMatrix;\n    uniform mat4 uPMatrix;\n\n    uniform mat4 texture0Matrix;\n    uniform mat4 texture1Matrix;\n    uniform mat4 mapMatrix;\n\n    varying vec3 vVertexPosition;\n    varying vec2 vTextureCoord0;\n    varying vec2 vTextureCoord1;\n    varying vec2 vTextureCoordMap;\n\n    void main() {\n        vec3 vertexPosition = aVertexPosition;\n\n        gl_Position = uPMatrix * uMVMatrix * vec4(vertexPosition, 1.0);\n\n        vTextureCoord0 = (texture0Matrix * vec4(aTextureCoord, 0.0, 1.0)).xy;\n        vTextureCoord1 = (texture1Matrix * vec4(aTextureCoord, 0.0, 1.0)).xy;\n        vTextureCoordMap = (mapMatrix * vec4(aTextureCoord, 0.0, 1.0)).xy;\n        vVertexPosition = vertexPosition;\n    }\n",Rn={x:0,touched:!1,pause:!1,lastCX:void 0,lastCY:void 0,bg:void 0,lastBg:void 0,overlay:!0,minimal:!0,scale:1,rotate:0};function Pn(n){const{loop:o=3,speed:u,easing:d,maskClosable:c=!0,maskOpacity:p=y,pullClosable:_=!0,bannerVisible:m=!0,overlayRender:f,toolbarRender:x,className:T,maskClassName:E,images:A,index:k=0,onIndexChange:O,visible:D,onClose:F,afterClose:z,portalContainer:L}=n,[I,U]=v(Rn),[V,N]=l(0),[B,W]=l(null),{touched:G,bg:X=p,lastBg:j,overlay:Y,scale:q,rotate:H,onScale:Z,onRotate:Q}=I,$=n.hasOwnProperty("index"),K=$?k:V,J=$?O:N,tt=r(K),et=A.length,it=A[K],rt="boolean"==typeof o?o:et>o,[st,nt,at]=function(t,e){const[,i]=s(t=>!t,!1),n=r(0),[a,o]=function(e){const i=r(e);function s(t){i.current=t}return h(()=>{(e=>{t?(e(t),n.current=1):n.current=2})(s)},[e]),[i.current,s]}(t);return[a,n.current,function(){i(),2===n.current&&(o(!1),e&&e()),n.current=0}]}(D,z);w(()=>{if(st)return U({pause:!0,x:K*-(innerWidth+20)}),void(tt.current=K);U(Rn)},[st]);const[ot,ht]=l(!0),[lt,ut]=l(null),{close:dt,changeIndex:ct}=g({close(t){Q&&Q(0),U({overlay:!0,lastBg:X}),F(t)},changeIndex(t,e=!1){lt&&clearTimeout(lt);const i=rt?tt.current+(t-K):t,r=et-1,s=((t,e,i)=>Math.max(Math.min(t,i),0))(i,0,r),n=rt?i:s,a=innerWidth+20;U({touched:!1,x:-a*tt.current,lastCX:void 0,lastCY:void 0,bg:p,overlay:Y}),console.log("changeIndex"),U({touched:!1,lastCX:void 0,lastCY:void 0,x:-a*n,pause:e}),tt.current=n;const o=t<0?r:t>r?0:t;J&&(J(rt?o:s),ot?(null==B||B.goToIndex(rt?o:s),ht(!1),ut(setTimeout(()=>{ht(!0)},700))):ut(setTimeout(()=>{null==B||B.goToIndex(rt?o:s),ht(!0)},700)))}});if(function(t,e){const i=r(e);i.current=e,a(()=>{function e(t){i.current(t)}return t&&window.addEventListener(t,e,void 0),()=>{t&&window.removeEventListener(t,e)}},[t])}("keydown",t=>{if(D)switch(t.key){case"ArrowLeft":ct(K-1,!0);break;case"ArrowRight":ct(K+1,!0);break;case"Escape":dt()}}),function(t,e,i){h(()=>{const r=t.length;return i?t.concat(t).concat(t).slice(r+e-1,r+e+2):t.slice(Math.max(e-1,0),Math.min(e+2,r+1))},[t,e,i])}(A,K,rt),a(()=>{st&&A&&requestAnimationFrame(()=>{if(!document.getElementById("canvas"))return;if(document.querySelector(".plane"))return;const t=bn(A.map(t=>t.src),K);W(t)})},[st,A]),!st)return null;const pt=Y&&!nt,_t=D?X:j,mt=Z&&Q&&{images:A,index:K,visible:D,onClose:dt,onIndexChange:ct,overlayVisible:pt,overlay:it&&it.overlay,scale:q,rotate:H,onScale:Z,onRotate:Q},ft=u?u(nt):400,gt=d?d(nt):"cubic-bezier(0.25, 0.8, 0.25, 1)";return!u||u(3),d&&d(3),e(R,{className:`PhotoView-Portal${pt?"":" PhotoView-Slider__clean"}${D?"":" PhotoView-Slider__willClose"}${T?` ${T}`:""}`,role:"dialog",onClick:t=>t.stopPropagation(),container:L,children:[D&&t(M,{}),t("div",{className:`PhotoView-Slider__Backdrop${E?` ${E}`:""}${1===nt?" PhotoView-Slider__fadeIn":2===nt?" PhotoView-Slider__fadeOut":""}`,style:{background:_t?`rgba(0, 0, 0, ${_t})`:void 0,transitionTimingFunction:gt,transitionDuration:`${G?0:ft}ms`,animationDuration:`${ft}ms`},onAnimationEnd:at}),m&&e("div",{className:"PhotoView-Slider__BannerWrap",children:[e("div",{className:"PhotoView-Slider__Counter",children:[K+1," / ",et]}),e("div",{className:"PhotoView-Slider__BannerRight",children:[x&&mt&&x(mt),t(P,{className:"close",onClick:dt})]})]}),t("div",{id:"wrap-texture",children:t("div",{id:"canvas"})}),!b&&m&&e(i,{children:[(rt||0!==K)&&t("div",{className:"PhotoView-Slider__ArrowLeft",onClick:()=>ct(K-1),children:t(S,{})}),(rt||K+1<et)&&t("div",{className:"PhotoView-Slider__ArrowRight",onClick:()=>ct(K+1),children:t(C,{})})]}),f&&mt&&t("div",{className:"PhotoView-Slider__Overlay",children:f(mt)})]})}const Sn=["children","onIndexChange","onVisibleChange"],Cn={images:[],visible:!1,index:0};function Mn(i){let{children:s,onIndexChange:n,onVisibleChange:a}=i,o=f(i,Sn);const[l,u]=v(Cn),d=r(0),{images:c,visible:p,index:_}=l,y=g({nextId:()=>d.current+=1,update(t){const e=c.findIndex(e=>e.key===t.key);if(e>-1){const i=c.slice();return i.splice(e,1,t),void u({images:i})}u(e=>({images:e.images.concat(t)}))},remove(t){u(e=>{const i=e.images.filter(e=>e.key!==t);return{images:i,index:Math.min(i.length-1,_)}})},show(t){const e=c.findIndex(e=>e.key===t);u({visible:!0,index:e}),a&&a(!0,e,l)}}),b=g({close(){u({visible:!1}),a&&a(!1,_,l)},changeIndex(t){u({index:t}),n&&n(t,l)}}),w=h(()=>m({},l,y),[l,y]);return e(x.Provider,{value:w,children:[s,t(Pn,m({images:c,visible:p,index:_,onIndexChange:b.changeIndex,onClose:b.close},o))]})}const En=({src:t,render:e,overlay:i,width:s,height:n,triggers:o=["onClick"],children:l})=>{const _=u(x),f=function(){const{current:t}=r({sign:!1,fn:void 0});return t.sign||(t.sign=!0,t.fn=_.nextId()),t.fn}(),v=r(null);d(null==l?void 0:l.ref,()=>v.current),a(()=>()=>{_.remove(f)},[]);const y=g({render:t=>e&&e(t),show(t,e){_.show(f),function(t,e){if(l){const i=l.props[t];i&&i(e)}}(t,e)}}),b=h(()=>{const t={};return o.forEach(e=>{t[e]=y.show.bind(null,e)}),t},[]);return a(()=>{_.update({key:f,src:t,originRef:v,render:y.render,overlay:i,width:s,height:n})},[t]),l?c.only(p(l,m({},b,{ref:v}))):null};export{Mn as PhotoProvider,Pn as PhotoSlider,En as PhotoView};
//# sourceMappingURL=react-photo-view.modern.js.map
